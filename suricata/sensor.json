{"2020051101": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Zabbix SQL(latest.php) \u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2016-10134\uff09|tag:SQL\u6ce8\u5165\u6f0f\u6d1e|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:Zabbix SQL(latest.php) \u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2016-10134\uff09|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, CVE-2016-10134;content:\"latest.php\";http_uri;nocase;content:\"toggle_ids[\";http_uri;distance:1;nocase;pcre:\"/select|union|order|convert|concat|group_concat|sleep|waitfor|substr|updatexml/URi\";sid:2020051101;rev:2;)", "2019090140": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Exim\u8fde\u63a5|direction:in|level:action|service_name:Exim(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Exim|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220[- ]([^\\r\\n]+) ESMTP Exim (V?\\d\\S+)/\";sid:2019090140;gid:0;)", "2019090269": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"E|00 00 00|\";depth:4;pcre:\"/^E\\0\\0\\0.S[^\\0]+\\0C0A000\\0Mel protocolo 65363/\";sid:2019090269;gid:0;)", "2020061803": "alert tcp $HOME_NET 3389 -> $EXTERNAL_NET any (msg:\"name:\u7206\u7834 windows \u8fdc\u7a0b\u684c\u9762\u670d\u52a1|tag:\u7206\u7834\u7834\u89e3|src:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u653b\u51fb\u8005\u7206\u7834 windows \u8fdc\u7a0b\u684c\u9762\u670d\u52a1\uff0c\u5c1d\u8bd5\u767b\u9646\u8fdc\u7a0b\u684c\u9762|attacker:dest\";flow:established, from_server;flowbits:isset, rdp_blasting;flowbits:set, is_hydra;threshold:type both,track by_dst,count 30, seconds 5;dsize:11;content:\"|03 00 00 0b 06 d0 00 00 12 34 00|\";depth:11;sid:2020061803;rev:1;)", "2827560": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike\u8fde\u63a5|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:\u5b58\u5728Cobalt Strike \u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\".png?cydac=\";http_uri;fast_pattern;content:\"&cydcn=\";http_uri;distance:0;content:\"&cydcs=\";http_uri;distance:0;content:\"&cydsr=\";http_uri;distance:0;content:\"&cydsc=\";http_uri;distance:0;content:\"&cydul=\";http_uri;distance:0;content:!\"Referer|3a|\";http_header;metadata:former_category MALWARE;reference:md5,6b2b65517778554fb66733b0a0473bb0;classtype:trojan-activity;sid:2827560;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2017_08_16, malware_family CobaltStrike, performance_impact Moderate, updated_at 2017_08_16;)", "2020081907": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fbeOA\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u901a\u8fbeOA\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, tongda_oa_afd_upload;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"{new_name:\";http_server_body;content:\"/../\";http_server_body;distance:0;within:50;sid:2020081907;rev:1;)", "2020021703": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u53cd\u5411\u4ee3\u7406\u8fde\u63a5|tag:\u53cd\u5411\u4ee3\u7406|dest:external_net|src:home_net|level:action|severity:2|result:unknown|o_msg:\u53cd\u5411\u4ee3\u7406\u8fde\u63a5\";flow:established, to_server;dsize:6;content:\"|01 04|\";offset:0;depth:2;sid:2020021703;rev:1;)", "2020030003": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u8681\u5251\u8fde\u63a5webshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u8681\u5251\u8fde\u63a5webshell|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"linux\";nocase;http_server_body;content:\"utc\";nocase;distance:0;http_server_body;flowbits:isset,first_packet_send;flowbits:unset,first_packet_send;sid:2020030003;)", "2834195": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ETPRO POLICY External IP Address Lookup via ifconfig .co|tag:TEST|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:dest\";flow:to_server,established;content:\"GET\";http_method;content:\"ifconfig.co\";http_host;depth:11;isdataat:!1,relative;fast_pattern;http_header_names;content:!\"Referer\";metadata:former_category POLICY;classtype:trojan-activity;sid:2834195;rev:1;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Audit, created_at 2019_01_03, performance_impact Low, updated_at 2019_01_03;)", "2019010021": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:weblogic\u8865\u4e01\u7ed5\u8fc7\u6f0f\u6d1e|tag:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Weblogic  \u62a4\u7f51\u671f\u95f4\u4f7f\u7528\u76840day\u8865\u4e01\u7ed5\u8fc7\u6f0f\u6d1e|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/_async/AsyncResponseService\";http_uri;content:\"java.lang.ProcessBuilder\";content:\"oracle.toplink.internal.sessions.UnitOfWorkChangeSet\";content:\"<void index=\\\"\";gid:3;sid:2019010021;rev:1;)", "2020062803": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4ee5GET\u65b9\u5f0f\u8bbf\u95ee\u811a\u672c\u6587\u4ef6|tag:\u653b\u51fb\u4ee3\u7406|tool:Neo-reGeorg|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:4|result:unknown|o_msg:\u4ee5GET\u65b9\u5f0f\u8bbf\u95ee\u811a\u672c\u6587\u4ef6|attacker:src|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;flowbits:set, access_script_file_get;noalert;content:\"GET\";http_method;content:\".\";http_uri;pcre:\"/\\.(php|jspx|js|ashx|aspx|jsp)/Ui\";sid:2020062803;rev:1;)", "2019090216": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:qmail\u8fde\u63a5|direction:in|level:action|service_name:Qmail|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728qmail|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220[\\s-](\\S+) ESMTP ?\\r\\n214[- ]qmail home page: http://pobox\\.com/~djb/qmail\\.html\\r\\n214[- ]qmail-ldap patch home page: http://www\\.nrg4u\\.com\\r\\n/\";sid:2019090216;gid:0;)", "2019090118": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(imap)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"* OK \";depth:5;pcre:\"/^\\* OK \\[[^\\[]+\\] Dovecot \\(Ubuntu\\) ready\\.\\r\\n/\";sid:2019090118;gid:0;)", "2019060008": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\".jsp?\";http_uri;pcre:\"/[\\w.$@!%_-]+=\\d{3}/iUR\";http_accept;content:\"text/html, image/gif, image/jpeg, *\\; q=.2, */*\\; q=.2\";pkt_data;noalert;flowbits:set, bingxie_webshell_jsp;sid:2019060008;gid:0;rev:1;)", "2026934": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"dm9rZS1XbWlNZXR\";distance:0;fast_pattern;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026934;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2020030023": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528\u5de5\u5177LaZagne|tag:LaZagne|tool:LaZagne|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:LaZagne|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"|0d 0a 7c|=========\";http_server_body;content:\"===========================================================|7c|\";http_server_body;distance:0;within:60;content:\" The LaZagne Project \";http_server_body;distance:70;content:\"! BANG BANG !\";http_server_body;distance:70;content:\"|0d 0a 7c|=========\";http_server_body;distance:70;content:\"===========================================================|7c|\";http_server_body;distance:0;within:60;sid:2020030023;rev:1;)", "2018020065": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u670d\u52a1\u5668\u51fa\u73b0PHP fatal error|direction:in|dest:home_net|src:external_net|level:action|o_msg:\u670d\u52a1\u5668\u8fd4\u56de\u9875\u9762\u51fa\u73b0php fatal error|failed_by:http_status_3XX,http_status_4XX\";http_content_type;content:\"text/html\";pkt_data;content:\"Warning</b>:\";nocase;within:3000;http_server_body;content:\"in\";within:300;http_server_body;pcre:\"/in (<b>)?\\d:(\\[\\d\\w_.-]+)+\\.php(<\\/b>)? on line /Q\";flow:from_server,established;sid:2018020065;rev:1;)", "2019010062": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7spark REST api\u90e8\u7f72\u4ee3\u7801(Python)|tag:\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u672a\u6388\u6743\u7684\u653b\u51fb\u8005\u53ef\u80fd\u901a\u8fc7\u672a\u6b63\u786e\u914d\u7f6eACL\u7684spark REST API\u8fdc\u7a0b\u6267\u884c\u4efb\u610f\u4ee3\u7801|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/v1/submissions/create\";isdataat:!1,relative;http_uri;content:\"\\\"action\\\"\";http_client_body;content:\"\\\"CreateSubmissionRequest\\\"\";within:30;http_client_body;content:\"\\\"spark.pyspark.python\\\"\";http_client_body;flowbits:set,spark_state_access;gid:3;sid:2019010062;)", "2019070007": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Botnet January\u626b\u63cf\u540e\u95e8|tag:\u626b\u63cf\u9ed1\u5ba2\u540e\u95e8|direction:out|src:home_net|dest:external_net|level:attack|phase:attack_out|failed_by:http_status_3XX,http_status_4XX|severity:2|result:unknown|o_msg:\u53ebJanuary\u7684botnet\u81ea\u52a8\u626b\u63cf\u540e\u9762\u7684\u884c\u4e3a\";content:\"POST\";nocase;http_method;content:\"=die(@md5(J4nur4ry))\";nocase;http_client_body;within:30;flow:to_server,established;gid:0;sid:2019070007;rev:1;)", "2019090242": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:radmin\u8fde\u63a5|direction:in|level:action|service_name:Radmin|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728Radmin|server:src\";flow:from_server,established;content:\"|01 00 00 00|\";depth:4;pcre:\"/^\\x01\\x00\\x00\\x00\\x25\\x79\\x00\\x02\\x12\\x08\\x02\\x00\\x79\\x0a/\";sid:2019090242;gid:0;)", "2020062809": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Venom-\u6b63\u5411\u4ee3\u7406)|tag:\u653b\u51fb\u4ee3\u7406|tool:Venom|dest:home_net|level:attack|phase:exploit|type:exploit|severity:4|result:unknown|o_msg:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Venom-\u6b63\u5411\u4ee3\u7406)|attacker:src\";flow:established, to_server;flowbits:set, Venom_link_type_2;content:\"ABCDEFGH\";depth:8;content:\"VCMD\";distance:0;within:4;content:\"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|\";distance:0;within:16;content:\"|00 00 00 00 00 00 00 26|\";distance:50;within:8;content:\"|00 00 00 00|\";distance:0;within:4;sid:2020062809;rev:1;)", "2008703": "alert tcp $HOME_NET any -> $HOME_NET 445 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";flow:established,to_server;content:\"|1F 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"/../\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008703;classtype:attempted-admin;sid:2008703;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2019040000": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Muieblackcat\u8815\u866b\u626b\u63cf|tag:\u8815\u866b\u626b\u63cf|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|phase:recon|failed_by:http_status_3XX,http_status_4XX|severity:1|result:unknown|o_msg:\u68c0\u6d4b\u5230\u8815\u866b\u626b\u63cf\uff0c\u5229\u7528\u626b\u63cf\u5de5\u5177\u4e3aMuieblackcat\uff0c\u4e0d\u662f\u4eba\u4e3a\u653b\u51fb\";content:\"/w00tw00t.at.blackhats.romanian.anti-sec\";nocase;http_uri;within:300;flow:to_server,established;gid:0;sid:2019040000;rev:1;)", "2020032403": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7phpmyadmin\u5199shell|tag:shell|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5c1d\u8bd5\u901a\u8fc7phpmyadmin\u5199shell|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, phpmyadmin_exec_sql_success;content:\"POST\";http_method;content:\"/import.php\";http_uri;content:\"sql_query=\";http_client_body;content:\"select\";http_client_body;distance:0;nocase;content:\"+'%3C%3Fphp+\";http_client_body;distance:0;nocase;content:\"+into+outfile+\";http_client_body;distance:0;nocase;content:\".php\";http_client_body;distance:0;nocase;sid:2020032403;rev:1;)", "2020070302": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, bingxie_webshell_1;noalert;flowbits:set, bingxie_webshell_2;flowbits:unset, bingxie_webshell_1;content:\"200\";http_stat_code;http_header_names;content:\"|0d 0a|Set-Cookie|0d 0a|\";pkt_data;http_content_len;content:\"16\";pkt_data;pcre:\"/^[a-fA-F0-9]{16}$/Q\";sid:2020070302;gid:0;rev:1;)", "2018010110": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|attacker:src\";content:\"select count\";nocase;http_header;within:2000;content:\"NULL,NULL,NULL,NULL,NULL\";nocase;http_header;within:152;flow:to_server,established;gid:0;sid:2018010110;rev:1;)", "2026950": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET WEB_SPECIFIC_APPS WP Cost Estimator Plugin AFI Vulnerability|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:to_server,established;content:\"/wp-admin/admin-ajax.php?action=lfb_upload_form\";nocase;http_uri;metadata:former_category WEB_SPECIFIC_APPS;reference:url,www.wordfence.com/blog/2019/02/vulnerabilities-patched-in-wp-cost-estimation-plugin/;classtype:web-application-attack;sid:2026950;rev:2;metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, signatrue_severity Audit, created_at 2019_02_21, updated_at 2019_02_21;)", "2020061013": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, tp_5_rce_1;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"favicon.ico|0a|\";http_server_body;depth:40;content:\"index.php|0a|\";http_server_body;distance:0;content:\"robots.txt|0a|\";http_server_body;distance:0;content:\"router.php|0a|\";http_server_body;distance:0;content:\"static|0a|\";http_server_body;distance:0;content:\"static\";http_server_body;distance:0;sid:2020061013;rev:1;)", "2020032401": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7phpmyadmin\u67e5\u8be2mysql\u8def\u5f84|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5c1d\u8bd5\u901a\u8fc7phpmyadmin\u67e5\u8be2mysql\u8def\u5f84|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, phpmyadmin_exec_sql_success;content:\"POST\";http_method;content:\"/import.php\";http_uri;content:\"sql_query=\";http_client_body;content:\"select+%40%40basedir%3B\";http_client_body;distance:0;nocase;sid:2020032401;rev:1;)", "2020072911": "alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528\u5411\u65e5\u8475\u8fdc\u63a7|tag:\u5411\u65e5\u8475\u8fdc\u63a7|level:attack|tool:\u5411\u65e5\u8475\u8fdc\u63a7|severity:1|src:home_net|phase:exploit|type:rat|result:unknown|o_msg:\u4f7f\u7528\u5411\u65e5\u8475\u8fdc\u63a7|attacker:dest\";flow:to_server;flowbits:isset, sunlogin_1;content:\"|6f 72 61 79|\";depth:4;content:\"SHA1:\";distance:52;within:6;sid:2020072911;rev:2;)", "2018010200": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6d4b\u8bd5SQL\u6ce8\u5165\u6f0f\u6d1e|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"or\";nocase;http_uri;pcre:\"/or(%20|\\s+)\\d+(%3d|=)\\d+/iU\";flow:to_server,established;gid:0;sid:2018010200;rev:1;)", "2019090099": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Pure-FTPd\u8fde\u63a5|direction:in|level:action|service_name:PureFTPd|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728PureFTPd|server:src\";flow:from_server,established;content:\"220---------- Welcome to Pure-FTPd [privsep] [TLS] ----------|0d 0a|\";depth:63;sid:2019090099;gid:0;)", "2019090265": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"E|00 00 00|\";depth:4;pcre:\"/^E\\0\\0\\0.S[^\\0]+\\0C0A000\\0Mnicht unterst.{1,2}tztes Frontend-Protokoll 65363\\.19778: Server unterst.{1,2}tzt 1\\.0 bis 3\\.0\\0Fpostmaster\\.c\\0L\\d+\\0/\";sid:2019090265;gid:0;)", "2020041020": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2016-0638)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2016-0638)|attacker:dest\";flow:established, to_client;flowbits:isset, cve_2016_0638;content:\"|ac ed 00 05|\";content:\"weblogic.rjvm.ClassTableEntry\";distance:0;content:\"weblogic.jms.common.StreamMessageImpl\";distance:0;sid:2020041020;rev:1;)", "2020060103": "alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528Cobalt Strike\u6728\u9a6c|tag:Cobalt Strike|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:c2|severity:3|result:unknown|o_msg:\u68c0\u6d4b\u5230\u6709\u4eba\u5728\u5185\u7f51\u4f7f\u7528Cobalt Strike\u8fde\u63a5\u5916\u7f51\u7684Teamserver\";flow:established, to_client;tls_cert_subject;content:\"OU=AdvancedPenTesting,\";sid:2020060103;rev:2;)", "2019090257": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"EFATAL:\";depth:7;pcre:\"/^EFATAL:  ung\\xfcltige L\\xe4nge des Startpakets\\n\\0/\";sid:2019090257;gid:0;)", "2019090040": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(SMTP)|direction:in|level:action|service_name:Microsoft Exchange(SMTP)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange Server|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220-([-.+\\w]+) Microsoft SMTP MAIL ready at.*Version: ([-\\w.]+)\\r\\n/\";sid:2019090040;gid:0;)", "2009457": "alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"name:Virut\u6728\u9a6c|type:trojan|tag:Virut|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230Virut\u6728\u9a6c\u4e0a\u7ebf|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";depth:4;http_method;content:\".asp?mac=\";http_uri;content:\"&rw=\";http_uri;content:\"&ver=\";http_uri;pcre:\"/.asp\\?mac=([0-9A-F]{2}-){5}([0-9A-F]{2})/Ui\";reference:url,www.threatexpert.com/reports.aspx?find=ipk8888.cn&x=0&y=0;reference:url,doc.emergingthreats.net/2009457;classtype:trojan-activity;sid:2009457;rev:6;)", "2019060033": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\".aspx?\";http_uri;pcre:\"/[\\w.$@!%_-]+=\\d{3}/iUR\";http_accept;content:\"text/html, image/gif, image/jpeg, *\\; q=.2, */*\\; q=.2\";pkt_data;noalert;flowbits:set, bingxie_webshell_aspx;sid:2019060033;gid:0;rev:1;)", "2019090139": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Winmail\u8fde\u63a5|direction:in|level:action|service_name:Winmail(imap)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Winmail|server:src\";flow:from_server,established;content:\"* OK \";depth:5;pcre:\"/^\\* OK IMAP4 ready! [-\\w_.]+ Winmail Mail Server MagicWinmail Extend IMAP 101\\r\\n/\";sid:2019090139;gid:0;)", "2018010067": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6d4b\u8bd5SQL\u6ce8\u5165\u6f0f\u6d1e|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"and\";nocase;http_client_body;pcre:\"/and(%20| )\\d+(%3d|=)\\d+/iP\";within:500;flow:to_server,established;gid:0;sid:2018010067;rev:1;)", "2019010128": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Tomcat \u4efb\u610f\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e(CVE-2020-1938)|tag:\u6587\u4ef6\u5305\u542b|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5229\u7528Apache Tomcat \u4efb\u610f\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e(CVE-2020-1938)\u8fdb\u884c\u653b\u51fb|attacker:src\";flow:established, to_server;flowbits:set, cve_2020_1938_1;content:\"|12 34|\";startswith;content:\"|02 02|\";offset:2;content:\"|00 08|HTTP/1.1|00|\";distance:0;within:11;content:\"javax.servlet.include.request_uri|00 00|\";distance:100;content:\"javax.servlet.include.servlet_path|00 00|\";distance:4;sid:2019010128;rev:1;)", "2010642": "alert tcp $HOME_NET any -> $HOME_NET 21 (msg:\"name:FTP root\u7528\u6237\u7206\u7834|direction:in|dest:home_net|src:home_net|level:attack|phase:post_exploit|severity:2|result:unknown|o_msg:FTP Administrtor\u7528\u6237\u7206\u7834|type:infil\";flow:established,to_server;content:\"USER \";nocase;depth:5;content:\"root\";within:15;nocase;threshold:type threshold, track by_src, count 5, seconds 60;reference:url,doc.emergingthreats.net/2010642;classtype:attempted-recon;sid:2010642;rev:3;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2008700": "alert udp $HOME_NET any -> $HOME_NET 139 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";content:\"|00 2e 00 2e 00 2f 00 2e 00 2e 00 2f 00 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 87|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008700;classtype:attempted-admin;sid:2008700;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2027033": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"gAaQBzACAAcAByAG8AZwByAGE\";distance:0;fast_pattern;metadata:former_category ATTACK_RESPONSE;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027033;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_03_05, malware_family DNSlivery, updated_at 2019_03_05;)", "2833199": "alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Cobalt Strike\u6728\u9a6cSSL\u8bc1\u4e66\u4f20\u8f93\u884c\u4e3a|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|dest:home_net|src:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike\u6728\u9a6cSSL\u8bc1\u4e66\u4f20\u8f93\u884c\u4e3a\";flow:established,from_server;tls_cert_subject;content:\"CN=files.office-help.site\";nocase;isdataat:!1,relative;metadata:former_category TROJAN;reference:md5,7a08297b230b1ce2a6feca70288666d3;classtype:trojan-activity;sid:2833199;rev:1;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2018_10_19, malware_family Cobalt_Strike, performance_impact Moderate, updated_at 2019_09_28;)", "2019090017": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:RDP\u8fde\u63a5|direction:in|level:action|service_name:RDP|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728RDP|server:src\";flow:from_server,established;content:\"|03 00 00|\";depth:3;pcre:\"/^\\x03\\0\\0\\t\\x02\\xf0\\x80!\\x80/\";sid:2019090017;gid:0;)", "2020062811": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Stowaway-\u53cd\u5411\u4ee3\u7406)|tag:\u653b\u51fb\u4ee3\u7406|tool:Stowaway|direction:in|src:home_net|dest:external_net|level:attack|phase:control|type:control|severity:4|result:unknown|o_msg:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Stowaway-\u53cd\u5411\u4ee3\u7406)\";flow:established, to_server;flowbits:set, Stowaway_link_type_1_1;content:\"d41d8cd98f00b204\";depth:16;content:\"|30 30 30 30 30 30 30 30 30 30 00 00 00 00 00 00|\";distance:0;within:16;content:\"COMMAND\";distance:2;within:7;content:\"STOWAWAYAGENT\";distance:4;within:13;sid:2020062811;rev:1;)", "2020061208": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u81f4\u8fdcOA A8-m \u540e\u53f0\u4e07\u80fd\u5bc6\u7801|tag:\u540e\u53f0\u767b\u5f55|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u81f4\u8fdcOA A8-m \u540e\u53f0\u4e07\u80fd\u5bc6\u7801WLCCYBD@SEEYON\uff0c\u653b\u51fb\u8005\u53ef\u76f4\u63a5\u767b\u5f55\u540e\u53f0|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, seeyou_passwd_bypass;content:\"POST\";http_method;content:\"/seeyon/management/index.jsp\";http_uri;content:\"password=WLCCYBD\";http_client_body;pcre:\"/^(%40|@)SEEYON/PR\";sid:2020061208;rev:1;)", "2020022703": "alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:\"name:Proftpd mod_copy\u6a21\u5757\u547d\u4ee4\u672a\u6388\u6743\u8c03\u7528\uff08CVE-2015-3306\uff09|tag:\u672a\u6388\u6743\u8c03\u7528|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Proftpd mod_copy\u6a21\u5757\u547d\u4ee4\u672a\u6388\u6743\u8c03\u7528\uff08CVE-2015-3306\uff09|attacker:src\";flow:established, to_server;flowbits:set, cve_2015_3306_cpto;content:\"site cpto \";sid:2020022703;rev:1;)", "2020073101": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874eWebshell\u901a\u8baf|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|gray:true|decode_by:bingxie_1|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;flowbits:set, bingxie_decode_1;noalert;content:\"GET\";http_method;content:\"=\";http_uri;fast_pattern;pcre:\"/\\.((php\\d?)|jsp|asp|aspx|jspx|asa|cdx|cer)\\?[\\w.$@!%_-]+=\\d{2,3}/Ui\";sid:2020073101;gid:0;rev:1;)", "2013283": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:DarkComet\u540e\u95e8\u6728\u9a6c|type:rat|tag:DarkComet|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230DarkComet-RAT\u521d\u59cb\u5316\u8fde\u63a5\";flow:from_server,established;dsize:12;content:\"|38 45 41 34 41 42 30 35 46 41 37 45|\";flowbits:set,ET.DarkCometJoin;reference:url,www.darkcomet-rat.com;reference:url,anubis.iseclab.org/?action=result&task_id=1a7326f61fef1ecb4ed4fbf3de3f3b8cb&format=txt;classtype:trojan-activity;sid:2013283;rev:4;)", "2019010098": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6cdb\u5faeOA E-cology \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u6cdb\u5faeOA E-cology \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|attacker:src\";flow:to_server,established;flowbits:set, ecology_oa_beanbash_rce;content:\"POST\";http_method;content:\"/\";http_uri;depth:1;pcre:\"/(\\/bsh.servlet.BshServlet|\\/weaver\\/bsh.servlet.BshServlet|\\/weaveroa\\/bsh.servlet.BshServlet|\\/oa\\/bsh.servlet.BshServlet)/Ii\";content:\"bsh.script=\";http_client_body;fast_pattern;pcre:\"/((e|(\\\\|%5c)u0065)(v|(\\\\|%5c)u0076)(a|(\\\\|%5c)u0061)(l|(\\\\|%5c)u006c))/RPi\";pcre:\"/\\\"e((\\\"|%22)%2b(\\\"|%22))?x((\\\"|%22)%2b(\\\"|%22))?e((\\\"|%22)%2b(\\\"|%22))?c/RPi\";content:\"bsh.httpServletRequest.getParameter\";http_client_body;distance:0;sid:2019010098;rev:1;)", "2020052406": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:reGeorg\u8fde\u63a5\u6210\u529f|tag:\u653b\u51fb\u4ee3\u7406|tool:reGeorg|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:unknown|o_msg:\u5185\u7f51\u6e17\u900f\u65f6\u7684\u5e38\u7528\u5de5\u5177reGeorg|failed_by:http_status_3XX,http_status_4XX\";flowbits:set, regeory_read;noalert;flow:established, to_server;content:\"X-CMD: READ\";http_header;sid:2020052406;rev:1;)", "2018060003": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u8fde\u63a5\u6210\u529f|tag:webshell\u8fde\u63a5\u6210\u529f|direction:in|dest:home_net|src:external_net|level:attack|severity:4|phase:control|type:shell|result:success|o_msg:\u68c0\u6d4b\u5230webshell\u6210\u529f\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"<html><body><center><form\";offset:0;nocase;http_server_body;pcre:\"/^\\s+method=\"POST\">\\s*<input\\s+type=\\\"password\"\\s+name=\"getpwd\">\\s+<input\\s+type=\"submit\"\\s+value=\" O K \"><\\/form><\\/center><\\/body><\\/html>$/iQR\";gid:0;sid:2018060003;rev:1;)", "2020070210": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u653b\u51fb\u8005\u83b7\u5f97\u670d\u52a1\u5668Shell|tag:getshell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u653b\u51fb\u8005\u83b7\u5f97\u670d\u52a1\u5668shell|attacker:dest\";flow:established;content:\"Microsoft Windows [\";depth:25;content:\"Microsoft Corporation\";distance:0;within:100;sid:2020070210;rev:1;)", "2017120103": "alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:\"name:\u5efa\u7acb\u901a\u4fe1\u96a7\u9053|type:tunneling|tag:DNS\u96a7\u9053|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:2|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u7578\u5f62\u7684DNS\u8bf7\u6c42\uff08CNAME\u7c7b\u578b\uff09\";content:!\"|00|\";offset:12;depth:1;byte_test:1, >, 63, 12, big;content:\"|00 05 00 01|\";isdataat:!1, relative;sid:2017120103;rev:1;)", "2019090056": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(POP3)|direction:in|level:action|service_name:Microsoft Exchange(POP3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange|server:src\";flow:from_server,established;content:\"*OK Microsoft Exchange\";depth:23;pcre:\"/^\\+OK Microsoft Exchange POP3 server version ([\\d.]+) ready  <[\\d.]+@([-\\w_.]+)>\\r\\n/\";sid:2019090056;gid:0;)", "2020020503": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528\u5de5\u5177Mimikatz\u63d0\u53d6\u5bc6\u7801|tag:mimikatz|tool:mimikatz|direction:in|src:external_net|dest:home_net|level:attack|phase:control|result:unknown|severity:2|o_msg:mimikatz|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"|0d 0a|Authentication Id : \";http_server_body;content:\"|0d 0a|Session           : \";http_server_body;distance:1;content:\"|0d 0a|User Name         : \";http_server_body;distance:1;content:\"|0d 0a|Domain            : \";http_server_body;distance:1;content:\"|0d 0a|Logon Server      : \";http_server_body;distance:1;content:\"|0d 0a|Logon Time        : \";http_server_body;distance:1;content:\"|0d 0a|SID               : \";http_server_body;distance:1;sid:2020020503;rev:1;)", "2019010024": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Coremail \u914d\u7f6e\u8bfb\u53d6\u6f0f\u6d1e|tag:\u914d\u7f6e\u6f0f\u6d1e|dest:home_net|level:attack|severity:3|phase:exploit|result:success|o_msg:Coremail\u7206\u51fa0day\u6f0f\u6d1e\u53ef\u4ee5\u76f4\u63a5\u8bfb\u53d6\u914d\u7f6e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset,coremail.exp;content:\"200\";http_stat_code;http_content_type;content:\"application/xml\";pkt_data;content:\"<string name=\\\"Password\\\">\";http_server_body;gid:0;sid:2019010024;rev:1;)", "2018040033": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHPunit\u7684\u8fdc\u7a0b\u5199webshell\u6f0f\u6d1e\u5c1d\u8bd5|type:\u626b\u63cf|tag:\u6f0f\u6d1e\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|phase:recon|failed_by:http_status_3XX,http_status_4XX|severity:1|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u5bf9PHPunit\u7684\u8fdc\u7a0b\u5199webshell\u6f0f\u6d1e\u5c1d\u8bd5\";content:\"POST\";nocase;http_method;content:\"/phpunit/src/Util/PHP/eval-stdin.php\";nocase;http_uri;within:300;content:\"<?php\";nocase;http_client_body;offset:0;flow:to_server,established;gid:0;sid:2018040033;rev:1;)", "2020082005": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874eWebshell\u901a\u8baf|tag:webshell|tool:\u51b0\u874e|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u51b0\u874eWebshell\u901a\u8baf|gray:true|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, bingxie_3_0_4_asp;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;pcre:\"/^[[:print:]]{0,3}[^[:print:]]/Q\";sid:2020082005;gid:0;rev:1;)", "2020080315": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Metasploit \u8fde\u63a5(tcp)|tag:\u53cd\u5f39shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:Metasploit \u8fde\u63a5(windows/shell/reverse_tcp)\";flags:P, A;flow:from_server, established;flowbits:set, windows_shell_reverse_tcp;noalert;dsize:4;content:\"|0b 01 00 00|\";depth:4;sid:2020080315;)", "2012303": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"name:NightDragon\u540e\u95e8\u6728\u9a6c|type:rat|tag:NightDragon|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230Night Dragon\u7684C&C\u7684\u5fc3\u8df3\u901a\u8baf\u51fa\u7ad9\u6d41\u91cf\";flow:established,to_server;dsize:16;content:\"|01 50 00 00 00 00 00 00 00 00 00 01 68 57 24 13|\";threshold:type limit, count 1, seconds 60, track by_src;reference:url,www.mcafee.com/us/resources/white-papers/wp-global-energy-cyberattacks-night-dragon.pdf;classtype:trojan-activity;sid:2012303;rev:4;)", "2834660": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u75280kee team\u7684URL\u722c\u866bcrawlergo|tag:\u722c\u866b|tool:crawlergo|dest:home_net|level:attack|phase:recon|result:unknown|severity:1|o_msg:\u653b\u51fb\u8005\u4f7f\u7528\u4e86360 0kee team\u5f00\u6e90URL\u722c\u866bcrawlergo\u8fdb\u884c\u722c\u53d6\uff0c\u5730\u5740\u4e3ahttps://github.com/0Kee-Team/crawlergo|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"crawlergo-0KeeTeam\";http_user_agent;fast_pattern;sid:2834660;rev:1;)", "2018010017": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u53cd\u5f39shell|tag:metasploit\u540e\u95e8|direction:in|phase:control|src:external_net|dest:home_net|level:attack|severity:3|result:success|o_msg:\u68c0\u6d4b\u5230windows metasploit\u7684meterpreter\u9ed1\u5ba2shell\u53cd\u5f39\u8bf7\u6c42\";flow:established,to_server;content:\"|16 03 01 00 51 01 00 00 4d 03 01 5b|\";content:\"|20 00 39 00 38 00 35 00 16 00 13 00 0a 00 33 00 32 00 2f 00 07 00 05 00 04 00 15 00 12 00 09 00 ff 01 00 00 04 00 23 00 00|\";gid:3;sid:2018010017;rev:1;)", "2019090103": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:vsFTPd\u8fde\u63a5|direction:in|level:action|service_name:vsFTPd|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728vsFTPd|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 Welcome to the NSLU2 vsftp daemon\\.\\r\\n/\";sid:2019090103;gid:0;)", "2019090089": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:FileZilla\u8fde\u63a5|direction:in|level:action|service_name:FileZilla|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728FileZilla|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 Private ftp server, anonymous login not allowed\\.\\r\\n214-The following commands are recognized:\\r\\n   USER   PASS   QUIT   CWD    PWD    PORT   PASV   TYPE\\r\\n   LIST   REST   CDUP   RETR   STOR   SIZE   DELE   RMD \\r\\n   MKD    RNFR   RNTO   ABOR   SYST   NOOP   APPE   NLST\\r\\n   MDTM   XPWD   XCUP   XMKD   XRMD   NOP    EPSV   EPRT\\r\\n   AUTH   ADAT   PBSZ   PROT   FEAT   MODE   OPTS   HELP\\r\\n214 Have a nice day\\.\\r\\n/\";sid:2019090089;gid:0;)", "2020010002": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:bash\u53cd\u5f39shell|tag:\u53cd\u5f39shell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:bash\u53cd\u5f39shell(root)\";flow:established,to_server;flags:P,A;dsize:<100;content:\"[root@\";content:\"]#\";pcre:\"/\\[root@\\w+ [/~\\w][\\w/.-]*\\]#/\";flowbits:set,linux_bash_reverse_shell;sid:2020010002;)", "2018010109": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|attacker:src\";content:\"' UNION ALL SELECT\";nocase;http_header;content:\"NULL,NULL,NULL,NULL,NULL\";nocase;http_header;within:152;flow:to_server,established;gid:0;sid:2018010109;rev:1;)", "2019010075": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:phpstudy\u6f0f\u6d1e\u5229\u7528|tag:\u914d\u7f6e\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:exploit|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:phpstudy\u6f0f\u6d1e\u5229\u7528\u8bf7\u6c42|attacker:src\";flow:to_server,established;content:\"GET\";http_method;content:\" Accept-Charset:\";http_header;pcre:\"/^([a-zA-Z0-9+/]+a[a-zA-Z0-9+=/]+)$/HR\";sid:2019010075;gid:0;)", "2020070703": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Jenkins\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2019-1003000\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Jenkins\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2019-1003000\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;xbits:set, cve_2019_1003000_1, track ip_dst, expire 30;content:\"/descriptorByName/\";http_uri;fast_pattern;content:\"checkScript\";http_uri;distance:0;content:\"@GrabResolver\";http_uri;distance:0;sid:2020070703;rev:1;)", "2020070203": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u653b\u51fb|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u7591\u4f3c JNDI \u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, fastjson_jndi;xbits:set, jdni_link_jrmp, track ip_dst, expire 20;content:\"POST\";http_method;http_content_type;content:!\"application/x-amf\";pkt_data;content:\"ldap://\";http_client_body;fast_pattern;nocase;pcre:\"/ldap\\:\\/\\/(((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(\\.((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3})|([a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+\\.?)/Pi\";sid:2020070203;rev:1;)", "2020062303": "alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5efa\u7acb ICMP \u901a\u9053\u4f20\u8f93\u6570\u636e|tag:\u653b\u51fb\u4ee3\u7406|tool:icmpsh|direction:in|dest:external_net|src:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u653b\u51fb\u8005\u5efa\u7acbICMP\u96a7\u9053\uff0c\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4|attacker:dest\";flow:established, to_server;itype:8;icode:0;content:\"whoami\";depth:30;sid:2020062303;rev:1;)", "2019090059": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(POP3)|direction:in|level:action|service_name:Microsoft Exchange(POP3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange|server:src\";flow:from_server,established;content:\"*OK Microsoft Exchange\";depth:23;pcre:\"/^\\+OK The Microsoft Exchange POP3 service is ready\\.\\r\\n/\";sid:2019090059;gid:0;)", "2020062907": "alert dns $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528 dnscat2 \u5efa\u7acbdns\u96a7\u9053|tag:\u653b\u51fb\u4ee3\u7406|tool:dnscat2|direction:in|dest:external_net|src:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u4f7f\u7528 dnscat2 \u5efa\u7acbdns\u96a7\u9053|attacker:dest\";flow:established, to_server;dns_query;content:\"dnscat\";depth:6;threshold:type both, track by_dst, count 20, seconds 10;sid:2020062907;rev:1;)", "2020071413": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5e94\u7528\u7a0b\u5e8f\u5f00\u542f Xdebug \u6269\u5c55,\u653b\u51fb\u8005\u5f00\u59cb\u6267\u884c\u547d\u4ee4|tag:\u5371\u9669\u914d\u7f6e|dest:home_net|level:attack|severity:3|result:unknown|phase:exploit|o_msg:\u5e94\u7528\u7a0b\u5e8f\u5f00\u542f Xdebug \u6269\u5c55\uff0c\u653b\u51fb\u8005\u5f00\u59cb\u6267\u884c\u547d\u4ee4|attacker:src\";flow:from_server, established;flowbits:isset, xdebud_rce;flowbits:unset, xdebud_rce;flowbits:set, xdebud_rce_success;content:\"eval -i\";depth:10;sid:2020071413;)", "2018010030": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u89e3\u6790\u6f0f\u6d1e\u63a2\u6d4b|tag:\u89e3\u6790\u6f0f\u6d1e\u8bd5\u63a2|phase:exploit|dest:home_net|level:attack|severity:1|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:IIS6.0\u89e3\u6790\u6f0f\u6d1e\u63a2\u6d4b|attacker:src\";content:\"GET\";nocase;http_method;content:\".cdx\";nocase;http_uri;within:200;pcre:\"/\\/[\\d\\w_-]\\.(jpg|gif|png)/iUR\";flow:to_server,established;gid:0;sid:2018010030;rev:1;)", "2834510": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ETPRO POLICY External IP Address Lookup via 7fw .de|tag:TEST|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:dest\";flow:to_server,established;content:\"GET\";http_method;content:\"7fw.de\";http_host;depth:6;isdataat:!1,relative;fast_pattern;http_header_names;content:!\"Referer\";metadata:former_category POLICY;classtype:policy-violation;sid:2834510;rev:1;metadata:affected_product Any, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Audit, created_at 2019_01_23, performance_impact Low, updated_at 2019_01_23;)", "2019090143": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Exim\u8fde\u63a5|direction:in|level:action|service_name:Exim(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Exim|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 (\\w[\\w.-]+) ESMTP\\r\\n501 Syntactically invalid EHLO argument\\(s\\)\\r\\n/\";sid:2019090143;gid:0;)", "2018081310": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u8fdb\u884c\u6d4f\u89c8D\u76d8\";dsize:9;flow:from_server,established;content:\"LIST D:|0d 0a|\";depth:9;nocase;flowbits:isset,TB_ZxShell_2;sid:2018081310;rev:1;)", "2019090115": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(imap)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"* OK \";depth:5;pcre:\"/^\\* OK \\[CAPABILITY IMAP4rev1 SASL-IR SORT THREAD=REFERENCES MULTIAPPEND UNSELECT LITERAL\\+ IDLE CHILDREN NAMESPACE LOGIN-REFERRALS/\";sid:2019090115;gid:0;)", "20258012": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:\u626b\u63cf|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:recon|result:unknown|o_msg:\u626b\u63cf\u53ef\u80fd\u5b58\u5728\u7684\u9ed1\u5ba2\u540e\u95e8\";flow:to_server,established;flowbits:set,webshell.scan;content:\"file_put_contents\";http_client_body;metadata:former_category EXPLOIT;classtype:attempted-user;sid:20258012;rev:2;flowbits:set, caidao_request;flowbits:set,webshell.scan;metadata:affected_product Web_Server_Applications, affected_product PHP, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2018020066": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5236\u9020HTTP 500\u5185\u90e8\u9519\u8bef|tag:\u5185\u90e8\u9519\u8bef|direction:in|dest:home_net|src:external_net|level:action|o_msg:\u6545\u610f\u5236\u9020HTTP 500\u5185\u90e8\u9519\u8bef\uff0c\u83b7\u53d6\u6709\u7528\u7684\u62a5\u9519\u4fe1\u606f|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"500\";http_stat_code;gid:0;sid:2018020066;rev:1;)", "151205225": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:njRAT\u540e\u95e8\u6728\u9a6c|type:rat|tag:njRAT|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u6728\u9a6c\u540e\u95e8njRAT\";content:\"LV|7c|\";depth:3;content:\"|5b 65 6e 64 6f 66 5d|\";isdataat:!1,relative;classtype:trojan-activity;sid:151205225;rev:1;)", "2019090153": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Active Directory\u8fde\u63a5|direction:in|level:action|service_name:Windows Active Directory|service_class:auth|severity:1|result:unknown|o_msg:\u5b58\u5728Active Directory|server:src\";flow:from_server,established;content:\"0|84 00 00|\";depth:4;pcre:\"/^0\\x84\\0\\0..\\x02\\x01.*dsServiceName1\\x84\\0\\0\\0.\\x04.CN=NTDS\\x20Settings,CN=([^,]+),CN=Servers,CN=([^,]+),CN=Sites,CN=Configuration,DC=([^,]+),DC=([^,]+)0\\x84\\0/\";sid:2019090153;gid:0;)", "2018040011": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u535a\u5f69\u6f0f\u6d1e|tag:\u968f\u673a\u626b\u63cf|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|phase:recon|failed_by:http_status_3XX,http_status_4XX|severity:1|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u968f\u673a\u626b\u63cf\u535a\u5f69\u6f0f\u6d1e\uff08\u901a\u5e38\u4e3a\u5168\u7f51\u626b\u63cf\uff09\";content:\"POST\";nocase;http_method;content:\"/index.php?\";nocase;http_uri;within:300;content:\"caid=\";nocase;http_uri;within:5;pcre:\"/\\d+/iUR\";content:\"&ccid1=\";nocase;http_uri;within:7;pcre:\"/\\d+/iUR\";content:\"&fsale=\";nocase;http_uri;within:7;pcre:\"/${@?(print|eval)\\(/iUR\";flow:to_server,established;gid:0;sid:2018040011;rev:1;)", "2018041912": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:TGA3.0\u540e\u95e8\u6728\u9a6c|type:rat|tag:TGA3.0|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cTGA3.0\u4e0a\u7ebf\u5305\";dsize:20<>50;pcre:\"/^painel\\|Win.+?\\|.+?\\|[WL]AN\\|[[:print:]]+?-[[:print:]]+?\\|$/\";flow:to_server;sid:2018041912;rev:1;)", "2020051924": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee(mappings)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, spring_actuator_4_mappings;content:\"200\";http_stat_code;http_content_type;content:\"application\";content:\"spring-boot.actuator\";distance:0;content:\"json\";distance:0;pkt_data;content:\"{\\\"contexts\\\":{\\\"application-1\\\":{\\\"mappings\\\":\";http_server_body;startswith;sid:2020051924;rev:1;)", "2019010072": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:weblogic\u6f0f\u6d1e\u5229\u7528|tag:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:CVE-2017-10271 Payload\u653b\u51fb\u7cfb\u7edf[1]|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"<void class=\\\"sun.misc.BASE64Decoder\\\">\";http_client_body;content:\"<void method=\\\"decodeBuffer\\\"\";http_client_body;content:\"<string>yv66vgAAA\";http_client_body;flowbits:set, cmd_reponse_echo;gid:0;sid:2019010072;rev:1;)", "2019090188": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 [-\\w_]+ ESMTP ([-\\w_.]+) \\(Debian/GNU\\)\\r\\n/\";sid:2019090188;gid:0;)", "2020071405": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:qdPM <9.1 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-7246)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|severity:3|result:unknown|phase:exploit|o_msg:qdPM <9.1 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-7246),\u5c1d\u8bd5\u8986\u76d6.htaccess|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2020_7246;content:\"POST\";http_method;content:\"/index.php/myAccount/update\";http_uri;content:\"qdPM8=\";http_cookie;http_content_type;content:\"boundary=\";pkt_data;content:\"name=\\\"users[photo_preview]\\\"\";http_client_body;content:\".htaccess\";http_client_body;distance:0;within:100;sid:2020071405;)", "2020081423": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08tcp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884cipconfig\u547d\u4ee4\";flow:established;content:\"Windows IP \";fast_pattern;content:\" . . . . . . . : \";distance:0;content:\" . . . . . . . . . . . . : \";distance:0;pcre:\"/^(((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(\\.((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3})\\x0d\\x0a\\x20\\x20\\x20/R\";sid:2020081423;)", "2019000023": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u8fc7nc\u6267\u884c\u547d\u4ee4|tag:\u53cd\u5f39shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|attack_type:target|result:unknown|o_msg:\u901a\u8fc7nc\u6267\u884c\u547d\u4ee4\";flags:P,A;dsize:7;flow:established;content:\"whoami|0a|\";pcre:\"/^whoami\\n$/\";flowbits:set,whoami_send;sid:2019000023;)", "2019010146": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"union\";nocase;http_client_body;pcre:\"/[\\\\/*! ]+all[\\\\/*! ]+/select[\\\\/*! ]+/iPR\";flow:to_server,established;gid:0;sid:2019010146;rev:1;)", "2020081412": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08tcp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884c\u547d\u4ee4ps -aux\";flow:established;content:\"USER\";content:\"PID\";distance:0;content:\"%CPU\";distance:0;pcre:\"/USER\\s+PID\\s+%CPU\\s+%MEM\\s+VSZ\\s+RSS\\s+TTY\\s+STAT\\s+START\\s+TIME\\s+COMMAND\\x0a/\";sid:2020081412;)", "2019010121": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Solr\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2019-0193)|tag:\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Apache Solr\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2019-0193)|attacker:src\";flow:to_server,established;flowbits:set, cve_2019_0193;content:\"POST\";http_method;content:\"/solr/\";http_uri;startswith;content:\"/dataimport\";http_uri;distance:0;content:\"debug=true\";http_client_body;content:\"<dataConfig>\";http_client_body;content:\"<script>\";http_client_body;distance:0;pcre:\"/(java\\.lang\\.ProcessBuilder)|(java\\.lang\\.Runtime\\.getRuntime)/PR\";content:\"</script>\";http_client_body;distance:0;content:\"script\\:\";http_client_body;distance:0;content:\"</dataConfig>\";http_client_body;distance:0;sid:2019010121;rev:1;)", "2020021003": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Drupal7 \u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u5220\u6587\u4ef6)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Drupal7 \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Archive_Tar\";content:\"_temp_tarname\";distance:0;sid:2020021003;rev:1;)", "2020062906": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:reDuh \u4ee3\u7406\u6587\u4ef6\u8fde\u63a5\u6210\u529f|tag:\u653b\u51fb\u4ee3\u7406|tool:reDuh|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:reDuh \u4ee3\u7406\u6587\u4ef6\u8fde\u63a5\u6210\u529f|attacker:dest|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, reDuh_link_1;content:\"200\";http_stat_code;content:\"Success\";http_server_body;sid:2020062906;rev:1;)", "2018081327": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u6253\u5f00\u8fdb\u7a0b\u7ba1\u7406\";dsize:4;flow:from_server,established;content:\"PS|0D 0A|\";nocase;flowbits:isset,TB_ZxShell;sid:2018081327;rev:1;)", "2019090034": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:VNC\u8fde\u63a5|direction:in|level:action|service_name:VNC|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728VNC|server:src\";flow:from_server,established;content:\"RFB\";depth:3;pcre:\"/^RFB 004\\.001\\n/\";sid:2019090034;gid:0;)", "2018041916": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6781\u5149\u540e\u95e8\u6728\u9a6c|type:rat|tag:jiguang2009|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6c\u6781\u51492009\u5fc3\u8df3\u5305\";flow:from_server,established;dsize:3;content:\"|31 0d 0a|\";depth:3;flowbits:isset,TB_jiguang2009_2;threshold:type both, track by_dst, count 9, seconds 300;sid:2018041916;rev:1;)", "28359291": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ETPRO POLICY External IP Address Lookup via api.ip .sb|tag:TEST|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:dest\";flow:to_server,established;content:\"GET\";http_method;content:\"/ip\";http_uri;depth:3;isdataat:!1,relative;content:\"api.ip.sb\";http_host;depth:9;fast_pattern;isdataat:!1,relative;metadata:former_category POLICY;classtype:policy-violation;sid:28359291;rev:1;metadata:attack_target Client_Endpoint, deployment Perimeter, tag IP_address_lookup_website, signatrue_severity Audit, created_at 2019_04_17, performance_impact Low, updated_at 2019_04_17;)", "2020011403": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JBoss \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2013-4810\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JBOSS\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/invoker/EJBInvokerServlet\";http_uri;within:40;content:\"application/x-java-serialized-object\";http_header;content:\"invocation.MarshalledInvocation\";http_header;distance:0;content:\"| ac ed 00 05 |sr\";http_client_body;startswith;sid:2020011403;rev:1;)", "2808855": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:EZBRO\u6728\u9a6c|type:rat|tag:EZBRO|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230TROJAN.CLICKER.MSIL/EZBRO.A\";flow:to_server,established;flowbits:isset,EZBRO.A;dsize:4;content:\"|01 00 04 00|\";reference:url,stopmalvertising.com/malware-reports/anatomy-of-a-net-click-fraud-bot.html;reference:md5,dbcb2d297e5d79c5a161801b2be775ba;classtype:trojan-activity;sid:2808855;rev:1;)", "2018120501": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Konni\u540e\u95e8\u6728\u9a6c|type:rat|tag:Konni|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cKonni\u51fa\u7ad9\u6d41\u91cf|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;content:\"/getcom/upload.php\";http_uri;isdataat:!1,relative;content:\"HTTP\";http_user_agent;depth:4;isdataat:!1,relative;sid:2018120501;rev:1;)", "202000807": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874eWebshell\u901a\u8baf|tag:webshell|tool:\u51b0\u874e|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u51b0\u874eWebshell\u901a\u8baf|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;flowbits:set, bingxie_3_0_jsp;noalert;content:\"POST\";http_method;http_content_len;content:\"8940\";pkt_data;content:\"JSESSIONID=\";http_cookie;pcre:\"/^[a-z0-9]{32}/CRi\";pcre:\"/^[A-Za-z0-9+\\/]{8938}[A-Za-z0-9+\\/=]{2}$/P\";sid:202000807;gid:0;rev:1;)", "2019010029": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u81f4\u8fdcOA\u6f0f\u6d1e|tag:CMS\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u5c1d\u8bd5\u81f4\u8fdcOA\u6f0f\u6d1e|attacker:src\";content:\"POST\";http_method;content:\"/seeyou/htmlofficeservlet\";http_uri;nocase;content:\"DBSTEP\";http_client_body;content:\"V3.0\";content:\"<%@ page\";content:\"import=\\\"java.util.*\";content:\"Runtime.getRuntime().exec(\";flow:to_server,established;flowbits:set,zhiyuan.exp;gid:0;sid:2019010029;rev:1;)", "2018030026": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Burpsuite\u653b\u51fb\u5c1d\u8bd5|tag:web\u6f0f\u6d1e\u626b\u63cf|tool:burpsuite|phase:recon|dest:home_net|level:attack|severity:2|result:unknown|o_msg:\u4f7f\u7528burp\u8fdb\u884c\u5404\u79cdweb\u6f0f\u6d1e\u653b\u51fb\u5c1d\u8bd5|failed_by:http_status_3XX,http_status_4XX|attack_type:target|attacker:src\";content:\"POST\";nocase;http_method;content:\".burpcollaborator.net\";nocase;http_uri;within:1024;pcre:\"/[\\d\\w]{30,40}.burpcollaborator.net/iU\";flow:to_server,established;sid:2018030026;rev:1;)", "2017960": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u77ff\u6c60\u5730\u5740|type:mining|tag:BitCoinMiner|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230W32/BitCoinMiner.MultiThreat\u6316\u77ff\u534f\u8bae\u7279\u5f81\uff08HTTP\u5934\uff09|failed_by:http_status_3XX,http_status_4XX\";flow:established,from_server;content:\"X-Stratum|3A|\";http_header;reference:url,www.anubisnetworks.com/unknowndga17-the-mevade-connection/;classtype:policy-violation;sid:2017960;rev:2;)", "2019090098": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Pure-FTPd\u8fde\u63a5|direction:in|level:action|service_name:PureFTPd|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728PureFTPd|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220.*Welcome to .*Pure-?FTPd[^(]+\\r\\n/\";sid:2019090098;gid:0;)", "2019090060": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Rsync\u8fde\u63a5|direction:in|level:action|service_name:Rsync|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728Rsync|server:src\";flow:from_server,established;content:\"@RSYNCD:\";depth:8;pcre:\"/^@RSYNCD: (\\d+)/\";sid:2019090060;gid:0;)", "2020010022": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08cve-2019-2725\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08cve-2019-2725\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/wls-wsat/CoordinatorPortType\";http_uri;http_content_type;content:\"text/xml\";pkt_data;content:\"<soapenv:Envelope\";http_client_body;content:\"class\";http_client_body;distance:0;pcre:\"/(oracle\\.toplink\\.internal\\.sessions\\.UnitOfWorkChangeSet)|(com\\.sun.rowset\\.JdbcRowSetImpl)|(org\\.slf4j\\.ext\\.EventData)/PR\";flowbits:set, cve-2019-2725;sid:2020010022;rev:1;)", "2020081904": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fbeOA\u4efb\u610f\u6587\u4ef6\u5220\u9664|tag:\u6743\u9650\u7ed5\u8fc7|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u901a\u8fbeOA\u4efb\u610f\u6587\u4ef6\u5220\u9664|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, tongda_oa_afd;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"<OBJECT classid=\";depth:20;http_server_body;sid:2020081904;rev:1;)", "2019020009": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Tomcat\u7ba1\u7406\u754c\u9762\u767b\u5f55|tag:Tomcat|force_save:true|direction:in|src:external_net|dest:home_net|level:action|severity:2|result:unknown|o_msg:Tomcat\u7ba1\u7406\u754c\u9762\u767b\u5f55\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;flowbits:set, tomcat_wake_password;noalert;content:\"GET\";http_method;content:\"/manager/html\";http_uri;content:\"Authorization: Basic \";http_header;sid:2019020009;rev:1;)", "2027762": "alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528AndDesk|direction:in|src:external_net|dest:home_net|level:action|service_name:AnyDesk|severity:1|service_class:rlogin|result:unknown|o_msg:\u4f7f\u7528AndDesk|server:dest\";flow:established, to_client;tls_cert_subject;content:\"C=DE, O=philandro Software GmbH, CN=AnyNet Relay\";isdataat:!1,relative;fast_pattern;threshold:type limit, track by_dst, count 1, seconds 600;sid:2027762;rev:2;)", "2020050922": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell\u4ea4\u4e92|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:webshell\u4ea4\u4e92|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, jsp_replace_shell_2;content:\"GET\";http_method;content:\".jsp?\";http_uri;nocase;content:\"help=\";http_uri;distance:0;content:!\"other\";http_uri;nocase;noalert;sid:2020050922;gid:0;rev:1;)", "2808854": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:EZBRO\u6728\u9a6c|type:rat|tag:EZBRO|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230TROJAN.CLICKER.MSIL/EZBRO.A\u4e0a\u7ebf\u5305\";flow:to_server,established;content:\"|5b 00 01 05 39 57 00 4d 6f 7a 69 6c 6c 61 25 32 46|\";depth:17;flowbits:set,EZBRO.A;reference:url,stopmalvertising.com/malware-reports/anatomy-of-a-net-click-fraud-bot.html;reference:md5,dbcb2d297e5d79c5a161801b2be775ba;classtype:trojan-activity;sid:2808854;rev:1;)", "2020041011": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, weblogic_xmldecode_1;flowbits:isset,weblogic_xmldecode_2;content:\"202\";http_stat_code;content:\"X-Powered-By: Servlet\";http_header;sid:2020041011;)", "2020062202": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:tomcat\u5185\u5b58webshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:success|o_msg:tomcat\u5185\u5b58\u9a6c\u6d4b\u8bd5webshell|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset,webshell_nofile_webshell;content:\"200\";http_stat_code;http_header_names;content:\"|0d 0a|Transfer-Encoding|0d 0a|Date|0d 0a|Keep-Alive|0d 0a|Connection|0d 0a 0d 0a|\";depth:53;sid:2020062202;rev:1;)", "2020081406": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08http\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884c\u547d\u4ee4ps -aux|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"USER\";http_server_body;content:\"PID\";http_server_body;distance:0;content:\"%CPU\";http_server_body;distance:0;pcre:\"/USER\\s+PID\\s+%CPU\\s+%MEM\\s+VSZ\\s+RSS\\s+TTY\\s+STAT\\s+START\\s+TIME\\s+COMMAND\\x0a/Q\";sid:2020081406;)", "2018030013": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u83dc\u5200\u521d\u59cb\u8fde\u63a5\u6210\u529f|tag:webshell\u8fde\u63a5|tool:\u83dc\u5200|direction:in|dest:home_net|src:external_net|level:attack|type:shell|phase:control|severity:4|result:success|o_msg:\u83dc\u5200\u521d\u59cb\u8fde\u63a5\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";content:\"200\";nocase;http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"|09|\";http_server_body;within:50;pcre:\"/^([\\d\\w`~!@#$%^&*()+=_<>?,./:\"\\;'\\\\{}\\[\\]]{3})(\\/[\\d\\w._-]+)+\\x09/iQ\";flowbits:isset,req;flowbits:set,req_webshell;flow:from_server,established;sid:2018030013;rev:1;)", "2019060035": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u83b7\u53d6powershell\u811a\u672c|tag:\u4e0b\u8f7d\u6076\u610f\u6587\u4ef6|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|type:unknown_url|result:success|o_msg:\u7591\u4f3c\u4e0b\u8f7dpowershell\u811a\u672c|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;http_content_type;content:\"text/plain\";pkt_data;content:\"(New-Object\";nocase;http_server_body;pcre:\"/\\s+(system\\.)?Net\\.WebClient\\)\\.DownloadString\\('(http|https)/QR\";gid:0;sid:2019060035;rev:1;)", "2018010046": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"union\";nocase;http_uri;pcre:\"/[\\\\/*! ]+/select[\\\\/*! ]+/iUR\";flow:to_server,established;gid:0;sid:2018010046;rev:1;)", "2020051926": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee(configprops)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, spring_actuator_configprops;content:\"200\";http_stat_code;http_content_type;content:\"application\";content:\"spring-boot.actuator\";distance:0;content:\"json\";distance:0;pkt_data;content:\"{\\\"contexts\\\":{\\\"application-1\\\":\";http_server_body;startswith;content:\"configprops\";distance:0;http_server_body;sid:2020051926;rev:1;)", "2019030005": "alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528ngrok\u8fdb\u884c\u5185\u7f51\u7a7f\u900f|tag:tunnel|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|tool:ngrok|result:unknown|o_msg:\u5c1d\u8bd5\u4e0e\u516c\u7f51ngrok\u670d\u52a1\u5668\u5efa\u7acb\u63a7\u5236\u8fde\u63a5\uff0c\u53ef\u7528\u6765\u8fdb\u884c\u5185\u7f51\u7a7f\u900f\";flow:established,to_server;tls_sni;content:\"tunnel.in.ngrok.com\";flowbits:set,ngrok_state_findsni;flowbits:noalert;sid:2019030005;)", "2018062902": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5229\u7528etherworm\u5efa\u7acb\u901a\u4fe1\u96a7\u9053|type:infil|tag:\u7aef\u53e3\u6620\u5c04|direction:lateral|src:external_net|dest:home_net|level:attack|phase:post_exploit|severity:4|result:success|o_msg:\u53d1\u73b0\u9ed1\u5ba2\u5de5\u5177etherworm\u7684sock\u6a21\u5757\u5c06\u5185\u7f51\u4e3b\u673a\u4f5c\u4e3a\u53cd\u5411\u4ee3\u7406\u5bf9\u5185\u7f51\u8fdb\u884c\u6e17\u900f\";dsize:6;flow:established,to_client;content:\"|01 02 00 00 00 00|\";flowbits:isset,TB_tool_exe_01packet;sid:2018062902;rev:1;)", "2020070326": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u8bf7\u6c42Linux\u4e0b\u654f\u611f\u6587\u4ef6|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5c1d\u8bd5\u8bf7\u6c42Linux\u4e0b\u654f\u611f\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"/usr/local\";http_uri;fast_pattern;pcre:\"/^(\\/apache\\/conf\\/httpd\\.conf)|(\\/apache2\\/conf\\/httpd\\.conf)|(\\/httpd\\/conf\\/httpd\\.conf)|(\\/lib\\/php\\.ini)/URi\";sid:2020070326;rev:1;)", "2019010027": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5XSS\u6f0f\u6d1e|tag:XSS|dest:home_net|level:attack|severity:1|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728XSS|attacker:src\";content:\"<script>\";http_uri;nocase;pcre:\"/\\w+\\([\\w'\"]+\\)/iUR\";content:\"</script>\";http_uri;nocase;flow:to_server,established;gid:0;sid:2019010027;rev:1;)", "2019090307": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:CouchDB\u8fde\u63a5|direction:in|level:action|service_name:CouchDB|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728CouchDB|failed_by:http_status_3XX,http_status_4XX|server:dest\";flow:from_server,established;content:\"200\";http_stat_code;content:\"Server: inets|2f|develop\";http_raw_header;content:\"|7b 22|couchdb|22 3a 20 22|Welcome|22 2c 20 22|version|22 2c 20 22|\";http_server_body;sid:2019090307;gid:0;)", "2020061215": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fbeOA\u524d\u53f0\u4efb\u610f\u7528\u6237\u4f2a\u9020\u767b\u5f55\u6f0f\u6d1e|tag:\u672a\u6388\u6743\u8bbf\u95ee|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u901a\u8fbeOA\u524d\u53f0\u4efb\u610f\u7528\u6237\u4f2a\u9020\u767b\u5f55\u6f0f\u6d1e\uff0c\u83b7\u53d6\u7528\u6237cookie|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, tongda_login_bypass_step_2;content:\"200\";http_stat_code;content:\"PHPSESSID=\";http_cookie;pcre:\"/^[a-z0-9]{26}\\;/CR\";http_content_type;content:\"text/html\";pkt_data;content:\"{\\\"status\\\":1\";http_server_body;depth:40;sid:2020061215;rev:1;)", "2020041004": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:weblogic\u6f0f\u6d1e\u5229\u7528|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:weblogic\u6f0f\u6d1e\u5229\u7528|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset,weblogic_xmldecode_1;content:\"500\";http_stat_code;http_content_type;content:\"text/xml\";pkt_data;content:\"java.io.IOException: Cannot run program \\\"\";http_server_body;pcre:\"/(ifconfig|dir|ipconfig|)\\\": CreateProcess /RQ\";sid:2020041004;)", "2018081330": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u4f7f\u7528Htran\u547d\u4ee4\";flow:from_server,established;content:\"HTran\";depth:5;nocase;flowbits:isset,TB_ZxShell;sid:2018081330;rev:1;)", "2018041915": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6781\u5149\u540e\u95e8\u6728\u9a6c|type:rat|tag:jiguang2009|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6c\u6781\u51492009\u5fc3\u8df3\u5305\";flow:to_server,established;dsize:6;content:\"|4d 54 49 7a 0d 0a|\";depth:6;flowbits:noalert;flowbits:set,TB_jiguang2009_2;threshold:type both, track by_src, count 9, seconds 300;sid:2018041915;rev:1;)", "2018020057": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528HEAD\u8bf7\u6c42|direction:in|src:external_net|dest:home_net|level:action|o_msg:HTTP\u7684HEAD\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"HEAD\";nocase;http_method;gid:0;sid:2018020057;rev:1;)", "2018060007": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Webshell(\u4f5c\u8005:YangFei)\u8fde\u63a5\u6210\u529f|tag:webshell\u8fde\u63a5\u6210\u529f|direction:in|src:external_net|dest:home_net|level:attack|severity:4|phase:control|type:shell|result:unknown|o_msg:\u68c0\u6d4b\u5230webshell\u6210\u529f\u8fde\u63a5,\u4f5c\u8005yangfei,\u4f7f\u7528\u57df\u540dthisdoor.com, \u90ae\u7bb1:lcxcc007@gmail.com|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";nocase;http_method;content:\".php\";nocase;http_uri;pcre:\"/(.php)$/iU\";content:\"getpwd=\";nocase;http_client_body;offset:0;pcre:\"/getpwd=([\\d\\w_.!@#$%^&*()+-]+)$/iP\";flowbits:set, yangfei_webshell;flowbits:noalert;noalert;gid:0;sid:2018060007;rev:1;)", "2020051918": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee(beans)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, spring_actuator_beans;content:\"200\";http_stat_code;http_content_type;content:\"application\";content:\"spring-boot.actuator\";distance:0;content:\"json\";distance:0;pkt_data;content:\"{\\\"contexts\\\":{\\\"application-1\\\":{\\\"beans\\\":\";http_server_body;startswith;sid:2020051918;rev:1;)", "2019090065": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MongoDB\u8fde\u63a5|direction:in|level:action|service_name:MongoDB|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728MongoDB|server:src\";flow:from_server,established;content:\"|00 00 00|\";offset:1;depth:3;pcre:\"/^.\\0\\0\\0....:0\\0\\0\\x01\\0\\0\\0\\x08\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x01\\0\\0\\0g\\0\\0\\0\\x01ok\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x02errmsg\\0.\\0\\0\\0not authorized on (\\S+) to execute command \\{ serverStatus: 1\\.0 \\}\\0\\x10code\\0\\r\\0\\0\\0\\0/\";sid:2019090065;gid:0;)", "2018010023": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MSSQL\u7206\u7834|tag:MSSQL\u7206\u7834|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5bf9MSSQL\u670d\u52a1\u5668\u7206\u7834|attacker:src\";dsize:300<>650;flow:to_server,established;content:\"|02 00 02 00 00 00 02 00|\";depth:8;content:\"MSDBLIB\";nocase;threshold:type limit, track by_src, count 30, seconds 1;sid:2018010023;rev:1;)", "2018040018": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5357\u65b9\u6570\u636eCMS\u7684\u6f0f\u6d1e\u626b\u63cf|tag:\u6f0f\u6d1e\u626b\u63cf|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|failed_by:http_status_3XX,http_status_4XX|phase:recon|severity:1|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u5bf9\u5357\u65b9\u6570\u636eCMS\u7684\u6f0f\u6d1e\u626b\u63cf\";content:\"GET\";nocase;http_method;content:\"/NewsType.asp?SmallClass='\";nocase;http_uri;within:300;pcre:\"/\\s+union\\s+select\\s+\\d+,/iUR\";flow:to_server,established;gid:0;sid:2018040018;rev:1;)", "2020010050": "alert dns $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528gobygo.net\u8fdb\u884c\u53cd\u5f39|tag:dnslog|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u5229\u7528dnslog\u8fdb\u884c\u53cd\u5f39|attacker:dest\";flow:established, to_server;dns_query;content:\".gobygo.net\";pkt_data;sid:2020010050;rev:1;)", "2020021011": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Laravel \u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u6267\u884c\u547d\u4ee4)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Laravel \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Illuminate\";content:\"Broadcasting\";distance:1;content:\"PendingBroadcast\";distance:1;content:\"*events\";distance:1;content:\"Illuminate\";distance:1;content:\"Bus\";distance:1;content:\"*event\";distance:1;content:\"MockConfiguration\";distance:1;content:\"*code\";distance:1;sid:2020021011;rev:1;)", "2019010110": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ThinkCMF \u4efb\u610f\u5185\u5bb9\u5305\u542b\u6f0f\u6d1e|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:ThinkCMF \u4efb\u610f\u5185\u5bb9\u5305\u542b\u6f0f\u6d1e|attacker:src\";flow:to_server,established;flowbits:set, thinkcmf_include_file;content:\"POST\";http_method;content:\"a=display\";http_client_body;content:\"templateFile=\";http_client_body;sid:2019010110;rev:1;)", "2020062210": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4e0a\u4f20 ABPTTS \u4ee3\u7406\u6587\u4ef6|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u653b\u51fb\u8005\u4e0a\u4f20 ABPTTS \u4ee3\u7406\u6587\u4ef6, \u5c1d\u8bd5\u8fde\u63a5\u5185\u7f51webshell|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"boundary=\";pkt_data;content:\"filename=\";http_client_body;content:\".jsp\";http_client_body;distance:0;within:100;content:\"<%\";http_client_body;distance:0;content:\"This file is part of A Black Path Toward The Sun (\\\"ABPTTS\\\")\";http_client_body;distance:0;sid:2020062210;rev:1;)", "2020072207": "alert smb $HOME_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528smb_psexec\u8c03\u7528powershell|tag:\u8fdc\u7a0b\u63a7\u5236|tool:psexec|direction:out|src:home_net|dest:home_net|level:attack|phase:control|attacker:src|result:success|severity:4|o_msg:\u4f7f\u7528smb_psexec\u8c03\u7528powershell\";flow:established, to_server;content:\"SMB\";offset:5;depth:3;content:\"%|00|C|00|O|00|M|00|S|00|P|00|E|00|C|00|%|00|\";distance:0;content:\"p|00|o|00|w|00|e|00|r|00|s|00|h|00|e|00|l|00|l|00 2e 00|e|00|x|00|e|00|\";distance:0;sid:2020072207;rev:1;)", "2008690": "alert udp $HOME_NET any -> $HOME_NET 139 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";content:\"|0B|\";offset:2;depth:1;content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008690;classtype:attempted-admin;sid:2008690;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2019090018": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:RDP\u8fde\u63a5|direction:in|level:action|service_name:RDP|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728RDP|server:src\";flow:from_server,established;content:\"|03 00 00|\";depth:3;pcre:\"/^\\x03\\0\\0\\x0b\\x06\\xd0\\0\\x004\\x12\\0/\";sid:2019090018;gid:0;)", "2019090207": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 (?:.*? )?([-\\w_.]+) ESMTP(?: [^\\r\\n]*)?\\r\\n402 4\\.5\\.2 Error: command not recognized\\r\\n/\";sid:2019090207;gid:0;)", "2017120107": "alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:\"name:\u5efa\u7acb\u901a\u4fe1\u96a7\u9053|type:tunneling|tag:DNS\u96a7\u9053|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:2|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5f02\u5e38\u7684TXT\u7c7b\u578b\u8bf7\u6c42\";content:!\"|00|\";offset:12;depth:1;byte_test:1, >, 30, 12, big;content:\"|00 10 00 01|\";isdataat:!5, relative;threshold:type threshold, track by_src, count 50, seconds 300;sid:2017120107;rev:2;)", "2010220": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (ClickAdsByIE)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| ClickAdsByIE\";http_header;reference:url,doc.emergingthreats.net/2010220;classtype:trojan-activity;sid:2010220;rev:5;)", "2019090258": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"E|00 00 00|\";depth:4;pcre:\"/^E\\0\\0\\09SFATAL\\0MExpecting a startup message, but received \\r\\0\\0/\";sid:2019090258;gid:0;)", "2018112812": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:weblogic\u7684\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230weblogic\u7684\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2017-10271\uff09|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"post\";nocase;http_method;content:\"/wls-wsat/CoordinatorPortType\";nocase;http_uri;content:\"class=|22|java.beans.xmldecoder|22|\";nocase;sid:2018112812;)", "2809645": "alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:\"name:\u5229\u7528SMB\u4f20\u8f93mimikatz|tag:smb|direction:lateral|type:infil|src:home_net|dest:home_net|attacker:src|level:attack|phase:post_exploit|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5728\u5185\u7f51\u901a\u8fc7SMB\u534f\u8bae\u4f20\u8f93\u9ed1\u5ba2\u5de5\u5177Mimikatz\u7684mimidrv.sys\u6587\u4ef6\uff08Ascii\uff09\";flow:established,to_server;content:\"|FF|SMB|a2|\";offset:4;depth:5;byte_test:1,!&,0x80,6,relative;content:\"mimidrv.sys\";distance:0;reference:url,github.com/gentilkiwi/mimikatz;classtype:trojan-activity;sid:2809645;rev:1;metadata:created_at 2015_01_30, updated_at 2015_01_30;)", "2015747": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5JBoss/JMX InvokerServlet\u7ed5\u8fc7\u5c1d\u8bd5|tag:\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:JBOSS\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/invoker/JMXInvokerServlet/\";http_uri;nocase;reference:cve,CVE-2007-1036;reference:url,exploit-db.com/exploits/21080/;classtype:web-application-attack;sid:2015747;rev:3;metadata:created_at 2012_09_28, updated_at 2012_09_28;)", "2019090189": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ESMTP \\(Debian/GNU Mewwwwwww\\)\\r\\n/\";sid:2019090189;gid:0;)", "2020060223": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(CommonsCollections6-HTTP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"application/\";pcre:\"/(x-www-form-urlencoded)|(x-java-serialized-object)/R\";pkt_data;content:\"|ac ed 00 05|\";http_client_body;fast_pattern;content:\"java.util.HashSet\";http_client_body;content:\"org.apache.commons.collections.keyvalue.TiedMapEntry\";http_client_body;content:\"org.apache.commons.collections.map.LazyMap\";http_client_body;content:\"org.apache.commons.collections.Transformer\";http_client_body;content:\"org.apache.commons.collections.functors.ConstantTransformer\";http_client_body;content:\"org.apache.commons.collections.functors.InvokerTransformer\";http_client_body;sid:2020060223;rev:1;)", "2809505": "alert tcp $EXTERNAL_NET any -> $HOME_NET 27017 (msg:\"name:MongoDB\u6570\u636e\u5e93\u679a\u4e3e|tag:\u672a\u6388\u6743\u6f0f\u6d1e|direction:in|src:external_net|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:MongoDB\u516c\u7f51\u76f4\u63a5\u8bbf\u95ee-REST INFO\u54cd\u5e94\";flow:to_server,established;content:\"|d4 07 00 00|\";offset:12;depth:4;fast_pattern;content:\"admin.$cmd|00|\";distance:0;content:\"listDatabases|00|\";distance:0;sid:2809505;rev:1;)", "2019090142": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Exim\u8fde\u63a5|direction:in|level:action|service_name:Exim(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Exim|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 SMTP Server RoiMailServer ready\\.\\r\\n/\";sid:2019090142;gid:0;)", "2020060226": "alert TCP $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(CommonsCollections6-TCP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|attacker:src\";flow:established, to_server;content:\"|ac ed 00 05|\";fast_pattern;content:\"java.util.Hashtable\";content:\"org.apache.commons.collections.Transformer\";content:\"org.apache.commons.collections.functors.ConstantTransformer\";content:\"org.apache.commons.collections.functors.InvokerTransformer\";content:\"java.util.HashMap\";sid:2020060226;rev:1;)", "2019010043": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u5229\u7528Jira\u670d\u52a1\u7aef\u6a21\u677f\u6ce8\u5165\u6f0f\u6d1e|tag:SSTI|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Jira\u670d\u52a1\u7aef\u6a21\u677f\u6ce8\u5165(CVE-2019-11581)|attacker:src\";flow:to_server,established;content:\"POST\";nocase;http_method;content:\"/secure/ContactAdministrators.jspa\";http_uri;content:\"subject=\";http_client_body;pcre:\"/\\$\\w+\\.\\w+\\([^\\)]*\\)/P\";distance:0;gid:3;sid:2019010043;)", "2020081002": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:powershell \u53cd\u5f39shell|tag:\u53cd\u5f39shell|type:shell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:powershell\u53cd\u5f39shell\";flow:established;content:\"Windows PowerShell running as user\";depth:50;content:\"Microsoft Corporation\";distance:2;within:200;sid:2020081002;)", "2027210": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ET POLICY Outbound POST Request with ps PowerShell Command Output|tag:TEST|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:dest\";flow:to_server,established;content:\"POST\";http_method;content:\"|48 61 6e 64 6c 65 73 20 20 4e 50 4d 28 4b 29 20 20 20 20 50 4d 28 4b 29 20 20 20 20 20 20 57 53 28 4b 29|\";http_client_body;fast_pattern;metadata:former_category TROJAN;reference:url,attack.mitre.org/techniques/T1057/;reference:url,attack.mitre.org/techniques/T1086/;classtype:trojan-activity;sid:2027210;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, tag T1086, tag T1057, created_at 2019_04_16, performance_impact Low, updated_at 2019_04_16;)", "2020080321": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7 Metasploit \u8fde\u63a5\u670d\u52a1\u5668(tcp)|tag:\u53cd\u5f39shell|dest:home_net|level:attack|phase:exploit|severity:3|attack_type:target|result:unknown|o_msg:Metasploit \u8fde\u63a5(windows/shell/bind_tcp)|attacker:src\";flags:P, A;flow:to_server, established;flowbits:set, windows_shell_bind_tcp;noalert;dsize:4;content:\"|0b 01 00 00|\";depth:4;sid:2020080321;)", "2020052005": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell \u8fde\u63a5\u6210\u529f|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:success|o_msg:webshell \u8fde\u63a5\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, jsp_webshell_20200520;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"|0d 0a 0d 0a 0d 0a|\";http_server_body;depth:6;content:\"<pre>\";distance:0;within:5;http_server_body;content:\"</pre>\";distance:0;http_server_body;sid:2020052005;rev:1;)", "2020010003": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:bash\u53cd\u5f39shell|tag:\u53cd\u5f39shell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:bash\u53cd\u5f39shell(root)\";flow:established,to_server;flags:P,A;dsize:<100;content:\"root@\";content:\"#\";pcre:\"/^root@\\w+:[/~\\w][\\w/.-]*#/\";flowbits:set,linux_bash_reverse_shell;sid:2020010003;)", "2020032604": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Discuz!X \u22643.4 \u540e\u53f0sql\u6ce8\u5165|tag:sql\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:3|result:succsee|o_msg:Discuz!X \u22643.4 \u540e\u53f0sql\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, discuz_3_4_sqli;content:\"200\";http_stat_code;content:\"MySQL Query Error\";http_server_body;sid:2020032604;rev:1;)", "2020062223": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:success|o_msg:\u653b\u51fb\u8005\u5c1d\u8bd5\u901a\u8fc7webshell\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, mem_webshell_interaction_1;content:\"200\";http_stat_code;content:\"Webshell in Memory:|0a 0a|Usage:|0a|anyurl?pwd=pass\";http_server_body;content:\"For learning exchanges only, do not use for illegal purposes.by rebeyond.\";http_server_body;sid:2020062223;rev:1;)", "2020061907": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7206\u7834 Jupyter Notebook|tag:\u66b4\u529b\u7834\u89e3|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u7206\u7834 Jupyter Notebook\uff0c\u653b\u51fb\u8005\u5982\u679c\u6210\u529f\u8fdb\u5165\uff0c\u53ef\u76f4\u63a5\u8bbf\u95ee\u90e8\u5206\u6587\u4ef6\uff0c\u5e76\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;noalert;flowbits:set, jupyter_notebook_blasting;content:\"POST\";http_method;content:\"/login?next=/tree?\";http_uri;depth:30;content:\"password=\";http_client_body;sid:2020061907;rev:1;)", "2020081443": "alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08udp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884cipconfig\u547d\u4ee4\";content:\"Windows IP \";fast_pattern;content:\" . . . . . . . : \";distance:0;content:\" . . . . . . . . . . . . : \";distance:0;pcre:\"/^(((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(\\.((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3})\\x0d\\x0a\\x20\\x20\\x20/R\";sid:2020081443;)", "2020080303": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Metasploit \u8fde\u63a5(tcp)|tag:\u53cd\u5f39shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:Metasploit \u8fde\u63a5(linux/x86/meterpreter/reverse_tcp)\";flow:from_server, established;content:\"mbedtls_platform_entropy_poll|00|\";fast_pattern;content:\"execve|00|\";distance:0;within:7;content:\"mbedtls_ctr_drbg_random|00|\";distance:0;within:24;content:\"__c_locale|00|\";distance:0;within:11;content:\"webcam_stop|00|\";distance:0;within:12;sid:2020080303;)", "2020070802": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6587\u4ef6\u5305\u542b\u8bfb\u53d6|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u6587\u4ef6\u8bfb\u53d6\u5c1d\u8bd5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, file_read_general;content:\"/var\";http_uri;fast_pattern;pcre:\"/(log\\/apache2\\/access\\.log)|(\\/log\\/apache\\/access\\.log)|(\\/log\\/httpd\\/access\\.log)|(\\/log\\/apache2\\/access_log)|(\\/log\\/apache\\/access_log)|(\\/log\\/httpd\\/access_log)|(\\/httpd\\/logs\\/access_log)|(\\/httpd\\/logs\\/access\\.log)|(\\/www\\/logs\\/access_log)|(\\/www\\/logs\\/access\\.log)|(\\/log\\/access_log)|(\\/log\\/access\\.log)/U\";sid:2020070802;rev:1;)", "2018040024": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:dedeCMS\u7684\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u626b\u63cf|tag:\u6f0f\u6d1e\u626b\u63cf|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|phase:recon|failed_by:http_status_3XX,http_status_4XX|severity:1|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u5bf9dedeCMS\u7684\u6f0f\u6d1e\u626b\u63cf\";content:\"GET\";nocase;http_method;content:\"/install/index.php.bak?\";nocase;http_uri;within:300;content:\"&inslockfile=\";nocase;http_uri;within:80;pcre:\"/[\\w\\d]{1,2}/iUR\";content:\"&s_lang=\";nocase;http_uri;within:80;pcre:\"/[\\w\\d]{1,2}/iUR\";content:\"&install_demo_name=../data/admin/config_update.php\";nocase;http_uri;within:80;flow:to_server,established;gid:0;sid:2018040024;rev:1;)", "2018020061": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528CONNECT\u8bf7\u6c42\u5bfb\u627e\u4ee3\u7406\u670d\u52a1\u5668|direction:in|src:external_net|dest:home_net|level:action|o_msg:HTTP\u7684TRACE\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"CONNECT\";nocase;http_method;gid:0;sid:2018020061;rev:1;)", "2019010053": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:\u626b\u63cf|dest:home_net|level:attack|phase:exploit|severity:1|result:unknown|o_msg:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"/images/\";nocase;http_uri;pcre:\"/([\\w\\d]+\\/)?[\\w\\d_.-]+\\.(asp|php|aspx|jsp)/URi\";flow:to_server,established;gid:0;sid:2019010053;)", "180520001": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:DDos.Win_ctrol|type:botnet|tag:CtlDDoS|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230CnC\u7a0b\u5e8fDDos.Win_ctrol 2.0\";dsize:220;flow:from_server,established;content:\"|88 00 00 00|\";depth:4;content:\"|00 00 00 00 c0 a8 14|\";distance:4;within:7;classtype:trojan-activity;sid:180520001;rev:1;)", "2019090183": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220-InterScan Version (\\S+) .*Ready\\r\\n220 ([-.+\\w]+) ESMTP Postfix\\r\\n/\";sid:2019090183;gid:0;)", "2019010138": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"updatexml(\";nocase;http_client_body;pcre:\"/\\d, *concat\\(0x\\w\\w,/iP\";flow:to_server,established;gid:0;sid:2019010138;rev:1;)", "202099994": "alert tcp $HOME_NET any -> $HOME_NET any (msg:\"name:\u68c0\u6d4bSSH\u6307\u7eb9|tag:\u626b\u63cf|tool:Nmap|type:infil|direction:in|phase:post_exploit|src:home_net|attacker:src|dest:home_net|level:attack|severity:1|result:unknown|o_msg:NMAP \u68c0\u6d4bSSH\u6307\u7eb9\";dsize:27;content:\"SSH\";nocase;offset:0;pcre:\"/-\\d\\.\\d-Nmap-SSH\\d-Hostkey/iR\";flow:to_server,established;sid:202099994;rev:1;)", "2027044": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"YXJnb3JwIHNpaF\";distance:0;fast_pattern;metadata:former_category ATTACK_RESPONSE;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027044;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_03_05, malware_family DNSlivery, updated_at 2019_03_05;)", "2019090230": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Courier\u8fde\u63a5|direction:in|level:action|service_name:Courier(imap)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Courier imap|server:src\";flow:from_server,established;content:\"GET NO\";depth:6;pcre:\"/^GET NO Error in IMAP command received by server\\.\\r\\n/\";sid:2019090230;gid:0;)", "2020062904": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u8fde\u63a5 reDuh \u4ee3\u7406\u6587\u4ef6|tag:\u653b\u51fb\u4ee3\u7406|tool:reDuh|dest:home_net|level:attack|phase:exploit|type:exploit|severity:4|result:unknown|o_msg:\u5c1d\u8bd5\u8fde\u63a5 reDuh \u4ee3\u7406\u6587\u4ef6|attacker:src|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;flowbits:set, reDuh_link_1;content:\"GET\";http_method;content:\"?action=checkPort&port=\";http_uri;http_accept;content:\"text/html, image/gif, image/jpeg, *\\; q=.2, */*\\; q=.2\";pkt_data;sid:2020062904;rev:1;)", "2018062807": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:weevely\u8fde\u63a5\u8bf7\u6c42|tag:\u83dc\u5200|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230weevely\u8fde\u63a5php webshell\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;pcre:\"/^APISID=we\\;/C\";sid:2018062807;rev:1;)", "2020050602": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528SaltStack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u83b7\u53d6root_key(CVE-2020-11651,CVE-2020-11652)|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|src:home_net|level:attack|phase:exploit|result:success|o_msg:SaltStack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2020-11651,CVE-2020-11652)\u3010\u83b7\u53d6root_key\u3011|severity:3|attacker:dest\";flow:to_client, established;flowbits:isset, cve_2020_11651_read_root_key;content:\"user\";content:\"root\";distance:0;sid:2020050602;rev:2;)", "2019090218": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:qmail\u8fde\u63a5|direction:in|level:action|service_name:Qmail|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728qmail|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220[\\s-](\\S+) (?:OK )?ESMTP ?\\r\\n214[- ]qmail home page: http://pobox\\.com/~djb/qmail\\.html/\";sid:2019090218;gid:0;)", "2020080302": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Metasploit \u8fde\u63a5(tcp)|tag:\u53cd\u5f39shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:Metasploit \u8fde\u63a5(linux/x64/meterpreter_reverse_tcp)\";flags:P, A;flow:from_server, established;dsize:571;byte_extract:4, 0, Metasploit_meterpreter_tcp;byte_extract:2, 0, Metasploit_meterpreter_tcp_1;byte_test:4, =, Metasploit_meterpreter_tcp, 4;byte_test:4, =, Metasploit_meterpreter_tcp, 8;byte_test:4, =, Metasploit_meterpreter_tcp, 12;byte_test:4, =, Metasploit_meterpreter_tcp, 16;byte_test:4, =, Metasploit_meterpreter_tcp, 20;byte_test:4, !=, Metasploit_meterpreter_tcp, 24;byte_test:2, =, Metasploit_meterpreter_tcp_1, 24;byte_test:4, =, Metasploit_meterpreter_tcp, 28;byte_test:4, !=, Metasploit_meterpreter_tcp, 32;byte_test:2, =, Metasploit_meterpreter_tcp_1, 32;sid:2020080302;)", "2020051928": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee(health)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, spring_actuator_health;content:\"200\";http_stat_code;http_content_type;content:\"application\";content:\"spring-boot.actuator\";distance:0;content:\"json\";distance:0;pkt_data;content:\"{\\\"description\\\":\";http_server_body;startswith;content:\"\\\"status\\\":\";distance:0;http_server_body;sid:2020051928;rev:1;)", "2018010018": "alert tcp $HOME_NET 23 -> $EXTERNAL_NET any (msg:\"name:\u7206\u7834Telnet|tag:Telnet\u7206\u7834|src:home_net|level:attack|phase:exploit|result:unknown|o_msg:TELNET \u670d\u52a1\u6b63\u5728\u88ab\u7206\u7834|severity:1|attacker:dest\";flow:from_server,established;content:\"login incorrect\";nocase;threshold:type threshold, track by_dst, count 10, seconds 60;gid:3;sid:2018010018;rev:1;)", "2020071401": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Liferay Portal Json Web Service \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(CVE-2020-7961)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|severity:3|result:unknown|phase:exploit|o_msg:Liferay Portal Json Web Service \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(CVE-2020-7961)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2020_7961;content:\"POST\";http_method;content:\"/api/jsonws/invoke\";http_uri;depth:40;content:\"cmd=\";http_client_body;content:\"com.mchange.v2.c3p0.WrapperConnectionPoolDataSource\";http_client_body;content:\"aced0005\";http_client_body;sid:2020071401;)", "2019060004": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6b63\u5e38jsp\u8bf7\u6c42|tag:jsp|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:1|result:unknown|o_msg:\u6b63\u5e38asxh\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";content:\"POST\";nocase;http_method;content:\".asxh\";nocase;http_uri;pcre:\"/\\.asxh(\\?)?/iU\";flow:to_server,established;flowbits:set,post_req;flowbits:noalert;gid:0;sid:2019060004;rev:1;)", "2019020010": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Tomcat\u4e0a\u4f20war\u5305|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|severity:2|phase:exploit|success_by:http_status_200|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Tomcat\u4e0a\u4f20war\u5305\uff0c\u8fd0\u7ef4\u5de5\u7a0b\u5e08\u5e38\u89c1\u64cd\u4f5c\uff0c\u4f46\u653b\u51fb\u8005\u559c\u6b22\u7528\u8fd9\u79cd\u65b9\u6cd5\u4e0a\u4f20webshell|attacker:src\";flow:to_server,established;flowbits:set, tomcat_upload_success;noalert;content:\"POST\";http_method;content:\"/manager/html/upload\";http_uri;http_content_type:content: \"multipart/form-data\";pkt_data;content:\"name=\\\"deployWar\\\"\";http_client_body;content:\"filename=\\\"\";http_client_body;sid:2019020010;rev:1;)", "2020070216": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u7591\u4f3c\u88ab\u52ab\u6301|tag:\u52ab\u6301|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u7591\u4f3c\u901a\u8fc7\u9875\u9762\u7be1\u6539\u8fdb\u884c\u52ab\u6301|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, gaoling;content:\"200\";http_stat_code;http_content_len;content:\"127\";pkt_data;content:\"<meta http-equiv=\\\"refresh\\\"\";distance:0;http_server_body;content:\"content=\\\"0\\;\";within:16;http_server_body;content:\"URL=https://verified-rx.com/search.html\";within:50;http_server_body;sid:2020070216;rev:1;)", "2019070005": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ThinkPHP\u6f0f\u6d1e|tag:ThinkPHP\u6f0f\u6d1e\u5229\u7528|direction:out|src:home_net|dest:external_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:attack_out|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728ThinkPHP\u6f0f\u6d1e\";content:\"GET\";nocase;http_method;content:\"/index.php\";nocase;http_uri;within:100;pcre:\"/(\\/)?\\?s=(\\/)?index\\/\\\\think\\\\template\\\\driver\\\\file/write&cacheFile=/iUR\";flow:to_server,established;gid:0;sid:2019070005;rev:1;)", "2020061904": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:GoAhead \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2017-17562)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u653b\u51fb\u8005GoAhead \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2017-17562)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2017_17562;content:\"200\";http_stat_code;content:\"X-Frame-Options: SAMEORIGIN\";http_header;http_content_type;content:\"text/html\";pkt_data;content:\"<title>cgi title</title>\";http_server_body;depth:100;sid:2020061904;rev:1;)", "2018020033": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:curl\u5411\u5916\u8bf7\u6c42|tag:curl\u8bf7\u6c42|tool:curl|direction:out|src:home_net|dest:external_net|level:action|result:unknown|o_msg:\u68c0\u6d4b\u5230linux\u670d\u52a1\u5668\u5185\u90e8\u4f7f\u7528curl\u5411\u5916\u8bf7\u6c42\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"curl\";http_user_agent;nocase;gid:3;sid:2018020033;rev:1;)", "2020081010": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u77ff\u6c60\u901a\u8baf\uff08\u8bf7\u6c42-Stratum\u534f\u8bae\uff09|tag:\u6316\u77ff|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|result:success|o_msg:\u68c0\u6d4b\u5230\u77ff\u6c60\u901a\u8baf\uff08\u8bf7\u6c42-Stratum\u534f\u8bae\uff09\";flow:established, to_server;content:\"{\\\"id\\\": \";depth:10;pcre:\"/^\\{\"id\"\\:\\s?(\\d{1,3}|null),\\s?\"method\"\\:\\s?\"[[:print:]]+?\\\",\\s?\"params\"\\:\\s?\\[[[:print:]]*?\\]\\}$/\";sid:2020081010;rev:2;)", "2027036": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"BoAGkAcwAgAHAAcgBvAGcAcgBhAG\";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027036;rev:2;metadata:created_at 2019_03_05, updated_at 2019_03_05;)", "2024217": "alert smb $HOME_NET any -> $HOME_NET any (msg:\"name:\u5229\u7528MS17-010\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u7591\u4f3c\u5b58\u5728\u6c38\u6052\u4e4b\u84dd\u6f0f\u6d1e\u5806\u55b7\u5c04\u884c\u4e3a - MS17-010\";flow:to_server,established;content:\"|ff|SMB|33 00 00 00 00 18 07 c0 00 00 00 00 00 00 00 00 00 00 00 00 00 08 ff fe 00 08|\";offset:4;depth:30;fast_pattern:10,20;content:\"|00 09 00 00 00 10|\";distance:1;within:6;content:\"|00 00 00 00 00 00 00 10|\";within:8;content:\"|00 00 00 10|\";distance:4;within:4;pcre:\"/^[a-zA-Z0-9+/]{1000,}/R\";threshold:type threshold, track by_src, count 5, seconds 1;metadata:former_category EXPLOIT;classtype:trojan-activity;sid:2024217;rev:2;metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_05_13;)", "2009359": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u68c0\u6d4bHTTP\u548cweb\u5e94\u7528\u6307\u7eb9|tag:\u626b\u63cf|tool:Nmap|type:\u6307\u7eb9\u63a2\u6d4b|direction:in|phase:recon|src:external_net|dest:home_net|level:attack|severity:1|result:unknown|o_msg:NMAP\u626b\u63cf\u68c0\u6d4bHTTP\u548cweb\u5e94\u7528\u6307\u7eb9|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"Nmap NSE\";http_user_agent;sid:2009359;rev:4;)", "2019010040": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u5229\u7528fastjson\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:JAVA\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u901a\u8fc7http POST\u89e6\u53d1fastjson\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(JNDI\u6ce8\u5165)|attacker:src\";flow:to_server,established;content:\"@type\";http_client_body;content:\"org.apache.ibatis.datasource.jndi.JndiDataSourceFactory\";distance:1;nocase;http_client_body;content:\"rmi|3A|//\";http_client_body;flowbits:set, fastjson_exp;xbits:set,is_exploit_fastjson,track ip_dst;gid:3;sid:2019010040;)", "2020051306": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7591\u4f3c\u9488\u5bf9\u6df1\u4fe1\u670dVPN\u7684\u653b\u51fb\u884c\u4e3a|tag:\u6df1\u4fe1\u670dVPN|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:unknown|o_msg:\u7591\u4f3c\u9488\u5bf9\u6df1\u4fe1\u670dVPN\u7684\u653b\u51fb\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"/por/?\";http_uri;depth:8;content:\"rnd=\";http_uri;distance:0;within:8;pcre:\"/\\.(ini|bat|cmd|print|md5)/URi\";sid:2020051306;gid:0;rev:1;)", "2020070701": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:DVR\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e(CVE-2018-9995)|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:DVR\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e(CVE-2018-9995)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2018_9995;content:\"/device.rsp\";http_uri;depth:20;content:\"opt=user\";http_uri;content:\"cmd=list\";http_uri;content:\"uid=admin\";http_cookie;sid:2020070701;rev:1;)", "2009538": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (ms_ie) - Crypt.ZPACK Gen\u6728\u9a6c\u4e0b\u8f7d\u7684GET\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent\\: ms_ie|0d 0a|\";http_header;nocase;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/2009538;classtype:trojan-activity;sid:2009538;rev:5;)", "2019090270": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"E|00 00 00|\";depth:4;pcre:\"/^E\\0\\0\\0.S[^\\0]+\\0C0A000\\0M\\xe3\\x83\\x95\\xe3\\x83\\xad\\xe3\\x83\\xb3\\xe3\\x83\\x88\\xe3\\x82\\xa8\\xe3\\x83\\xb3\\xe3\\x83\\x89\\xe3\\x83\\x97\\xe3\\x83\\xad\\xe3\\x83\\x88\\xe3\\x82\\xb3\\xe3\\x83\\xab/\";sid:2019090270;gid:0;)", "2019010079": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:php create_function\u6f0f\u6d1e\u5229\u7528|tag:webshell php|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u901a\u8fc7create_function\u95f4\u63a5\u8c03\u7528eval\u89e6\u53d1rce|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\".php\";http_uri;content:\"=\";distance:0;http_client_body;content:\"}\";distance:0;http_client_body;content:\"\\;/*\";distance:0;http_client_body;pcre:\"/(?:^|&)\\w+=[\\w\\s@()\\;.'\"_-]*}\\s*@?(?:echo )?(?:system|assert|eval|exec|shell_exec|passthru|popen|proc_open|)\\([\\s\\w'\"$_\\[\\]()%]*?\\)\\s*\\;\\s*\\/[*/]/P\";flowbits:set,php_create_function;sid:2019010079;)", "2020063005": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Nexus \u4f7f\u7528\u9ed8\u8ba4\u5bc6\u7801|tag:\u5f31\u53e3\u4ee4|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Nexus \u4f7f\u7528\u9ed8\u8ba4\u5bc6\u7801|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, nexus_weak_passwd;content:\"200\";http_stat_code;content:\"|0d 0a|Server: Nexus/\";http_header;sid:2020063005;rev:1;)", "2020070101": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Nexus \u4f7f\u7528\u9ed8\u8ba4\u5bc6\u7801|tag:\u5f31\u53e3\u4ee4|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Nexus \u4f7f\u7528\u9ed8\u8ba4\u5bc6\u7801|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, nexus_weak_passwd_2;noalert;content:\"POST\";http_method;content:\"/service/rapture/session\";http_uri;depth:40;content:\"username=YWRtaW4%3D\";http_client_body;depth:80;nocase;content:\"password=YWRtaW4xMjM%3D\";http_client_body;depth:80;nocase;sid:2020070101;rev:1;)", "2018010052": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MSSQL\u6ce8\u5165|tag:\u6ce8\u5165\u68c0\u6d4b\u7248\u672c|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MSSQL\u6ce8\u5165 - \u68c0\u6d4bMSSQL\u7248\u672c|dest:home_net|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"and\";nocase;http_uri;pcre:\"/[ + ]+\\d[=<>][ |+]@@version/iUR\";content:\"CHR(\";nocase;http_uri;pcre:\"/chr\\(\\d{1,3}\\)/iU\";flow:to_server,established;gid:0;sid:2018010052;rev:1;)", "2008718": "alert tcp $HOME_NET any -> $HOME_NET 139 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";flow:established,to_server;content:\"|20 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"../../\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008718;classtype:attempted-admin;sid:2008718;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2019090283": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DNS\u8fde\u63a5|direction:in|level:action|service_name:Microsoft DNS|service_class:other|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft DNS|server:src\";flow:from_server,established;content:\"|07|version|04|bind\";within:27;pcre:\"/\\x07version\\x04bind\\0\\0\\x10\\0\\x03\\xc0\\x0c\\0\\x10\\0[\\x01\\x03].{7}Microsoft DNS (6\\.0\\.6001.+)/\";sid:2019090283;gid:0;)", "2017573": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JBoss/JMX InvokerServlet RCE Using Marshalled Object|tag:\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:JBOSS\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/invoker/JMXInvokerServlet/\";http_uri;nocase;fast_pattern:only;content:\"invocation.MarshalledInvocation\";nocase;reference:url,www.exploit-db.com/exploits/28713/;classtype:web-application-attack;sid:2017573;rev:3;metadata:created_at 2013_10_09, updated_at 2013_10_09;)", "2008696": "alert udp $HOME_NET any -> $HOME_NET 139 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";content:\"|20 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"..|5C|..|5C|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008696;classtype:attempted-admin;sid:2008696;rev:6;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2019090210": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 .*\\r\\n502 Error: command not implemented\\r\\n$/\";sid:2019090210;gid:0;)", "2018010081": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"=DBMS_PIPE.RECEIVE_MESSAGE(CHR(\";nocase;http_client_body;within:1000;pcre:\"/(chr\\(\\d{2,3})+/iPR\";flow:to_server,established;gid:0;sid:2018010081;rev:1;)", "2020050603": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:SaltStack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2020-11651,CVE-2020-11652)|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:SaltStack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2020-11651,CVE-2020-11652)\u3010\u6267\u884c\u547d\u4ee4\u3011|severity:3|attacker:src\";flow:to_server, established;flowbits:set, cve_2020_11651_rce_1;content:\"enc|a5|clear|a4|load\";pcre:\"/cmd.runner.fun.salt.cmd/R\";pcre:\"/fun.cmd.exec_code/R\";sid:2020050603;rev:2;)", "2020070809": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6587\u4ef6\u5305\u542b\u8bfb\u53d6|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u6587\u4ef6\u8bfb\u53d6\u5c1d\u8bd5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, file_read_general;content:\"apache\";http_client_body;fast_pattern;pcre:\"/access(\\.|_)log/P\";sid:2020070809;rev:1;)", "2018081321": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u6253\u5f00\u8fdc\u7a0b\u4e3b\u673a\u6444\u50cf\u5934\";dsize:8;flow:from_server,established;content:\"capsrv|0D 0A|\";depth:8;nocase;flowbits:isset,TB_ZxShell;sid:2018081321;rev:1;)", "2027097": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT Possible Linksys WRT100/110 RCE Attempt (CVE-2013-3568)|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/ping.cgi\";http_uri;depth:9;isdataat:!1,relative;content:\"pingstr=\";http_client_body;depth:8;fast_pattern;content:\"|3b|\";http_client_body;distance:0;within:25;metadata:former_category EXPLOIT;reference:cve,2013-3568;reference:url,www.exploit-db.com/exploits/28484;classtype:attempted-user;sid:2027097;rev:2;metadata:attack_target IoT, deployment Perimeter, signatrue_severity Major, created_at 2019_03_19, performance_impact Low, updated_at 2019_03_19;)", "2020070812": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6587\u4ef6\u5305\u542b\u8bfb\u53d6|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u6587\u4ef6\u8bfb\u53d6\u5c1d\u8bd5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, file_read_general;content:\"etc\";http_client_body;fast_pattern;pcre:\"/httpd((\\/)|%2f|%2F)logs((\\/)|%2f|%2F)access(_|\\.)log/P\";sid:2020070812;rev:1;)", "2020011407": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JBoss \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2017-12149\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JBOSS\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2017_12149;content:\"POST\";http_method;content:\"/invoker/readonly\";http_uri;within:40;http_content_type;content:\"application/\";pcre:\"/(x-www-form-urlencoded)|(x-java-serialized-object)/R\";pkt_data;content:\"| ac ed 00 05 |sr\";http_client_body;startswith;sid:2020011407;rev:1;)", "2020071303": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Citrix Netscaler/ADC \u8ba4\u8bc1\u7ed5\u8fc7(CVE-2020-7473)|tag:\u6743\u9650\u7ed5\u8fc7|dest:home_net|level:attack|severity:3|result:unknown|phase:exploit|o_msg:Citrix Netscaler/ADC \u8ba4\u8bc1\u7ed5\u8fc7(CVE-2020-7473)\u3010step_2\u3011|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2020_7473_step_2;content:\"/menu/ss\";depth:15;content:\"force_setup=\";http_uri;fast_pattern;content:\"username=\";http_uri;content:\"sid=\";http_uri;content:\"SESSID=\";http_cookie;pcre:\"/SESSID=[0-9a-zA-Z]{32}/C\";sid:2020071303;)", "2025803": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:\u626b\u63cf|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:recon|result:unknown|o_msg:\u626b\u63cf\u53ef\u80fd\u5b58\u5728\u7684\u9ed1\u5ba2\u540e\u95e8\";flow:established,to_server;content:\"maWxlX3B1dF9jb250ZW50c\";http_header;metadata:former_category EXPLOIT;classtype:attempted-user;flowbits:set,webshell.scan;sid:2025803;rev:2;metadata:affected_product Web_Server_Applications, affected_product PHP, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2018010113": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|attacker:src\";content:\"select(sleep(5))\";nocase;http_header;within:2000;flow:to_server,established;gid:0;sid:2018010113;rev:1;)", "2020010044": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6|tag:\u6587\u4ef6\u5305\u542b|level:attack|phase:exploit|severity:3|result:success|o_msg:\u5229\u7528\u6f0f\u6d1e\u5bfc\u81f4/etc/passwd|dest:home_net|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"root:x:0:0:root:/root:/bin/bash\";http_server_body;within:100;content:\"bin:x:1:1:bin:/bin:/sbin/nologin\";http_server_body;flow:from_server,established;gid:0;sid:2020010044;rev:1;)", "2018040009": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u68c0\u6d4bSSH\u6307\u7eb9|tag:\u626b\u63cf|tool:Nmap|type:\u6307\u7eb9\u63a2\u6d4b|direction:in|phase:recon|src:external_net|dest:home_net|level:attack|severity:1|result:unknown|o_msg:NMAP \u68c0\u6d4bSSH\u6307\u7eb9\";dsize:27;content:\"SSH\";nocase;offset:0;pcre:\"/-\\d\\.\\d-Nmap-SSH\\d-Hostkey/iR\";flow:to_server,established;sid:2018040009;rev:1;)", "2019090061": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Rsync\u8fde\u63a5|direction:in|level:action|service_name:Rsync|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728Rsync|server:src\";flow:from_server,established;content:\"@ERROR:\";depth:7;pcre:\"/^@ERROR: protocol startup error\\n/\";sid:2019090061;gid:0;)", "2826178": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike\u8fde\u63a5\u8bf7\u6c42(\u5229\u7528Amazon\u8d44\u6599\u9875)|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike \u5229\u7528Amazon\u8d44\u6599\u9875\u8fdb\u884c\u53cd\u5f39\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\"/s/ref=nb_sb_noss_1/167-3294888-0262949/field-keywords=books\";fast_pattern;http_uri;content:\"skin=noskin\";http_cookie;http_header_names;content:!\"Referer|0d 0a|\";metadata:former_category MALWARE;reference:md5,dc65cbf12622eb55f0fd382e0fe250c5;classtype:trojan-activity;sid:2826178;rev:3;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Critical, created_at 2017_04_28, performance_impact Moderate, updated_at 2020_03_05;)", "2020081401": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Shiro \u4f7f\u7528\u516c\u5f00\u79d8\u94a5|tag:\u5371\u9669\u914d\u7f6e|dest:home_net|level:attack|phase:exploit|result:success|o_msg:Apache Shiro \u4f7f\u7528\u516c\u5f00\u79d8\u94a5|severity:1|gray:true|decode_by:decode_shiro_1|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server, established;content:\"rememberMe=\";http_cookie;sid:2020081401;rev:2;)", "2018050001": "alert tcp $EXTERNAL_NET any -> $HOME_NET 3306 (msg:\"name:\u4f7f\u7528UDF\u63d0\u6743|tag:\u63d0\u6743|direction:in|src:external_net|dest:home_net|level:attack|severity:4|phase:control|o_msg:\u68c0\u6d4b\u5230\u4f7f\u7528Mysql UDF\u63d0\u6743\";content:\"create\";nocase;within:12;pcre:\"/\\s+function\\s+(sys_eval|cmdshell|cmd_shell|sys_exec)\\s+returns\\s+string\\s+soname\\s+['\"][\\w\\d]+\\.(so|dll)[\"']/iR\";gid:0;sid:2018050001;rev:1;)", "2019090075": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Serv-U\u8fde\u63a5|direction:in|level:action|service_name:Serv-U|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728Serv-U|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220-Serv-U FTP Server for Winsock\\r\\n/\";sid:2019090075;gid:0;)", "2020050801": "alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:\"name:\u5c1d\u8bd5FTP\u533f\u540d\u767b\u5f55|tag:\u533f\u540d\u767b\u5f55|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:\u5c1d\u8bd5FTP\u533f\u540d\u767b\u5f55|severity:1|attacker:src\";flow:to_server, established;flowbits:set, ftp_login_any;content:\"USER \";depth:10;content:\"anonymous\";distance:0;within:15;sid:2020050801;rev:2;)", "2019090096": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:bftp\u8fde\u63a5|direction:in|level:action|service_name:bftp|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728bftp|server:src\";flow:from_server,established;content:\"421\";depth:3;pcre:\"/^421-Could not open file /var/run/bftpdutmp\\r\\n/\";sid:2019090096;gid:0;)", "2020052503": "alert dns $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528awvsscan119.autoverify.cn\u8fdb\u884c\u53cd\u5f39|tag:dnslog|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u5229\u7528dnslog\u8fdb\u884c\u53cd\u5f39|attacker:dest\";flow:established, to_server;dns_query;content:\".awvsscan119.autoverify.cn\";pkt_data;sid:2020052503;rev:1;)", "2019000025": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u8fc7nc\u6267\u884c\u547d\u4ee4|tag:\u53cd\u5f39shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|attack_type:target|result:unknown|o_msg:\u901a\u8fc7nc\u6267\u884c\u547d\u4ee4\";flags:P,A;dsize:<11;flow:established;content:\"uname\";pcre:\"/^uname\\s+-a\\n$/\";flowbits:set,uname_send;sid:2019000025;)", "2024214": "alert smb $HOME_NET any -> $HOME_NET any (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u7591\u4f3c\u5b58\u5728ECLIPSEDWING\u6f0f\u6d1e\u63a2\u6d4b - MS08-067\";flow:to_server,established;content:\"|ff|SMB|2f 00 00 00 00|\";offset:4;depth:9;content:\"NTLMSSP|00 03 00 00 00 01 00 01 00|\";distance:0;fast_pattern;content:\"|00 00 00 00 49 00 00 00|\";distance:4;within:8;content:\"|00 00 00 00 48 00 00 00|\";within:8;content:\"|00 00 00 00 48 00 00 00|\";within:8;content:\"|00 00 00 00 48 00 00 00|\";within:8;content:\"|00 00 00 00 49 00 00 00|\";within:8;content:\"|00 00 00 00 00 00 00 00 00|\";distance:4;within:9;isdataat:!1,relative;metadata:former_category EXPLOIT;classtype:trojan-activity;sid:2024214;rev:1;metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_04_17;)", "2020051408": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Confluence \u672a\u6388\u6743 RCE (CVE-2019-3396)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:Confluence \u672a\u6388\u6743 RCE (CVE-2019-3396)|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2019_3396;content:\"POST\";http_method;content:\"/macro/preview\";http_uri;depth:60;http_content_type;content:\"application/json\";pkt_data;content:\"_template\";http_client_body;sid:2020051408;rev:2;)", "2020011306": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ThinkPHP 6.0 \u4efb\u610f\u6587\u4ef6\u521b\u5efa\u6f0f\u6d1e|tag:\u4efb\u610f\u6587\u4ef6\u521b\u5efa|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:success|o_msg:ThinkPHP 6.0 \u4efb\u610f\u6587\u4ef6\u521b\u5efa\u6f0f\u6d1e|attacker:src\";flow:established, from_server;flowbits:isset, thinkphp_upload;content:\"phpsession=\";nocase;content:\"..%2F\";http_cookie;distance:0;sid:2020011306;rev:1;)", "2020010207": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(Commons Beanutils)|tag:\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(Commons Beanutils)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"| ac ed 00 05 |sr\";http_client_body;distance:0;content:\"java.util.PriorityQueue\";http_client_body;distance:0;content:\"org.apache.commons.beanutils.BeanComparator\";http_client_body;distance:0;content:\"outputProperties\";http_client_body;distance:0;sid:2020010207;rev:1;)", "2019090247": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:OpenVPN\u8fde\u63a5|direction:in|level:action|service_name:OpenVPN|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728OpenVPN|server:src\";flow:from_server,established;content:\"|00 0e|@\";depth:3;pcre:\"/^\\0\\x0e@........\\0\\0\\0\\0\\0/\";sid:2019090247;gid:0;)", "2019010005": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5c1d\u8bd5KindEditor\u6f0f\u6d1e|tag:CMS\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728KindEditor\u4e0a\u4f20\u6f0f\u6d1e|attacker:src\";content:\"{\\\"error\\\":0,\\\"url\\\":\\\"\";nocase;http_server_body;within:40;flowbits:isset,kindedior;flow:from_server,established;gid:0;sid:2019010005;rev:1;)", "2020060815": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache FreeMarker\u6a21\u677fFusionAuth\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2020-7799\uff09|tag:\u6587\u4ef6\u64cd\u4f5c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Apache FreeMarker\u6a21\u677fFusionAuth\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2020-7799\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/ajax/email/template/preview\";http_uri;content:\"emailTemplate.defaultHtmlTemplate=\";http_client_body;content:\"${\";http_client_body;distance:0;within:10;content:\"freemarker.template.utility.Execute\";http_client_body;distance:0;sid:2020060815;rev:1;)", "2018041911": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6697\u591c\u7cbe\u7075\u540e\u95e8\u6728\u9a6c|type:rat|tag:NightElf|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6c\u6697\u591c\u7cbe\u7075\u5378\u8f7d\u81ea\u8eab\";dsize:1;content:\"|6c|\";flow:from_server;flowbits:isset,TB_NightElf;sid:2018041911;rev:1;)", "2019090117": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(imap)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"* OK \";depth:5;pcre:\"/^\\* OK \\[[^\\[]+\\] Dovecot ready\\.\\r\\n/\";sid:2019090117;gid:0;)", "2025807": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT php script base64 encoded Remote Code Execution 1|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"Lyo8P3BocC\";metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025807;rev:2;metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2806216": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:Linksys E1500/E2500\u7684\u6f0f\u6d1e\u5229\u7528|tag:webshell|src:home_net|dest:home_net|level:attack|phase:exploit|severity:2|gray:true|result:unknown|o_msg:Struts\u7684\u6f0f\u6d1e\u5229\u7528|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;content:\"/apply.cgi\";fast_pattern:only;http_uri;nocase;content:\"ping\";nocase;http_client_body;content:\"size\";distance:0;http_client_body;pcre:\"/ping(\\x25\\x35\\x66|\\x5f)size=(\\x25\\x32\\x36|\\x26)[a-z]/Pi\";reference:bugtraq,5776;reference:url,homesupport.cisco.com/de-eu/support/routers/E1500;reference:url,s3cur1ty.de/m1adv2013-004;classtype:attempted-recon;sid:2806216;rev:2;metadata:created_at 2013_04_05, updated_at 2013_04_05;)", "2020041015": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic XXE\u6f0f\u6d1e\uff08CVE-2019-2648\uff09|tag:xxe|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic XXE\uff08CVE-2019-2648\uff09|attacker:src\";flow:established, to_server;xbits:set, weblogic_xxe, track ip_dst, expire 20;content:\"|ac ed 00 05|\";content:\"weblogic.wsee.reliability.WsrmServerPayloadContext\";distance:0;content:\"<!DOCTYPE\";distance:0;content:\"SYSTEM \";distance:0;pcre:\"/(http|https):\\/\\//Ri\";sid:2020041015;rev:1;)", "2019090196": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([\\w_.-]+) VHCS2 [\\w._-]+ (\\w+) Managed ESMTP ([\\w._-]+)\\r\\n/\";sid:2019090196;gid:0;)", "2020051110": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:kindeditor 4.1.5 \u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:success|o_msg:kindeditor 4.1.5 \u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e|gray:true|attacker:src\";flow:from_server,established;flowbits:isset, kindeditor_list;content:\"current_dir_path\";http_server_body;content:\"filesize\";http_server_body;distance:0;content:\"filename\";http_server_body;distance:0;sid:2020051110;rev:1;)", "2020030004": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u8681\u5251\u8fde\u63a5webshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:unknown|o_msg:\u8681\u5251\u8fde\u63a5webshell|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"%40eval(chr(\";nocase;http_client_body;pcre:\"/chr\\(0x[\\da-f]{2}\\)\\.chr\\(0x[\\da-f]{2}\\)/RPi\";flowbits:set, first_packet_send;flowbits:noalert;sid:2020030004;)", "2020010902": "alert tcp $EXTERNAL_NET any -> $HOME_NET 27017 (msg:\"name:MongoDB\u6570\u636e\u5e93\u679a\u4e3e|tag:\u672a\u6388\u6743\u6f0f\u6d1e|direction:in|src:external_net|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:MongoDB\u6570\u636e\u5e93\u679a\u4e3e\";flow:to_server,established;flowbits:set, mongodb_link;content:\"|d4 07 00 00|\";offset:12;depth:4;fast_pattern;content:\"admin.$cmd|00|\";distance:0;content:\"buildinfo|00|\";distance:0;sid:2020010902;rev:1;)", "2008096": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (INSTALLER)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| INSTALLER|0d 0a|\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008096;classtype:trojan-activity;sid:2008096;rev:8;)", "2020082302": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5b9d\u5854Linux\u6743\u9650\u7ed5\u8fc7|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5b9d\u5854Linux\u6743\u9650\u7ed5\u8fc7|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, baota_auth_bypass;noalert;content:\"GET\";http_method;content:\"/pma/\";http_uri;depth:5;isdataat:!1, relative;content:!\"SESSIONID=\";http_cookie;sid:2020082302;rev:1;)", "180608002": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u767d\u91d1\u8fdc\u63a7|type:rat|tag:Baijin|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u6728\u9a6c\u540e\u95e8\u767d\u91d1\u8fdc\u63a7V4.x\u4e0a\u7ebf\u5305\";dsize:22;flow:from_server,established;content:\"|57 69 6e 64 73 16 00 00 00 01 00 00 00 78 9c 63 00 00 00 01 00 01|\";sid:180608002;rev:1;)", "2019010127": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u7206\u7834SSH|src:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u5b58\u5728SSH\u7206\u7834\u884c\u4e3a|attacker:dest\";flow:from_server,established;content:\"SSH\";depth:3;pcre:\"/^SSH-([\\d.]+)-OpenSSH[_-]([\\S ]+)/i\";threshold:type threshold, track by_src, count 10, seconds 1;sid:2019010127;gid:0;)", "2020081011": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u77ff\u6c60\u901a\u8baf\uff08\u54cd\u5e94-Stratum\u534f\u8bae\uff09|tag:\u6316\u77ff|direction:out|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u68c0\u6d4b\u5230\u77ff\u6c60\u901a\u8baf\uff08\u54cd\u5e94-Stratum\u534f\u8bae\uff09\";flow:established, from_server;content:\"{\\\"id\\\":\";depth:10;pcre:\"/^\\{\"id\"\\:(null|\\d{1,3}),\"method\"\\:\"[[:print:]]+?\",\"params\"\\:\\[[[:print:]]*\\]\\}$/\";sid:2020081011;rev:2;)", "2018010015": "alert http $EXTERNAL_NET any -> $HOME_NET 9200 (msg:\"name:elasticsearch\u6f0f\u6d1e\u5229\u7528|tag:elasticsearch\u6f0f\u6d1e|dest:home_net|level:attack|severity:2|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528cve2014_3120\u7684payload\u653b\u51fbelasticsearch\u670d\u52a1|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established,to_server;content:\"java.util\";content:\"java.io\";content:\"exec\";gid:3;sid:2018010015;rev:1;)", "2019070009": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:weblogic\u6f0f\u6d1e\u5229\u7528|tag:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|direction:out|dest:external_net|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:attack_out|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Weblogic wls9_async_response.war\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\";flow:to_server,established;content:\"/_async/AsyncResponseService\";http_uri;flowbits:set, weblogic_1;gid:3;sid:2019070009;rev:1;)", "2019090092": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:FileZilla\u8fde\u63a5|direction:in|level:action|service_name:FileZilla|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728FileZilla|server:src\";flow:from_server,established;content:\"550\";depth:3;pcre:\"/^550 No connections allowed from your IP\\r\\n/\";sid:2019090092;gid:0;)", "2019090254": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:OpenVPN\u8fde\u63a5|direction:in|level:action|service_name:OpenVPN|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728OpenVPN|server:src\";flow:from_server,established;content:\"@\";depth:1;pcre:\"/^@........\\x01\\0\\0\\0\\0d\\xc1x\\x01\\xb8\\x9b\\xcb\\x8f\\0\\0\\0\\0$/\";sid:2019090254;gid:0;)", "2018000015": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5b58\u5728webshell\u8bbf\u95ee|tag:\u626b\u63cf\u9ed1\u5ba2\u540e\u95e8|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:2|result:success|type:shell|o_msg:webshell\u8fde\u63a5\u5931\u8d25|failed_by:http_status_3XX,http_status_4XX\";http_content_type;content:\"text/html\";pkt_data;content:\"Warning</b>:\";within:300;http_server_body;content:\"Cannot call assert() with string argument \";http_server_body;content:\"eval()'d code on\";http_server_body;flow:from_server,established;sid:2018000015;rev:1;)", "2022345": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Bulta\u540e\u95e8\u6728\u9a6c|type:rat|tag:Bulta|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230Win32/Bulta\u5fc3\u8df3\u5305\";flow:established,to_server;content:\"|1f 93 97 d3 94 01 69 49 4d 7b a7 ac f6 7a|\";depth:14;reference:md5,8dd612b14a2a448e8b1b6f3d09909e45;classtype:trojan-activity;sid:2022345;rev:2;)", "2020050610": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:SaltStack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2020-11651,CVE-2020-11652)|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|src:home_net|level:attack|phase:exploit|result:success|o_msg:SaltStack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2020-11651,CVE-2020-11652)\u3010\u4e0a\u4f20\u6587\u4ef6\u3011|severity:2|attacker:dest\";flow:to_client, established;flowbits:isset, cve_2020_11651_upload_file;content:\"salt/wheel\";pcre:\"/fun.wheel.file_roots.write/R\";sid:2020050610;rev:2;)", "2019090082": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:FileZilla\u8fde\u63a5|direction:in|level:action|service_name:FileZilla|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728FileZilla|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 ([-\\w_.]+) running FileZilla Server version (\\d[-.\\w ]+)\\r\\n/\";sid:2019090082;gid:0;)", "2020010909": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:XML\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165|tag:XML\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:XML\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"<svg \";http_client_body;http_content_type;content:!\"boundary=\";pkt_data;content:\"xlink:href=\\\"\";http_client_body;distance:0;pcre:\"/^(file|http|https|php|expect):\\/\\//PRi\";sid:2020010909;rev:1;)", "2020071302": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Citrix Netscaler/ADC \u8ba4\u8bc1\u7ed5\u8fc7(CVE-2020-7473)|tag:\u6743\u9650\u7ed5\u8fc7|dest:home_net|level:attack|severity:3|result:success|phase:exploit|o_msg:Citrix Netscaler/ADC \u8ba4\u8bc1\u7ed5\u8fc7(CVE-2020-7473)\u3010step_1\u3011|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2020_7473_step_1;content:\"406\";http_stat_code;content:\"SESSID=\";http_cookie;pcre:\"/SESSID=[0-9a-zA-Z]{32}/C\";http_content_type;content:\"application/xml\";pkt_data;content:\"MISMATCH_OBJECTNAME_ERROR\";http_server_body;sid:2020071302;)", "2018072503": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7aef\u53e3\u626b\u63cf|tag:\u626b\u63cf|tool:Nmap|type:\u6307\u7eb9\u63a2\u6d4b|direction:in|phase:recon|src:external_net|dest:home_net|level:attack|severity:1|result:unknown|o_msg:NMAP NULL\u626b\u63cf\u4e8b\u4ef6\";flags:0;threshold:type both, track by_src, count 500, seconds 10;sid:2018072503;rev:1;)", "2020061810": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528goby\u626b\u63cf\u5668\u626b\u63cf|tag:\u626b\u63cf\u5668|dest:home_net|level:attack|phase:recon|severity:3|result:unknown|tool:goby|o_msg:\u4f7f\u7528goby\u626b\u63cf\u5668\u8fdb\u884c\u626b\u63cf\uff0c\u5904\u4e8e\u6f0f\u6d1e\u626b\u63cf\u9636\u6bb5|attacker:src\";flow:established, to_server;content:\"GIOP\";depth:4;content:\"goby://127.0.0.1:12345/Exploit\";distance:0;sid:2020061810;rev:1;)", "2020081704": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4e0a\u4f20\u51b0\u874eWebshell|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:\u4e0a\u4f20\u51b0\u874eWebshell|failed_by:http_status_3XX,http_status_4XX|success_by:resp_body_upload_success_str|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"boundary=\";pkt_data;content:\"import=\";http_client_body;content:\"javax.crypto.\";http_client_body;distance:0;content:\"Cipher.getInstance(\";http_client_body;distance:0;content:\"sun.misc.BASE64Decoder(\";http_client_body;distance:0;sid:2020081704;rev:1;)", "2020051303": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7591\u4f3c\u9488\u5bf9\u6df1\u4fe1\u670dVPN\u7684\u653b\u51fb\u884c\u4e3a|tag:\u6df1\u4fe1\u670dVPN|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:unknown|o_msg:\u7591\u4f3c\u9488\u5bf9\u6df1\u4fe1\u670dVPN\u7684\u653b\u51fb\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;content:\"/por/login_psw.csp\";http_uri;depth:20;content:\"svpn_name=\";http_client_body;content:\"svpn_password=\";http_client_body;threshold:type threshold, track by_src, count 10, seconds 6;sid:2020051303;gid:0;rev:1;)", "2020052106": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:SSRF \u6f0f\u6d1e\u5229\u7528|tag:SSRF|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:unknown|o_msg:SSRF \u6f0f\u6d1e\u5229\u7528\uff0c\u4f7f\u7528gopher\u534f\u8bae\u6784\u9020\u8bf7\u6c42\u5305|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;content:\"=\";http_client_body;content:\"gopher%3A//\";http_client_body;distance:0;pcre:\"/(GET|POST) /PR\";content:\"HTTP/\";http_client_body;offset:4;sid:2020052106;rev:1;)", "2018081318": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u8fdb\u884c\u6587\u4ef6\u4e0b\u8f7d\";dsize:5<>50;flow:from_server,established;content:\"RETR \";depth:5;nocase;content:\"|0d 0a|\";flowbits:isset,TB_ZxShell_4;sid:2018081318;rev:1;)", "2017873": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u77ff\u6c60\u5730\u5740|type:mining|tag:BitCoinMiner|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230W32/BitCoinMiner.MultiThreat\u6316\u77ff\u534f\u8bae\u7279\u5f81\uff08\u670d\u52a1\u7aef\u56de\u5305\uff09\";flow:established,from_server;content:\"|22|params|22 3A| [|22|\";depth:120;content:\"|22|method|22 3A| |22|mining.notify|22|\";distance:0;reference:url,research.zscaler.com/2013/12/bitcoin-mining-operation-seen-across.html;reference:url,www.btcguild.com/new_protocol.php;reference:url,mining.bitcoin.cz/stratum-mining;classtype:trojan-activity;sid:2017873;rev:3;)", "2018020003": "alert tcp $HOME_NET 6379 -> $EXTERNAL_NET any (msg:\"name:redis\u767b\u5f55\u6210\u529f|tag:\u767b\u5f55|direction:in|src:home_net|dest:external_net|level:action|result:success|o_msg:Redis\u670d\u52a1\u767b\u5f55\u6210\u529f\";flow:from_server,established;content:\"+OK\";dsize:<10;gid:3;sid:2018020003;rev:1;)", "2018010083": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:SSRF\u6f0f\u6d1e\u5c1d\u8bd5|tag:SSRF\u653b\u51fb|dest:home_net|level:attack|severity:3|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528SSRF\u5c1d\u8bd5\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"GET\";http_method;content:\"dict://\";nocase;http_uri;within:1000;pcre:\"/(^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$)/iUR\";gid:0;sid:2018010083;rev:1;)", "2020081719": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528Nessus\u626b\u63cf|tag:\u626b\u63cf\u5668|dest:home_net|level:attack|phase:recon|severity:2|result:unknown|o_msg:\u4f7f\u7528Nessus\u8fdb\u884c\u626b\u63cf|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"Nessus\";http_user_agent;depth:20;sid:2020081719;rev:1;)", "2018010016": "alert http $HOME_NET 9200 -> $EXTERNAL_NET any (msg:\"name:elasticsearch\u6f0f\u6d1e\u5229\u7528|tag:elasticsearch\u6f0f\u6d1e|dest:home_net|level:attack|severity:3|phase:exploit|result:success|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528metasploit\u6210\u529f\u653b\u51fbelasticsearch\u670d\u52a1\u5e76\u6267\u884c\u4ee3\u7801|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established,from_server;content:\"successful\";content:\"msf_result\";gid:3;sid:2018010016;rev:1;)", "2018062801": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:\u83dc\u5200\u8fde\u63a5\u8bf7\u6c42|tag:\u83dc\u5200|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u83dc\u5200\u8fde\u63a5php webshell\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;pcre:\"/=.{0,3}eval.{0,4}\\(.?base64_decode.{0,2}\\(.{0,10}action.{0,10}\\).{0,2}\\).{0,5}action.?=/iP\";classtype:trojan-activity;sid:2018062801;rev:1;)", "2019090184": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([-.\\w]+) ESMTP Postfix \\(([-.\\w]+)\\) \\(([-.\\w ]+)\\)/\";sid:2019090184;gid:0;)", "2020081403": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08http\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884cdir\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"   <DIR>          \";http_server_body;fast_pattern;pcre:\"/\\d{4}\\/[01]+\\d\\/[0-3]\\d {2}[0-2]\\d\\:[0-6]\\d {4}<DIR> {10}\\.\\x0d\\x0a\\d{4}\\/[01]+\\d\\/[0-3]\\d {2}[0-2]\\d\\:[0-6]\\d {4}<DIR> {10}\\.{2}\\x0d\\x0a/Q\";sid:2020081403;)", "2019090119": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(imap)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"* OK \";depth:5;pcre:\"/^\\* OK Welcome to [^.]+\\. Dovecot ready\\.\\r\\n/\";sid:2019090119;gid:0;)", "2018020058": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528OPTIONS\u8bf7\u6c42|direction:in|src:external_net|dest:home_net|level:action|o_msg:HTTP\u7684OPTIONS\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"OPTIONS\";nocase;http_method;gid:0;sid:2018020058;rev:1;)", "2019090264": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"E|00 00 00|\";depth:4;pcre:\"/^E\\0\\0\\0.S[^\\0]+\\0C0A000\\0Mnicht unterst\\xc3\\xbctztes Frontend-Protokoll 65363\\.19778: Server unterst\\xc3\\xbctzt 1\\.0 bis 3\\.0\\0Fpostmaster\\.c\\0L\\d+\\0/\";sid:2019090264;gid:0;)", "2020010004": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u8fc7bash\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4|tag:\u53cd\u5f39shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|attack_type:target|result:unknown|o_msg:whoami\";flags:P,A;dsize:7;flow:established,to_client;content:\"whoami|0a|\";offset:0;depth:7;flowbits:isset,linux_bash_reverse_shell;flowbits:set,bash_whoami;flowbits:noalert;sid:2020010004;)", "2008694": "alert udp $HOME_NET any -> $HOME_NET 139 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";content:\"|1F 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"|00 2E 00 2E 00 5C 00 2E 00 2E 00 5C|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008694;classtype:attempted-admin;sid:2008694;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2020062902": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u670d\u52a1\u5668\u88ab\u4e0a\u4f20 reDuh \u4ee3\u7406\u6587\u4ef6|tag:\u653b\u51fb\u4ee3\u7406|tool:reDuh|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:4|result:unknown|o_msg:\u670d\u52a1\u5668\u88ab\u4e0a\u4f20 reDuh \u4ee3\u7406\u6587\u4ef6|attacker:dest|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_len;content:\"27\";pkt_data;content:\"Unknown request to ReDuh!\";depth:27;http_server_body;sid:2020062902;rev:1;)", "2008211": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (WinProxy)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| WinProxy|0d 0a|\";nocase;http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008211;classtype:trojan-activity;sid:2008211;rev:8;)", "2020032407": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7phpmyadmin\u67e5\u8be2\u6162\u67e5\u8be2\u65e5\u5fd7\u72b6\u6001|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5c1d\u8bd5\u901a\u8fc7phpmyadmin\u67e5\u8be2\u6162\u67e5\u8be2\u65e5\u5fd7\u72b6\u6001|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, phpmyadmin_exec_sql_success;content:\"POST\";http_method;content:\"/import.php\";http_uri;content:\"sql_query=\";http_client_body;content:\"show+variables+like+\";http_client_body;distance:0;nocase;content:\"%25slow%25\";http_client_body;distance:0;within:15;nocase;sid:2020032407;rev:1;)", "2020062213": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:success|o_msg:\u653b\u51fb\u8005\u5c1d\u8bd5\u901a\u8fc7webshell\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, mem_webshell_interaction;content:\"200\";http_stat_code;http_content_len;byte_test:0,<=,80,0,string,dec;pkt_data;sid:2020062213;rev:1;)", "2018060008": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:b374k Webshell\u8fde\u63a5\u6210\u529f|tag:Webshell\u8fde\u63a5|direction:in|src:external_net|dest:home_net|level:attack|severity:4|phase:control|type:shell|result:unknown|o_msg:b374k Webshell\u8fde\u63a5\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";content:\"GET\";nocase;http_method;content:\".php\";nocase;http_uri;within:1500;pcre:\"/(\\.php)$/iU\";content:\"pass=\";http_cookie;offset:0;pcre:\"/pass=([0-9a-f]{40})$/C\";flow:to_server,established;flowbits:noalert;flowbits:set,b374k_shell;gid:0;sid:2018060008;rev:1;)", "2011398": "alert tcp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:\"name:Yoyo-DDoS|type:botnet|tag:Yoyo-DDoS|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u50f5\u5c38\u7f51\u7edcYoyo-DDoS\u5bb6\u65cf\u6267\u884cDDoS\u547d\u4ee4\";flow:established,from_server;dsize:124;content:\"|00 10 00 00|http|3a|//\";depth:11;reference:url,asert.arbornetworks.com/2010/08/yoyoddos-a-new-family-of-ddos-bots/;classtype:trojan-activity;sid:2011398;rev:3;)", "2025817": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT php script double base64 encoded Remote Code Execution 8|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"ZLancvY0dod0\";metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025817;rev:2;metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2020022701": "alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:\"name:Proftpd mod_copy\u6a21\u5757\u547d\u4ee4\u672a\u6388\u6743\u8c03\u7528\uff08CVE-2015-3306\uff09|tag:\u672a\u6388\u6743\u8c03\u7528|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Proftpd mod_copy\u6a21\u5757\u547d\u4ee4\u672a\u6388\u6743\u8c03\u7528\uff08CVE-2015-3306\uff09|attacker:src\";flow:established, to_server;flowbits:set, cve_2015_3306_cpfr;content:\"site cpfr \";pcre:\"/\\/(proc|etc|tmp)/R\";sid:2020022701;rev:1;)", "2019090298": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Wins\u8fde\u63a5|direction:in|level:action|service_name:WINS|service_class:other|severity:1|result:unknown|o_msg:\u5b58\u5728Wins|server:src\";flow:from_server,established;content:\"EInvalid packet length\";depth:22;pcre:\"/^\\0\\0\\0\\x1e\\xffS\\xad\\x80\\0\\0\\0\\x01\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0...\\0\\0\\x01\\0\\0\\x81\\0\\x02/\";sid:2019090298;gid:0;)", "2019090108": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:vsFTPd\u8fde\u63a5|direction:in|level:action|service_name:vsFTPd|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728vsFTPd|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 Welcome to [\\w._-]+ FTP service\\.\\r\\n$/\";sid:2019090108;gid:0;)", "2020041022": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2016-3510)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2016-3510)|attacker:dest\";flow:established, to_client;flowbits:isset, cve_2016_3510;content:\"|ac ed 00 05|\";content:\"org.apache.commons.collections.functors.InvokerTransformer\";distance:0;sid:2020041022;rev:1;)", "2018030032": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528appscan\u626b\u63cf|tag:\u626b\u63cf\u5de5\u5177|tool:AppScan|phase:recon|dest:home_net|level:attack|severity:2|result:unknown|o_msg:\u4f7f\u7528appscan\u626b\u63cf|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"/appscan_fingerprint/\";nocase;http_uri;within:1000;flow:to_server,established;sid:2018030032;rev:1;)", "2012304": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"name:NightDragon\u540e\u95e8\u6728\u9a6c|type:rat|tag:NightDragon|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230Night Dragon\u7684C&C\u7684\u5fc3\u8df3\u901a\u8baf\u8fdb\u7ad9\u6d41\u91cf\";flow:established,from_server;dsize:16;content:\"|01 50 00 00 00 00 00 00 00 00 00 01 68 57 24 13|\";threshold:type limit, count 1, seconds 60, track by_src;reference:url,www.mcafee.com/us/resources/white-papers/wp-global-energy-cyberattacks-Night-dragon.pdf;classtype:trojan-activity;sid:2012304;rev:6;)", "2020072008": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u6f0f\u6d1e\u653b\u51fb\uff08\u673a\u5668\u5b66\u4e60\uff09|tag:exploit|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u8bf7\u6c42\u4f53\u5305\u542b dnslog|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\".net\";http_client_body;fast_pattern;pcre:\"/(burpcollaborator\\.net)|(h\\.i\\.ydscan\\.net)/Pi\";sid:2020072008;rev:1;)", "2020041021": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2016-3510)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2016-3510)|attacker:src\";flow:established, to_server;flowbits:set, cve_2016_3510;content:\"|ac ed 00 05|\";content:\"weblogic.corba.utils.MarshalledObject\";distance:0;content:\"org.apache.commons.collections.functors.InvokerTransformer\";distance:0;sid:2020041021;rev:1;)", "2019010087": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:SQL\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|success_by:sql_inject_success|o_msg:\u5c1d\u8bd5\u5229\u7528MySQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"union select 1,\";nocase;http_uri;flow:to_server,established;gid:0;sid:2019010087;rev:1;)", "2020081001": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:nishang \u8bf1\u5bfc\u7528\u6237\u8f93\u5165\u51ed\u8bc1|tag:webshell|type:shell|tool:nishang|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:nishang \u8bf1\u5bfc\u7528\u6237\u8f93\u5165\u51ed\u8bc1(Invoke-CredentialsPhish)|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"Username: \";http_server_body;content:\"Password: \";http_server_body;distance:0;content:\"Domain:\";http_server_body;distance:0;content:\"Domain:\";http_server_body;distance:0;sid:2020081001;)", "2020010034": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528\u6f0f\u6d1e\u6267\u884c\u547d\u4ee4|tag:\u6267\u884c\u547d\u4ee4|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u68c0\u6d4b\u5230\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"|0a d5 fd d4 da 20 |Ping|20|\";http_server_body;content:\"|20 be df d3 d0 20|\";distance:6;http_server_body;content:\"|20 d7 d6 bd da b5 c4 ca fd be dd 3a|\";distance:2;http_server_body;content:\"|c0 b4 d7 d4 20|\";distance:1;http_server_body;content:\"|20 b5 c4 bb d8 b8 b4 3a 20 d7 d6 bd da 3d|\";distance:6;http_server_body;content:\"|20 ca b1 bc e4 3c|\";distance:1;http_server_body;content:\"ms TTL=\";distance:2;http_server_body;flowbits:isset,cmd_reponse_echo;sid:2020010034;rev:1;)", "2026928": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"YXJ0LVByb2N\";distance:0;fast_pattern;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026928;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2026943": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"52b2tlLUNvbW1hbm\";distance:0;fast_pattern;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026943;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2020060907": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Zookeeper\u4fe1\u606f\u6cc4\u9732|tag:\u4fe1\u606f\u6cc4\u9732|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Zookeeper\u4fe1\u606f\u6cc4\u9732\uff0c\u6cc4\u9732\u7cfb\u7edf\u5927\u91cf\u7684\u654f\u611f\u4fe1\u606f|attacker:dest\";flow:established, from_server;content:\"Environment:\";fast_pattern;content:\"|0a|zookeeper.version=\";distance:0;content:\"|0a|java.version=\";distance:0;content:\"|0a|java.vendor=\";distance:0;content:\"|0a|java.home=\";distance:0;content:\"|0a|java.class.path=\";distance:0;sid:2020060907;rev:1;)", "2018080192": "alert tcp $HOME_NET any -> $HOME_NET any (msg:\"name:\u7206\u7834FTP|tag:ftp|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:1|gray:|result:unknown|o_msg:\u5411ftp\u53d1\u9001\u7528\u6237\u540d\";dsize:5<>40;flow:to_server,established;content:\"USER \";depth:5;nocase;flowbits:isset,TB_FTPBrute0;flowbits:set,TB_FTPBrute1;threshold:type limit, track by_src, count 10, seconds 1;flowbits:noalert;sid:2018080192;rev:1;)", "2018072501": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7aef\u53e3\u626b\u63cf|tag:\u626b\u63cf|tool:Nmap|type:\u6307\u7eb9\u63a2\u6d4b|direction:in|phase:recon|src:external_net|dest:home_net|level:attack|severity:1|result:unknown|o_msg:NMAP XMAS\u626b\u63cf\u4e8b\u4ef6\";flags:FPU;threshold:type both, track by_src, count 800, seconds 10;sid:2018072501;rev:1;)", "2019010078": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:php create_function\u6f0f\u6d1e\u5229\u7528|tag:webshell php|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:success|o_msg:\u901a\u8fc7create_function\u95f4\u63a5\u8c03\u7528eval\u89e6\u53d1rce|attacker:src\";flow:from_server,established;flowbits:isset,php_create_function;content:\"X-Powered-By: PHP/\";nocase;http_header;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";file_data;content:!\"<!DOCTYPE html\";nocase;content:!\"</html>\";nocase;content:!\"</head>\";nocase;content:!\"</div>\";nocase;content:!\"</body>\";nocase;content:!\"<meta \";nocase;sid:2019010078;)", "2020051914": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring SpEL\u8868\u8fbe\u5f0f\u4ee3\u7801\u6ce8\u5165|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Spring SpEL\u8868\u8fbe\u5f0f\u4ee3\u7801\u6ce8\u5165\uff0c\u7528\u4e8e\u6709\u4f1a\u663e\u7684\u60c5\u51b5\u4e0b\uff0c\u9a8c\u8bc1\u6f0f\u6d1e\u5b58\u5728|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"${new\";http_client_body;content:\"java.lang.String(new\";http_client_body;distance:1;content:\"byte[]{\";http_client_body;distance:1;sid:2020051914;rev:1;)", "2019010150": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6d4b\u8bd5SQL\u6ce8\u5165\u6f0f\u6d1e|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"and length(\";nocase;http_client_body;pcre:\"/\\w+\\)\\s?=\\s?'\\d+/iPR\";flow:to_server,established;gid:0;sid:2019010150;rev:1;)", "2019090063": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MongoDB\u8fde\u63a5|direction:in|level:action|service_name:MongoDB|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728MongoDB|server:src\";flow:from_server,established;content:\"|cb 00 00 00|\";depth:4;pcre:\"/^\\xcb\\0\\0\\0....:0\\0\\0\\x01\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x01\\0\\0\\0\\xa7\\0\\0\\0\\x01uptime\\0\\0\\0\\0\\0\\0 `@\\x03globalLock\\09\\0\\0\\0\\x01totalTime\\0\\0\\0\\0\\x7c\\xf0\\x9a\\x9eA\\x01lockTime\\0\\0\\0\\0\\0\\0\\xac\\x9e@\\x01ratio\\0!\\xc6\\$G\\xeb\\x08\\xf0>\\0\\x03mem\\0<\\0\\0\\0\\x10resident\\0\\x03\\0\\0\\0\\x10virtual\\0\\xa2\\0\\0\\0\\x08supported\\0\\x01\\x12mapped\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x01ok\\0\\0\\0\\0\\0\\0\\0\\xf0\\?\\0$/\";sid:2019090063;gid:0;)", "2020010024": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6570\u636e\u5e93\u6587\u4ef6\u6cc4\u9732|tag:\u6587\u4ef6\u5305\u542b|level:attack|phase:exploit|severity:3|result:success|o_msg:\u6cc4\u9732\u6570\u636e\u6587\u4ef6|dest:home_net|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"#oracle database settings\";http_server_body;content:\"jdbc.type=oracle\";http_server_body;content:\"jdbc.driver=oracle.jdbc.driver.OracleDriver\";http_server_body;content:\"jdbc.url=jdbc:oracle:\";http_server_body;content:\"jdbc.username=\";http_server_body;content:\"jdbc.password=\";http_server_body;flow:from_server,established;flowbits:isset, is_etc_pass_vuln;gid:0;sid:2020010024;rev:1;)", "2019070011": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:weblogic\u8865\u4e01\u7ed5\u8fc7\u6f0f\u6d1e|tag:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|direction:out|src:home_net|dest:external_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:attack_out|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Weblogic  \u62a4\u7f51\u671f\u95f4\u4f7f\u7528\u76840day\u8865\u4e01\u7ed5\u8fc7\u6f0f\u6d1e\";flow:to_server,established;content:\"POST\";http_method;content:\"wls-wsat/CoordinatorPortType\";http_uri;content:\"\\;/\";http_uri;pcre:\"/(\\.\\.\\/\\w)$/RU\";content:\"oracle.toplink.internal.sessions.UnitOfWorkChangeSet\";content:\"<void index=\\\"\";gid:3;sid:2019070011;rev:1;)", "2018081328": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u6253\u5f00\u670d\u52a1\u7ba1\u7406\";dsize:4;flow:from_server,established;content:\"SC|0D 0A|\";nocase;flowbits:isset,TB_ZxShell;sid:2018081328;rev:1;)", "201903001": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:AWVS\u626b\u63cf|tag:\u626b\u63cf|tool:AWVS|phase:recon|dest:home_net|level:attack|severity:2|result:unknown|o_msg:\u4f7f\u7528AWVS\u8fdb\u884cweb\u6f0f\u6d1e\u626b\u63cf|attack_type:target|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"GET\";http_method;content:\"www.acunetix-referrer.com\";http_cookie;within:1000;sid:201903001;gid:0;rev:1;)", "2027028": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"lzIHByb2d\";distance:0;fast_pattern;metadata:former_category ATTACK_RESPONSE;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027028;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_03_05, malware_family DNSlivery, updated_at 2019_03_05;)", "2008495": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (antispyprogram)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| antispyprogram\";http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008495;classtype:trojan-activity;sid:2008495;rev:7;)", "2019010057": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:\u626b\u63cf|dest:home_net|level:attack|phase:exploit|severity:1|result:unknown|o_msg:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"=print(md5(\";nocase;http_client_body;within:80;flow:to_server,established;gid:0;sid:2019010057;)", "2018030004": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5fa1\u5251\u540e\u53f0\u626b\u63cf|tag:\u626b\u63cf|tool:\u5fa1\u5251|phase:exploit|dest:home_net|level:attack|severity:2|result:unknown|o_msg:\u4f7f\u7528\u5fa1\u5251\u8fdb\u884c\u654f\u611f\u76ee\u5f55\u626b\u63cf|attacker:src\";content:\"HEAD\";nocase;content:\"Host: \";nocase;http_raw_header;offset:0;pcre:\"/[\\d\\w._-]+(\\x0d\\x0a)$/iDR\";flow:to_server,established;threshold:type both, track by_src, count 300, seconds 1;sid:2018030004;rev:1;)", "2019000077": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Fastjson <=1.2.66 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Fastjson <=1.2.66 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, fastjson_jndi;content:\"@type\";http_client_body;fast_pattern;content:\"org.apache.hadoop.shaded.com.zaxxer.hikari.HikariConfig\";http_client_body;distance:0;pcre:\"/(metricRegistry|healthCheckRegistry)/Pi\";pcre:\"/(ldap|rmi):\\/\\//PRi\";sid:2019000077;rev:1;)", "2020051913": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring SpEL\u8868\u8fbe\u5f0f\u4ee3\u7801\u6ce8\u5165|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Spring SpEL\u8868\u8fbe\u5f0f\u4ee3\u7801\u6ce8\u5165\uff0c\u7528\u4e8e\u6709\u4f1a\u663e\u7684\u60c5\u51b5\u4e0b\uff0c\u9a8c\u8bc1\u6f0f\u6d1e\u5b58\u5728|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"${\";http_client_body;pcre:\"/\\$\\{\\d{1,5}[\\*\\+-\\/]\\d{1,5}\\}/P\";sid:2020051913;rev:1;)", "2019090137": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Winmail\u8fde\u63a5|direction:in|level:action|service_name:Winmail(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Winmail|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 [-\\w_.]+ Winmail Mail Server ESMTP ready\\r\\n/\";sid:2019090137;gid:0;)", "2019090133": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK Dovecot DA ready\\.\\r\\n/\";sid:2019090133;gid:0;)", "2019090261": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"E|00 00 00|\";depth:4;pcre:\"/^E\\0\\0\\0.S[^\\0]+\\0VFATAL\\0C0A000\\0M.*?65363\\.19778.*\\0Fpostmaster\\.c\\0L\\d{4}\\0RProcessStartupPacket\\0\\0$/\";sid:2019090261;gid:0;)", "2020072013": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u6f0f\u6d1e\u653b\u51fb\uff08\u673a\u5668\u5b66\u4e60\uff09|tag:exploit|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u8bf7\u6c42\u4f53\u5305\u542b dnslog|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\".net\";http_uri;fast_pattern;pcre:\"/(burpcollaborator\\.net)|(h\\.i\\.ydscan\\.net)/Ui\";sid:2020072013;rev:1;)", "2020030006": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u8681\u5251\u8fde\u63a5webshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:unknown|o_msg:\u8681\u5251\u8fde\u63a5webshell|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"QGluaV9\";http_client_body;content:\"%40eval(%40base64_decode\";nocase;http_client_body;flowbits:set, first_packet_send;flowbits:noalert;sid:2020030006;)", "2018010014": "alert http $EXTERNAL_NET any -> $HOME_NET 9200 (msg:\"name:elasticsearch\u6f0f\u6d1e\u5229\u7528|tag:elasticsearch\u6f0f\u6d1e|dest:home_net|level:attack|severity:2|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528cve2015_1427\u7684payload\u653b\u51fbelasticsearch\u670d\u52a1|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established,to_server;content:\"java.lang.Math.class.forName\";gid:3;sid:2018010014;rev:1;)", "2020060227": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(Groovy1-HTTP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"application/\";pcre:\"/(x-www-form-urlencoded)|(x-java-serialized-object)/R\";pkt_data;content:\"|ac ed 00 05|\";http_client_body;fast_pattern;content:\"sun.reflect.annotation.AnnotationInvocationHandler\";http_client_body;content:\"java.util.Mapxrjava.lang.reflect.Proxy\";http_client_body;content:\"org.codehaus.groovy.runtime.ConvertedClosure\";http_client_body;sid:2020060227;rev:1;)", "2020070307": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;flowbits:set, tp_5_23_rce;content:\"%5f%6d%65%74%68%6f%64%3d%5f%5f%63%6f%6e%73%74%72%75%63%74\";http_client_body;content:\"%66%69%6c%74%65%72%5b%5d%3d\";http_client_body;sid:2020070307;rev:1;)", "2019010129": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Apache Tomcat \u4efb\u610f\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e(CVE-2020-1938)|tag:\u6587\u4ef6\u5305\u542b|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u8be5\u68c0\u6d4b\u53ea\u80fd\u8bf4\u660eApache Tomcat \u4efb\u610f\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e(CVE-2020-1938)\u5b58\u5728\uff0c\u5e76\u4e14\u88ab\u9a8c\u8bc1\u6210\u529f|attacker:dest\";flow:established, from_server;flowbits:isset, cve_2020_1938_1;flowbits:unset, cve_2020_1938_1;content:\"|41 42|\";startswith;content:\"|03|\";distance:1;content:\"<?xml\";distance:0;within:30;sid:2019010129;rev:1;)", "2826019": "alert tls $EXTERNAL_NET 443 -> $HOME_NET any (msg:\"name:Empire \u8fde\u63a5\u68c0\u6d4b|tag:\u6728\u9a6c|direction:out|src:external_net|dest:home_net|level:attack|type:c2|phase:control|severity:3|result:success|o_msg:\u4f7f\u7528Empire \u8fde\u63a5\u68c0\u6d4b\";flow:established,from_server;content:\"|09 00 b0 ec d5 47 1e 45 8f ef|\";fast_pattern;content:\"|55 04 06|\";distance:0;content:\"|02|US\";distance:1;within:3;metadata:former_category TROJAN;reference:md5,9572b94b6a635a7b8347caf73fe1afd1;classtype:trojan-activity;sid:2826019;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Targeted, tag PowerShell, signature_severity Major, created_at 2017_04_18, malware_family PowerShell_Empire, performance_impact Low, updated_at 2017_04_18;)", "2019010000": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5ThinkPHP\u6f0f\u6d1e|tag:ThinkPHP\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728ThinkPHP\u6f0f\u6d1e|attacker:src\";content:\"GET\";nocase;http_method;content:\"/index.php\";nocase;http_uri;within:100;pcre:\"/(\\/)?\\?s=(\\/)?index\\/(\\\\)?think\\\\app\\/invokefunction&function=/iUR\";flow:to_server,established;gid:0;sid:2019010000;rev:1;)", "2020052501": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5947\u5b89\u4fe1\u6f0f\u6d1e\u626b\u63cf\u5668|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tool:\u5947\u5b89\u4fe1\u6f0f\u6d1e\u626b\u63cf\u5668|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5947\u5b89\u4fe1\u6f0f\u6d1e\u626b\u63cf\u5668|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"GET\";http_method;content:\"jiance.qianxin.com\";http_uri;fast_pattern;sid:2020052501;rev:1;)", "2018041806": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:DRAT2009\u540e\u95e8\u6728\u9a6c|type:rat|tag:DRAT2009|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cDrat2009\u5378\u8f7d\u81ea\u8eab\";dsize:5;flow:from_server,established;content:\"|30 35 36 0d 0a|\";flowbits:isset,TB_DRAT2009_A;flowbits:isset,TB_DRAT2009_B;sid:2018041806;rev:1;)", "2026942": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"dm9rZS1Db21tYW\";distance:0;fast_pattern;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026942;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2018020039": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6d4f\u89c8Web\u76ee\u5f55|tag:\u76ee\u5f55\u904d\u5386|direction:in|dest:home_net|src:external_net|level:attack|phase:exploit|severity:1|result:success|o_msg:\u68c0\u6d4b\u5230\u6d4f\u89c8\u76ee\u5f55\u7684\u884c\u4e3a\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u7279\u6027\u83b7\u53d6web\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|gray:true\";flow:from_server,established;content:\"<html><head><title>\";nocase;http_server_body;offset:0;pcre:\"/(^([a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,} - \\/([\\d\\w_-]+\\/)*)</title></head><body><H1>\\1</H1><hr>\\x0d\\x0a\\x0d\\x0a<pre><A HREF/iQR\";content:\"[To Parent Directory]</A><br><br>\";nocase;http_server_body;within:60;gid:0;sid:2018020039;)", "2008363": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (ISMYIE)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| ISMYIE|0d 0a|\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008363;classtype:trojan-activity;sid:2008363;rev:7;)", "2020072701": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Shiro \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:Apache Shiro \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|severity:4|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server, established;flowbits:set, shiro_exp_by_tools;content:\"rememberMe=\";http_cookie;fast_pattern;http_header_names;content:\"|0d 0a|Testecho|0d 0a|Testcmd|0d 0a|\";pkt_data;sid:2020072701;rev:1;)", "2020052008": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u653b\u51fb\u8005\u4f7f\u7528\u8681\u5251\u5c1d\u8bd5\u8fde\u63a5webshell|tag:\u8681\u5251|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:unknown|o_msg:\u653b\u51fb\u8005\u4f7f\u7528\u8681\u5251\u5c1d\u8bd5\u8fde\u63a5webshell|tool:\u8681\u5251|failed_by:http_status_3XX,http_status_4XX\";flow:established, to_server;http_content_type;content:\"antSword\";pkt_data;sid:2020052008;rev:1;)", "2019060009": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:success|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;content:\".php\";http_uri;content:\"PHPSESSID=\";http_cookie;pcre:\"/[a-fA-F0-9]{32}/CR\";http_content_len;byte_test:0,>,1000,0,string,dec;pkt_data;content:\"a\";nocase;http_client_body;pcre:\"/^([a-zA-Z0-9+/]+a[a-zA-Z0-9+=/]+)$/P\";flowbits:isset, bingxie_webshell_step2;sid:2019060009;gid:0;rev:1;)", "2019090072": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MySQL\u8fde\u63a5|direction:in|level:action|service_name:MySQL|service_class:database|phase:action|severity:1|result:unknown|o_msg:MySQL\u8fde\u63a5|server:src\";flow:from_server,established;content:\"|00 00 00 0a|\";offset:1;depth:4;pcre:\"/[4-9]\\.\\d{1,2}\\.\\d{1,2}/R\";content:\"|00 00 00 00 00 00 00 00 00 00|\";pcre:\"/[`~!@#$%^&*()_+=\\[\\]{}\\;':\",.\\/\\\\<|>?a-zA-Z0-9-]{12}\\x00/R\";isdataat:!1,relative;sid:2019090072;gid:0;)", "2018010121": "alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 (msg:\"name:3389\u6f0f\u6d1e\u653b\u51fb\u5c1d\u8bd5(CVE-2019-0708)|tag:RDP\u6f0f\u6d1e|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:CVE-2019-0708|attacker:src\";flow:to_server,established;content:\"|03 00|\";offset:0;depth:2;content:\"|02 f0|\";distance:2;within:2;content:\"|00 05 00 14 7c 00 01|\";within:512;content:\"|03 c0|\";distance:3;within:384;content:\"MS_T120|00|\";distance:6;within:372;threshold:type limit, track by_src, count 2, seconds 600;classtype:bad-unknown;reference:url,portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0708;sid:2018010121;rev:1;)", "2100687": "alert tcp $EXTERNAL_NET any -> $HOME_NET 1433 (msg:\"name:\u8fde\u63a5MSSQL\u5e76\u4e14\u6267\u884cxp_cmdshell\u547d\u4ee4|tag:MSSQL\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u8fde\u63a5MSSQL\u5e76\u4e14\u6267\u884cxp_cmdshell\u547d\u4ee4\uff0c\u8bf7\u68c0\u67e5\u662f\u5426\u4e3a\u5ba2\u6237\u81ea\u5df1\u884c\u4e3a|attacker:src\";flow:to_server,established;content:\"x|00|p|00|_|00|c|00|m|00|d|00|s|00|h|00|e|00|l|00|l|00|\";nocase;sid:2100687;)", "2019010055": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u6267\u884cphpinfo|tag:\u626b\u63cf|dest:home_net|level:attack|phase:exploit|severity:1|result:unknown|o_msg:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"=phpinfo()\";nocase;http_uri;flow:to_server,established;gid:0;sid:2019010055;)", "2020011406": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:JBoss \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08jboss_jmxinvokerservlet_rce\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:JBOSS\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, jboss_jmxinvokerservlet_rce;content:\"200\";http_stat_code;http_content_type;content:\"application/x-java-serialized-object\";content:\"class=org.jboss.invocation.MarshalledValue\";pkt_data;content:\"| ac ed 00 05 |sr\";http_server_body;startswith;sid:2020011406;rev:1;)", "2008706": "alert tcp $HOME_NET any -> $HOME_NET 139 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";flow:established,to_server;content:\"|0B|\";offset:2;depth:1;content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008706;classtype:attempted-admin;sid:2008706;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2020010036": "alert tcp $HOME_NET 6379 -> $EXTERNAL_NET any (msg:\"name:\u7206\u7834Redis|tag:Redis\u7206\u7834|tool:redis_exp|src:home_net|level:attack|phase:exploit|result:unknown|o_msg:Redis\u670d\u52a1\u6b63\u5728\u88ab\u7206\u7834|severity:1|attacker:dest\";flow:to_client,established;flowbits:isset, redis_blast;content:\"-ERR invalid password\";threshold:type threshold, track by_src, count 10, seconds 60;sid:2020010036;rev:1;)", "2008693": "alert udp $HOME_NET any -> $HOME_NET 139 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";content:\"|1F 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"|00 2E 00 2E 00 2F 00 2E 00 2E 00 2F|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008693;classtype:attempted-admin;sid:2008693;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2018060011": "alert TCP $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6267\u884cid\u547d\u4ee4|tag:\u6267\u884c\u547d\u4ee4|direction:in|dest:external_net|src:home_net|level:attack|severity:4|phase:control|type:shell|result:success|o_msg:linux id\u547d\u4ee4\u8fd4\u56de\u503c\";content:\"uid=0|28|root|29|\";offset:0;dsize:<50;sid:2018060011;rev:1;)", "2019090185": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 (.*) ([\\w._-]+) ESMTP Postfix \\(([\\w._-]+)\\)\\r\\n/\";sid:2019090185;gid:0;)", "2019060042": "alert udp $HOME_NET any -> any 53 (msg:\"name:\u5229\u7528cloudeye.cn\u8fdb\u884cdnslog\u53cd\u5f39|tag:dns\u53cd\u5f39|direction:out|level:attack|phase:control|severity:3|result:success|o_msg:\u68c0\u6d4bcloudeye.cn\u7684dns\u8bf7\u6c42\";content:\"|01 00|\";offset:2;content:\"|08|cloudeye|02|cn|00|\";nocase;sid:2019060042;)", "2020010008": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fc7bash\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4|tag:\u53cd\u5f39shell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:\u901a\u8fc7bash\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4\";flow:established,to_server;content:\"whoami|0a|\";content:\"nobody\";distance:0;flowbits:unset,bash_whoami;flowbits:isset,bash_whoami;sid:2020010008;)", "2020070606": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528webshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:success|o_msg:webshell\u4ea4\u4e92|attacker:dest|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"|2d 3e 7c|\";http_server_body;depth:20;fast_pattern;content:\"|7c 3c 2d|\";http_server_body;distance:0;http_content_type;content:\"text/html\";pkt_data;pcre:\"/->\\|(((.*\\n)+)|(.*)|(.*\\r\\n)+)\\|<-/Qs\";sid:2020070606;rev:1;)", "2020070605": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PHPCMS \u6ce8\u518c\u9875\u9762\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e|tag:sql\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:4|result:success|o_msg:PHPCMS \u6ce8\u518c\u9875\u9762\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, phpcms_9_6_upload;content:\"200\";http_stat_code;content:\"<b>MySQL Query : </b> \";http_server_body;depth:200;content:\".php&gt\\;\";http_server_body;distance:60;sid:2020070605;rev:1;)", "2020062908": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u670d\u52a1\u5668\u88ab\u4e0a\u4f20 reDuh \u4ee3\u7406\u6587\u4ef6|tag:\u653b\u51fb\u4ee3\u7406|tool:reDuh|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:4|result:unknown|o_msg:\u670d\u52a1\u5668\u88ab\u4e0a\u4f20 reDuh \u4ee3\u7406\u6587\u4ef6|attacker:dest|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"[ReDuh]ERROR:Undefined action parameter\";depth:100;http_server_body;sid:2020062908;rev:1;)", "2019000064": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Jenkins\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2015-8103\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Jenkins\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2015-8103\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/cli\";http_uri;content:\"Side: upload\";http_header;content:\"<===[JENKINS REMOTING CAPACITY]===>\";http_client_body;content:\"|ac ed 00 05|\";http_client_body;distance:0;pcre:\"/(bsh)|(com\\.google\\.inject)(com\\.mchange\\.v2\\.c3p0)|(com\\.sun\\.jndi)|(com\\.sun\\.corba)|(com\\.sun\\.javafx)|(com\\.sun\\.org\\.apache\\.regex\\.internal)|(java\\.awt)|(java\\.rmi)|(javax\\.management)|(javax\\.naming)|(javax\\.script)|(javax\\.swing)|(org\\.apache\\.commons\\.beanutils)|(org\\.apache\\.commons\\.collections\\.functors)|(org\\.apache\\.myfaces)|(org\\.apache\\.wicket)|(org\\.apache\\.xalan)|(oerg\\.codehaus\\.groovy\\.runtime)|(org\\.hibernate)|(org\\.python)|(sun\\.rmi)|(javax\\.imageio)|(java\\.util\\.ServiceLoader)|(java\\.net\\.URLClassLoader)/PR\";sid:2019000064;rev:1;)", "2019010084": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7591\u4f3c\u51b0\u874ewebshell|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u51b0\u874e\u7684\u8bf7\u6c42\u5305|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\".jsp\";http_uri;content:\"=\";http_cookie;pcre:\"/[a-fA-F0-9]{32}/CR\";http_content_len;byte_test:0,>=,7000,0,string,dec;pkt_data;http_accept;content:\"text/html, image/gif, image/jpeg, *\\; q=.2, */*\\; q=.2\";pkt_data;content:\"a\";nocase;http_client_body;pcre:\"/^([a-zA-Z0-9+/]+a[a-zA-Z0-9+=/]+)$/P\";sid:2019010084;gid:0;rev:1;)", "2020081006": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:nishang \u7a83\u53d6\u5c4f\u5e55|tag:\u4fe1\u606f\u6cc4\u9732|type:shell|tool:nishang|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:nishang \u7a83\u53d6\u5c4f\u5e55(Show-TargetScreen)\";flow:established;content:\"HTTP/1.1 200 OK|0d 0a|\";depth:20;content:\"Content-Type: multipart/x-mixed-replace\\; boundary=--boundary|0d 0a 0a 0a 0a|\";distance:0;within:70;content:\"--boundary|0a|\";distance:0;within:15;content:\"Content-Type: image/jpeg|0a|\";distance:0;within:30;content:\"Content-Length: \";distance:0;within:20;sid:2020081006;)", "2020081726": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528Netsparker\u626b\u63cf|tag:\u626b\u63cf\u5668|dest:home_net|level:attack|phase:recon|severity:2|result:unknown|o_msg:\u4f7f\u7528Netsparker\u8fdb\u884c\u626b\u63cf|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Accept: netsparker/check\";http_header;sid:2020081726;rev:1;)", "2019010073": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:weblogic\u6f0f\u6d1e\u5229\u7528|tag:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:CVE-2017-10271 Payload\u653b\u51fb\u7cfb\u7edf[1]|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"<void class=\\\"weblogic.utils.Hex\\\"\";http_client_body;content:\"method=\\\"fromHexString\\\"\";http_client_body;content:\"<string>0xcafebabe\";http_client_body;flowbits:set, cmd_reponse_echo;gid:0;sid:2019010073;rev:1;)", "2020052602": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:FreeMarker\u6a21\u677f\u6ce8\u5165|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|type:exploit|severity:3|result:unknown|o_msg:\u653b\u51fb\u8005\u5229\u7528FreeMarker\u6a21\u677f\u5f15\u64ce\uff0c\u5b9e\u73b0\u4ee3\u7801\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"<\";http_client_body;content:\"#\";http_client_body;distance:0;within:20;content:\"freemarker.template.utility.ObjectConstructor\";http_client_body;distance:0;content:\"java.lang.\";http_client_body;distance:0;pcre:\"/ProcessBuilder|Runtime/PRi\";sid:2020052602;rev:1;)", "2019090085": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:FileZilla\u8fde\u63a5|direction:in|level:action|service_name:FileZilla|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728FileZilla|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220.*\\r\\n220[- ]FileZilla Server version (\\d[-.\\w ]+)\\r\\n/\";sid:2019090085;gid:0;)", "2008657": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent(Compatible)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| Compatible|0d 0a|\";http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008657;classtype:trojan-activity;sid:2008657;rev:7;)", "2009540": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230PCFlashbang.com Spyware\u4e0a\u7ebf(PCFlashBangA)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| PCFlashBang\";http_header;reference:url,www.ca.com/us/securityadvisor/pest/pest.aspx?id=453113169;reference:url,doc.emergingthreats.net/2009540;classtype:trojan-activity;sid:2009540;rev:9;)", "2020051915": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, spring_actuator;content:\"/actuator\";http_uri;isdataat:!2, relative;sid:2020051915;rev:1;)", "2010960": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5229\u7528WhatWeb\u8fdb\u884cweb\u5e94\u7528\u6307\u7eb9\u626b\u63cf|tag:\u626b\u63cf|tool:WhatWeb|dest:home_net|level:attack|phase:recon|severity:1|result:unknown|o_msg:\u9ed1\u5ba2\u5de5\u5177Whatweb\u626b\u63cf\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established,to_server;content:\"|0d 0a|User-Agent|3A| WhatWeb/\";reference:url,www.morningstarsecurity.com/research/whatweb;reference:url,doc.emergingthreats.net/2010960;classtype:attempted-recon;sid:2010960;rev:4;metadata:created_at 2010_07_30, updated_at 2019_09_27;)", "2020072904": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Zabbix_2.x_4.x\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e|tag:\u672a\u6388\u6743\u8bbf\u95ee|phase:exploit|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Zabbix_2.x_4.x\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e|attacker:src\";flow:to_server,established;flowbits:set, Zabbix_2_x_4_x;noalert;content:\"zabbix.php\";http_uri;content:\"action=dashboard.view\";http_uri;distance:1;content:!\"JSESSIONID=\";http_cookie;content:!\"zbx_sessionid=\";http_cookie;gid:0;sid:2020072904;rev:1;)", "2020061015": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:phpmyadmin \u5c1d\u8bd5\u5728\u6570\u636e\u5e93\u4e2d\u63d2\u5165session\u6587\u4ef6|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:phpmyadmin \u5c1d\u8bd5\u5728\u6570\u636e\u5e93\u4e2d\u63d2\u5165session\u6587\u4ef6\uff0c\u540e\u7eed\u5305\u542b\u6587\u4ef6\u3001\u6267\u884c\u547d\u4ee4\u4f7f\u7528|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/lint.php\";http_uri;depth:40;content:\"phpMyAdmin=\";http_cookie;content:\"sql_query=\";http_client_body;content:\"insert\";http_client_body;nocase;distance:0;content:\"..%2F..%2Ftmp%2Fsess_\";http_client_body;distance:0;sid:2020061015;rev:1;)", "2019090003": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MySQL\u8fde\u63a5|direction:in|level:action|service_name:MySQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728MySQL|server:src\";flow:from_server,established;content:\"|00 00 00|\";offset:1;depth:3;pcre:\"/^.\\0\\0\\0\\x0a(6\\.[-_~.+\\w]+)\\0...\\0/\";sid:2019090003;gid:0;)", "2025879": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6587\u4ef6\u5305\u542b\u6cc4\u9732/etc/passwd|tag:\u6587\u4ef6\u5305\u542b|level:attack|phase:exploit|severity:3|result:success|o_msg:\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff0c\u5305\u542b/etc/passwd|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"root:x:0:0:root:/root:/bin/\";http_server_body;within:1000;flow:from_server,established;gid:0;sid:2025879;rev:1;)", "2019090094": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:bftp\u8fde\u63a5|direction:in|level:action|service_name:bftp|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728bftp|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^(220)\\s+bftpd ([\\d.]+) at ([-\\w_.]+) ready\\.?\\r\\n/\";sid:2019090094;gid:0;)", "2019090113": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(imap)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"* OK \";depth:5;pcre:\"/^\\* OK [Dd]ovecot ready\\.\\r\\n/\";sid:2019090113;gid:0;)", "2018081307": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u8fdb\u884c\u5efa\u7acb\u6587\u4ef6\u7ba1\u7406\u8fde\u63a5\";dsize:8;flow:from_server,established;content:\"FileMG|0D 0A|\";depth:8;nocase;flowbits:isset,TB_ZxShell;sid:2018081307;rev:1;)", "2020082301": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5b9d\u5854Linux\u6743\u9650\u7ed5\u8fc7|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5b9d\u5854Linux\u6743\u9650\u7ed5\u8fc7|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, baota_auth_bypass;noalert;content:\"GET\";http_method;content:\"/pma/\";http_uri;depth:5;isdataat:!1, relative;http_header_names;content:!\"Cookie\";nocase;pkt_data;sid:2020082301;rev:1;)", "2018112716": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:\u7206\u7834tomcat\u540e\u53f0\u53e3\u4ee4|tag:\u7206\u7834|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5bf9tomcat\u540e\u53f0\u7684\u5f31\u53e3\u4ee4\u7206\u7834\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX\";content:\"/manager/html\";nocase;http_uri;content:\"get\";nocase;http_method;content:\"authorization|3a 20|basic\";nocase;threshold:type threshold,track by_src,count 10,seconds 10;flow:to_server,established;sid:2018112716;)", "2018111005": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Lucky\u52d2\u7d22|type:trojan|tag:Lucky\u52d2\u7d22|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5bf9Lucky\u52d2\u7d22\u7684\u4e0b\u8f7d\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\"/d/ft32\";http_uri;fast_pattern;sid:2018111005;rev:1;)", "2019020000": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:FTP\u767b\u5f55\u6210\u529f|tag:ftp|direction:in|src:home_net|dest:external_net|level:action|severity:1|result:success|o_msg:FTP\u767b\u5f55\u6210\u529f\";flow:established,to_client;content:\"230\";offset:0;depth:3;flowbits:isset,send_user;flowbits:isset,send_pwd;flowbits:unset,send_user;flowbits:unset,send_pwd;gid:3;sid:2019020000;)", "2020050903": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|dest:home_net|level:attack|phase:exploit|type:shell|severity:3|result:success|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:isset, bingxie_webshell_step2;content:\"POST\";http_method;content:\".php\";http_uri;isdataat:!1,relative;content:\"PHPSESSID=\";http_cookie;content:\"Pragma: no-cache\";http_header;content:\"Connection: keep-alive\";http_header;http_content_len;byte_test:0,>,1000,0,string,dec;pkt_data;pcre:\"/^([a-zA-Z0-9+/]+a[a-zA-Z0-9+=/]+)$/P\";sid:2020050903;gid:0;rev:1;)", "2019010032": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u5229\u7528fastjson\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:JAVA\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u901a\u8fc7http POST\u89e6\u53d1fastjson\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(TemplatesImpl\u5229\u7528\u94fe)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"{\";http_client_body;pcre:\"/{\\s*\\\"@type\\\"\\s*:\\s*\\\"L*com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl\\;*\\\"[^}]*}/Pi\";distance:-1;content:\"_bytecodes\";http_client_body;gid:3;sid:2019010032;)", "2019020007": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:tomcat\u767b\u5f55\u6210\u529f|tag:tomcat|direction:in|src:external_net|dest:home_net|level:action|phase:control|severity:1|result:success|o_msg:tomcat\u767b\u5f55\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"401\";http_stat_code;flowbits:set, http_ba;flowbits:noalert;gid:3;sid:2019020007;)", "2008494": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (ieagent)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| ieagent\";http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008494;classtype:trojan-activity;sid:2008494;rev:7;)", "2020021014": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Monolog\u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u547d\u4ee4\u6267\u884c)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Monolog\u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Monolog\";content:\"SyslogUdpHandler\";distance:1;content:\"BufferHandler\";distance:1;content:\"*bufferSize\";distance:1;content:\"*processors\";distance:1;sid:2020021014;rev:1;)", "2008658": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent(GetUrlSize)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| GetUrlSize|0d 0a|\";http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008658;classtype:trojan-activity;sid:2008658;rev:7;)", "2020062211": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u653b\u51fb\u8005\u5c1d\u8bd5\u901a\u8fc7webshell\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, mem_webshell_interaction;content:\"POST\";http_method;content:\"pass_the_world=\";http_client_body;content:\"model=\";http_client_body;pcre:\"/^(exec|connectback|urldownload|list|download|upload|proxy|chopper)/PR\";sid:2020062211;rev:1;)", "2020010007": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u8fc7bash\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4|tag:\u53cd\u5f39shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|attack_type:target|result:unknown|o_msg:ifconfig\";flow:established,to_client;dsize:9;flags:P,A;content:\"ifconfig|0a|\";offset:0;depth:9;flowbits:isset,linux_bash_reverse_shell;flowbits:set,ip_send;flowbits:noalert;sid:2020010007;)", "2020060003": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5b58\u5728webshell\u8bbf\u95ee|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|type:shell|o_msg:webshell\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";http_content_type;content:\"text/html\";pkt_data;content:\"<form method=\\\"post\\\" action=\\\"\";http_server_body;content:\".aspx\\\" id=\\\"ASPXSpy\\\" enctype=\\\"multipart/form-data\\\">\";http_server_body;flow:from_server,established;sid:2020060003;rev:1;)", "2019090042": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(SMTP)|direction:in|level:action|service_name:Microsoft Exchange(SMTP)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange Server|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 ([-\\w_.]+) Microsoft ESMTP MAIL Service ready at/\";sid:2019090042;gid:0;)", "2020051106": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:CKeditor\u7f16\u8f91\u5668\u5229\u7528\u884c\u4e3a|tag:\u7f16\u8f91\u5668\u5229\u7528|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:CKeditor\u7f16\u8f91\u5668\u5229\u7528\u884c\u4e3a|severity:2|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"ckeditor/\";http_uri;nocase;fast_pattern;pcre:\"/(filemanager\\/connectors\\/test\\.html)|(filemanager\\/connectors\\/uploadtest\\.html)|(filemanager\\/browser\\/default\\/browser\\.html)|(filemanager\\/browser\\/default\\/frmupload\\.html)|(filemanager\\/connectors\\/php\\/upload\\.php)|(samples\\/sample_posteddata\\.php)|(samples\\/assets\\/posteddata\\.php)/URi\";threshold:type both,track by_src,count 10,seconds 10;sid:2020051106;rev:2;)", "2025808": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT php script base64 encoded Remote Code Execution 2|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"8qPD9waHAg\";metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025808;rev:2;metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2020010032": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528\u6f0f\u6d1e\u6267\u884c\u547d\u4ee4|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u68c0\u6d4b\u5230\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;http_content_len;byte_test:0,<,50,0,string,dec;pkt_data;content:\"uid=\";http_server_body;pcre:\"/^\\d+\\(\\w+\\) gid=^\\d+\\(\\w+\\) groups=^\\d+\\(\\w+\\)/QR\";flowbits:isset,cmd_reponse_echo;sid:2020010032;)", "2013285": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DarkComet\u540e\u95e8\u6728\u9a6c|type:rat|tag:DarkComet|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230DarkComet-RAT\u5ba2\u6237\u7aef\u4fdd\u6301\u8fde\u63a5\";flow:to_server,established;dsize:12;content:\"|39 34 41 35 41 44 30 41 45 46 36 39|\";flowbits:isset,ET.DarkCometJoin;reference:url,www.darkcomet-rat.com;classtype:trojan-activity;sid:2013285;rev:2;)", "2020051301": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7591\u4f3c\u51b0\u874ewebshell\u901a\u8baf|tag:webshell|tool:\u51b0\u874e|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|gray:true|result:unknown|o_msg:\u7591\u4f3c\u51b0\u874ewebshell\u901a\u8baf|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;flowbits:set, bingxie_send_message;noalert;content:\"POST\";http_method;content:\".\";http_uri;pcre:\"/^(asp|jsp|jspx|aspx|php)$/URi\";http_content_len;byte_test:0,>=,1000,0,string,dec;pkt_data;content:\"a\";http_client_body;nocase;pcre:\"/^([A-Za-z0-9+\\/]{4})*([A-Za-z0-9+\\/]{4}|[A-Za-z0-9+\\/]{3}=|[A-Za-z0-9+\\/]{2}==)$/P\";sid:2020051301;gid:0;rev:1;)", "2019090250": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:OpenVPN\u8fde\u63a5|direction:in|level:action|service_name:OpenVPN|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728OpenVPN|server:src\";flow:from_server,established;content:\">INFO:\";depth:6;pcre:\"/^>INFO:OpenVPN Management Interface Version ([\\d.]+) -- type 'help' for more info\\r\\n>/\";sid:2019090250;gid:0;)", "2019090041": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(SMTP)|direction:in|level:action|service_name:Microsoft Exchange(SMTP)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange Server|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 \\[?([-.+\\w]+)\\]? Microsoft ESMTP MAIL Service, Version: ([-\\w.]+) ready/\";sid:2019090041;gid:0;)", "2020070805": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6587\u4ef6\u5305\u542b\u8bfb\u53d6|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u6587\u4ef6\u8bfb\u53d6\u5c1d\u8bd5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, file_read_general;content:\"opt\";http_client_body;fast_pattern;pcre:\"/(lampp((\\/)|(%2f)|(%2F))logs((\\/)|(%2f)|(%2F))access_log)|(((\\/)|(%2f)|(%2F))lampp((\\/)|(%2f)|(%2F))logs((\\/)|(%2f)|(%2F))access\\.log)|(((\\/)|(%2f)|(%2F))xampp((\\/)|(%2f)|(%2F))logs((\\/)|(%2f)|(%2F))access\\.log)|(((\\/)|(%2f)|(%2F))xampp((\\/)|(%2f)|(%2F))logs((\\/)|(%2f)|(%2F))access_log)/Pi\";sid:2020070805;rev:1;)", "2020081710": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Metasploit \u8fde\u63a5|tag:\u53cd\u5f39shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|attack_type:target|result:success|o_msg:Metasploit \u8fde\u63a5|gray:true\";flags:P, A;flow:from_server, established;flowbits:noalert;xbits:set, msf_reverser_response, track ip_pair, expire 2;dsize:4;sid:2020081710;)", "2019090300": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DNS\u8fde\u63a5|direction:in|level:action|service_name:Microsoft DNS|service_class:other|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft DNS|server:src\";flow:from_server,established;content:\"|00 06 05 00 00 01 00 01 00 00 00 00 07|version|04|bind|00 00 10 00 03 c0 0c 00 10 00 01|X|02 00 00 00|\";offset:0;depth:41;pcre:\"/^\\0\\x06\\x05\\0\\0\\x01\\0\\x01\\0\\0\\0\\0\\x07version\\x04bind\\0\\0\\x10\\0\\x03\\xc0\\x0c\\0\\x10\\0\\x01X\\x02\\0\\0\\0..Microsoft DNS (.+)/\";sid:2019090300;gid:0;)", "2018121217": "alert smb $HOME_NET 445 -> $HOME_NET any (msg:\"name:SMB\u7206\u7834|tag:\u7206\u7834|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:dest|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230smb\u7684\u7206\u7834\u884c\u4e3a\";flow:to_client,established;content:\"|53 4d 42 73|\";offset:5;depth:4;content:\"|8d 01 00 c0|\";distance:4;within:4;threshold:type threshold,track by_src,count 20,seconds 2;sid:2018121217;)", "2020051248": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:D-Link DIR600 command.php \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|tag:\u547d\u4ee4\u6267\u884c\u6f0f|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:D-Link DIR600 command.php \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, d_link_600_rce;content:\"POST\";http_method;content:\"/command.php\";http_uri;content:\"cmd=\";http_client_body;pcre:\"/(ls|cd|pwd|wget|curl|adduser|cat|passwd|chmod|echo|netstat|uname|sysctl|mysql|history|bash|useradd|ps|ifconfig|find|id|grep|awk|last|lsof|iptables|find|whoami|touch|ping)/PRi\";sid:2020051248;rev:2;)", "2020010045": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u7591\u4f3c\uff01webshell\u6267\u884c\u547d\u4ee4\u5217\u76ee\u5f55|tag:\u6267\u884c\u547d\u4ee4|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:web\u9875\u9762\u6267\u884c\u547d\u4ee4ls|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"|0a|-\";http_server_body;fast_pattern;pcre:\"/^((r|-)(w|-)(x|-)){3} {1,3}\\d{1,4} /QR\";flowbits:isset,post_req;sid:2020010045;rev:1;)", "2018112310": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5927\u7070\u72fc\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u5927\u7070\u72fc\u8fdc\u63a7|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cBigBadWolf\u5728\u7ebf\";flow:from_server,established;content:\"|BF 05 50 2B CD F2 DF 00 D9 1B 86 06 C2 95 3D 53 63 78 9C E3 07 00 00 10 00 10|\";depth:26;dsize:26;sid:2018112310;rev:1;)", "2019090289": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DNS\u8fde\u63a5|direction:in|level:action|service_name:Microsoft DNS|service_class:other|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft DNS|server:src\";flow:from_server,established;content:\"|07|version|04|bind\";within:27;pcre:\"/\\x07version\\x04bind\\0\\0\\x10\\0\\x03\\xc0\\x0c\\0\\x10\\0[\\x01\\x03].{7}Microsoft DNS (6\\.0)$/\";sid:2019090289;gid:0;)", "2018081311": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u8fdb\u884c\u6d4f\u89c8E\u76d8\";dsize:9;flow:from_server,established;content:\"LIST E:|0d 0a|\";depth:9;nocase;flowbits:isset,TB_ZxShell_2;sid:2018081311;rev:1;)", "2020011412": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Citrix ADC \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2019-19781\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Citrix ADC|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2019_19781;content:\"POST\";http_method;content:\"/vpn/../vpns/portal/scripts/newbm.pl\";http_raw_uri;startswith;content:\" template.new(\";http_client_body;sid:2020011412;rev:1;)", "2019090282": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DNS\u8fde\u63a5|direction:in|level:action|service_name:Microsoft DNS|service_class:other|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft DNS|server:src\";flow:from_server,established;content:\"|07|version|04|bind\";within:27;pcre:\"/\\x07version\\x04bind\\0\\0\\x10\\0\\x03\\xc0\\x0c\\0\\x10\\0[\\x01\\x03].{7}Microsoft DNS (6\\.0\\.6002.+)/\";sid:2019090282;gid:0;)", "2020080313": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Metasploit \u8fde\u63a5(tcp)|tag:\u53cd\u5f39shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:Metasploit \u8fde\u63a5(windows/x64/shell_reverse_tcp)\";flags:P, A;flow:from_server, established;flowbits:set, windows_x64_shell_reverse_tcp;noalert;dsize:4;content:\"|50 01 00 00|\";depth:4;sid:2020080313;)", "2020071449": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Citrix \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e(CVE-2020-8196)|tag:\u672a\u6388\u6743\u8bbf\u95ee|dest:home_net|level:attack|severity:3|result:unknown|phase:exploit|o_msg:Citrix \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u5b83\u9a8c\u8bc1API\u8c03\u7528\u662f\u5426\u6210\u529f|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2020_8196;content:\"POST\";http_method;http_content_type;content:\"application/xml\";pkt_data;content:\"|0d 0a|X-NITRO-ONERROR:\";http_header;content:\"<\";http_header;distance:0;content:\"<server>\";http_client_body;sid:2020071449;)", "2019000078": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Fastjson <=1.2.62 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Fastjson <=1.2.62 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, fastjson_jndi;content:\"@type\";http_client_body;fast_pattern;content:\"org.apache.xbean.propertyeditor.JndiConverter\";http_client_body;distance:0;content:\"asText\";http_client_body;nocase;pcre:\"/(ldap|rmi):\\/\\//PRi\";sid:2019000078;rev:1;)", "2019090194": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 .*\\r\\n221 2\\.7\\.0 Error: I can break rules, too\\. Goodbye\\.\\r\\n/\";sid:2019090194;gid:0;)", "2020040805": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Nexus Repository Manager 3 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Repository Manager 3 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/service/extdirect\";http_uri;http_content_type;content:\"application/json\";pkt_data;content:\"\\\"action\\\"\";http_client_body;content:\"\\\"cleanup_CleanupPolicy\\\"\";http_client_body;distance:0;content:\"\\\"data\\\"\";http_client_body;content:\"\\\"format\\\"\";http_client_body;distance:0;pcre:\"/\\$(\\\\\\\\.)?\\{/PR\";sid:2020040805;rev:1;)", "20198004": "alert tcp $HOME_NET any -> $EXTERNAL_NET !3389 (msg:\"name:lcx\u7aef\u53e3\u6620\u5c04|tag:\u7aef\u53e3\u6620\u5c04|direction:lateral|type:infil|src:home_net|dest:external_net|level:attack|phase:post_exploit|severity:3|gray:|result:success|o_msg:\u53d1\u73b0\u9ed1\u5ba2\u5de5\u5177lcx.exe\u5c06\u5185\u7f51\u4e3b\u673a\u7aef\u53e3\u6620\u5c04\u5230\u5916\u7f51\";dsize:19;flow:established,to_server;flowbits:isset, lcx_syn;content:\"|03 00 00 13 0e d0 00 00 12|4|00 02 1f 08 00 02 00 00 00|\";offset:0;sid:20198004;rev:1;)", "2020051246": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:DIR-412 \u65e5\u5fd7\u6cc4\u6f0f\u6f0f\u6d1e|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:DIR-412 \u65e5\u5fd7\u6cc4\u6f0f\u6f0f\u6d1e|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, d_link_412_info;noalert;content:\"/log_get.php\";http_uri;sid:2020051246;rev:2;)", "2020081712": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7 msf \u8fde\u63a5\u670d\u52a1\u5668|tag:\u53cd\u5f39shell|dest:home_net|level:attack|phase:exploit|severity:4|attack_type:target|result:unknown|o_msg:msf \u8fde\u63a5|gray:true|attacker:src\";flags:P, A;flow:to_server, established;flowbits:noalert;xbits:set, msf_reverser_response, track ip_pair, expire 2;dsize:4;sid:2020081712;)", "2020062301": "alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5efa\u7acb ICMP \u901a\u9053\u4f20\u8f93\u6570\u636e|tag:\u653b\u51fb\u4ee3\u7406|tool:pingtunnel|direction:in|dest:external_net|src:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u5c1d\u8bd5\u5efa\u7acb ICMP \u901a\u9053\uff0c\u4f20\u8f93\u6570\u636e|attacker:dest\";flow:established, to_server;itype:8;icode:0;content:\"|10 01 22 0f 01 00 00 00 0e d6|\";depth:10;threshold:type both, track by_src, count 30, seconds 30;sid:2020062301;rev:1;)", "2019090206": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 (?:.*? )?([-\\w_.]+) ESMTP(?: [^\\r\\n]*)?\\r\\n502 5\\.5\\.2 Error: command not recognized\\r\\n/\";sid:2019090206;gid:0;)", "2016954": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Struts2\u6f0f\u6d1e\u5229\u7528|tag:Struts\u6f0f\u6d1e|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|success_by:execmd|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Struts2 OGNL Java Exec\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u7684payload\u653b\u51fb\u7cfb\u7edf|attacker:src\";flow:to_server,established;content:\"memberAccess\";http_client_body;nocase;content:\"allowStaticMethodAccess\";http_client_body;nocase;flowbits:set,cmd_reponse_echo;sid:2016954;)", "2829579": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u534e\u4e3aHG532\u8def\u7531\u5668\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c (CVE-2017-17215)|tag:\u8def\u7531\u5668\u6f0f\u6d1e|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u7528\u8be5\u6f0f\u6d1e\uff0c\u5411\u8def\u7531\u5668UPnP\u670d\u52a1\u76d1\u542c\u768437215\u7aef\u53e3\u53d1\u9001\u4e00\u4e2a\u7279\u6b8a\u6784\u9020\u7684 HTTP \u8bf7\u6c42\u5305\uff0c\u5373\u53ef\u89e6\u53d1\u547d\u4ee4\u6267\u884c\u3002\u6b64\u7aef\u53e3\u5728\u9ed8\u8ba4\u914d\u7f6e\u4e0b\u5e76\u4e0d\u80fd\u4ece\u5916\u7f51\u8bbf\u95ee\uff0c\u4f46\u7531\u4e8e\u8be5\u7cfb\u5217\u8def\u7531\u5668\u6570\u91cf\u6781\u5176\u5de8\u5927\uff0c\u6240\u4ee5\u4e92\u8054\u7f51\u4e0a\u4ecd\u6709\u8f83\u591a\u53ef\u8bbf\u95ee\u5230\u8be5\u7aef\u53e3\u7684\u8bbe\u5907\u5b58\u5728\u3002\u76ee\u524d\u5df2\u7ecf\u6709\u8815\u866b\u5728\u5229\u7528\u8fd9\u4e9b\u66b4\u9732\u5728\u4e92\u8054\u7f51\u4e0a\u7684\u7aef\u53e3\u8fdb\u884c\u4f20\u64ad|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/ctrlt/DeviceUpgrade_1\";http_uri;fast_pattern;content:\"|3c|NewStatusURL|3e|\";http_client_body;content:\"|24 28|\";http_client_body;within:3;content:\"NewStatusURL|3e|\";http_client_body;distance:0;content:\"|3c|NewDownloadURL|3e|\";http_client_body;distance:0;content:\"|24 28|\";http_client_body;within:3;content:\"NewDownloadURL|3e|\";http_client_body;distance:0;metadata:former_category EXPLOIT;reference:cve,2017-17215;classtype:trojan-activity;sid:2829579;rev:1;metadata:affected_product Linux, attack_target Networking_Equipment, deployment Perimeter, signature_severity Major, created_at 2018_02_06, performance_impact Low, updated_at 2018_02_06;)", "2018010092": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Redis\u672a\u6388\u6743\u6f0f\u6d1e\u5199SSH Key|tag:\u672a\u6388\u6743\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Redis\u56e0\u914d\u7f6e\u4e0d\u5f53\u53ef\u4ee5\u672a\u6388\u6743\u8bbf\u95ee\u3002\u653b\u51fb\u8005\u65e0\u9700\u8ba4\u8bc1\u76f4\u63a5\u5199SSH key|attacker:src\";content:\"config set\";nocase;offset:0;pcre:\"/\\s+[\\w\\d_-]+\\s+\\/root\\/\\.ssh/iR\";flow:to_server,established;flowbits:set, redis_shell_req_1;gid:0;sid:2018010092;rev:1;)", "2019000074": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Intellian Satellian Aptus Web\u63a7\u5236\u53f0\u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-7989\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:Intellian Satellian Aptus Web\u63a7\u5236\u53f0\u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-7989\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2020\u2014_7980;content:\"200\";http_stat_code;content:\"\\\"EXEC_CMD\\\"\";http_server_body;content:\"\\\"SUCCESS_\\\"\";http_server_body;distance:0;sid:2019000074;rev:1;)", "2020052102": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5c1d\u8bd5\u5efa\u7acbsocks5\u8fde\u63a5|tag:\u4ee3\u7406|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:4|result:unknown|o_msg:\u653b\u51fb\u8005\u8fdb\u5165\u5185\u7f51\u7684\u5e38\u7528\u624b\u6bb5\uff0c\u9700\u8981\u4e00\u53f0\u88ab\u63a7\u5236\u7684\u5916\u7f51\u53ef\u8bbf\u95ee\u4e3b\u673a|gray:true\";flow:established, from_server;flowbits:isset, s5_step_1;noalert;flowbits:set, s5_step_2;dsize:2;content:\"|05 00|\";depth:3;sid:2020052102;rev:1;)", "2020060004": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u7591\u4f3cwebshell\u8bbf\u95ee|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:2|result:success|type:shell|o_msg:webshell\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"\u4e3b\u673a\u540d|3a|\";http_server_body;content:\"OS \u540d\u79f0|3a|\";http_server_body;content:\"OS \u7248\u672c|3a|\";http_server_body;content:\"OS \u5236\u9020\u5546|3a|\";http_server_body;content:\"Microsoft Corporation\";distance:0;http_server_body;content:\"OS \u914d\u7f6e|3a|\";http_server_body;content:\"OS \u6784\u4ef6\u7c7b\u578b|3a|\";http_server_body;content:\"\u6ce8\u518c\u7684\u6240\u6709\u4eba|3a|\";http_server_body;content:\"\u6ce8\u518c\u7684\u7ec4\u7ec7|3a|\";http_server_body;content:\"\u4ea7\u54c1 ID|3a|\";http_server_body;content:\"\u521d\u59cb\u5b89\u88c5\u65e5\u671f|3a|\";http_server_body;content:\"\u7cfb\u7edf\u542f\u52a8\u65f6\u95f4|3a|\";http_server_body;content:\"\u7cfb\u7edf\u5236\u9020\u5546|3a|\";http_server_body;content:\"\u7cfb\u7edf\u578b\u53f7|3a|\";http_server_body;content:\"\u7cfb\u7edf\u7c7b\u578b|3a|\";http_server_body;content:\"\u5904\u7406\u5668|3a|\";http_server_body;reference:md5,a22af4fc7fe011069704a15296634ca6;classtype:trojan-activity;sid:2020060004;rev:1;metadata:created_at 2014_08_25, updated_at 2014_08_25;)", "2020052201": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|failed_by:http_status_3XX,http_status_4XX|phase:exploit|severity:3|result:unknown|tool:ysoserial|o_msg:\u4f7f\u7528\u5de5\u5177 ysoserial \u751f\u6210\u53cd\u5e8f\u5217\u5316payload|attacker:src\";flow:established, to_server;content:\"|ac ed 00 05|\";content:\"ysoserial\";content:\"payload\";distance:1;sid:2020052201;rev:1;)", "2018030023": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u83dc\u5200webshell\u5217\u76ee\u5f55\u884c\u4e3a|tag:webshell\u8fde\u63a5|tool:\u83dc\u5200|direction:in|dest:home_net|src:external_net|level:attack|phase:control|severity:4|result:success|o_msg:\u83dc\u5200webshell\u5217\u76ee\u5f55\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX\";content:\"200\";nocase;http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"|09|\";http_server_body;within:100;pcre:\"/([\\d\\w`~!@#$%^&*()+=_<>?,./:\"\\;'\\\\{}\\[\\]]{3})ERROR:// No such file or directory\\1/iQ\";flowbits:isset,req;flow:from_server,established;sid:2018030023;rev:1;)", "2019090121": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(imap)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"* OK \";depth:5;pcre:\"/^\\* OK Waiting for authentication process to respond\\.\\.\\r\\n/\";sid:2019090121;gid:0;)", "2020070107": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668\u6210\u529f(Termite-\u6b63\u5411\u4ee3\u7406)|tag:\u653b\u51fb\u4ee3\u7406|tool:Termite|direction:in|src:home_net|dest:external_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668\u6210\u529f(Termite-\u6b63\u5411\u4ee3\u7406)|attacker:dest\";flow:established, from_server;flowbits:isset, termite_link_type_1;dsize:125;content:\"|04 00 00 00 01 00 00 00|\";depth:8;content:\"|00 00 00 00 00 00 00 00|\";distance:0;within:8;content:\"|6c 00 00 00 01 00 00 00|\";distance:0;within:8;content:\"|01 61 67 65 6e 74 00 00|\";distance:0;within:8;sid:2020070107;rev:1;)", "2018041809": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:DRAT2008\u540e\u95e8\u6728\u9a6c|type:rat|tag:DRAT2008|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cDrat2008\u5378\u8f7d\u81ea\u8eab\";dsize:5;flow:from_server,established;content:\"|30 35 36 0d 0a|\";flowbits:isset,TB_DRAT2009_1;flowbits:isset,TB_DRAT2009_2;sid:2018041809;rev:1;)", "2018081316": "alert tcp $EXTERNAL_NET any -> $HOME_NET [!21] (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u8fdb\u884c\u6587\u4ef6\u4e0a\u4f20\";dsize:5<>50;flow:from_server,established;content:\"STOR \";depth:5;nocase;content:\"|0d 0a|\";isdataat:!1,relative;flowbits:isset,TB_ZxShell_3;sid:2018081316;rev:1;)", "2019000054": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Orcale\u4fe1\u606f\u6cc4\u9732|tag:Orcale|dest:home_net|phase:exploit|level:attack|severity:1|result:unknown|o_msg:\u901a\u8fc7\u5404\u79cd\u6e20\u9053\u5bfc\u81f4Orcale\u5730\u5740\uff0c\u5bc6\u7801\uff0c\u7528\u6237\u540d\u6cc4\u9732|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"jdbc\";http_server_body;fast_pattern;pcre:\"/(jbdc\\:oracle\\:thin\\:@)|(oracle\\.jdbc\\.driver\\.OracleDriver)/Qi\";content:\"password\";http_server_body;content:\"user\";http_server_body;http_content_type;content:\"application/json\";pkt_data;sid:2019000054;rev:1;)", "2018072701": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:PowerShell\u8fdc\u7a0b\u767b\u5f55\u6210\u529f|tag:powershell|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:dest|result:success|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u901a\u8fc7PowerShell\uff08http\uff09\u8fdb\u884c\u8fdc\u7a0b\u767b\u9646\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";content:\"200\";http_stat_code;content:\"Server: Microsoft-HTTPAPI\";http_header;nocase;content:\"--Encrypted Boundary\";nocase;http_server_body;flow:from_server,established;flowbits:isset,TB_PowerShell_HTTP;sid:2018072701;rev:1;)", "2025809": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT php script base64 encoded Remote Code Execution 3|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"vKjw/cGhwI\";metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025809;rev:2;metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2019090110": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:vsFTPd\u8fde\u63a5|direction:in|level:action|service_name:vsFTPd|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728vsFTPd|server:src\";flow:from_server,established;content:\"500\";depth:3;pcre:\"/^500 OOPS: vsftpd: (.*)\\r\\n/\";sid:2019090110;gid:0;)", "2019090260": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"E|00 00 00|\";depth:4;pcre:\"/^E\\0\\0\\0.S[^\\0]+\\0C0A000\\0M.*?65363\\.19778.*\\0Fpostmaster\\.c\\0L\\d{4}\\0RProcessStartupPacket\\0\\0$/\";sid:2019090260;gid:0;)", "2020051905": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring Data Rest \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2017-8046\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Spring Data Rest \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2017-8046\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2017_8046;content:\"PATCH\";http_method;http_content_type;content:\"application/json-patch+json\";pkt_data;content:\"op\";http_client_body;content:\"path\";http_client_body;content:\"T(\";http_client_body;distance:3;within:8;sid:2020051905;rev:1;)", "2825064": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Empire \u8fde\u63a5\u4ea4\u4e92|tag:\u6728\u9a6c|direction:out|src:home_net|dest:external_net|level:attack|type:c2|phase:control|severity:3|result:success|o_msg:\u4f7f\u7528Empire \u8fde\u63a5\u4ea4\u4e92|failed_by:http_status_3XX,http_status_4XX\";flow:established,from_server;content:\"Server|3a 20|Microsoft-IIS/7.5|0d 0a|\";content:\"<html><body><h1>It works!</h1><p>This is the default web page for this server.</p><p>The web server software is running but no content has been added, yet.</p></body></html>\";isdataat:!1,relative;classtype:trojan-activity;sid:2825064;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_02_22, updated_at 2019_09_28;)", "2020081413": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08tcp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884c\u547d\u4ee4ps -ef\";flow:established;content:\"UID\";content:\"PID\";distance:0;content:\"PPID\";distance:0;pcre:\"/UID\\s+PID\\s+PPID\\s+C\\s+STIME\\s+TTY\\s+TIME\\s+CMD\\x0a/\";sid:2020081413;)", "20258041": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:payload\u4e2d\u5305\u542bbase64\u540e\u7684/bin/bash|tag:payload|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u653b\u51fbpayload\u4e2d\u4f7f\u7528base64\u7f16\u7801\u540e\u7684/bin/bash|attacker:src\";flow:to_server,established;content:\"L2Jpbi9iYXNo\";http_client_body;metadata:former_category EXPLOIT;classtype:attempted-user;sid:20258041;rev:2;metadata:attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2018000031": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u83dc\u5200\u8fde\u63a5\u6210\u529f|tag:webshell\u8fde\u63a5|tool:\u83dc\u5200|direction:in|dest:home_net|src:external_net|level:attack|phase:control|severity:4|result:success|type:shell|o_msg:\u83dc\u5200\u8fde\u63a5\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";content:\"200\";nocase;http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"X@Y\";http_server_body;within:50;pcre:\"/X@Y\\w+(X@Y)(.?)$/iQ\";flow:from_server,established;sid:2018000031;rev:1;)", "2020061014": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, tp_5_rce_1;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"/var/www/html/\";http_server_body;depth:40;sid:2020061014;rev:1;)", "2020060906": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u653b\u51fb\u8005\u5c1d\u8bd5\u901a\u8fc7webshell\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\".jsp?threedr3am=\";http_uri;sid:2020060906;rev:1;)", "2020052508": "alert dns $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528xip.io\u8fdb\u884c\u53cd\u5f39|tag:dnslog|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u5229\u7528dnslog\u8fdb\u884c\u53cd\u5f39|attacker:dest\";flow:established, to_server;dns_query;content:\".xip.io\";pkt_data;sid:2020052508;rev:1;)", "2027039": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"FyZ29ycCB\";distance:0;fast_pattern;metadata:former_category ATTACK_RESPONSE;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027039;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_03_05, malware_family DNSlivery, updated_at 2019_03_05;)", "2806187": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Struts\u7684\u6f0f\u6d1e\u5229\u7528|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:2|success_by:execmd|result:unknown|o_msg:Struts\u7684\u6f0f\u6d1e\u5229\u7528|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"action?\";http_uri;nocase;content:\"#context\";http_uri;content:\"allowStaticMethodAccess\";fast_pattern:only;http_uri;pcre:\"/action\\?\\w+?\\x3d\\x28.+?allowStaticMethodAccess/U\";reference:cve,2011-3923;reference:url,blog.o0o.nu/2012/01/cve-2011-3923-yet-another-struts2.html;classtype:attempted-user;sid:2806187;rev:2;metadata:created_at 2013_04_01, updated_at 2013_04_01;)", "2018080196": "alert tcp $HOME_NET 21 -> $HOME_NET any (msg:\"name:FTP\u767b\u9646\u6210\u529f|tag:ftp|direction:lateral|type:infil|src:home_net|dest:home_net|level:action|phase:post_exploit|severity:1|force_save:true|result:success|o_msg:ftp\u670d\u52a1\u767b\u5f55\u6210\u529f\";dsize:23;flow:to_client,established;content:\"230 Login successful.\";depth:21;nocase;content:\"|0d 0a|\";distance:0;sid:2018080196;rev:1;)", "2010379": "alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"name:\u5c1d\u8bd5JBOSS/JMX \u8fdc\u7a0b\u6f0f\u6d1e|tag:\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:JBOSS\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST \";nocase;depth:5;uricontent:\"/jmx-console/HtmlAdaptor\";nocase;content:\"action=invokeOp&name=jboss.deployment\";nocase;content:\"flavor%253DURL%252Ctype%253DDeploymentScanner\";within:50;nocase;content:\"=http%3A%2F%2F\";within:40;reference:url,www.notsosecure.com/folder2/2009/10/27/hacking-jboss-with-jmx-console/;reference:url,www.nruns.com/_downloads/Whitepaper-Hacking-jBoss-using-a-Browser.pdf;reference:url,doc.emergingthreats.net/2010379;classtype:web-application-attack;sid:2010379;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2025805": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:payload\u4e2d\u5305\u542bbase64\u540e\u7684/bin/bash|tag:payload|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u653b\u51fbpayload\u4e2d\u4f7f\u7528base64\u7f16\u7801\u540e\u7684/bin/bash|attacker:src\";flow:established,to_server;content:\"9iaW4vYmFza\";http_header;metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025805;rev:2;metadata:attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2020061903": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:GoAhead \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2017-17562)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u653b\u51fb\u8005GoAhead \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2017-17562)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2017_17562;content:\"POST\";http_method;content:\"/cgi-bin/\";http_uri;depth:40;nocase;content:\"LD_PRELOAD=/proc/self/fd/0\";http_uri;distance:0;nocase;http_content_len;byte_test:0, >=, 8000, 0, string, dec;pkt_data;sid:2020061903;rev:1;)", "180827000": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dofloo_DDoS|type:botnet|tag:Dofloo|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u6728\u9a6c\u540e\u95e8Linux.DDoS.AesDDoS/Dofloo/MrBlack\u4e0a\u7ebf\u5305\";dsize:1024;flow:to_server,established;content:\"VERSONEX:Linux\";depth:14;nocase;content:\"MHz|7C|\";distance:0;nocase;content:\"MB|7C|\";distance:0;nocase;sid:180827000;rev:1;)", "2020070801": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u9ed1\u5ba2\u5de5\u5177fimap\u626b\u63cf\u884c\u4e3a|tag:\u626b\u63cf|tool:fimap|dest:home_net|level:attack|phase:recon|severity:3|result:unknown|o_msg:\u9ed1\u5ba2\u5de5\u5177fimap\u626b\u63cf\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"fimap.googlecode.com\";http_user_agent;sid:2020070801;rev:1;)", "2020060105": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Powershell\u4e0b\u8f7dpayload|tag:\u4e0b\u8f7d\u6076\u610f\u6587\u4ef6|direction:out|dest:external_net|level:attack|phase:control|severity:3|result:success|type:unknown_url|o_msg:\u7591\u4f3c\u4e0b\u8f7dpowershell\u811a\u672c|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"New-Object IO.MemoryStream(\";http_server_body;content:\"|5B|Convert|5D 3A 3A|FromBase64String|28 22|\";http_server_body;content:\"New-Object IO.Compression.GzipStream|28|\";http_server_body;gid:0;sid:2020060105;rev:1;)", "2020051916": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, spring_actuator;content:\"200\";http_stat_code;http_content_type;content:\"application\";content:\"spring-boot.actuator\";distance:0;content:\"json\";distance:0;pkt_data;content:\"{\\\"_links\\\":{\\\"self\\\":{\\\"href\\\":\";http_server_body;startswith;sid:2020051916;rev:1;)", "2020050904": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|dest:home_net|level:attack|phase:exploit|type:shell|severity:3|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, bingxie_webshell;noalert;content:\"GET\";http_method;content:\".jsp?\";http_uri;pcre:\"/[\\w.$@!%_-]+=\\d{3}$/iUR\";isdataat:!1,relative;content:\"Connection: keep-alive\";http_header;sid:2020050904;gid:0;rev:1;)", "2020070603": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PHPCMS v9.6.0 wap\u6a21\u5757 SQL\u6ce8\u5165(noalert)|tag:sql\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:4|result:success|o_msg:PHPCMS v9.6.0 wap\u6a21\u5757 SQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, phpcms_9_6_sqlinject;content:\"200\";http_stat_code;content:\"<b>MySQL Query : </b> \";http_server_body;depth:200;sid:2020070603;rev:1;)", "2019090033": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:VNC\u8fde\u63a5|direction:in|level:action|service_name:VNC|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728VNC|server:src\";flow:from_server,established;content:\"RFB\";depth:3;pcre:\"/^RFB 005\\.000\\n/\";sid:2019090033;gid:0;)", "2019090240": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:radmin\u8fde\u63a5|direction:in|level:action|service_name:Radmin|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728Radmin|server:src\";flow:from_server,established;content:\"|01 00 00 00|\";depth:4;pcre:\"/^\\x01\\x00\\x00\\x00\\x25\\x71\\x00\\x02\\x12\\x08\\x02\\x00\\x71\\x0a/\";sid:2019090240;gid:0;)", "2008544": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (winlogon)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| winlogon\";http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008544;classtype:trojan-activity;sid:2008544;rev:7;)", "2024421": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:BeEF\u653b\u51fb\u8bf7\u6c42|tag:XSS|tool:BeEF|direction:in|src:home_net|dest:external_net|level:attack|attack_type:target|phase:control|severity:4|result:unknown|o_msg:BeEF\u653b\u51fb\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:established,from_server;content:\"Content-Type|3a 20|text/javascript|0d 0a|Server|3a 20|Apache/2.2.3 (CentOS)|0d 0a|Pragma|3a|\";fast_pattern;http_header;depth:69;content:\"|0d 0a|Expires|3a 20|0|0d 0a|\";http_header;content:!\"Set-Cookie|3a 20|\";content:!\"X-Powered-By|3a 20|\";http_header;sid:2024421;)", "2020051302": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u7591\u4f3c\u51b0\u874ewebshell\u901a\u8baf|tag:webshell|tool:\u51b0\u874e|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:success|o_msg:\u7591\u4f3c\u51b0\u874ewebshell\u901a\u8baf|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, bingxie_send_message;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"a\";http_server_body;nocase;pcre:\"/^([A-Za-z0-9+\\/]{4}){250,}([A-Za-z0-9+\\/]{4}|[A-Za-z0-9+\\/]{3}=|[A-Za-z0-9+\\/]{2}==)$/Q\";sid:2020051302;gid:0;rev:1;)", "2020070108": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Termite-\u53cd\u5411\u4ee3\u7406)|tag:\u653b\u51fb\u4ee3\u7406|tool:Termite|direction:in|src:home_net|dest:external_net|level:attack|phase:control|type:control|severity:4|result:unknown|o_msg:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Termite-\u53cd\u5411\u4ee3\u7406)\";flow:established, to_server;flowbits:set, termite_link_type_2;dsize:125;content:\"|04 00 00 00 01 00 00 00|\";depth:8;content:\"|00 00 00 00 00 00 00 00|\";distance:0;within:8;content:\"|6c 00 00 00 01 00 00 00|\";distance:0;within:8;content:\"|01 61 67 65 6e 74 00 00|\";distance:0;within:8;sid:2020070108;rev:1;)", "20170252": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:1|result:unknown|o_msg:\u6267\u884c\u547d\u4ee4net user|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"=net\";http_client_body;pcre:\"/=net(%20| )user\\b/iP\";flowbits:set,net_user;sid:20170252;)", "2020061212": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fbeOA\u524d\u53f0\u4efb\u610f\u7528\u6237\u4f2a\u9020\u767b\u5f55\u6f0f\u6d1e|tag:\u672a\u6388\u6743\u8bbf\u95ee|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u901a\u8fbeOA\u524d\u53f0\u4efb\u610f\u7528\u6237\u4f2a\u9020\u767b\u5f55\u6f0f\u6d1e\uff0c\u83b7\u53d6\u7528\u6237code_uid|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, tongda_login_bypass_step_1;content:\"200\";http_stat_code;http_content_type;content:\"image/png\";pkt_data;content:\"\\\"code_uid\\\"\";http_server_body;pcre:\"/^\\:\\\"\\{[A-Z0-9]{8}-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{12}\\}\\\"/QR\";sid:2020061212;rev:1;)", "2020080304": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Metasploit \u8fde\u63a5(http)|tag:\u53cd\u5f39shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:Metasploit \u8fde\u63a5(linux/x64/meterpreter_reverse_http)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;flowbits:set, win_linux_x64_meterpreter_reverse_http;noalert;content:\"GET\";http_method;content:\"/\";http_uri;pcre:\"/^[a-zA-Z0-9\\-_]+\\/$/UR\";http_header_names;content:\"|0d 0a|Host\";depth:6;content:\"|0d 0a|User-Agent|0d 0a|Accept|0d 0a|Connection|0d 0a 0d 0a|\";distance:0;within:36;pkt_data;content:\"|0d 0a|Accept: */*|0d 0a|\";http_header;sid:2020080304;)", "2027094": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT Possible Netgear DGN2200 RCE (CVE-2017-6334)|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/dnslookup.cgi\";http_uri;depth:14;isdataat:!1,relative;content:\"DIAG_diag.htm|0d 0a|\";http_header;fast_pattern;content:\"host_name=\";http_client_body;depth:10;content:\"|3b|\";http_client_body;distance:0;metadata:former_category EXPLOIT;reference:url,www.exploit-db.com/exploits/41394;reference:cve,2017-6334;classtype:attempted-user;sid:2027094;rev:1;metadata:attack_target IoT, deployment Perimeter, signatrue_severity Major, created_at 2019_03_18, performance_impact Low, updated_at 2019_03_18;)", "2020080306": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7 Metasploit \u8fde\u63a5\u670d\u52a1\u5668(tcp)|tag:\u8fdc\u7a0b\u8fde\u63a5|dest:home_net|level:attack|phase:exploit|severity:3|attack_type:target|result:unknown|o_msg:Metasploit \u8fde\u63a5(linux/x64/meterpreter/bind_tcp)|attacker:src\";flow:to_server, established;content:\"mbedtls_ctr_drbg_random|00|\";fast_pattern;content:\"__cxa_finalize|00|\";distance:0;within:15;content:\"__c_locale|00|\";distance:0;within:11;content:\"_init|00|\";distance:0;within:6;content:\"__gmt|00|\";distance:0;within:6;content:\"__c_dot_utf8|00|\";distance:0;within:13;sid:2020080306;)", "2020061214": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u8fbeOA\u524d\u53f0\u4efb\u610f\u7528\u6237\u4f2a\u9020\u767b\u5f55\u6f0f\u6d1e|tag:\u672a\u6388\u6743\u8bbf\u95ee|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u901a\u8fbeOA\u524d\u53f0\u4efb\u610f\u7528\u6237\u4f2a\u9020\u767b\u5f55\u6f0f\u6d1e\uff0c\u83b7\u53d6\u7528\u6237cookie|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, tongda_login_bypass_step_2;content:\"/ispirit/login_code_check.php\";http_uri;depth:80;nocase;content:\"codeuid=\";http_uri;distance:0;within:40;nocase;pcre:\"/^\\{[A-Z0-9]{8}-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{12}\\}/UR\";sid:2020061214;rev:1;)", "2019090152": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:OpenLDAP\u8fde\u63a5|direction:in|level:action|service_name:OpenLDAP|service_class:auth|severity:1|result:unknown|o_msg:\u5b58\u5728OpenLDAP|server:src\";flow:from_server,established;content:\"0|84 00 00 00|\";depth:5;pcre:\"/^0\\x84\\0\\0\\0I\\x02\\x01\\x01a\\x84\\0\\0\\0@\\n\\x01\\x02\\x04\\0\\x049historical protocol version requested, use LDAPv3 instead$/\";sid:2019090152;gid:0;)", "2018010031": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u89e3\u6790\u6f0f\u6d1e\u63a2\u6d4b|tag:\u89e3\u6790\u6f0f\u6d1e\u8bd5\u63a2|phase:exploit|dest:home_net|level:attack|severity:1|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:IIS6.0\u89e3\u6790\u6f0f\u6d1e\u63a2\u6d4b|attacker:src\";content:\"GET\";nocase;http_method;content:\".asp\";nocase;http_uri;within:200;pcre:\"/\\/[\\d\\w_-]\\.(jpg|gif|png)/iUR\";flow:to_server,established;gid:0;sid:2018010031;rev:1;)", "2020081711": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Metasploit \u8fde\u63a5(tcp)|tag:\u53cd\u5f39shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|attack_type:target|result:success|o_msg:Metasploit \u8fde\u63a5(windows/x64/meterpreter/reverse_tcp)|gray:true\";flow:from_server, established;xbits:isset, msf_reverser_response, track ip_pair;content:\"MZ\";depth:2;content:\"This program cannot be run in DOS mode.\";distance:0;within:200;sid:2020081711;)", "2018111002": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Lucky\u52d2\u7d22|type:trojan|tag:Lucky\u52d2\u7d22|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5bf9Lucky\u52d2\u7d22\u7684\u4e0b\u8f7d\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\"/d/ft64\";http_uri;fast_pattern;sid:2018111002;rev:1;)", "2020072804": "alert smb $HOME_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528psexec\u8c03\u7528\u6267\u884c\u547d\u4ee4|tag:\u8fdc\u7a0b\u63a7\u5236|tool:psexec|src:home_net|dest:home_net|level:attack|phase:exploit|attacker:src|result:success|severity:4|o_msg:\u4f7f\u7528psexec\u8c03\u7528\u6267\u884c\u547d\u4ee4\";flow:established, to_server;content:\"SMB\";offset:5;depth:3;content:\"%|00|S|00|Y|00|S|00|T|00|E|00|M|00|D|00|R|00|I|00|V|00|E|00|%|00|\";distance:0;content:\"e|00|c|00|h|00|o|00|\";distance:0;content:\"c|00|m|00|d|00 2e 00|e|00|x|00|e\";distance:0;sid:2020072804;rev:1;)", "2018111003": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Lucky\u52d2\u7d22|type:trojan|tag:Lucky\u52d2\u7d22|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5bf9Lucky\u52d2\u7d22\u7684\u4e0b\u8f7d\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\"/d/conn64\";http_uri;fast_pattern;sid:2018111003;rev:1;)", "2019060030": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"ASP.NET_SessionId=\";http_cookie;pcre:\"/[a-zA-Z0-9]{24}/CR\";http_content_len;byte_test:0,=,16,0,string,dec;pkt_data;content:\"c\";nocase;http_server_body;within:16;pcre:\"/^([a-f0-9A-F]{16})$/Q\";isdataat:!1,relative;noalert;flowbits:isset, bingxie_webshell_aspx;flowbits:set, bingxie_webshell_step2_aspx;sid:2019060030;gid:0;rev:1;)", "2020060402": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u9ed1\u5ba2\u5de5\u5177Masscan\u626b\u63cf\u884c\u4e3a|tag:\u626b\u63cf|tool:Masscan|dest:home_net|level:attack|phase:recon|severity:3|result:unknown|o_msg:\u9ed1\u5ba2\u5de5\u5177Masscan\u626b\u63cf\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"masscan/\";http_user_agent;sid:2020060402;rev:1;)", "2019090259": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"EFATAL:\";depth:7;pcre:\"/^EFATAL:  invalid length of startup packet\\n\\0$/\";sid:2019090259;gid:0;)", "2020072905": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Zabbix_2.x_4.x\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e|tag:\u672a\u6388\u6743\u8bbf\u95ee|phase:exploit|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Zabbix_2.x_4.x\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e|attacker:src\";flow:to_server,established;flowbits:set, Zabbix_2_x_4_x;noalert;content:\"zabbix.php\";http_uri;content:\"action=dashboard.view\";http_uri;distance:1;http_header_names;content:!\"Cookie\";pkt_data;gid:0;sid:2020072905;rev:1;)", "2020070321": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|tag:\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\".php\";http_uri;content:\"<?\";http_uri;fast_pattern;distance:0;pcre:\"/echo|eval|system|phpinfo|md5|die|assert|call_user_func|print|file_put_contents/URi\";sid:2020070321;rev:1;)", "2019010003": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5ThinkPHP\u6f0f\u6d1e|tag:ThinkPHP\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728ThinkPHP\u6f0f\u6d1e|attacker:src\";content:\"GET\";nocase;http_method;content:\"/index.php\";nocase;http_uri;within:100;pcre:\"/(\\/)?\\?s=(\\/)?index\\/(\\\\)?think\\\\template\\\\driver\\\\file/write&cacheFile=/iUR\";flow:to_server,established;gid:0;sid:2019010003;rev:1;)", "2020050604": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:SaltStack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2020-11651,CVE-2020-11652)|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|src:home_net|level:attack|phase:exploit|result:success|o_msg:SaltStack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2020-11651,CVE-2020-11652)\u3010\u6267\u884c\u547d\u4ee4\u3011|severity:3|attacker:dest\";flow:to_client, established;flowbits:isset, cve_2020_11651_rce_1;content:\"salt/run\";content:\"jid\";distance:0;sid:2020050604;rev:2;)", "2019060028": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"ASP.NET_SessionId=\";http_cookie;pcre:\"/[a-zA-Z0-9]{24}/CR\";http_content_len;byte_test:0,=,16,0,string,dec;pkt_data;content:\"e\";nocase;http_server_body;within:16;pcre:\"/^([a-f0-9A-F]{16})$/Q\";isdataat:!1,relative;noalert;flowbits:isset, bingxie_webshell_aspx;flowbits:set, bingxie_webshell_step2_aspx;sid:2019060028;gid:0;rev:1;)", "2019090014": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Memcached\u8fde\u63a5|direction:in|level:action|service_name:Memcached|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728Memcached|server:src\";flow:from_server,established;content:\"|00 01 00 00 00 01 00 00|STAT\";depth:12;pcre:\"/^\\0\\x01\\0\\0\\0\\x01\\0\\0STAT pid \\d+\\r\\nSTAT uptime \\d+\\r\\nSTAT time \\d+\\r\\nSTAT version ([.\\d]+)\\r\\n/\";sid:2019090014;gid:0;)", "2020021025": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:YII\u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u547d\u4ee4\u6267\u884c)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:YII\u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"CDbCriteria\";content:\"CMapIterator\";distance:1;content:\"CFileCache\";distance:1;content:\"serializer\";distance:1;content:\"cacheFileSuffix\";distance:1;content:\"base64,\";distance:1;content:\"CMapIterator_keys\";distance:1;content:\"CMapIterator_key\";distance:1;sid:2020021025;rev:1;)", "2026940": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"nZva2UtQ29tbW\";distance:0;fast_pattern;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026940;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2018080190": "alert tcp $HOME_NET 21 -> $HOME_NET any (msg:\"name:FTP\u767b\u5f55\u6210\u529f|tag:ftp|direction:lateral|type:infil|src:home_net|dest:home_net|level:action|phase:post_exploit|severity:1|force_save:true|result:unknown|o_msg:ftp\u670d\u52a1\u767b\u5f55\u6210\u529f\";dsize:21;flow:to_client,established;content:\"230 User logged in.\";depth:19;nocase;content:\"|0d 0a|\";distance:0;sid:2018080190;rev:1;)", "2018010058": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MSSQL\u6ce8\u5165|tag:\u6ce8\u5165\u5f00\u542f3389|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MSSQL\u6ce8\u5165 - \u5f00\u542f3389|dest:home_net|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"\\;declare\";nocase;http_uri;pcre:\"/[ +]+@[\\d\\w_-]+[\\s\\w/\\\\.*\\d()\"'=,:\\;+<>@_-]+HKEY_LOCAL_MACHINE[\\s\\w/\\\\.*\\d()\"'=,:\\;+<>@_-]+exec master\\.(dbo)?\\.xp_regwrite[\\s\\w/\\\\.*\\d()\"',+@_-]+system\\\\currentcontrolset\\\\services\\\\termservice/iUR\";flow:to_server,established;gid:0;sid:2018010058;rev:1;)", "2020061312": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Draytek\u4f01\u4e1a\u7f51\u7edc\u8bbe\u5907\u547d\u4ee4\u6ce8\u5165\uff08CVE-2020-8515\uff09|tag:\u547d\u4ee4\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Draytek\u4f01\u4e1a\u7f51\u7edc\u8bbe\u5907\u547d\u4ee4\u6ce8\u5165\uff08CVE-2020-8515\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"/cgi-bin/mainfunction.cgi\";http_uri;depth:80;content:\"rtick=\";http_client_body;pcre:\"/(%27%0A)|(\\|\\|)|(%7c%7c)|(%7c)|(%3b)|(%26)|([\\|\\;]).*(ls|cd|pwd|wget|curl|adduser|cat|passwd|chmod|echo|netstat|uname|sysctl|mysql|history|bash|useradd|ps|ifconfig|find|id|grep|awk|last|lsof|iptables|find|whoami|touch|ping)/PRi\";sid:2020061312;rev:1;)", "2018041201": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7070\u9e3d\u5b502.03\u540e\u95e8\u6728\u9a6c|type:rat|tag:hupigon|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u6d4b\u5230\u540e\u95e8\u6728\u9a6c\u7070\u9e3d\u5b502.03\u4e0a\u7ebf\u5305\";flow:from_server,established;dsize:20;content:\"|00 00 00 38 62 34 63 61 35 38 31 37 32 38 38 30 62 62 62|\";depth:20;flowbits:isset,TB_huigezi_2.03;sid:2018041201;rev:1;)", "2019090069": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:SSH\u8fde\u63a5|direction:in|level:action|service_name:OpenSSH|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728SSH|server:src\";flow:from_server,established;content:\"SSH\";depth:3;pcre:\"/^SSH-([\\d.]+)-OpenSSH[_-]([\\S ]+)/i\";sid:2019090069;gid:0;)", "2020021026": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZendFramework\u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u5220\u6587\u4ef6)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:ZendFramework\u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Zend_Http_Response_Stream\";content:\"*_cleanup\";distance:1;content:\"*stream_name\";distance:1;sid:2020021026;rev:1;)", "2020072801": "alert smb $HOME_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528PsExec\u8c03\u7528\u6267\u884c\u547d\u4ee4|tag:\u8fdc\u7a0b\u63a7\u5236|tool:psexec|src:home_net|dest:home_net|level:attack|phase:exploit|attacker:src|result:success|severity:4|o_msg:\u4f7f\u7528psexec_command\u8c03\u7528\u6267\u884c\u547d\u4ee4\";flow:established, to_server;content:\"SMB\";offset:5;depth:3;content:\"%|00|C|00|O|00|M|00|S|00|P|00|E|00|C|00|%|00|\";distance:0;content:\"e|00|c|00|h|00|o|00|\";distance:0;content:\"%|00|S|00|Y|00|S|00|T|00|E|00|M|00|D|00|R|00|I|00|V|00|E|00|%|00|\";distance:0;sid:2020072801;rev:1;)", "2019090275": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"E|00 00 00|\";depth:4;pcre:\"/^E\\0\\0\\0.S[^\\0]+\\0VFATAL\\0C0A000\\0Munsupported frontend protocol 65363/\";sid:2019090275;gid:0;)", "20258031": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:\u626b\u63cf|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:recon|result:unknown|o_msg:\u626b\u63cf\u53ef\u80fd\u5b58\u5728\u7684\u9ed1\u5ba2\u540e\u95e8\";flow:to_server,established;content:\"maWxlX3B1dF9jb250ZW50c\";http_client_body;metadata:former_category EXPLOIT;classtype:attempted-user;flowbits:set,webshell.scan;sid:20258031;rev:2;metadata:affected_product Web_Server_Applications, affected_product PHP, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2815177": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528Empire\u5229\u7528XLS\u5b8f\u5efa\u7acbSession\u521d\u59cb\u6d3b\u52a8|tag:\u6728\u9a6c|direction:out|src:home_net|dest:external_net|level:attack|type:c2|phase:control|severity:3|result:success|o_msg:\u4f7f\u7528Empire\u5efa\u7acbSession|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;content:\"/index\";http_uri;depth:6;content:\"Mozilla/5.0 (Windows NT 6.1|3b 20|WOW64|3b 20|Trident/7.0|3b 20|rv|3a|11.0) like Gecko\";http_user_agent;http_start;content:\"HTTP/1.1|0d 0a|Cookie|3a 20|SESSIONID=\";fast_pattern;http_header_names;content:!\"Referer|0d 0a|\";classtype:trojan-activity;sid:2815177;rev:4;metadata:created_at 2015_12_03, updated_at 2020_04_03;)", "2832170": "alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Cobalt Strike\u6728\u9a6cSSL\u8bc1\u4e66\u4f20\u8f93\u884c\u4e3a|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|dest:home_net|src:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike\u6728\u9a6cSSL\u8bc1\u4e66\u4f20\u8f93\u884c\u4e3a\";flow:established,from_server;tls_cert_subject;content:\"CN=work.windown-office.com\";nocase;isdataat:!1,relative;metadata:former_category TROJAN;reference:md5,4ec62c9d83a93e9dd3a314f48de147a5;classtype:trojan-activity;sid:2832170;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2018_08_14, malware_family APT32, malware_family Cobalt_Strike, updated_at 2019_09_28;)", "202000808": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874eWebshell\u901a\u8baf|tag:webshell|tool:\u51b0\u874e|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u51b0\u874eWebshell\u901a\u8baf|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, bingxie_3_0_jsp;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;http_header_names;content:!\"Cookie\";pkt_data;pcre:\"/^.{96}$/Q\";sid:202000808;gid:0;rev:1;)", "2025815": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT php script double base64 encoded Remote Code Execution 6|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"4cVBEOXdhSEFn\";metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025815;rev:2;metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2019090020": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:RDP\u8fde\u63a5|direction:in|level:action|service_name:RDP|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728RDP|server:src\";flow:from_server,established;content:\"|03 00 00|\";depth:3;pcre:\"/^\\x03\\0\\0\\x0b\\x06\\xd0\\0\\0\\0\\0\\0/\";sid:2019090020;gid:0;)", "2020020001": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:phpmyadmin\u767b\u5f55\u6210\u529f|tag:phpmyadmin|dest:home_net|phase:exploit|level:attack|severity:1|result:success|o_msg:phpmyadmin\u767b\u5f55\u6210\u529f|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"/index.php\";http_uri;nocase;content:\"POST\";http_method;content:\"pma_username=\";http_client_body;content:\"pma_password=\";http_client_body;flowbits:set, phpmyadmin_login;flowbits:noalert;gid:4;sid:2020020001;)", "2017574": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Jboss EJBInvokerServlet\u6f0f\u6d1e\u5229\u7528(CVE-2013-4810)|tag:\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:CVE-2013-4810|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/invoker/EJBInvokerServlet/\";http_uri;nocase;fast_pattern:only;content:\"invocation.MarshalledInvocation\";nocase;reference:url,www.exploit-db.com/exploits/28713/;classtype:web-application-attack;sid:2017574;rev:3;metadata:created_at 2013_10_09, updated_at 2013_10_09;)", "2020051207": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Jboss \u901a\u8fc7HEAD\u65b9\u5f0f\u4e0a\u4f20\u6587\u4ef6|tag:\u5371\u9669\u884c\u4e3a|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:Jboss \u901a\u8fc7HEAD\u65b9\u5f0f\u4e0a\u4f20\u6587\u4ef6|severity:2|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, jboss_remote_war;content:\"HEAD\";http_method;content:\"/jmx-console/HtmlAdaptor\";http_uri;content:\"action=invokeOp\";http_uri;distance:0;pcre:\"/\\.(war|jsp)/URi\";sid:2020051207;rev:2;)", "2019090299": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DNS\u8fde\u63a5|direction:in|level:action|service_name:Microsoft DNS|service_class:other|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft DNS|server:src\";flow:from_server,established;content:\"|80 f0 80|\";offset:0;depth:3;pcre:\"/^\\x80\\xf0\\x80(\\x80|\\x82|\\x02)\\0\\x01\\0\\0....\\x20CKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\0\\0!\\0\\x01/\";sid:2019090299;gid:0;)", "2020070315": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|tag:\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\".php\";http_uri;content:\"system\";http_client_body;fast_pattern;pcre:\"/\\$_(GET|POST)\\[\\S+\\]/PRi\";sid:2020070315;rev:1;)", "2019090255": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"EInvalid packet length\";depth:22;pcre:\"/^EInvalid packet length\\0$/\";sid:2019090255;gid:0;)", "2008488": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (NULL)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| NULL\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008488;classtype:trojan-activity;sid:2008488;rev:8;)", "2018072700": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:PowerShell\u8fdc\u7a0b\u767b\u5f55\u5c1d\u8bd5|tag:powershell|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u901a\u8fc7PowerShell\uff08http\uff09\u8fdb\u884c\u8fdc\u7a0b\u767b\u9646\u5c1d\u8bd5\uff08set\uff09|failed_by:http_status_3XX,http_status_4XX\";content:\"/wsman?PSVersion=\";http_uri;nocase;content:\"Microsoft WinRM Client\";nocase;http_user_agent;flow:to_server,established;flowbits:set,TB_PowerShell_HTTP;sid:2018072700;rev:1;)", "2027037": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"GgAaQBzACAAcAByAG8AZwByAGEAbQ\";distance:0;fast_pattern;metadata:former_category ATTACK_RESPONSE;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027037;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_03_05, malware_family DNSlivery, updated_at 2019_03_05;)", "2020081450": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08http\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884cipconfig\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"Windows IP \";http_server_body;fast_pattern;content:\" . . . . . . . : \";http_server_body;distance:0;content:\" . . . . . . . . . . . . : \";http_server_body;distance:0;pcre:\"/^(((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(\\.((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3})\\x0d\\x0a\\x20\\x20\\x20/QR\";sid:2020081450;)", "2024213": "alert smb $HOME_NET any -> $HOME_NET any (msg:\"name:\u5229\u7528MS17-010\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u7591\u4f3c\u5b58\u5728\u6c38\u6052\u51a0\u519b\u6f0f\u6d1e\u7684\u5f02\u6b65\u54cd\u5e94 - MS17-010\";flow:from_server,established;flowbits:isset,ET.ETERNALCHAMPIONsync;content:\"|ff|SMB|25 00 00 00 00 98 03 c0 00 00 00 00 00 00 00 00 00 00 00 00|\";offset:4;depth:24;fast_pattern:4,20;content:\"|7c 00|\";distance:32;within:2;content:\"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|\";within:20;content:\"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|\";distance:100;within:20;content:\"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|\";distance:100;within:20;content:\"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|\";distance:100;within:20;content:\"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|\";distance:0;isdataat:!1,relative;metadata:former_category EXPLOIT;classtype:trojan-activity;sid:2024213;rev:2;metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_04_17;)", "2019090015": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Memcached\u8fde\u63a5|direction:in|level:action|service_name:Memcached|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728Memcached|server:src\";flow:from_server,established;content:\"STAT\";depth:4;pcre:\"/^STAT pid \\d+\\r\\nSTAT uptime (\\d+)\\r\\nSTAT time \\d+\\r\\nSTAT version ([.\\d]+) \\(?Ubuntu\\)?\\r\\n/\";sid:2019090015;gid:0;)", "2020051109": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:kindeditor \u5217\u76ee\u5f55\u884c\u4e3a|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:kindeditor \u5217\u76ee\u5f55\u884c\u4e3a|gray:true|attacker:src\";flowbits:set, kindeditor_list;content:\"/kindeditor/\";http_uri;fast_pattern;nocase;content:\"php/file_manager_json.php?path=\";http_uri;nocase;distance:0;flow:to_server,established;sid:2020051109;rev:1;)", "2019090249": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:OpenVPN\u8fde\u63a5|direction:in|level:action|service_name:OpenVPN|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728OpenVPN|server:src\";flow:from_server,established;content:\"|00|<|aa c5|\";depth:4;pcre:\"/^\\0<\\xaa\\xc5\\r\\^\\xf7\\x1b\\xd1\\xe1a/\\xe8\\x17P\\x9dOb\\xbb\\x93\\x87\\xe0\\xf3v\\x81K\\xa4!\\xe6\\xc7\\x01\\x977u5A\\xd1M\\x1b\\;\\xc7\\xcb\\x87\\xb5\\x87\\xf3~\\xc8w\\xef\\xd3\\x87eA\\0\\^\\xbf\\xc5\\x93i\\xf6\\x87$/\";sid:2019090249;gid:0;)", "2020061206": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Shiro \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Apache Shiro \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;flowbits:set, shiro_rce_test;content:\"rememberMe=\";http_cookie;noalert;pcre:\"/^([A-Za-z0-9+\\/]{4}){600}([A-Za-z0-9+\\/]{4})*([A-Za-z0-9+\\/]{4}|[A-Za-z0-9+\\/]{3}=|[A-Za-z0-9+\\/]{2}==)/CR\";sid:2020061206;rev:1;)", "2019090151": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:OpenLDAP\u8fde\u63a5|direction:in|level:action|service_name:OpenLDAP|service_class:auth|severity:1|result:unknown|o_msg:\u5b58\u5728OpenLDAP|server:src\";flow:from_server,established;content:\"0E|02 01 01|a\";depth:6;pcre:\"/^0E\\x02\\x01\\x01a@\\n\\x01\\x02\\x04\\0\\x049historical protocol version requested, use LDAPv3 instead/\";sid:2019090151;gid:0;)", "2020011402": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JBoss \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2010-0739\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JBOSS\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/jmx-console/HtmlAdaptor\";http_uri;within:40;http_content_type;content:\"application/x-www-form-urlencoded\";pkt_data;content:\"action=invokeOpByName\";http_client_body;content:\"name=jboss.deployer\";http_client_body;content:\"argType=java.lang.String\";http_client_body;sid:2020011402;rev:1;)", "2019090193": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([-\\w_.]+) ESMTP PostFix ([\\d.]+)\\r\\n/\";sid:2019090193;gid:0;)", "2020050912": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|dest:home_net|level:attack|phase:exploit|type:shell|severity:3|result:success|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:isset, bingxie_webshell_step2;content:\"POST\";http_method;content:\".asp\";http_uri;isdataat:!1,relative;content:\"ASPSESSIONID\";http_cookie;content:\"Pragma: no-cache\";http_header;content:\"Connection: keep-alive\";http_header;http_content_len;byte_test:0,>,7000,0,string,dec;pkt_data;sid:2020050912;gid:0;rev:1;)", "202099997": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:\u68c0\u6d4bHTTP\u548cweb\u5e94\u7528\u6307\u7eb9|tag:\u626b\u63cf|tool:Nmap|type:infil|direction:in|phase:post_exploit|src:home_net|attacker:src|dest:home_net|level:attack|severity:1|result:unknown|o_msg:NMAP\u626b\u63cf\u68c0\u6d4bHTTP\u548cweb\u5e94\u7528\u6307\u7eb9|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"Nmap NSE\";http_user_agent;sid:202099997;rev:4;)", "2018081323": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u6682\u505c\u9632\u706b\u5899\u8fdb\u7a0b\";dsize:11;flow:from_server,established;content:\"SuspendFW|0D 0A|\";depth:11;nocase;flowbits:isset,TB_ZxShell;sid:2018081323;rev:1;)", "2018000016": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8(base64\u4f20\u8f93)|tag:\u626b\u63cf\u9ed1\u5ba2\u540e\u95e8|dest:home_net|level:attack|phase:exploit|failed_by:http_status_3XX,http_status_4XX|severity:2|result:unknown|o_msg:\u68c0\u6d4b\u5230\u626b\u63cf\u83dc\u5200\u540e\u95e8\u884c\u4e3a(\u9ed1\u5403\u9ed1\u884c\u4e3a)\uff0c\u9ed1\u5ba2\u4ee5\u7206\u7834\u65b9\u5f0f\u5927\u8303\u56f4\u626b\u63cf\u522b\u7684\u9ed1\u5ba2\u7559\u4e0b\u7684\u540e\u95e8|attacker:src\";content:\"POST\";nocase;http_method;content:\"eval\";nocase;http_client_body;content:\"base64_decode\";nocase;http_client_body;distance:0;flowbits:set, caidao_request;flowbits:set,webshell.scan;flow:to_server,established;gid:0;sid:2018000016;rev:1;)", "2020050924": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell\u4ea4\u4e92|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:webshell\u4ea4\u4e92|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, jsp_replace_shell_2;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"<pre>|0a|\";http_server_body;within:6;content:\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\";http_server_body;distance:0;sid:2020050924;gid:0;rev:1;)", "2020061017": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:phpmyadmin \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6(WooYun-2016-199433)|tag:\u6587\u4ef6\u5305\u542b|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:phpmyadmin \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6(WooYun-2016-199433)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, wooyun_2016_199433;content:\"200\";http_stat_code;content:\"phpMyAdmin=\";http_cookie;content:\"<br />|0a|<b>Fatal error</b>\";http_server_body;content:\"Cannot use object of type PMA_Config as array in\";http_server_body;sid:2020061017;rev:1;)", "2018030002": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:AWVS\u626b\u63cf|tag:\u626b\u63cf|tool:AWVS|phase:recon|dest:home_net|level:attack|severity:2|result:unknown|o_msg:\u4f7f\u7528AWVS\u8fdb\u884cweb\u6f0f\u6d1e\u626b\u63cf|attack_type:target|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"|0d 0a|Acunetix-Product:|20|WVS\";nocase;http_raw_header;within:350;flow:to_server,established;sid:2018030002;rev:1;)", "2019090093": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:CuteFTP\u8fde\u63a5|direction:in|level:action|service_name:CuteFTP|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728CuteFTP|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220-\\n220-Welcome to the HOME Edition of GlobalSCAPE CuteFTP Server, which limits\\n/\";sid:2019090093;gid:0;)", "2020072201": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike\u8fde\u63a5|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:3|o_msg:\u5b58\u5728Cobalt Strike \u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;content:\"/submit.php?id=\";http_uri;depth:16;fast_pattern;pcre:\"/^[0-9]{3,6}$/RU\";http_header_names;content:\"|0d 0a|Accept\";depth:8;content:\"|0d 0a|Content-Type|0d 0a|User-Agent|0d 0a|Host|0d 0a|Content-Length|0d 0a|Connection|0d 0a|Cache-Control|0d 0a 0d 0a|\";distance:0;within:80;pkt_data;content:\"Accept: */*|0d 0a|\";http_header;depth:13;http_content_type;content:\"application/octet-stream\";depth:24;isdataat:!1,relative;pkt_data;sid:2020072201;rev:1;)", "2020062304": "alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5efa\u7acb ICMP \u901a\u9053\u4f20\u8f93\u6570\u636e|tag:\u653b\u51fb\u4ee3\u7406|tool:icmpsh|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u653b\u51fb\u8005\u5efa\u7acbICMP\u96a7\u9053\uff0c\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4|attacker:src\";flow:established, from_server;itype:0;icode:0;content:\"whoami\";depth:30;sid:2020062304;rev:1;)", "2018010086": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6587\u4ef6\u5305\u542b\u6cc4\u9732/etc/passwd|tag:\u6587\u4ef6\u5305\u542b|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff0c\u5305\u542b/etc/passwd|dest:home_net|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"=\";nocase;http_uri;pcre:\"/^[.\\\\/]+etc\\/passwd&?/iUR\";flow:to_server,established;flowbits:set, is_etc_pass_vuln;flowbits:noalert;gid:0;sid:2018010086;rev:1;)", "2020041026": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(JRMP)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(JRMP)|attacker:dest\";flow:established, to_server;xbits:isset, weblogic_link_jrmp, track ip_src;content:\"|30 0c 02 01|\";startswith;content:\"|01 60 07 02|\";distance:0;within:4;content:\"|01 03 04 00 80 00|\";distance:0;within:6;sid:2020041026;rev:1;)", "2020071305": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Citrix Netscaler/ADC \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d(CVE-2020-7473)|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|severity:3|result:unknown|phase:exploit|o_msg:Citrix Netscaler/ADC \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d(CVE-2020-7473)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2020_7473_3;content:\"/rapi/filedownload\";http_uri;depth:25;content:\"filter=path:\";http_uri;distance:0;http_content_type;content:\"application/xml\";pkt_data;content:\"SESSID=\";http_cookie;pcre:\"/SESSID=[0-9a-zA-Z]{32}/C\";sid:2020071305;)", "2020072003": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u8bbf\u95ee Tomcat \u6837\u4f8b\u76ee\u5f55|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:recon|severity:1|result:unknown|o_msg:\u5c1d\u8bd5\u8bbf\u95ee Tomcat \u6837\u4f8b\u76ee\u5f55|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, tomcat_examples;content:\"examples/\";http_uri;fast_pattern;pcre:\"/^((servlets\\/chat\\/chat)|(servlets\\/servlet\\/HelloWorldExample)|(servlets\\/servlet\\/RequestInfoExample)|(servlets\\/servlet\\/RequestHeaderExample)|(servlets\\/servlet\\/RequestParamExample)|(servlets\\/servlet\\/CookieExample)|(servlets\\/servlet\\/SessionExample)|(servlets\\/nonblocking\\/bytecounter)|(servlets\\/nonblocking\\/numberwriter)|(servletToJsp)|(jsp\\/jsp2\\/misc\\/config.jsp)|(jsp\\/security\\/protected\\/*)|(async\\/async)|(async\\/stockticker)|(CompressionTest))/UR\";sid:2020072003;rev:1;)", "2020051912": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring SpEL\u8868\u8fbe\u5f0f\u4ee3\u7801\u6ce8\u5165|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Spring SpEL\u8868\u8fbe\u5f0f\u4ee3\u7801\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"T(org.apache.commons.io.IOUtils).toString(\";http_method;sid:2020051912;rev:1;)", "2019090149": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:OpenLDAP\u8fde\u63a5|direction:in|level:action|service_name:OpenLDAP|service_class:auth|severity:1|result:unknown|o_msg:\u5b58\u5728OpenLDAP|server:src\";flow:from_server,established;content:\"02|02 01 01|a\";depth:6;pcre:\"/^02\\x02\\x01\\x01a-\\n\\x01\\x02\\x04\\0\\x04&requested protocol version not allowed$/\";sid:2019090149;gid:0;)", "2020072705": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20(CVE-2019-2618)|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:WebLogic\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20(CVE-2019-2618)|severity:2|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2019_2618;content:\"POST\";http_method;content:\"/bea_wls_deployment_internal/DeploymentService\";http_uri;http_header_names;content:\"|0d 0a|wl_upload_application_name|0d 0a|\";nocase;pkt_data;http_content_type;content:\"multipart\";depth:15;pkt_data;content:\"wl_upload_application_name\";http_header;nocase;content:\"..\";distance:1;within:40;http_header;sid:2020072705;rev:1;)", "2019010083": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7591\u4f3c\u51b0\u874ewebshell|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u51b0\u874e\u7684\u8bf7\u6c42\u5305|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\".php\";http_uri;content:\"=\";http_cookie;pcre:\"/[a-fA-F0-9]{32}/CR\";http_content_len;byte_test:0,>=,7000,0,string,dec;pkt_data;http_accept;content:\"text/html, image/gif, image/jpeg, *\\; q=.2, */*\\; q=.2\";pkt_data;content:\"a\";nocase;http_client_body;pcre:\"/^([a-zA-Z0-9+/]+a[a-zA-Z0-9+=/]+)$/P\";sid:2019010083;gid:0;rev:1;)", "2020062814": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Stowaway-\u53cd\u5411\u4ee3\u7406)|tag:\u653b\u51fb\u4ee3\u7406|tool:Stowaway|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Stowaway-\u53cd\u5411\u4ee3\u7406)\";flow:established, from_server;flowbits:isset, Stowaway_link_type_1_2;content:\"|30 30 30 30 30 30 30 30 30 31 00 00 00 00 00 00|\";offset:16;depth:16;content:\"|00 00 00 30 30 30 30 30 30 30 30 30 30 |\";distance:64;within:13;sid:2020062814;rev:1;)", "2020041027": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2018-2628)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2018-2628)|attacker:src\";flow:established, to_server;flowbits:set, cve_2017_3248_or_2018_2628;xbits:set, weblogic_link_jrmp, track ip_dst, expire 60;content:\"|ac ed 00 05|\";content:\"java.rmi.activation.Activator\";distance:0;content:\"java.rmi.server.RemoteObjectInvocationHandler\";distance:0;content:\"java.rmi.server.RemoteObject\";distance:0;content:\"UnicastRef\";distance:0;sid:2020041027;rev:1;)", "2019090205": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([-\\w_.]+) ESMTP (?:[^(]+? )?\\(Ubuntu\\)\\r\\n502 5\\.5\\.2 Error: command not recognized\\r\\n/\";sid:2019090205;gid:0;)", "2020060225": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(CommonsCollections6-HTTP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"application/\";pcre:\"/(x-www-form-urlencoded)|(x-java-serialized-object)/R\";pkt_data;content:\"|ac ed 00 05|\";http_client_body;fast_pattern;content:\"java.util.Hashtable\";http_client_body;content:\"org.apache.commons.collections.Transformer\";http_client_body;content:\"org.apache.commons.collections.functors.ConstantTransformer\";http_client_body;content:\"org.apache.commons.collections.functors.InvokerTransformer\";http_client_body;content:\"java.util.HashMap\";http_client_body;sid:2020060225;rev:1;)", "2020081421": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08tcp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884c\u547d\u4ee4ll\u6216ls -l\";flow:established;content:\"total \";fast_pattern;content:\"|0a|d\";distance:2;within:80;pcre:\"/^((r|-)(w|-)(x|-)){3}\\s+\\d+\\s\\S+[ ]{2}\\S+[ ]+\\d+\\s/R\";sid:2020081421;)", "2020040801": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Nexus Repository Manager 3 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Repository Manager 3 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/service/extdirect\";http_uri;http_content_type;content:\"application/json\";pkt_data;content:\"\\\"method\\\"\";http_client_body;pcre:\"/\"(create|update)\"/PR\";content:\"\\\"data\\\"\";http_client_body;content:\"\\\"roles\\\"\";http_client_body;distance:0;pcre:\"/\\$(\\\\\\\\.)?\\{/PR\";sid:2020040801;rev:1;)", "2020061801": "alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 (msg:\"name:\u7206\u7834 windows \u8fdc\u7a0b\u684c\u9762\u670d\u52a1|tag:\u7206\u7834\u7834\u89e3|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u653b\u51fb\u8005\u7206\u7834 windows \u8fdc\u7a0b\u684c\u9762\u670d\u52a1\uff0c\u5c1d\u8bd5\u767b\u9646\u8fdc\u7a0b\u684c\u9762|attacker:src\";flow:established, to_server;noalert;flowbits:set, rdp_blasting;content:\"Cookie: mstshash=\";depth:50;sid:2020061801;rev:1;)", "2020041009": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08cve-2019-2729\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08cve-2019-2725\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, weblogic_xmldecode_1;flowbits:set, weblogic_xmldecode_2;content:\"POST\";http_method;http_content_type;content:\"text/xml\";pkt_data;pcre:\"/(\\/_async\\/)|(\\/wls-wsat\\/)/Ii\";content:\"<soapenv:Envelope\";http_client_body;nocase;content:\"<array method=\\\"forName\\\">\";http_client_body;distance:0;nocase;pcre:\"/(oracle\\.toplink\\.internal\\.sessions\\.UnitOfWorkChangeSet)|(com\\.sun.rowset\\.JdbcRowSetImpl)|(org\\.slf4j\\.ext\\.EventData)|(com\\.bea\\.core\\.repackaged\\.springframework\\.context\\.support\\.FileSystemXmlApplicationContext)/PRi\";sid:2020041009;rev:1;)", "2020051906": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Spring Data Rest \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2017-8046\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Spring Data Rest \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2017-8046\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2017_8046;content:\"400\";http_stat_code;http_content_type;content:\"application/hal+json\";pkt_data;content:\"\\\"cause\\\"\";http_server_body;depth:10;content:\"message\";http_server_body;distance:6;content:\"EL1010E: Property or field\";http_server_body;distance:2;sid:2020051906;rev:1;)", "2020051244": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:D-Link DIR-645 \u8eab\u4efd\u8ba4\u8bc1\u7ed5\u8fc7|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:D-Link DIR-645 \u8eab\u4efd\u8ba4\u8bc1\u7ed5\u8fc7|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, d_link_645_auth_bypass;content:\"POST\";http_method;content:\"/getcfg.php\";http_uri;content:\"SERVICES=DEVICE.ACCOUNT\";http_client_body;isdataat:!5, relative;sid:2020051244;rev:2;)", "2018010078": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"select count\";nocase;http_uri;within:1000;content:\"NULL,NULL,NULL,NULL,NULL\";nocase;http_uri;within:152;flow:to_server,established;gid:0;sid:2018010078;rev:1;)", "2809850": "alert dns $HOME_NET any -> any 53 (msg:\"name:Cobalt Strike DNS\u8fde\u63a5|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:\u5b58\u5728Cobalt Strike DNS\u8fde\u63a5\";flow:to_server;dns_query;content:\".stage.\";offset:3;depth:7;pcre:\"/^[a-z]{3}\\.stage\\.\\d{6,10}/i\";threshold:type both, track by_src, count 30, seconds 60;metadata:former_category TROJAN;reference:md5,d370c5360b01054028d0792f7505c1d6;classtype:trojan-activity;sid:2809850;rev:3;metadata:created_at 2015_02_20, updated_at 2018_05_11;)", "2019090285": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DNS\u8fde\u63a5|direction:in|level:action|service_name:Microsoft DNS|service_class:other|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft DNS|server:src\";flow:from_server,established;content:\"|07|version|04|bind\";within:27;pcre:\"/\\x07version\\x04bind\\0\\0\\x10\\0\\x03\\xc0\\x0c\\0\\x10\\0\\x01.{7}Microsoft DNS (10\\.0$)/\";sid:2019090285;gid:0;)", "2006365": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (MYURL)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| MYURL|0d 0a|\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2006365;classtype:trojan-activity;sid:2006365;rev:9;)", "2019000046": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7591\u4f3cwebshell|tag:webshell|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:CVE-2017-10271 Payload\u653b\u51fb\u7cfb\u7edf[1]|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/bea_wls_internal/\";http_uri;pcre:\"/[0-9a-zA-Z]+\\.(jsp)$/iUR\";flowbits:set, weblogic_write_file3;gid:0;sid:2019000046;rev:1;)", "2019090239": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:radmin\u8fde\u63a5|direction:in|level:action|service_name:Radmin|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728Radmin|server:src\";flow:from_server,established;content:\"|01 00 00 00|\";depth:4;pcre:\"/^\\x01\\x00\\x00\\x00\\x25\\x00\\x00\\x02\\x12\\x08\\x02\\x00\\x00\\x0a/\";sid:2019090239;gid:0;)", "2020032101": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Fastjson <=1.2.62 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Fastjson <=1.2.62 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, fastjson_jndi;content:\"@type\";http_client_body;fast_pattern;content:\"br.com.anteros.dbcp.AnterosDBCPConfig\";http_client_body;distance:0;content:\"healthCheckRegistry\";http_client_body;nocase;pcre:\"/(ldap|rmi):\\/\\//PRi\";sid:2020032101;rev:1;)", "2020072704": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Weblogic\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6(CVE-2019-2615)|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|result:success|o_msg:Weblogic\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6(CVE-2019-2615)|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2019_2615;content:\"200\";http_stat_code;http_content_type;content:\"text/plain\";depth:12;pkt_data;content:\"|0d 0a|X-Powered-By: Servlet\";http_header;content:!\"Bad request type:\";http_server_body;sid:2020072704;rev:1;)", "2020051007": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|dest:home_net|level:attack|phase:exploit|type:shell|severity:3|result:success|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:isset, bingxie_webshell_step2;content:\"POST\";http_method;content:\".jspx\";http_uri;isdataat:!1,relative;content:\"JSESSIONID=\";http_cookie;content:\"Pragma: no-cache\";http_header;content:\"Connection: keep-alive\";http_header;http_content_len;byte_test:0,>,8000,0,string,dec;pkt_data;pcre:\"/^([a-zA-Z0-9+/]+a[a-zA-Z0-9+=/]+)$/P\";sid:2020051007;gid:0;rev:1;)", "2020072005": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, weblogic_xmldecode_1;content:\"200\";http_stat_code;content:\"xmldecoder_vul_test\";depth:30;sid:2020072005;rev:1;)", "2018010090": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:NC\u53cd\u5f39SHELL|tag:\u53cd\u5f39shell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|result:success|o_msg:\u5229\u7528redis\u5199shell,\u53cd\u5f39shell\";content:\"bash: no job control in this shell|0a|\";offset:0;dsize:35;flow:to_server,established;xbits:isset, is_redis_exec, track ip_pair;gid:0;sid:2018010090;rev:1;)", "2019010051": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:nosql\u6ce8\u5165(mongo)|tag:nosql\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u901a\u8fc7php\u548cmongodb\u7684\u7279\u6027\u6ce8\u5165\u6761\u4ef6\u8868\u8fbe\u5f0f\u7ed5\u8fc7\u9a8c\u8bc1\uff0c\u6216\u76f2\u6ce8\u51fa\u654f\u611f\u6570\u636e|attacker:src\";flow:to_server,established;content:\"&\";http_uri;pcre:\"/\\w\\[\\$(:?eq|gt|gte|in|lt|lte|ne|nin|and|not|nor|or|exists|type|expr|jsonSchema|mod|regex|text|where|geoIntersects|geoWithin|near|nearSphere|all|elemMatch|size|bitsAllClear|bitsAllSet|bitsAnyClear|bitsAnySet|comment|elemMatch|meta|slice|)\\]/UR\";gid:3;sid:2019010051;)", "2019010050": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:nosql\u6ce8\u5165(mongo)|tag:nosql\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u901a\u8fc7php\u548cmongodb\u7684\u7279\u6027\u6ce8\u5165\u6761\u4ef6\u8868\u8fbe\u5f0f\u7ed5\u8fc7\u9a8c\u8bc1\uff0c\u6216\u76f2\u6ce8\u51fa\u654f\u611f\u6570\u636e|attacker:src\";flow:to_server,established;content:\".php?\";http_uri;pcre:\"/\\w\\[\\$(:?eq|gt|gte|in|lt|lte|ne|nin|and|not|nor|or|exists|type|expr|jsonSchema|mod|regex|text|where|geoIntersects|geoWithin|near|nearSphere|all|elemMatch|size|bitsAllClear|bitsAllSet|bitsAnyClear|bitsAnySet|comment|elemMatch|meta|slice)\\]/UR\";gid:3;sid:2019010050;)", "2020051003": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ASPwebshell\u8fde\u63a5|tag:webshell\u8fde\u63a5|tool:\u83dc\u5200|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|type:shell|o_msg:asp webshell\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, caidao_req;content:\"POST\";http_method;content:\".asp\";http_uri;http_content_type;content:\"application/x-www-form-urlencoded\";pkt_data;http_content_len;byte_test:0,>=,800,0,string,dec;pkt_data;content:\"Connection: keep-alive\";http_header;content:\"Response.Write(\\\"\\\"\\\"\\\"|2d 3e 7c|\\\"\\\"\\\"\\\")\";http_client_body;content:\"Response.Write(\\\"\\\"\\\"\\\"|7c 3c 2d|\\\"\\\"\\\"\\\")\";http_client_body;sid:2020051003;rev:1;)", "2019090130": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/\\+OK E-mail server ready\\.\\r\\n/\";sid:2019090130;gid:0;)", "2008608": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u6728\u9a6cWinFixer\u76f8\u5173User-Agent (ElectroSun)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| ElectroSun \";http_header;reference:url,doc.emergingthreats.net/2008608;classtype:trojan-activity;sid:2008608;rev:8;)", "2020060212": "alert TCP $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(CommonsBeanutils1-TCP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|attacker:src\";flow:established, to_server;content:\"|ac ed 00 05|\";fast_pattern;content:\"java.util.PriorityQueue\";content:\"org.apache.commons.beanutils.BeanComparator\";content:\"com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl\";sid:2020060212;rev:1;)", "2019090244": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:radmin\u8fde\u63a5|direction:in|level:action|service_name:Radmin|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728Radmin|server:src\";flow:from_server,established;content:\"|01 00 00 00|\";depth:4;pcre:\"/^\\x01\\x00\\x00\\x00\\x25\\x04\\x00\\x02\\x12\\x08\\x02\\x00\\x04\\x0a/\";sid:2019090244;gid:0;)", "2018030024": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:W8AY web\u6f0f\u6d1e\u626b\u63cf(\u653b\u51fb\u8005:W8AY)|tag:\u6f0f\u6d1e\u626b\u63cf|tool:w8ay\u626b\u63cf\u5668|phase:recon|dest:home_net|level:attack|severity:2|result:unknown|o_msg:W8AY\u7f16\u5199\u63d2\u4ef6\u6216\u626b\u63cf\u8fdb\u884c\u626b\u63cf\uff0c\u4f5c\u8005\u7f51\u7edcID:w8ay|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"<sCRiPt/SrC=//60.wf/4PrhD>\";nocase;http_user_agent;within:1024;flow:to_server,established;sid:2018030024;rev:1;)", "2018010009": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Struts2\u6f0f\u6d1e\u5229\u7528|tag:Struts\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|success_by:execmd|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Struts2 Jakarta Plugin\u63d2\u4ef6\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u7684payload\u653b\u51fb\u7cfb\u7edf|attacker:src\";flow:to_server,established;content:\"com.opensymphony.xwork2.ActionContext.container\";http_client_body;content:\"com.opensymphony.xwork2.ognl.OgnlUtil@class\";http_client_body;gid:3;sid:2018010009;rev:1;)", "2020021013": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Magento\u53cd\u5e8f\u5217\u5316\u653b\u51fb(SQL\u6ce8\u5165)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Magento\u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Credis_Client\";content:\"*redis\";distance:1;content:\"Mage_Sales_Model_Order_Payment_Transactionr\";distance:1;content:\"Mage_Sales_Model_Order_Payment\";distance:1;content:\"*_expression\";distance:1;content:\"*_resourceName\";distance:1;sid:2020021013;rev:1;)", "2018020040": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u904d\u5386\u76ee\u5f55\u4e2d\u5305\u542bxls\u6587\u4ef6|tag:\u76ee\u5f55\u904d\u5386|direction:in|dest:home_net|src:external_net|level:action|result:success|o_msg:\u68c0\u6d4b\u5230\u76ee\u5f55\u904d\u5386\u884c\u4e3a(IIS)|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"<html><head><title>\";nocase;http_server_body;offset:0;pcre:\"/(^([a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,} - \\/([\\d\\w_-]+\\/)*)</title></head><body><H1>\\1</H1><hr>\\x0d\\x0a\\x0d\\x0a<pre><A HREF/iQR\";content:\"[To Parent Directory]</A><br><br>\";nocase;http_server_body;within:60;content:\".xls</A><br>\";nocase;http_server_body;within:1500;gid:0;sid:2018020040;)", "2019090047": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(SMTP)|direction:in|level:action|service_name:Microsoft Exchange(SMTP)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange Server|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 ([-\\w_.]+) Microsoft Exchange Internet Mail Service ([-\\w_.]+) ready\\r\\n/\";sid:2019090047;gid:0;)", "2020050902": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|dest:home_net|level:attack|phase:exploit|type:shell|severity:3|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, bingxie_webshell;noalert;flowbits:set, bingxie_webshell_step2;content:\"200\";http_stat_code;content:\"PHPSESSID=\";http_cookie;http_content_len;content:\"16\";pkt_data;pcre:\"/^([a-z0-9]{16})$/Q\";isdataat:!1,relative;sid:2020050902;gid:0;rev:1;)", "2020052101": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u5efa\u7acbsocks5\u8fde\u63a5|tag:\u4ee3\u7406|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:unknown|o_msg:\u653b\u51fb\u8005\u8fdb\u5165\u5185\u7f51\u7684\u5e38\u7528\u624b\u6bb5\uff0c\u9700\u8981\u4e00\u53f0\u88ab\u63a7\u5236\u7684\u5916\u7f51\u53ef\u8bbf\u95ee\u4e3b\u673a|gray:true\";flow:established, to_server;flowbits:set, s5_step_1;noalert;dsize:3;content:\"|05 01 00|\";depth:3;sid:2020052101;rev:1;)", "2020032406": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7phpmyadmin\u4fee\u6539\u5168\u5c40\u65e5\u5fd7\u8def\u5f84|tag:\u5371\u9669\u914d\u7f6e|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5c1d\u8bd5\u901a\u8fc7phpmyadmin\u4fee\u6539\u5168\u5c40\u65e5\u5fd7\u8def\u5f84|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, phpmyadmin_exec_sql_success;content:\"POST\";http_method;content:\"/import.php\";http_uri;content:\"sql_query=\";http_client_body;content:\"set+global+general_log_file\";http_client_body;distance:0;nocase;content:\".php\";http_client_body;distance:0;nocase;sid:2020032406;rev:1;)", "2020072808": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u89e3\u6790\u6f0f\u6d1e\u5229\u7528|tag:IIS\u6f0f\u6d1e|phase:exploit|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|success_by:resp_body_upload_success_str|o_msg:Apache \u89e3\u6790\u6f0f\u6d1e\u63a2\u6d4b|attacker:src\";content:\"POST\";http_method;flow:to_server,established;http_content_type;content:\"multipart/form-data\\;\";content:\"boundary=\";pkt_data;content:\"Content-Disposition:\";nocase;http_client_body;pcre:\"/filename=\"[^.\\/]+\\.((php\\d?)|phtml)\\.[a-z0-9]+/PRi\";gid:0;sid:2020072808;rev:1;)", "2019010080": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:php create_function\u6f0f\u6d1e\u5229\u7528|tag:webshell php|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u901a\u8fc7create_function\u95f4\u63a5\u8c03\u7528eval\u89e6\u53d1rce|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\".php\";http_uri;content:\"=\";distance:0;http_client_body;content:\"}\";distance:0;http_client_body;content:\"\\;//\";distance:0;http_client_body;pcre:\"/(?:^|&)\\w+=[\\w\\s@()\\;.'\"_-]*}\\s*@?(?:echo )?(?:system|assert|eval|exec|shell_exec|passthru|popen|proc_open|)\\([\\s\\w'\"$_\\[\\]()%]*?\\)\\s*\\;\\s*\\/[*/]/P\";flowbits:set,php_create_function;sid:2019010080;)", "2019090200": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([\\w._-]+)  ESMTP\\r\\n501 Syntax: EHLO hostname\\r\\n/\";sid:2019090200;gid:0;)", "2018040019": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:dedeCMS\u7684\u6f0f\u6d1e\u626b\u63cf|tag:\u6f0f\u6d1e\u626b\u63cf|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|phase:recon|failed_by:http_status_3XX,http_status_4XX|severity:1|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u5bf9dedeCMS\u7684\u6f0f\u6d1e\u626b\u63cf\";content:\"GET\";nocase;http_method;content:\"/plus/search.php?keyword=as&typeArr[\";nocase;http_uri;within:300;pcre:\"/^\\d+=\\x60\\x5c\\x27\\x60\\)/iUR\";flowbits:set,recon_dedecms;flow:to_server,established;gid:0;sid:2018040019;rev:1;)", "2020050730": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Bash\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:Bash\u6f0f\u6d1e|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"\\;\";http_user_agent;pcre:\"/\\(\\s*\\)\\s*\\{\\s*\\:\\s*\\;\\s*\\}\\s*\\;/V\";sid:2020050730;rev:2;)", "2019090102": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft FTP\u8fde\u63a5|direction:in|level:action|service_name:Microsoft FTP|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft FTP|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220[ -]Microsoft FTP Service\\r\\n/\";sid:2019090102;gid:0;)", "2019090163": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ApacheDS LDAP|direction:in|level:action|service_name:ApacheDS LDAP|service_class:auth|severity:1|result:unknown|o_msg:\u5b58\u5728ApacheDS LDAP|server:src\";flow:from_server,established;content:\"0&|02 01 01|a\";depth:6;pcre:\"/^0&\\x02\\x01\\x01a!\\n\\x01\\x02\\x04\\0\\x04\\x1aOnly LDAP v3 is supported\\.$/\";sid:2019090163;gid:0;)", "2020021021": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Symfony\u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u5199\u6587\u4ef6)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Symfony\u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Symfony\";content:\"Bridge\";distance:1;content:\"PhpUnit\";distance:1;content:\"Legacy\";distance:1;content:\"SymfonyTestsListenerTrait\";distance:1;content:\"SymfonyTestsListenerTraitstate\";distance:1;content:\"php://filter/convert.base64-decode/resource=test\";distance:1;content:\"SymfonyTestsListenerTraitisSkipped\";distance:1;sid:2020021021;rev:1;)", "2020061303": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4e0a\u4f20Behinder webshell|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u4e0a\u4f20Behinder webshell|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"boundary=\";pkt_data;content:\"<jsp\";http_client_body;distance:0;content:\"javax.crypto.\";http_client_body;distance:0;content:\"Cipher.getInstance(\\\"AES\\\")\\;\";http_client_body;distance:0;sid:2020061303;rev:1;)", "2020050901": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|dest:home_net|level:attack|phase:exploit|type:shell|severity:3|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, bingxie_webshell;noalert;content:\"GET\";http_method;content:\".php?\";http_uri;pcre:\"/[\\w.$@!%_-]+=\\d{3}$/iUR\";isdataat:!1,relative;content:\"Connection: keep-alive\";http_header;sid:2020050901;gid:0;rev:1;)", "2019020003": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:FTP\u767b\u5f55\u6210\u529f|tag:ftp|direction:in|src:external_net|dest:home_net|level:action|severity:1|result:success|o_msg:FTP\u767b\u5f55\u6210\u529f\";flow:established,to_server;content:\"USER\";nocase;offset:0;depth:4;flowbits:isset,send_220;flowbits:set,send_user;noalert;gid:3;sid:2019020003;)", "2027042": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"1hcmdvcnAgc2\";distance:0;fast_pattern;metadata:former_category ATTACK_RESPONSE;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027042;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_03_05, malware_family DNSlivery, updated_at 2019_03_05;)", "2008797": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (miip)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| miip|0d 0a|\";http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008797;classtype:trojan-activity;sid:2008797;rev:8;)", "2020070702": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DVR\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e(CVE-2018-9995)|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:DVR\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e(CVE-2018-9995)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2018_9995;content:\"200\";http_stat_code;content:\"|0d 0a|Server: \";http_header;content:\" rsp\";http_header;distance:0;within:20;content:\"\\\"result\\\":0\";depth:20;http_server_body;content:\"\\\"uid\\\":\";http_server_body;distance:4;within:100;content:\"\\\"pwd\\\":\";http_server_body;distance:0;sid:2020070702;rev:1;)", "2020062308": "alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5efa\u7acb ICMP \u901a\u9053\u4f20\u8f93\u6570\u636e|tag:\u653b\u51fb\u4ee3\u7406|tool:icmpsh|direction:in|dest:external_net|src:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u653b\u51fb\u8005\u5efa\u7acbICMP\u96a7\u9053\uff0c\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4|attacker:dest\";flow:established, to_server;itype:8;icode:0;content:\"net user\";depth:30;sid:2020062308;rev:1;)", "2019090267": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"E|00 00 00|\";depth:4;pcre:\"/^E\\0\\0\\0.S[^\\0]+\\0C0A000\\0M\\?\\?\\?\\?\\?\\?\\?\\?\\?\\?\\?\\?\\?\\?\\?\\? \\?\\?\\?\\?\\?\\?\\?\\? \\?\\?\\?\\?\\?\\?\\?\\?\\?\\?\\? \\?\\?\\?\\?\\?\\?\\?\\?\\?\\? 65363\\.19778\\; \\?\\?\\?\\?\\?\\? \\?\\?\\?\\?\\?\\?\\?\\?\\?\\?\\?\\? 1\\.0 - 3\\.0 \\0Fpostmaster\\.c\\0L1695\\0RProcessStartupPacket\\0\\0$/\";sid:2019090267;gid:0;)", "202099998": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:\u68c0\u6d4bHTTP\u548cweb\u5e94\u7528\u6307\u7eb9|tag:\u626b\u63cf|tool:Nmap|type:infil|direction:in|phase:post_exploit|src:home_net|attacker:src|dest:home_net|level:attack|severity:1|result:unknown|o_msg:NMAP\u626b\u63cf\u68c0\u6d4bHTTP\u548cweb\u5e94\u7528\u6307\u7eb9|failed_by:http_status_3XX,http_status_4XX\";content:\"Mozilla/5.0 (compatible|3b| Nmap Scripting Engine\";nocase;http_user_agent;depth:46;flow:to_server,established;sid:202099998;rev:5;)", "2018081322": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u8fdb\u884c\u7aef\u53e3\u6620\u5c04\";dsize:10;flow:from_server,established;content:\"rPortMap|0D 0A|\";depth:10;nocase;flowbits:isset,TB_ZxShell;sid:2018081322;rev:1;)", "2013331": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Ruskill\u540e\u95e8\u6728\u9a6c|type:rat|tag:Ruskill|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230Ruskill\u53d1\u9001\u672c\u5730\u626b\u63cf\u62a5\u544a\";flow:established,to_server;content:\"PRRVMSG\";depth:7;content:\"Port Scan started on\";distance:0;content:\"with a delay of\";distance:0;classtype:trojan-activity;sid:2013331;rev:1;)", "2020030007": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u8681\u5251\u8fde\u63a5webshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:unknown|o_msg:\u8681\u5251\u8fde\u63a5webshell|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"function%20asenc(%24out)%7Breturn%20%24out%3B%7D%3B\";http_client_body;content:\"asoutput()%3Bdie()%3B\";http_client_body;flowbits:set, first_packet_send;flowbits:noalert;sid:2020030007;)", "2020060208": "alert TCP $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(C3P0-TCP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|attacker:src\";flow:established, to_server;content:\"|ac ed 00 05|\";fast_pattern;content:\"com.mchange.v2.c3p0.PoolBackedDataSource\";content:\"impl.PoolBackedDataSourceBasInumHelperThreadsLconnectionPoolDataSourcet\";content:\"com.mchange.v2.naming.ReferenceIndirector$ReferenceSerialized\";sid:2020060208;rev:1;)", "2019090114": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(imap)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"* OK \";depth:5;pcre:\"/^\\* OK \\[CAPABILITY IMAP4rev1 SORT THREAD=REFERENCES MULTIAPPEND UNSELECT LITERAL\\+ IDLE CHILDREN NAMESPACE LOGIN-REFERRALS [^\\]]+\\]/\";sid:2019090114;gid:0;)", "2019090076": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Serv-U\u8fde\u63a5|direction:in|level:action|service_name:Serv-U|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728Serv-U|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 Serv-U FTP-Server v([-\\w_.]+ build \\d+) for WinSock ready\\.\\.\\.\\r\\n/\";sid:2019090076;gid:0;)", "2019010076": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fc7phpmyadmin\u65e5\u5fd7getshell|tag:phpmyadmin|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u901a\u8fc7phpmyadmin\u65e5\u5fd7getshell|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"{\";http_server_body;pcre:\"/\\\"variable\\\":\\\"\\w+.php\\\",\\\"message\\\":\\\"([\\w_-]+)?\\\",\\\"success\\\":true[^}]+}/QR\";flowbits:isset, phpmyadmin_edit_logname;flowbits:unset, phpmyadmin_edit_logname;gid:4;sid:2019010076;)", "2020010017": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u8fbeOA\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20|tag:\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u901a\u8fbeOA\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, tongda_upload;content:\"POST\";http_method;content:\"/ispirit/im/upload.php\";http_uri;http_content_type:content: \"multipart/form-data\";pkt_data;content:\"name=\\\"P\\\"\";http_client_body;sid:2020010017;rev:1;)", "2018010108": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165\u8bfb\u53d6\u6587\u4ef6|tag:\u6ce8\u5165\u8bfb\u6587\u4ef6|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:\u5c1d\u8bd5\u5229\u7528MySQL\u6ce8\u5165\u8bfb\u53d6\u6587\u4ef6|attacker:src\";content:\"union\";nocase;http_header;pcre:\"/[(\\/\\*.*\\*\\/)| ]select/iHR\";content:\"load_file(\";nocase;http_header;distance:1;within:40;flow:to_server,established;gid:0;sid:2018010108;rev:1;)", "2809851": "alert tcp $HOME_NET any -> any 53 (msg:\"name:Cobalt Strike DNS(tcp)\u8fde\u63a5|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:\u5b58\u5728Cobalt Strike DNS\u8fde\u63a5\";flow:to_server;dns_query;content:\".stage.\";offset:3;depth:7;pcre:\"/^[a-z]{3}\\.stage\\.\\d{6,10}/i\";threshold:type both, track by_src, count 30, seconds 60;reference:md5,d370c5360b01054028d0792f7505c1d6;classtype:trojan-activity;sid:2809851;rev:3;metadata:created_at 2015_02_20, updated_at 2016_10_18;)", "2018040023": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:AspCMS\u7684\u6f0f\u6d1e\u626b\u63cf|tag:\u6f0f\u6d1e\u626b\u63cf|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|phase:recon|failed_by:http_status_3XX,http_status_4XX|severity:1|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u5bf9AspCMS\u7684\u6f0f\u6d1e\u626b\u63cf\";content:\"GET\";nocase;http_method;content:\"AspCms_AboutEdit.asp?id=\";nocase;http_uri;within:300;pcre:\"/^\\d+\\sand\\s+\\d=\\d\\s+union\\s+select\\s+(\\d,)+loginname/iUR\";flow:to_server,established;gid:0;sid:2018040023;rev:1;)", "2020061814": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528goby\u626b\u63cf\u5668\u626b\u63cf|tag:\u626b\u63cf\u5668|dest:home_net|level:attack|phase:recon|severity:3|result:unknown|tool:goby|o_msg:\u4f7f\u7528goby\u626b\u63cf\u5668\u8fdb\u884c\u626b\u63cf\uff0c\u5904\u4e8e\u6f0f\u6d1e\u626b\u63cf\u9636\u6bb5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\".action\";http_uri;within:100;content:\"name=\";http_client_body;depth:10;fast_pattern;content:\"println%28%27d4d85d5d36%27%2b%2706002e87ff%27%2b%27add1e049d0a6%27%29%29\";http_client_body;sid:2020061814;rev:1;)", "2020010046": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u6267\u884c\u547d\u4ee4|tag:\u6267\u884c\u547d\u4ee4|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:2|result:success|o_msg:web\u9875\u9762\u6267\u884c\u547d\u4ee4ls|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"|0a|d\";http_server_body;fast_pattern;pcre:\"/^((r|-)(w|-)(x|-)){3} {1,3}\\d{1,4}\\s/QR\";flowbits:isset,post_req;sid:2020010046;rev:1;)", "2019030004": "alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5229\u7528ngrok\u8fdb\u884c\u5185\u7f51\u7a7f\u900f|tag:tunnel|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|tool:ngrok|result:success|o_msg:\u4e0e\u516c\u7f51ngrok\u670d\u52a1\u5668\u901a\u8fc7tls\u5efa\u7acb\u63a7\u5236\u8fde\u63a5\uff0c\u53ef\u7528\u6765\u8fdb\u884c\u5185\u7f51\u7a7f\u900f\";flow:established,to_client;tls_cert_issuer;content:\"inconshreveable\";flowbits:isset,ngrok_state_findsni;flowbits:unset,ngrok_state_findsni;sid:2019030004;)", "2019090157": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:LDAP\u8fde\u63a5|direction:in|level:action|service_name:LDAP|service_class:auth|severity:1|result:unknown|o_msg:\u5b58\u5728LDAP|server:src\";flow:from_server,established;content:\"0|0c 02 01 01|a\";depth:6;pcre:\"/^0\\x0c\\x02\\x01\\x01a\\x07\\n\\x01\\0\\x04\\0\\x04\\0/\";sid:2019090157;gid:0;)", "2018010089": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Redis\u672a\u6388\u6743\u6f0f\u6d1e\u5229\u7528|tag:\u672a\u6388\u6743\u6f0f\u6d1e\u5229\u7528|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Redis\u56e0\u914d\u7f6e\u4e0d\u5f53\u53ef\u4ee5\u672a\u6388\u6743\u8bbf\u95ee\u3002\u653b\u51fb\u8005\u65e0\u9700\u8ba4\u8bc1\u8bbf\u95ee\u5230\u5185\u90e8\u6570\u636e|attacker:dest\";content:\"|2b 4f 4b 0d 0a|\";offset:0;dsize:5;flow:from_server,established;flowbits:isset, redis_shell_req_1;flowbits:set, redis_shell_req_2;xbits:set, is_redis_exec, track ip_pair;gid:0;sid:2018010089;rev:1;)", "180129200": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:BillGates_DDoS|type:rat|tag:BillGates|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u6728\u9a6c\u540e\u95e8Linux.DDOS.BillGates\u4e0a\u7ebf\u5305\";dsize:90<>150;flow:from_client,established;content:\"|01 00 00 00|\";depth:4;content:\"|00 00 00 00 00 00 00 00|\";distance:4;within:37;content:\"Linux|20|\";offset:88;depth:6;sid:180129200;rev:1;)", "2834762": "alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Cobalt Strike Beacon SSL\u8bc1\u4e66\u4f20\u8f93|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|dest:home_net|src:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike Beacon SSL\u8bc1\u4e66\u4f20\u8f93\";flow:established,from_server;tls_cert_subject;content:\"CN=tracker.ntt-corporation.com\";nocase;isdataat:!1,relative;metadata:former_category TROJAN;reference:md5,8dce7567944752bc47604fccdf1cc323;classtype:trojan-activity;sid:2834762;rev:1;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2019_02_06, malware_family Cobalt_Strike, performance_impact Low, updated_at 2019_09_28;)", "2019060025": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"ASPSESSIONID\";http_cookie;pcre:\"/[a-zA-Z]+=[a-zA-Z0-9]{24}/CR\";http_content_len;byte_test:0,=,16,0,string,dec;pkt_data;content:\"a\";nocase;http_server_body;within:16;pcre:\"/^([a-f0-9A-F]{16})$/Q\";isdataat:!1,relative;noalert;flowbits:isset, bingxie_webshell_asp;flowbits:set, bingxie_webshell_step2_asp;sid:2019060025;gid:0;rev:1;)", "2008504": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (SUiCiDE/1.5)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| SUiCiDE\";http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008504;classtype:trojan-activity;sid:2008504;rev:7;)", "2019090026": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:VNC\u8fde\u63a5|direction:in|level:action|service_name:VNC|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728VNC|server:src\";flow:from_server,established;content:\"RFB\";depth:3;pcre:\"/^RFB 003\\.00(\\d)\\n\\0\\0\\0\\0\\0\\0\\0kVNC Server is not licensed correctly\\.\\n\\nConnections will be prohibited until a valid license key is applied\\./\";sid:2019090026;gid:0;)", "2020081713": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Metasploit \u8fde\u63a5(tcp)|tag:\u53cd\u5f39shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|attack_type:target|result:success|o_msg:Metasploit \u8fde\u63a5(windows/meterpreter/bind_tcp)|gray:true\";flow:to_server, established;xbits:isset, msf_reverser_response, track ip_pair;content:\"MZ\";depth:2;content:\"This program cannot be run in DOS mode.\";distance:0;within:200;sid:2020081713;)", "2018040007": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7aef\u53e3\u626b\u63cf|tag:\u626b\u63cf|tool:ScanPort,Nmap|type:\u6307\u7eb9\u63a2\u6d4b|direction:in|phase:recon|src:external_net|dest:home_net|level:attack|severity:1|result:unknown|o_msg:\u4f7f\u7528ScanPort/Nmap -A\u8fdb\u884c\u7aef\u53e3\u626b\u63cf\";ttl:128;fragbits:*D;dsize:0;flags:S,CE;ack:0;window:64240;threshold:type both, track by_src, count 10, seconds 1;gid:0;sid:2018040007;)", "2020060403": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ThinkPHP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:ThinkPHP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, tp_5_rce_1;content:\"s=/index/\\\\think\\\";http_uri;depth:100;nocase;sid:2020060403;rev:1;)", "2019011118": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7591\u4f3c\u5bf9\u5916\u7206\u7834SSH|direction:out|src:external_net|dest:home_net|level:attack|severity:2|phase:attack_out|result:unknown|o_msg:\u5b58\u5728\u5185\u5411\u5916\u7684\u9ad8\u9891SSH\u767b\u5f55\u884c\u4e3a\uff0c\u7591\u4f3cSSH\u7206\u7834\uff0c\u5224\u65ad\u4e3a\u5185\u90e8\u4e3b\u673a\u9ad8\u9891\u767b\u5f55\u5916\u7f51\u4e3b\u673a\";flow:to_server,established;content:\"SSH\";depth:3;pcre:\"/^SSH-([\\d.]+)-OpenSSH[_-]([\\S ]+)/i\";threshold:type threshold, track by_src, count 10, seconds 1;sid:2019011118;gid:0;)", "2020071306": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Citrix Netscaler/ADC \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d(CVE-2020-7473)|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|severity:3|result:success|phase:exploit|o_msg:Citrix Netscaler/ADC \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d(CVE-2020-7473)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2020_7473_3;content:\"406\";http_stat_code;content:\"|0d 0a|Content-Disposition: attachment\\;filename=\";http_header;content:\"|0d 0a|Accept-Ranges: bytes|0d 0a|\";http_header;content:\"|0d 0a|Pragma: private|0d 0a|\";http_header;http_content_type;content:\"application/octet-stream\";pkt_data;sid:2020071306;)", "2004443": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (KKTone)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| KKTone\";nocase;http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2004443;classtype:trojan-activity;sid:2004443;rev:9;)", "2024297": "alert tcp $HOME_NET any -> $HOME_NET 445 (msg:\"name:\u5229\u7528MS17-010\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728\u6c38\u6052\u4e4b\u84dd\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a - MS17-010\";flow:established,to_server;content:\"|80 00 a8 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff 00 00 00 00 00 00 ff ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f1 df ff 00 00 00 00 00 00 00 00 20 f0 df ff 00 f1 df ff ff ff ff ff 60 00 04 10 00 00 00 00 80 ef df ff |\";metadata:former_category CURRENT_EVENTS;reference:cve,CVE-2017-0143;classtype:attempted-admin;sid:2024297;rev:1;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_05_16, performance_impact Low, updated_at 2017_05_16;)", "2020061901": "alert tcp $HOME_NET 11211 -> $EXTERNAL_NET any (msg:\"name:Memcache \u4fe1\u606f\u6cc4\u9732|tag:\u4fe1\u606f\u6cc4\u9732|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Memcache \u5bf9\u5916\u7f51\u5f00\u653e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u8fde\u63a5Memcache\uff0c\u6267\u884cMemcache\u547d\u4ee4|failed_by:http_status_3XX, http_status_4XX|attacker:dest\";flow:established, from_server;content:\"STAT pid \";depth:30;content:\"|0d 0a|STAT uptime \";distance:0;content:\"|0d 0a|STAT time \";distance:0;content:\"|0d 0a|STAT version \";distance:0;content:\"|0d 0a|STAT libevent \";distance:0;content:\"|0d 0a|STAT pointer_size \";distance:0;content:\"|0d 0a|STAT rusage_user \";distance:0;content:\"|0d 0a|STAT rusage_system \";distance:0;sid:2020061901;rev:1;)", "2018041909": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6697\u591c\u7cbe\u7075\u540e\u95e8\u6728\u9a6c|type:rat|tag:NightElf|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6c\u6697\u591c\u7cbe\u7075\u5fc3\u8df3\u5305\";dsize:1;content:\"|20|\";threshold:type both, track by_src, count 10, seconds 300;flow:from_server;flowbits:isset,TB_NightElf;sid:2018041909;rev:1;)", "2020070312": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|tag:\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\".php\";http_uri;content:\"eval\";http_uri;fast_pattern;distance:0;pcre:\"/\\$_(GET|POST)\\[\\S+\\]/URi\";sid:2020070312;rev:1;)", "2020062804": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u670d\u52a1\u5668\u88ab\u4e0a\u4f20 Neo-reGeorg \u4ee3\u7406\u6587\u4ef6|tag:\u653b\u51fb\u4ee3\u7406|tool:Neo-reGeorg|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:4|result:unknown|o_msg:\u670d\u52a1\u5668\u88ab\u4e0a\u4f20 Neo-reGeorg \u4ee3\u7406\u6587\u4ef6|attacker:dest|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, access_script_file_get;content:\"|0d 0a|Connection: Keep-Alive|0d 0a|\";http_header;http_content_len;byte_test:0,>=,11,0,string,dec;byte_test:0,<=,75,0,string,dec;pkt_data;http_content_type;content:\"text/html\";pkt_data;content:\"<!-- \";depth:5;http_server_body;pcre:\"/^<!-- [A-Za-z0-9_]{2,66} -->$/Q\";sid:2020062804;rev:1;)", "2020041002": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2017-10271\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2017-10271\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, weblogic_xmldecode_1;content:\"POST\";http_method;http_content_type;content:\"text/xml\";pkt_data;pcre:\"/(\\/_async\\/)|(\\/wls-wsat\\/)/Ii\";content:\"<soapenv:Envelope\";http_client_body;nocase;content:\"<void \";http_client_body;distance:0;nocase;content:\"class=\";http_client_body;distance:0;nocase;pcre:\"/(sun\\.misc\\.BASE64Decoder)|(weblogic\\.utils\\.Hex)|(java\\.lang\\.ProcessBuilder)|(java\\.lang\\.Runtime)|(java\\.lang\\.String)|(java\\.io\\.PrintWriter)|(java\\.beans\\.XMLDecoder)|(java\\.lang\\.Thread)/PRi\";sid:2020041002;rev:1;)", "2019090046": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(SMTP)|direction:in|level:action|service_name:Microsoft Exchange(SMTP)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange Server|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 ([-\\w_.]+) Microsoft Exchange Internet Mail Service ([-\\w_.]+) ready\\r\\n/\";sid:2019090046;gid:0;)", "2019090291": "alert tcp $HOME_NET any -> $EXTERNAL_NET 5938 (msg:\"name:\u4f7f\u7528Teamviewer|direction:in|src:home_net|dest:external_net|level:action|service_name:Teamviewer|severity:1|service_class:rlogin|result:unknown|o_msg:\u4f7f\u7528Teamviewer\u8fde\u63a5|server:src\";dsize:83;flow:to_server,established;content:\"|11 30 3c 00 3b 00 00 00|\";depth:8;content:\"|1b 00 00 00 18 00 00 00|\";distance:8;within:8;gid:2;sid:2019090291;rev:1;)", "2020030001": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u8681\u5251\u8fde\u63a5webshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u8681\u5251\u8fde\u63a5webshell|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"yvahk\";nocase;http_server_body;content:\"HGP\";nocase;distance:0;http_server_body;flowbits:isset,first_packet_send;flowbits:unset,first_packet_send;sid:2020030001;)", "2019000071": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ThinkPHP 6.0 \u4efb\u610f\u6587\u4ef6\u521b\u5efa\u6f0f\u6d1e|tag:\u4efb\u610f\u6587\u4ef6\u521b\u5efa|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:ThinkPHP 6.0 \u4efb\u610f\u6587\u4ef6\u521b\u5efa\u6f0f\u6d1e|attacker:src\";flow:established, to_server;flowbits:set, thinkphp_upload;content:\"phpsession=\";http_cookie;nocase;content:\"..%2F\";http_cookie;distance:0;sid:2019000071;rev:1;)", "2020052105": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:SSRF \u6f0f\u6d1e\u5229\u7528|tag:\u670d\u52a1\u7aef\u8bf7\u6c42\u4f2a\u9020|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:unknown|o_msg:SSRF \u6f0f\u6d1e\u5229\u7528\uff0c\u4f7f\u7528gopher\u534f\u8bae\u6784\u9020\u8bf7\u6c42\u5305|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\"=\";http_uri;content:\"gopher://\";http_uri;distance:0;pcre:\"/(GET|POST) /UR\";content:\"HTTP/\";http_uri;offset:4;sid:2020052105;rev:1;)", "2019010134": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"select count\";nocase;http_client_body;content:\"NULL,NULL,NULL,NULL,NULL\";nocase;http_client_body;within:152;flow:to_server,established;gid:0;sid:2019010134;rev:1;)", "2018041200": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u7070\u9e3d\u5b502.03\u540e\u95e8\u6728\u9a6c|type:rat|tag:hupigon|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6c\u7070\u9e3d\u5b502.03\u4e0a\u7ebf\u5305\";dsize:296;flow:to_server,established;content:\"|00 00 00|\";offset:37;depth:3;pcre:\"/Windows .+\\(.+?\\)((2[0-4]\\d|25[0-5]|[01]?\\d\\d?)\\.){3}(2[0-4]\\d|25[0-5]|[01]?\\d\\d?)\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00.+HGZV\\x00\\x00$/R\";flowbits:set,TB_huigezi_2.03;sid:2018041200;rev:1;)", "2838728": "alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Cobalt Strike\u53cd\u5f39\u8bf7\u6c42|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|dest:home_net|src:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike DNS\u53cd\u5f39\";flow:established,from_server;tls_cert_subject;content:\"CN=cdn.redirectme.net\";nocase;isdataat:!1,relative;metadata:former_category MALWARE;reference:md5,91710b59c243c5cce86175ff598e8c78;classtype:trojan-activity;sid:2838728;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2019_10_03, malware_family Cobalt_Strike, performance_impact Low, updated_at 2019_10_03;)", "2018030018": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ASP\u654f\u611f\u6587\u4ef6\u626b\u63cf|tag:\u626b\u63cf|tool:\u5317\u6781\u718a\u626b\u63cf\u5668|phase:recon|dest:home_net|level:attack|severity:2|result:unknown|o_msg:\u4f7f\u7528\u5317\u6781\u718a\u626b\u63cf\u5668\u8fdb\u884c\u626b\u63cfasp\u654f\u611f\u6587\u4ef6\uff0c\u5305\u62ec\u540e\u53f0\u6216\u6f0f\u6d1e\u7a0b\u5e8f\u7684\u6838\u5fc3\u6587\u4ef6\uff0c\u5317\u6781\u718a\u626b\u63cf\u5668\u662f\u5e7f\u5dde\u767d\u72d0\u516c\u53f8\u5f00\u53d1\u7684\u5355\u673a\u626b\u63cf\u5668|attacker:src\";content:\"GET\";nocase;content:\".asp\";pcre:\"/\\.(asp|aspx)$/iU\";content:\"Accept: */*|0d 0a|User-Agent: Mozilla/4.0 (compatible\\;Win32\\;WinHttp.WinHttpRequest.5)|0d 0a|Host:\";nocase;http_raw_header;offset:0;pcre:\"/[\\d\\w._-]+(\\x0d\\x0a)Connection: (Keep-Alive\\x0d\\x0a)$/iDR\";flow:to_server,established;threshold:type both, track by_src, count 40, seconds 1;sid:2018030018;rev:1;)", "2019010109": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ThinkCMF \u4efb\u610f\u5185\u5bb9\u5305\u542b\u6f0f\u6d1e|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:ThinkCMF \u4efb\u610f\u5185\u5bb9\u5305\u542b\u6f0f\u6d1e|attacker:src\";flow:to_server,established;flowbits:set, thinkcmf_include_file;content:\"GET\";http_method;content:\"a=fetch\";http_uri;content:\"content=\";http_uri;content:\"php\";http_uri;distance:0;content:\"file_put_contents\";http_uri;distance:1;sid:2019010109;rev:1;)", "2024351": "alert tcp $HOME_NET any -> $EXTERNAL_NET [25,2525,587] (msg:\"name:Executioner\u52d2\u7d22|type:rat|tag:Executioner\u52d2\u7d22|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u52d2\u7d22\u8f6f\u4ef6Executioner\u901a\u8fc7SMTP\u4e0a\u62a5\u611f\u67d3\";flow:established,to_server;dsize:<40;content:\"DECRYPT CODE|20 3a 20 20 20 20 20 20 20|\";fast_pattern;depth:21;reference:md5,eec4f84d12139add6d6ebf3b8c72fff7;classtype:trojan-activity;sid:2024351;rev:1;)", "2020050916": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c|tag:\u6267\u884c\u547d\u4ee4|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884c\u547d\u4ee4ll\u6216ls -l|failed_by:http_status_3XX,http_status_4XX\";flowbits:isset, post_req;flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"total \";http_server_body;fast_pattern;content:\"|0a|d\";http_server_body;distance:2;within:80;pcre:\"/^((r|-)(w|-)(x|-)){3}\\s+\\d+\\s\\S+[ ]{2}\\S+[ ]+\\d+\\s/QR\";sid:2020050916;gid:0;rev:1;)", "2020081721": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528AWVS\u626b\u63cf|tag:\u626b\u63cf\u5668|dest:home_net|level:attack|phase:recon|severity:2|result:unknown|o_msg:\u4f7f\u7528AWVS\u8fdb\u884c\u626b\u63cf|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"acunetix_wvs_security_test\";http_header;sid:2020081721;rev:1;)", "2008705": "alert tcp $HOME_NET any -> $HOME_NET 445 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";flow:established,to_server;content:\"|1F 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"|00 2E 00 2E 00 5C 00 2E 00 2E 00 5C|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008705;classtype:attempted-admin;sid:2008705;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2020061005": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Drupal \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2018-7602\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Drupal \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2018-7602\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"destination=/user\";http_uri;pcre:\"/%5B%2523(access_callback|pre_render|post_render|lazy_builder)%5D/Ii\";sid:2020061005;rev:1;)", "2020062905": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:reDuh \u4ee3\u7406\u6587\u4ef6\u8fde\u63a5\u6210\u529f|tag:\u653b\u51fb\u4ee3\u7406|tool:reDuh|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:reDuh \u4ee3\u7406\u6587\u4ef6\u8fde\u63a5\u6210\u529f|attacker:dest|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, reDuh_link_1;content:\"200\";http_stat_code;content:\"Success testing port \";http_server_body;sid:2020062905;rev:1;)", "2019090251": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:OpenVPN\u8fde\u63a5|direction:in|level:action|service_name:OpenVPN|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728OpenVPN|server:src\";flow:from_server,established;content:\".|83|&SU\";depth:5;pcre:\"/^\\.\\x83&SU\\xe3_\\xd5V\\x01\\0\\0\\0\\0\\0\\x010\\x02\\xfd\\xa8\\xe3\\0/\";sid:2019090251;gid:0;)", "2020051931": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee(metrics)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, spring_actuator_metrics;content:\"/actuator/metrics\";http_uri;sid:2020051931;rev:1;)", "2018080301": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Struts2\u6f0f\u6d1e|type:attack_out|tag:Struts2\u6f0f\u6d1e|direction:out|src:home_net|dest:external_net|level:attack|phase:attack_out|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5bf9\u5916\u4f7f\u7528Struts2 Jakarta Plugin\u63d2\u4ef6\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2017-5638\uff09\u7684payload\u653b\u51fb\u7cfb\u7edf|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"com.opensymphony.xwork2.ActionContext.container\";http_header;content:\"com.opensymphony.xwork2.ognl.OgnlUtil@class\";http_header;sid:2018080301;rev:1;)", "2019090223": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:qmail\u8fde\u63a5|direction:in|level:action|service_name:Qmail(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728qmail pop3|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK <\\d{1,5}\\.10\\d{8}@[-.\\w]+>\\r\\n$/\";sid:2019090223;gid:0;)", "2018112614": "alert smb $HOME_NET any -> $HOME_NET 445 (msg:\"name:\u6c38\u6052\u6d6a\u6f2b\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u6c38\u6052\u6d6a\u6f2b\u7684\u6f0f\u6d1e\u5229\u7528\";content:\"|ff 53 4d 42 26|\";offset:4;depth:5;threshold:type threshold,track by_src,count 10,seconds 1;flowbits:isset,WRITE_ANDX_REQUEST;sid:2018112614;)", "2019090005": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MySQL\u8fde\u63a5|direction:in|level:action|service_name:MySQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728MySQL|server:src\";flow:from_server,established;content:\"|00 00 00|\";offset:1;depth:3;pcre:\"/^.\\0\\0\\0\\x0a(4\\.[-_~.+\\w]+)\\0/\";sid:2019090005;gid:0;)", "2019090039": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:VNC\u8fde\u63a5|direction:in|level:action|service_name:VNC|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728VNC|server:src\";flow:from_server,established;content:\"RFB\";depth:3;pcre:\"/^RFB 003\\.00(\\d)\\n\\0\\0\\0\\0\\0\\0\\0(jServer|nVNC Server) license key is missing, invalid or has expired\\.\\nVisit http://www\\.realvnc\\.com to purchase a licence\\./\";sid:2019090039;gid:0;)", "2019090228": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Courier\u8fde\u63a5|direction:in|level:action|service_name:Courier(imap)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Courier imap|server:src\";flow:from_server,established;content:\"* OK\";depth:4;pcre:\"/^\\* OK.*?Courier-IMAP ready\\. Copyright 1998-(\\d+) Double Precision, Inc\\.  See COPYING for distribution information\\.\\r\\n/\";sid:2019090228;gid:0;)", "2019090177": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Hmail\u8fde\u63a5|direction:in|level:action|service_name:Hmail(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Hmail|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK \\(POP3\\) hMailServer ([-\\w.]+)\\r\\n/\";sid:2019090177;gid:0;)", "2016958": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528java\u4ee3\u7801\u6ce8\u5165|tag:Struts\u6f0f\u6d1e|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|success_by:execmd|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528\u901a\u7528java\u4ee3\u7801\u6ce8\u5165|attacker:src\";flow:to_server,established;http_content_type;content:!\"boundary=\";pkt_data;content:\"java.io.FileOutputStream\";http_client_body;nocase;content:\".write\";distance:0;nocase;http_client_body;content:\"sun.misc.BASE64Decoder\";nocase;http_client_body;reference:url,struts.apache.org/development/2.x/docs/s2-013.html;classtype:attempted-user;sid:2016958;flowbits:set,cmd_reponse_echo;rev:3;metadata:created_at 2013_05_31, updated_at 2013_05_31;)", "2019090178": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Hmail\u8fde\u63a5|direction:in|level:action|service_name:Hmail(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Hmail|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK POP3\\r\\n-ERR Invalid command in current state\\.\\r\\n/\";sid:2019090178;gid:0;)", "2019090080": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Serv-U\u8fde\u63a5|direction:in|level:action|service_name:Serv-U|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728Serv-U|server:src\";flow:from_server,established;content:\"421\";depth:3;pcre:\"/^421 Server is temporarily unavailable - please try again later\\.\\r\\n421 Service closing control connection\\.\\r\\n/\";sid:2019090080;gid:0;)", "2020051304": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7591\u4f3c\u9488\u5bf9\u6df1\u4fe1\u670dVPN\u7684\u653b\u51fb\u884c\u4e3a|tag:\u6df1\u4fe1\u670dVPN|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:unknown|o_msg:\u7591\u4f3c\u9488\u5bf9\u6df1\u4fe1\u670dVPN\u7684\u653b\u51fb\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"/por/?\";http_uri;depth:8;content:\"rnd=http\";http_uri;distance:0;within:10;content:\"://\";http_uri;distance:0;within:8;sid:2020051304;gid:0;rev:1;)", "2020070322": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cfWebshell\u540e\u95e8|tag:\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:\u626b\u63cfWebshell\u540e\u95e8|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\".php\";http_uri;content:\"<script language=\";http_uri;fast_pattern;nocase;distance:0;pcre:\"/echo|eval|system|phpinfo|md5|die|assert|call_user_func|print|file_put_contents/URi\";sid:2020070322;rev:1;)", "2019090021": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:RDP\u8fde\u63a5|direction:in|level:action|service_name:RDP|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728RDP|server:src\";flow:from_server,established;content:\"|03 00 00|\";depth:3;pcre:\"/^\\x03\\0\\0\\x0b\\x06\\xd0\\0\\0\\x03.\\0$/\";sid:2019090021;gid:0;)", "2020051111": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ewebeditor \u5c1d\u8bd5\u4e0b\u8f7d\u6570\u636e\u5e93\u6587\u4ef6|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:ewebeditor \u5c1d\u8bd5\u4e0b\u8f7d\u6570\u636e\u5e93\u6587\u4ef6|attacker:src\";flow:to_server,established;content:\"/ewebeditor/\";http_uri;fast_pattern;nocase;content:\"/db/ewebeditor.mdb\";http_uri;nocase;distance:0;sid:2020051111;rev:1;)", "2020052500": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6076\u610fhttp server\u642d\u5efa|tag:shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u9ed1\u5ba2\u5229\u7528python\u642d\u5efa\u5c0f\u578b\u7684http server\u6765\u4e0b\u8f7dpayload\uff0c\u4f20\u8f93\u6587\u4ef6\u3002\u4e34\u65f6\u4f7f\u7528\u7528\u5b8c\u5220\u9664\u3002|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"Server: SimpleHTTP/\";http_header;pcre:\"/^(\\d\\.\\d Python\\/\\d\\.\\d\\.\\d)/HR\";sid:2020052500;rev:1;)", "2027029": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"aXMgcHJvZ3J\";distance:0;fast_pattern;metadata:former_category ATTACK_RESPONSE;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027029;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_03_05, malware_family DNSlivery, updated_at 2019_03_05;)", "2020051901": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:vBulletin \u524d\u53f0sql\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2020-12720\uff09|tag:SQL\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:vBulletin \u524d\u53f0sql\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2020-12720\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2020_12720;content:\"POST\";http_method;content:\"/ajax/api/content_infraction/getIndexableContent\";http_uri;content:\"nodeId%5Bnodeid%5D=\";http_client_body;pcre:\"/select|union|order|convert|concat|group_concat|sleep|waitfor|substr|updatexml/PRi\";sid:2020051901;rev:1;)", "2020020601": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:apache flink\u4e0a\u4f20jar\u5305|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:apache flink\u4e0a\u4f20jar\u5305|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, flink_upload_jar;content:\"POST\";http_method;content:\"/jars/upload\";http_uri;startswith;content:\" name=\\\"jarfile\\\"\";http_client_body;sid:2020020601;rev:1;)", "2027043": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"WFyZ29ycCBzaW\";distance:0;fast_pattern;metadata:former_category ATTACK_RESPONSE;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027043;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_03_05, malware_family DNSlivery, updated_at 2019_03_05;)", "2020070106": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Termite-\u6b63\u5411\u4ee3\u7406)|tag:\u653b\u51fb\u4ee3\u7406|tool:Termite|dest:home_net|level:attack|phase:exploit|type:exploit|severity:4|result:unknown|o_msg:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Termite-\u6b63\u5411\u4ee3\u7406)|attacker:src\";flow:established, to_server;flowbits:set, termite_link_type_1;dsize:125;content:\"|03 00 00 00 00 00 00 00|\";depth:8;content:\"|01 00 00 00 00 00 00 00|\";distance:0;within:8;content:\"|6c 00 00 00 00 00 00 00|\";distance:0;within:8;content:\"|01 61 64 6d 69 6e 00 00|\";distance:0;within:8;sid:2020070106;rev:1;)", "2019090022": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:RDP\u8fde\u63a5|direction:in|level:action|service_name:RDP|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728RDP|server:src\";flow:from_server,established;content:\"|03 00 00|\";depth:3;pcre:\"/^\\x03\\0\\0\\x11\\x08\\x02..}\\x08\\x03\\0\\0\\xdf\\x14\\x01\\x01$/\";sid:2019090022;gid:0;)", "2020060203": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:cobaltstrike \u4e3b\u673a\u4e0a\u7ebf(http)|tag:cobaltstrike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|result:unknown|o_msg:cobaltstrike \u4e3b\u673a\u4e0a\u7ebf(http)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;http_accept;content:\"*/*\";pkt_data;content:!\"imapi.5211game.com\";http_host;content:\"a\";nocase;http_cookie;pcre:\"/^([A-Za-z0-9+\\/]){171}=$/C\";sid:2020060203;rev:1;)", "2020060809": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ActiveMQ\u7269\u7406\u8def\u5f84\u6cc4\u6f0f\u6f0f\u6d1e|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:ActiveMQ\u7269\u7406\u8def\u5f84\u6cc4\u6f0f\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, activemq_pwd;content:\"PUT\";http_method;content:\"fileserver\";http_uri;content:\"/../%08/\";http_raw_uri;distance:0;sid:2020060809;rev:1;)", "2019010033": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring Data Commons\u8fdc\u7a0b\u6267\u884c|tag:\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:exploit|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Spring Data Commons\u8fdc\u7a0b\u6267\u884c|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/users?page=&size=5\";http_uri;content:\"username[#this.getClass().forName(\\\"java.lang.Runtime\\\").getRuntime().exec\";http_client_body;startswith;sid:2019010033;gid:0;)", "2019000052": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528sqlmap --os-shell\u53c2\u6570getshell|tag:sqlmap|tool:sqlmap|dest:home_net|level:attack|phase:exploit|result:success|o_msg:\u4f7f\u7528sqlmap --os-shell\u53c2\u6570|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;xbits:isset, sqlmap_os_shell, track ip_pair;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"<pre>command execution test\";http_server_body;sid:2019000052;rev:1;)", "2806278": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u60e0\u666eIMC\u6f0f\u6d1e\u5229\u7528|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:2|gray:true|result:unknown|o_msg:\u60e0\u666eIMC\u6f0f\u6d1e\u5229\u7528|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"/fault/\";http_uri;content:\"/download?fileName=\";http_uri;content:\"|2e 2e 2f|\";depth:200;reference:cve,2012-5202;reference:bugtraq,58675;reference:url,www.zerodayinitiative.com/advisories/ZDI-13-051/;classtype:attempted-admin;sid:2806278;rev:2;metadata:created_at 2013_04_19, updated_at 2013_04_19;)", "2018040013": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:\u626b\u63cf\u9ed1\u5ba2\u540e\u95e8|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|failed_by:http_status_3XX,http_status_4XX|phase:recon|severity:2|result:unknown|o_msg:\u68c0\u6d4b\u5230\u626b\u63cf\u540e\u95e8\u884c\u4e3a(\u9ed1\u5403\u9ed1\u884c\u4e3a)\uff0c\u9ed1\u5ba2\u4ee5\u7206\u7834\u65b9\u5f0f\u5927\u8303\u56f4\u626b\u63cf\u522b\u7684\u9ed1\u5ba2\u7559\u4e0b\u7684\u540e\u95e8\";content:\"POST\";nocase;http_method;content:\"=execute\";nocase;http_client_body;within:21;pcre:\"/\\bexecute(\\+)*\\b/iP\";flowbits:set, caidao_request;flowbits:set,webshell.scan;flow:to_server,established;gid:0;sid:2018040013;rev:1;)", "2018010112": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|attacker:src\";content:\"=DBMS_PIPE.RECEIVE_MESSAGE(\";nocase;http_header;within:2000;pcre:\"/(chr\\(\\d{2,3})+/iHR\";flow:to_server,established;gid:0;sid:2018010112;rev:1;)", "2019060031": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"ASP.NET_SessionId=\";http_cookie;pcre:\"/[a-zA-Z0-9]{24}/CR\";http_content_len;byte_test:0,=,16,0,string,dec;pkt_data;content:\"b\";nocase;http_server_body;within:16;pcre:\"/^([a-f0-9A-F]{16})$/Q\";isdataat:!1,relative;noalert;flowbits:isset, bingxie_webshell_aspx;flowbits:set, bingxie_webshell_step2_aspx;sid:2019060031;gid:0;rev:1;)", "2019070006": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ThinkPHP\u6f0f\u6d1e|tag:ThinkPHP\u6f0f\u6d1e\u5229\u7528|direction:out|src:home_net|dest:external_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:attack_out|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728ThinkPHP\u6f0f\u6d1e\";content:\"GET\";nocase;http_method;content:\"/index.php\";nocase;http_uri;within:100;pcre:\"/(\\/)?\\?s=(\\/)?index\\/\\\\think\\\\view\\\\driver\\\\Php\\/display&content=/iUR\";flow:to_server,established;gid:0;sid:2019070006;rev:1;)", "2018041914": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6781\u5149\u540e\u95e8\u6728\u9a6c|type:rat|tag:jiguang2009|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6c\u6781\u51492009\u5fc3\u8df3\u5305\";flow:from_server,established;dsize:1;content:\"|00|\";depth:1;flowbits:isset,TB_jiguang2009;threshold:type both, track by_dst, count 29, seconds 300;sid:2018041914;rev:1;)", "2018081302": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u8fdb\u884c\u767b\u9646\u64cd\u4f5c\";dsize:70<>350;flow:to_server,established;content:\"-\";depth:20;content:\"@\";distance:1;pcre:\"/@((2[0-4]\\d|25[0-5]|[01]?\\d\\d?)\\.){3}(2[0-4]\\d|25[0-5]|[01]?\\d\\d?)/R\";content:\"OS:\";distance:0;nocase;content:\"CPU:\";distance:0;nocase;content:\"MHz\";distance:0;nocase;content:\"RAM:\";distance:0;nocase;flowbits:set,TB_ZxShell;sid:2018081302;rev:1;)", "2018030027": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Burpsuite\u653b\u51fb\u5c1d\u8bd5|tag:web\u6f0f\u6d1e\u626b\u63cf|tool:burpsuite|phase:recon|dest:home_net|level:attack|severity:2|result:unknown|o_msg:\u4f7f\u7528burp\u8fdb\u884c\u5404\u79cdweb\u6f0f\u6d1e\u653b\u51fb\u5c1d\u8bd5|failed_by:http_status_3XX,http_status_4XX|attack_type:target|attacker:src\";content:\"POST\";nocase;http_method;content:\"@burpcollaborator.net\";nocase;http_uri;within:1024;pcre:\"/[\\d\\w]{30,40}@burpcollaborator.net/iU\";flow:to_server,established;sid:2018030027;rev:1;)", "2018060002": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6267\u884c\u547d\u4ee4ifconfig|tag:\u547d\u4ee4\u6267\u884c|direction:in|severity:4|dest:home_net|src:external_net|level:attack|phase:control|type:shell|result:success|o_msg:\u547d\u4ee4\u6267\u884cifconfig|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"Link encap:Ethernet  HWaddr\";nocase;http_server_body;within:200;flowbits:isset,cmd;gid:0;sid:2018060002;rev:1;)", "2020051917": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee(beans)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, spring_actuator_beans;content:\"/actuator/beans\";http_uri;sid:2020051917;rev:1;)", "2020071304": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Citrix Netscaler/ADC \u8ba4\u8bc1\u7ed5\u8fc7(CVE-2020-7473)|tag:\u6743\u9650\u7ed5\u8fc7|dest:home_net|level:attack|severity:3|result:success|phase:exploit|o_msg:Citrix Netscaler/ADC \u8ba4\u8bc1\u7ed5\u8fc7(CVE-2020-7473)\u3010step_2\u3011|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2020_7473_step_2;content:\"200\";http_stat_code;content:\"<title>Citrix ADC - Configuration</title>\";http_server_body;sid:2020071304;)", "2020041007": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:webshell\u6267\u884cnet user|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset,weblogic_xmldecode_1;content:\"200\";http_stat_code;http_content_len;byte_test:0,<,7,0,string,dec;pkt_data;content:\"oracle\";http_server_body;sid:2020041007;)", "180621002": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PlugX8\u540e\u95e8\u6728\u9a6c|type:rat|tag:PlugX8|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5df2\u77e5\u540e\u95e8Backdoor.Win32.PlugX8\u7684CnC\u8fde\u63a5\";flow:to_server,established;content:\"POST /update?id=\";offset:0;depth:16;content:\"X0|3a|\";offset:48;depth:3;content:\"X1|3a|\";offset:64;depth:6;content:\"X2|3a|\";offset:70;depth:6;content:\"X3|3a|\";offset:80;depth:6;classtype:trojan-activity;sid:180621002;rev:1;)", "2019030010": "alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528ngrok\u8fdb\u884c\u5185\u7f51\u7a7f\u900f|tag:tunnel|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|tool:ngrok|result:unknown|o_msg:\u5c1d\u8bd5\u4e0e\u516c\u7f51ngrok\u670d\u52a1\u5668\u5efa\u7acb\u63a7\u5236\u8fde\u63a5\uff0c\u53ef\u7528\u6765\u8fdb\u884c\u5185\u7f51\u7a7f\u900f\";flow:established,to_server;tls_sni;content:\"tunnel.eu.ngrok.com\";flowbits:set,ngrok_state_findsni;flowbits:noalert;sid:2019030010;)", "2019090305": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:CouchDB\u8fde\u63a5|direction:in|level:action|service_name:CouchDB|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728CouchDB|failed_by:http_status_3XX,http_status_4XX|server:dest\";flow:from_server,established;content:\"200\";http_stat_code;content:\"Server: CouchDB|2f|\";http_raw_header;pcre:\"/Server: CouchDB/([\\w._-]+) \\(Erlang ([^)]*)\\)/H\";sid:2019090305;gid:0;)", "2011399": "alert tcp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:\"name:Yoyo-DDoS|type:botnet|tag:Yoyo-DDoS|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u50f5\u5c38\u7f51\u7edcYoyo-DDoS\u5bb6\u65cf\u4e0b\u8f7d\u6267\u884c\u53ef\u6267\u884c\u6587\u4ef6\u6d88\u606f\";flow:established,from_server;dsize:124;content:\"|00 00 00 04|http|3a|//\";depth:11;reference:url,asert.arbornetworks.com/2010/08/yoyoddos-a-new-family-of-ddos-bots/;classtype:trojan-activity;sid:2011399;rev:4;)", "2020050605": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:SaltStack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2020-11651,CVE-2020-11652)|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:SaltStack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2020-11651,CVE-2020-11652)\u3010\u6267\u884c\u547d\u4ee4\u3011|severity:3|attacker:src\";flow:to_server, established;flowbits:set, cve_2020_11651_rce_2;content:\"enc|a5|clear|a4|load\";pcre:\"/cmd._send_pub.fun.cmd.run/R\";sid:2020050605;rev:2;)", "2020052504": "alert dns $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528h.i.ydscan.net\u8fdb\u884c\u53cd\u5f39|tag:dnslog|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u5229\u7528dnslog\u8fdb\u884c\u53cd\u5f39|attacker:dest\";flow:established, to_server;dns_query;content:\".h.i.ydscan.net\";pkt_data;sid:2020052504;rev:1;)", "2019876": "alert ssh $HOME_NET any -> $HOME_NET any (msg:\"name:\u7206\u7834SSH|direction:in|dest:home_net|src:home_net|level:attack|phase:post_exploit|severity:2|result:unknown|o_msg:\u5b58\u5728SSH\u7206\u7834\u884c\u4e3a|type:infil\";flow:established,to_server;ssh_proto;content:\"PUTTY\";threshold:type limit, track by_src, count 1, seconds 30;metadata:former_category SCAN;classtype:network-scan;sid:2019876;rev:6;metadata:created_at 2014_12_05, updated_at 2017_12_01;)", "2020082007": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08http\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884cnetsh firewall show config\u547d\u4ee4|gray:true|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\":|0d 0a|-------------------------------------------------------------------|0d 0a|\";http_server_body;content:\"\\\"netsh firewall\\\" \";http_server_body;distance:0;content:\"\\\"netsh advfirewall firewall\\\" \";http_server_body;distance:0;sid:2020082007;)", "2009355": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (runUpdater.html)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| runUpdater|2e|html\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/2009355;classtype:trojan-activity;sid:2009355;rev:8;)", "2018040025": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHPunit\u7684\u8fdc\u7a0b\u5199webshell\u6f0f\u6d1e\u5c1d\u8bd5|tag:\u6f0f\u6d1e\u626b\u63cf|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|phase:recon|failed_by:http_status_3XX,http_status_4XX|severity:1|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u5bf9PHPunit\u7684\u8fdc\u7a0b\u5199webshell\u6f0f\u6d1e\u5c1d\u8bd5\";content:\"POST\";nocase;http_method;content:\"/phpunit/src/Util/PHP/eval-stdin.php\";nocase;http_uri;within:300;content:\"<?php\";nocase;http_client_body;within:80;pcre:\"/\\s+file_put_contents\\('/iPR\";flow:to_server,established;gid:0;sid:2018040025;rev:1;)", "2019010148": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:SQLMAP|tag:SQLMAP\u6ce8\u5165|tool:SQLMAP|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:\u5229\u7528SQLMAP\u5de5\u5177\u8fdb\u884c\u6ce8\u5165|attack_type:target|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"union all select \";nocase;http_client_body;pcre:\"/\\d,null,/iPR\";content:\"'<script>alert(\\\"XSS\\\")</script>',table_name FROM information_schema.tables WHERE \";nocase;http_client_body;distance:0;pcre:\"/\\d>\\d--\\/\\*\\*\\/\\;EXEC xp_cmdshell/iPR\";flow:to_server,established;gid:0;sid:2019010148;rev:1;)", "20198003": "alert tcp $HOME_NET any -> $EXTERNAL_NET !3389 (msg:\"name:lcx\u7aef\u53e3\u6620\u5c04|tag:\u7aef\u53e3\u6620\u5c04|direction:lateral|type:infil|src:home_net|dest:external_net|level:attack|phase:post_exploit|severity:3|gray:|result:success|o_msg:\u53d1\u73b0\u9ed1\u5ba2\u5de5\u5177lcx.exe\u5c06\u5185\u7f51\u4e3b\u673a\u7aef\u53e3\u6620\u5c04\u5230\u5916\u7f51\";dsize:19;flow:established,to_server;flowbits:isset, lcx_syn;content:\"|03 00 00 0b 06 d0 00|\";offset:0;sid:20198003;rev:1;)", "2018010103": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u904d\u5386\u4e0a\u5c42\u76ee\u5f55|tag:\u904d\u5386\u76ee\u5f55|level:attack|phase:exploit|severity:1|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u5c1d\u8bd5\u904d\u5386\u4e0a\u5c42\u76ee\u5f55\u5305\u542b/windows/win.ini|dest:home_net|attacker:src\";content:\"POST\";nocase;http_method;content:\"/windows/win.ini\";nocase;http_uri;within:1024;flow:to_server,established;gid:0;sid:2018010103;rev:1;)", "2019090219": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:qmail\u8fde\u63a5|direction:in|level:action|service_name:Qmail|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728qmail|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220  ESMTP\\r\\n214 qmail home page: http://pobox\\.com/~djb/qmail\\.html\\r\\n/\";sid:2019090219;gid:0;)", "2019010135": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"=DBMS_PIPE.RECEIVE_MESSAGE(CHR(\";nocase;http_client_body;pcre:\"/(chr\\(\\d{2,3})+/iPR\";flow:to_server,established;gid:0;sid:2019010135;rev:1;)", "2020081724": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528Netsparker\u626b\u63cf|tag:\u626b\u63cf\u5668|dest:home_net|level:attack|phase:recon|severity:2|result:unknown|o_msg:\u4f7f\u7528Netsparker\u8fdb\u884c\u626b\u63cf|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"X-Scanner: Netsparker\";http_header;sid:2020081724;rev:1;)", "2018010048": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:SQLMAP|tag:SQLMAP\u6ce8\u5165|tool:SQLMAP|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:\u5229\u7528SQLMAP\u5de5\u5177\u8fdb\u884c\u6ce8\u5165|attack_type:target|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"sqlmap\";nocase;http_user_agent;flow:to_server,established;gid:0;sid:2018010048;rev:1;)", "2020050723": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ElasticSearch \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:success|o_msg:ElasticSearch \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, es_rce;content:\"200\";http_stat_code;http_content_type;content:\"application/json\";pkt_data;content:\"successful\";http_server_body;content:\"hits\";http_server_body;distance:0;content:\"fields\";http_server_body;distance:0;sid:2020050723;rev:2;)", "2020022702": "alert tcp $HOME_NET 21 -> $EXTERNAL_NET any (msg:\"name:Proftpd mod_copy\u6a21\u5757\u547d\u4ee4\u672a\u6388\u6743\u8c03\u7528\uff08CVE-2015-3306\uff09|tag:\u672a\u6388\u6743\u8c03\u7528|src:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:Proftpd mod_copy\u6a21\u5757\u547d\u4ee4\u672a\u6388\u6743\u8c03\u7528\uff08CVE-2015-3306\uff09|attacker:dest\";flow:established, from_server;flowbits:isset, cve_2015_3306_cpfr;content:\"350 File\";content:\" or directory exists, ready for destination name\";distance:0;sid:2020022702;rev:1;)", "20258061": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:payload\u4e2d\u5305\u542bbase64\u540e\u7684/bin/bash|tag:payload|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u653b\u51fbpayload\u4e2d\u4f7f\u7528base64\u7f16\u7801\u540e\u7684/bin/bash|attacker:src\";flow:to_server,established;content:\"vYmluL2Jhc2\";http_client_body;metadata:former_category EXPLOIT;classtype:attempted-user;sid:20258061;rev:2;metadata:attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2020072802": "alert tcp $HOME_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528DcomExec\u8c03\u7528\u6267\u884c\u547d\u4ee4|tag:\u8fdc\u7a0b\u63a7\u5236|tool:dcomexec|src:home_net|dest:home_net|level:attack|phase:exploit|attacker:src|result:success|severity:4|o_msg:\u4f7f\u7528dcomexec\u8c03\u7528\u6267\u884c\u547d\u4ee4\";flow:established, to_server;content:\"NTLMSSP\";fast_pattern;content:\"E|00|x|00|e|00|c|00|u|00|t|00|e|00|S|00|h|00|e|00|l|00|l|00|C|00|o|00|m|00|m|00|a|00|n|00|d|00|\";distance:0;content:\"c|00|m|00|d|00 2e 00|e|00|x|00|e\";distance:0;sid:2020072802;rev:1;)", "2019000043": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528\u6f0f\u6d1e\u6267\u884c\u547d\u4ee4|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u68c0\u6d4b\u5230\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"flags=\";http_server_body;pcre:\"/[0-91-z]{3,8}: flags=\\d{3,9}/Q\";content:\"inet \";http_server_body;pcre:\"/\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\s+netmask\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\sbroadcast\\s+\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}/QR\";pcre:\"/\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}/RQ\";content:\"inet6 \";http_server_body;pcre:\"/[0-9a-f]{4}::[0-9a-f]{4}:[0-9a-f]{4}:[0-9a-f]{4}:[0-9a-f]{4}/QR\";flowbits:isset,cmd_reponse_echo;sid:2019000043;)", "2020070212": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Hadoop Yarn REST API\u672a\u6388\u6743\u8bbf\u95ee\u653b\u51fb|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Hadoop Yarn REST API\u672a\u6388\u6743\u8bbf\u95ee\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, hadoop_yarn_unauth;content:\"/ws/v1/cluster/apps\";fast_pattern;http_uri;http_content_type;content:\"application/json\";pkt_data;content:\"\\\"application-type\\\"\";http_client_body;content:\"\\\"YARN\\\"\";http_client_body;distance:1;within:10;content:\"\\\"commands\\\"\";http_client_body;content:\"\\\"command\\\"\";http_client_body;distance:2;within:20;sid:2020070212;rev:1;)", "2019090037": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:VNC\u8fde\u63a5|direction:in|level:action|service_name:VNC|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728VNC|server:src\";flow:from_server,established;content:\"RFB\";depth:3;pcre:\"/^RFB 003.130\\n$/\";sid:2019090037;gid:0;)", "2020021701": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u53cd\u5411\u4ee3\u7406\u8fde\u63a5\u5c1d\u8bd5|tag:\u53cd\u5411\u4ee3\u7406|dest:external_net|src:home_net|level:action|severity:2|result:unknown|o_msg:\u53cd\u5411\u4ee3\u7406\u8fde\u63a5\";flow:established, to_server;flowbits:set, rssock_link;dsize:6;content:\"|01 01|\";offset:0;depth:2;content:\"|00 00 00 00|\";distance:0;within:4;sid:2020021701;rev:1;)", "2020070202": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u653b\u51fb|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u7591\u4f3c JNDI \u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, fastjson_jndi;xbits:set, jdni_link_jrmp, track ip_dst, expire 20;content:\"POST\";http_method;http_content_type;content:!\"application/x-amf\";pkt_data;content:\"rmi://\";http_client_body;fast_pattern;nocase;pcre:\"/rmi\\:\\/\\/(((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(\\.((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3})|([a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+\\.?)/Pi\";sid:2020070202;rev:1;)", "2020021005": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Guzzle \u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u5199\u6587\u4ef6)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Guzzle \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"GuzzleHttp\";content:\"Cookie\";distance:1;content:\"FileCookieJar\";distance:1;content:\"FileCookieJarfilename\";distance:1;content:\"FileCookieJarstoreSessionCookies\";distance:1;content:\"CookieJarcookies\";distance:1;content:\"SetCookie\";distance:1;content:\"SetCookiedata\";distance:1;content:\"CookieJarstrictMode\";distance:1;sid:2020021005;rev:1;)", "2018010116": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6d4b\u8bd5SQL\u6ce8\u5165\u6f0f\u6d1e|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|attacker:src\";content:\"and\";nocase;http_header;pcre:\"/and[(%20)| ]\\d[(%3d)|=]\\d/H\";flow:to_server,established;gid:0;sid:2018010116;rev:1;)", "2020010048": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Jenkins\u5efa\u7acb\u53cc\u5411\u901a\u9053|tag:\u5371\u9669\u884c\u4e3a|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:Jenkins\u5efa\u7acb\u53cc\u5411\u901a\u9053|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, jenkins_build_cli;content:\"200\";http_stat_code;content:\"Starting HTTP duplex channel\";http_server_body;content:\"<===[JENKINS REMOTING CAPACITY]===>\";distance:0;sid:2020010048;rev:1;)", "2019090198": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 smtp-sink ESMTP\\r\\n$/\";sid:2019090198;gid:0;)", "2020060211": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(CommonsBeanutils1-HTTP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"application/\";pcre:\"/(x-www-form-urlencoded)|(x-java-serialized-object)/R\";pkt_data;content:\"|ac ed 00 05|\";http_client_body;fast_pattern;content:\"java.util.PriorityQueue\";http_client_body;content:\"org.apache.commons.beanutils.BeanComparator\";http_client_body;content:\"com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl\";http_client_body;sid:2020060211;rev:1;)", "2020060224": "alert TCP $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(CommonsCollections6-TCP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|attacker:src\";flow:established, to_server;content:\"|ac ed 00 05|\";fast_pattern;content:\"java.util.HashSet\";content:\"org.apache.commons.collections.keyvalue.TiedMapEntry\";content:\"org.apache.commons.collections.map.LazyMap\";content:\"org.apache.commons.collections.Transformer\";content:\"org.apache.commons.collections.functors.ConstantTransformer\";content:\"org.apache.commons.collections.functors.InvokerTransformer\";sid:2020060224;rev:1;)", "2018050002": "alert tcp $EXTERNAL_NET any -> $HOME_NET 3306 (msg:\"name:\u4f7f\u7528UDF\u63d0\u6743|tag:\u63d0\u6743|direction:in|src:external_net|dest:home_net|level:attack|severity:4|phase:control|o_msg:\u68c0\u6d4b\u5230\u4f7f\u7528Mysql UDF\u63d0\u6743\";content:\"create\";nocase;offset:4;pcre:\"/\\s+function\\s+[\\d\\w]+\\s+returns\\s+string\\s+soname\\s+[\"'](udf|lib_mysqludf_sys)\\.(so|dll)['\"]/iR\";gid:0;sid:2018050002;rev:1;)", "2020072807": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u89e3\u6790\u6f0f\u6d1e\u5229\u7528|tag:IIS\u6f0f\u6d1e|phase:exploit|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|success_by:resp_body_upload_success_str|o_msg:Apache \u89e3\u6790\u6f0f\u6d1e\u63a2\u6d4b|attacker:src\";content:\"POST\";http_method;flow:to_server,established;http_content_type;content:\"multipart/form-data\\;\";content:\"boundary=\";pkt_data;content:\"Content-Disposition:\";nocase;http_client_body;pcre:\"/filename=\\\"[^.\\/]+\\.[a-z0-9]+%00\\.php/PRi\";gid:0;sid:2020072807;rev:1;)", "2017120100": "alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:\"name:\u5efa\u7acb\u901a\u4fe1\u96a7\u9053|type:tunneling|tag:DNS\u96a7\u9053|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:2|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u7578\u5f62\u7684DNS\u8bf7\u6c42\uff08TXT\u7c7b\u578b\uff09\";content:!\"|00|\";offset:12;depth:1;byte_test:1, >, 63, 12, big;content:\"|00 10 00 01|\";isdataat:!5, relative;sid:2017120100;rev:1;)", "2020060217": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(CommonsCollections3-HTTP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"application/\";pcre:\"/(x-www-form-urlencoded)|(x-java-serialized-object)/R\";pkt_data;content:\"|ac ed 00 05|\";http_client_body;fast_pattern;content:\"sun.reflect.annotation.AnnotationInvocationHandler\";http_client_body;content:\"org.apache.commons.collections.map.LazyMap\";http_client_body;content:\"sun.reflect.annotation.AnnotationInvocationHandler\";http_client_body;sid:2020060217;rev:1;)", "2020051107": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:kindeditor 4.1.5 \u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:kindeditor 4.1.5 \u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e|gray:true|attacker:src\";flowbits:set, kindeditor_upload;flow:to_server,established;content:\"POST\";startswith;content:\"/kindeditor/\";http_uri;nocase;fast_pattern;pcre:\"/(asp\\/upload_json\\.asp)|(asp\\.net\\/upload_json\\.ashx)|(jsp\\/upload_json\\.jsp)|(php\\/upload_json\\.php)/URi\";content:\"filename=\";http_client_body;pcre:\"/\\.(asp|jsp|php|ashx|html)/PRi\";sid:2020051107;rev:1;)", "2020061012": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, tp_5_rce_1;content:\"200\";http_stat_code;http_content_len;content:\"17\";pkt_data;http_content_type;content:\"text/html\";pkt_data;content:\"www-data|0a|www-data\";http_server_body;depth:17;isdataat:!1, relative;sid:2020061012;rev:1;)", "2018050003": "alert tcp $EXTERNAL_NET any -> $HOME_NET 3306 (msg:\"name:\u4f7f\u7528MOF\u63d0\u6743|tag:\u63d0\u6743|direction:in|src:external_net|dest:home_net|level:attack|severity:4|phase:control|o_msg:\u68c0\u6d4b\u5230\u4f7f\u7528Mysql MOF\u63d0\u6743\";content:\"select\";nocase;offset:4;pcre:\"/\\s+load_file\\(['\"]\\w:[\\w\\d\\\\]+\\.mof['\"]\\)\\s+into\\s+dumpfile\\s+['\"]\\w:\\/[\\w]+\\/[\\w\\d]+\\/wbem\\/mof\\/nullevt\\.mof['\"]/iR\";gid:0;sid:2018050003;rev:1;)", "2019000060": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Jenkins\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2018-1000861\uff09|tag:\u5371\u9669\u884c\u4e3a|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Jenkins\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2017-1000353\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2018_1000861;content:\"200\";http_stat_code;content:\"X-Content-Type-Options: nosniff\";http_header;content:\"Server: Jetty\";http_header;content:\"<div/>\";http_server_body;within:8;isdataat:!1, relative;sid:2019000060;rev:1;)", "2020051001": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u83dc\u5200webshell\u8fde\u63a5|tag:webshell\u8fde\u63a5|tool:\u83dc\u5200|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|type:shell|o_msg:jsp webshell\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, caidao_req;noalert;content:\"POST\";http_method;content:\".jsp\";http_uri;http_content_type;content:\"application/x-www-form-urlencoded\";pkt_data;content:\"Connection: keep-alive\";http_header;content:\"code=\";http_client_body;sid:2020051001;rev:1;)", "2019060032": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"ASP.NET_SessionId=\";http_cookie;pcre:\"/[a-zA-Z0-9]{24}/CR\";http_content_len;byte_test:0,=,16,0,string,dec;pkt_data;content:\"a\";nocase;http_server_body;within:16;pcre:\"/^([a-f0-9A-F]{16})$/Q\";isdataat:!1,relative;noalert;flowbits:isset, bingxie_webshell_aspx;flowbits:set, bingxie_webshell_step2_aspx;sid:2019060032;gid:0;rev:1;)", "2019090055": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(POP3)|direction:in|level:action|service_name:Microsoft Exchange(POP3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange|server:src\";flow:from_server,established;content:\"*OK Microsoft Exchange\";depth:23;pcre:\"/^\\+OK Microsoft Exchange POP3 server version (\\S+) ready\\r\\n/\";sid:2019090055;gid:0;)", "2019090136": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Coremail\u8fde\u63a5|direction:in|level:action|service_name:Coremail(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Coremail|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 Coremail SMTP\\(Anti Spam\\) System \\(\\w+\\[(\\d+)\\]\\)\\r\\n/\";sid:2019090136;gid:0;)", "2019090252": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:OpenVPN\u8fde\u63a5|direction:in|level:action|service_name:OpenVPN|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728OpenVPN|server:src\";flow:from_server,established;content:\"|00 1a|@\";depth:3;pcre:\"/^\\0\\x1a@........\\x01\\0\\0\\0\\x007\\xa5&\\x08\\xa2\\x1b\\xa0\\xb1\\0\\0\\0\\0$/\";sid:2019090252;gid:0;)", "2020021017": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Slim\u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u547d\u4ee4\u6267\u884c)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Slim\u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Slim\";content:\"Http\";distance:1;content:\"Response\";distance:1;content:\"Appcontainer\";distance:1;content:\"Containervalues\";distance:1;sid:2020021017;rev:1;)", "2020051921": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee(info)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, spring_actuator_3_info;content:\"/actuator/info\";http_uri;sid:2020051921;rev:1;)", "2018062808": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:weevely\u8fde\u63a5\u8bf7\u6c42|tag:\u83dc\u5200|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230weevely\u8fde\u63a5php webshell\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;pcre:\"/^SSID=we\\;/C\";sid:2018062808;rev:1;)", "2020051210": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Jenkins \u811a\u672c\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:Jenkins \u811a\u672c\u6267\u884c\u6f0f\u6d1e|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, jenkins_script_rce;content:\"POST\";http_method;content:\"/script\";http_uri;content:\"script=\";http_client_body;pcre:\"/\\.(write|execute)/PRi\";sid:2020051210;rev:2;)", "2019090035": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:VNC\u8fde\u63a5|direction:in|level:action|service_name:VNC|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728VNC|server:src\";flow:from_server,established;content:\"RFB\";depth:3;pcre:\"/^RFB 003\\.00(\\d)\\n$/\";sid:2019090035;gid:0;)", "2025636": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike Beacon\u6570\u636e\u4f20\u8f93|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:\u5b58\u5728Cobalt Strike DNS\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;content:\"|43 6f 62 61 6c 74 20 53 74 72 69 6b 65 20 42 65 61 63 6f 6e 29|\";fast_pattern;http_user_agent;isdataat:!1,relative;http_header_names;content:!\"Referer\";metadata:former_category TROJAN;classtype:trojan-activity;sid:2025636;rev:1;metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2018_07_03, updated_at 2019_09_28;)", "2020060904": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Fastjson\u63a2\u6d4b|tag:\u670d\u52a1\u63a2\u6d4b|dest:home_net|level:attack|phase:recon|type:exploit|severity:3|result:unknown|o_msg:\u653b\u51fb\u8005\u63a2\u6d4b\u76ee\u6807\u673a\u5668\u662f\u5426\u4f7f\u7528fastjson|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"application/json\";pkt_data;content:\"@type\";http_client_body;fast_pattern;pcre:\"/(java\\.net\\.Inet4Address)|(java\\.net\\.Inet6Address)|(java\\.net\\.InetSocketAddress)|(java\\.net\\.URL)|(java\\.net\\.InetAddress)/PR\";sid:2020060904;rev:1;)", "2020061203": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u81f4\u8fdcOA Session\u6cc4\u6f0f|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u81f4\u8fdcOA Session\u6cc4\u6f0f|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, seeyou_session_disclosure;content:\"/yyoa/ext/https/getSessionList.jsp?cmd=getAll\";http_uri;sid:2020061203;rev:1;)", "2002842": "alert tcp $HOME_NET 3306 -> $EXTERNAL_NET any (msg:\"name:MySQL\u7206\u7834|tag:MySQL\u7206\u7834|phase:exploit|src:home_net|level:attack|severity:1|result:unknown|o_msg:\u5bf9MySql\u8fdb\u884c\u5bc6\u7801\u7206\u7834\u5c1d\u8bd5|attacker:dest\";flow:from_server,established;content:\"|01|\";offset:3;depth:4;content:\"root|00|\";nocase;distance:32;within:5;threshold:type both,track by_src,count 5,seconds 60;sid:2002842;rev:4;)", "2018010062": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4e0b\u8f7d\u5305\u542b\u5bc6\u7801\u7684inc\u6587\u4ef6|tag:\u4e0b\u8f7d\u654f\u611f\u6587\u4ef6|level:attack|phase:exploit|severity:3|result:success|o_msg:\u4e0b\u8f7d\u654f\u611f\u6587\u4ef6|dest:home_net|failed_by:http_status_3XX,http_status_4XX|attacker:src\";http_content_type;content:\"application/octet-stream\";pkt_data;content:\"200\";nocase;http_stat_code;content:\"password\";nocase;http_server_body;within:1460;pcre:\"/password\\s*=/iQ\";flow:from_server,established;flowbits:isset,sensitive_file;sid:2018010062;rev:1;)", "2029491": "alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Cobalt Strike \u6728\u9a6cSSL\u8bc1\u4e66\u4f20\u8f93|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|dest:home_net|src:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike \u6728\u9a6cSSL\u8bc1\u4e66\u4f20\u8f93\";flow:established,from_server;tls_cert_subject;content:\"CN=Adobe Reader/O=Adobe\";depth:23;isdataat:!1,relative;fast_pattern;tls_cert_issuer;content:\"C=AU, ST=Some-State, L=City, O=Some Company\";depth:43;isdataat:!1,relative;metadata:former_category MALWARE;reference:md5,e4224469bd75b63fa0cebd33c53b4d85;classtype:trojan-activity;sid:2029491;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag SSL_Malicious_Cert, signatrue_severity Major, created_at 2020_02_18, malware_family Cobalt_Strike, performance_impact Low, updated_at 2020_02_18;)", "2019090013": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Memcached\u8fde\u63a5|direction:in|level:action|service_name:Memcached|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728Memcached|server:src\";flow:from_server,established;content:\"|00 01 00 00 00 01 00 00|STAT\";depth:12;pcre:\"/^\\0\\x01\\0\\0\\0\\x01\\0\\0STAT pid \\d+\\r\\nSTAT uptime \\d+\\r\\nSTAT time \\d+\\r\\nSTAT version ([.\\d]+) \\(?Ubuntu\\)?\\r\\n/\";sid:2019090013;gid:0;)", "2019070003": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ThinkPHP\u6f0f\u6d1e|tag:ThinkPHP\u6f0f\u6d1e\u5229\u7528|direction:out|src:home_net|dest:external_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:attack_out|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728ThinkPHP\u6f0f\u6d1e\";content:\"GET\";nocase;http_method;content:\"/index.php\";nocase;http_uri;within:100;pcre:\"/(\\/)?\\?s=(\\/)?index\\/\\\\think\\\\Container/invokefunction&function=/iUR\";flow:to_server,established;gid:0;sid:2019070003;rev:1;)", "2008147": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (RBR)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| RBR|0d 0a|\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008147;classtype:trojan-activity;sid:2008147;rev:8;)", "2020011408": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:JBoss \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2017-12149\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:JBOSS\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2017_12149;content:\"500\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"Error report</title><style>\";http_server_body;within:100;content:\".readObject(\";distance:0;sid:2020011408;rev:1;)", "2019000068": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4e0b\u8f7dldif\u6587\u4ef6|tag:\u4e0b\u8f7d\u654f\u611f\u6587\u4ef6|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u4e0b\u8f7dldif\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"dn: \";http_server_body;fast_pattern;content:\"|0a|objectClass: \";distance:5;http_server_body;content:\"|0a 0a|dn: \";distance:5;http_server_body;sid:2019000068;rev:1;)", "2020052109": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:JspSpy Webshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u76ee\u6807\u4e3b\u673a\u53ef\u80fd\u5b58\u5728jsp\u7684webshell\u2014\u2014jspspy|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"<style type=\\\"text/css\\\">\";http_server_body;content:\"<input name=\\\"pw\\\" type=\\\"password\\\"\";http_server_body;distance:0;content:\"Copyright &copy\\; 2009 NinTy\";http_server_body;distance:0;content:\"www.Forjj.com\";http_server_body;distance:0;sid:2020052109;rev:1;)", "2020060808": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache HTTPD \u591a\u540e\u7f00\u89e3\u6790\u6f0f\u6d1e|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u653b\u51fb\u8005\u5c1d\u8bd5\u5229\u7528Apache HTTPD \u591a\u540e\u7f00\u89e3\u6790\u6f0f\u6d1e\uff0c\u4e0a\u4f20php\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"boundary=\";pkt_data;content:\"filename=\";http_client_body;content:\".php.\";http_client_body;nocase;distance:0;pcre:\"/filename=\\\"[\\w\\/\\s._-]+\\.php\\./Pi\";pcre:\"/(<\\?php)|(<script language=\\\"php\\\")/Pi\";sid:2020060808;rev:1;)", "2020052413": "alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fc7udp\u53cd\u5f39shell|tag:\u53cd\u5f39shell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u901a\u8fc7/dev/udp \u53cd\u5f39shell\uff0c\u83b7\u53d6\u4e3b\u673a\u6743\u9650\";content:\"|1b 5d 30 3b|\";depth:4;content:\"@\";distance:0;within:60;pcre:\"/(#|\\$) /R\";sid:2020052413;rev:1;)", "2020052003": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u8fde\u63a5webshell|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:\u5c1d\u8bd5\u8fde\u63a5jsp\u7684webshell|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, jsp_webshell_20200520;content:\"GET\";http_method;content:\".jsp\";http_uri;content:\"pass=\";http_uri;distance:1;content:\".jsp\";http_uri;content:\"cmd=\";http_uri;distance:1;pcre:\"/^([a-zA-Z0-9\\/\\+]{4})*([a-zA-Z0-9\\/\\+]{4}|[a-zA-Z0-9\\/\\+]{3}=|[a-zA-Z0-9\\/\\+]{2}==)/UR\";sid:2020052003;rev:1;)", "2020051507": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Fastjson \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Fastjson \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;xbits:set, jdni_link_jrmp, track ip_dst, expire 20;flowbits:set, fastjson_jndi;content:\"POST\";http_method;http_content_type;content:\"application/json\";pkt_data;content:\"@type\";http_client_body;fast_pattern;pcre:\"/(ldap|rmi):\\/\\//PRi\";sid:2020051507;rev:1;)", "2020061213": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u8fbeOA\u524d\u53f0\u4efb\u610f\u7528\u6237\u4f2a\u9020\u767b\u5f55\u6f0f\u6d1e|tag:\u672a\u6388\u6743\u8bbf\u95ee|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u901a\u8fbeOA\u524d\u53f0\u4efb\u610f\u7528\u6237\u4f2a\u9020\u767b\u5f55\u6f0f\u6d1e\uff0c\u83b7\u53d6\u7528\u6237cookie|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, tongda_login_bypass_step_2;content:\"POST\";http_method;content:\"/logincheck_code.php\";http_uri;depth:80;nocase;content:\"CODEUID=\";http_client_body;nocase;pcre:\"/^(%7B|%7b|\\{)[A-Z0-9]{8}-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{12}(%7D|%7d|\\})/PR\";content:\"UID=\";http_client_body;nocase;sid:2020061213;rev:1;)", "2812918": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike\u8fde\u63a5|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:\u5b58\u5728Cobalt Strike \u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;http_start;content:\"HTTP/1.1|0d 0a|Accept|3a 20|*/*|0d 0a|Cookie|3a 20|\";fast_pattern;pcre:\"/^[a-zA-Z0-9/+]{171}=/R\";http_header_names;content:!\"Referer\";metadata:former_category TROJAN;reference:md5,d3f53580f7ce72caf9be799106ad89ca;classtype:trojan-activity;sid:2812918;rev:3;metadata:created_at 2015_09_08, updated_at 2017_12_01;)", "2019010064": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7spark REST api\u90e8\u7f72\u4ee3\u7801(Java)|tag:\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u672a\u6388\u6743\u7684\u653b\u51fb\u8005\u53ef\u80fd\u901a\u8fc7\u672a\u6b63\u786e\u914d\u7f6eACL\u7684spark REST API\u8fdc\u7a0b\u6267\u884c\u4efb\u610f\u4ee3\u7801|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/v1/submissions/create\";isdataat:!1,relative;http_uri;content:\"\\\"action\\\"\";http_client_body;content:\"\\\"CreateSubmissionRequest\\\"\";within:30;http_client_body;content:\"\\\"mainClass\\\"\";http_client_body;content:\"\\\"sparkProperties\\\"\";http_client_body;content:\"\\\"spark.jars\\\"\";distance:0;http_client_body;flowbits:set,spark_state_access;gid:3;sid:2019010064;)", "2020062820": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(iox-\u53cd\u5411\u4ee3\u7406)|tag:\u653b\u51fb\u4ee3\u7406|tool:iox|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(iox-\u53cd\u5411\u4ee3\u7406)\";flow:established, from_server;flowbits:isset, iox_link_type_1_1;content:\"|00 e0 ee ff|\";depth:4;dsize:4;sid:2020062820;rev:1;)", "2020050908": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, bingxie_webshell;flowbits:set, bingxie_webshell_step2;noalert;content:\"200\";http_stat_code;content:\"JSESSIONID=\";http_cookie;http_content_type;content:\"text/xml\";pkt_data;http_content_len;content:\"16\";pkt_data;pcre:\"/^([a-z0-9]{16})$/Q\";isdataat:!1,relative;sid:2020050908;gid:0;rev:1;)", "2020071410": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4e3b\u673a JDWP \u7aef\u53e3\u5f00\u653e|tag:\u5371\u9669\u914d\u7f6e|src:home_net|level:attack|severity:3|result:success|phase:exploit|o_msg:\u4e3b\u673a JDWP \u7aef\u53e3\u5f00\u53d1\uff0c\u653b\u51fb\u8005\u53ef\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4|attacker:dest\";flow:from_server, established;flowbits:isset, jdwp_server_discover;content:\"JDWP-Handshake\";depth:14;dsize:14;sid:2020071410;)", "2020060101": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Fastjson<=1.2.68 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Fastjson \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"application/json\";pkt_data;content:\"@type\";http_client_body;fast_pattern;pcre:\"/(java\\.io\\.Serializable)|(java\\.io\\.Closeable)|(oracle\\.jms.\\AQ)|(java\\.util\\.Collection)|(java\\.lang\\.Iterable)|(java\\.lang\\.Object)|(java\\.lang\\.AutoCloseable)|(java\\.lang\\.Readable)|(java\\.lang\\.Cloneable)|(java\\.lang\\.Runnable)|(java\\.util\\.EventListener)/PRi\";sid:2020060101;rev:1;)", "2018040012": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u535a\u5f69\u6f0f\u6d1e|tag:\u968f\u673a\u626b\u63cf|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|phase:recon|failed_by:http_status_3XX,http_status_4XX|severity:1|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u968f\u673a\u626b\u63cf\u535a\u5f69\u6f0f\u6d1e\uff08\u901a\u5e38\u4e3a\u5168\u7f51\u626b\u63cf\uff09\";content:\"POST\";nocase;http_method;content:\"/index.php?\";nocase;http_uri;within:300;content:\"s=vod-search-area-\";nocase;http_uri;within:18;pcre:\"/${@?(print\\(eval|eval)\\(/iUR\";flow:to_server,established;gid:0;sid:2018040012;rev:1;)", "2020052411": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:reGeorg\u8fde\u63a5\u6210\u529f|tag:\u653b\u51fb\u4ee3\u7406|tool:reGeorg|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u5185\u7f51\u6e17\u900f\u65f6\u7684\u5e38\u7528\u5de5\u5177reGeorg|failed_by:http_status_3XX,http_status_4XX\";flowbits:isset, regeory_froward;flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"application/octet-stream\";pkt_data;content:\"X-STATUS: FAIL\";http_header;content:\"X-ERROR: POST request read filed\";http_header;sid:2020052411;rev:1;)", "2019020004": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:FTP\u767b\u5f55\u6210\u529f|tag:ftp|direction:in|src:home_net|dest:external_net|level:action|severity:1|result:success|o_msg:FTP\u767b\u5f55\u6210\u529f\";content:\"220\";offset:0;depth:3;flowbits:set,send_220;noalert;gid:3;sid:2019020004;)", "2018020037": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6d4f\u89c8Web\u76ee\u5f55|tag:\u76ee\u5f55\u904d\u5386|direction:in|dest:home_net|src:external_net|level:attack|phase:exploit|severity:1|result:success|o_msg:\u68c0\u6d4b\u5230\u6d4f\u89c8\u76ee\u5f55\u7684\u884c\u4e3a\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u7279\u6027\u83b7\u53d6web\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|gray:true\";flow:from_server,established;content:\"|0d 0a|<html>|0d 0a|<head><title>Index of /\";http_server_body;offset:3;gid:0;sid:2018020037;)", "2020070705": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Maccms8.x \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Maccms8.x \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, Maccms_8_x_rce;content:\"GET\";http_method;content:\"m=vod-search\";http_uri;fast_pattern;content:\"wd=\";http_uri;pcre:\"/{if-([\\s\\S]*?):([\\s\\S]+?)}([\\s\\S]*?){endif-([\\s\\S]*?)}/UR\";sid:2020070705;rev:1;)", "2026931": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"YXJ0LVByb2Nlc3\";distance:0;fast_pattern;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026931;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2019090169": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Hmail\u8fde\u63a5|direction:in|level:action|service_name:Hmail(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Hmail|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 \\(SMTP\\) hMailServer ([\\d.]+) - Up since .*\\r\\n/\";sid:2019090169;gid:0;)", "2008708": "alert tcp $HOME_NET any -> $HOME_NET 139 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";flow:established,to_server;content:\"|1F 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"../../\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008708;classtype:attempted-admin;sid:2008708;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2009715": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:XSS\u6f0f\u6d1e\u5c1d\u8bd5|tag:xss|dest:home_net|level:attack|phase:exploit|severity:1|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Xss\u6f0f\u6d1e\u5c1d\u8bd5|attacker:src\";flow:to_server,established;uricontent:\"onmouseover=\";nocase;reference:url,www.w3schools.com/jsref/jsref_onmouseover.asp;reference:url,doc.emergingthreats.net/2009715;classtype:web-application-attack;sid:2009715;rev:5;metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag XSS, tag Cross_Site_Scripting, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01;)", "2019090073": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Zookeeper\u8fde\u63a5|direction:in|level:action|service_name:Zookeeper|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728Zookeeper|server:src\";flow:from_server,established;content:\"Zookeeper version: \";depth:19;pcre:\"/^Zookeeper version: ([\\w.-]+), built on ([\\w./]+)/\";sid:2019090073;gid:0;)", "2018081317": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u8fdb\u884c\u6587\u4ef6\u4e0b\u8f7d(1)\";flow:from_server,established;content:\"FILE \";depth:5;nocase;content:\"|3A 5C|\";distance:1;within:2;flowbits:set,TB_ZxShell_4;flowbits:noalert;sid:2018081317;rev:1;)", "2020051910": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring SpEL\u8868\u8fbe\u5f0f\u4ee3\u7801\u6ce8\u5165|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Spring SpEL\u8868\u8fbe\u5f0f\u4ee3\u7801\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"T(java.lang.\";http_client_body;pcre:\"/Runtime|ProcessBuilder/PRi\";sid:2020051910;rev:1;)", "2826142": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Cobalt Strike\u8fde\u63a5|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:\u5b58\u5728Cobalt Strike \u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"OK\";http_stat_msg;content:\"X-Malware|3a 20|\";http_header;metadata:former_category TROJAN;reference:url,blog.cobaltstrike.com/2015/10/14/the-cobalt-strike-trials-evil-bit;classtype:trojan-activity;sid:2826142;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2017_04_27, performance_impact Moderate, updated_at 2017_04_27;)", "2008953": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:webshell\u8fde\u63a5\u6210\u529f|tag:webshell|direction:in|src:home_net|dest:home_net|level:attack|phase:control|severity:4|gray:true|result:unknown|o_msg:webshell\u8fde\u63a5\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"Microsoft Windows \";http_server_body;content:\"Copyright 1985-20\";distance:0;content:\"Microsoft Corp\";distance:0;content:\"|0a 0a|\";distance:0;flowbits:isset,req;sid:2008953;rev:9;)", "2019030002": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u8fde\u63a5\u5230\u516c\u7f51frp\u670d\u52a1\u5668|tag:tunnel|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|tool:frp|result:unknown|o_msg:\u5c1d\u8bd5\u4e0e\u516c\u7f51frp\u670d\u52a1\u5668\u5efa\u7acbfrp\u96a7\u9053\uff0c\u53ef\u7528\u6765\u8fdb\u884c\u5185\u7f51\u7a7f\u900f\";flow:established,to_server;dsize:<500;content:\"{\\\"version\\\"\\:\\\"\";content:\"\\\",\\\"hostname\\\"\\:\\\"\";distance:0;content:\"\\\",\\\"os\\\"\\:\\\"\";distance:0;content:\"\\\",\\\"arch\\\"\\:\\\"\";distance:0;content:\"\\\",\\\"user\\\"\\:\\\"\";distance:0;content:\"\\\",\\\"privilege_key\\\"\\:\\\"\";distance:0;content:\"\\\",\\\"timestamp\\\"\\:\";distance:0;content:\",\\\"run_id\\\"\\:\\\"\";distance:0;content:\"\\\",\\\"pool_count\\\"\\:\";distance:0;content:\"}\";distance:0;isdataat:!1,relative;flowbits:isset,frp_state_1;flowbits:unset,frp_state_1;flowbits:set,frp_state_2;flowbits:noalert;sid:2019030002;)", "2018010091": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:NC\u53cd\u5f39SHELL(2)|tag:\u53cd\u5f39shell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|attacker:external_net|result:success|o_msg:\u5229\u7528redis\u5199shell,\u53cd\u5f39shell\";content:\"|1b 5b|\";offset:0;pcre:\"/(\\x1b\\x5b[0-4][0-9]\\x3b[0-9]{2}m)\\x5b(\\x1b\\x5b[0-4][0-9]\\x3b[0-9]{2}m)?root(\\x1b\\x5b[0-4][0-9]\\x3b[0-9]{2}m)?@(\\x1b\\x5b[0-4][0-9]\\x3b[0-9]{2}m)?[\\w\\d._-]+/i\";flow:to_server,established;gid:0;sid:2018010091;rev:1;)", "2019090012": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MySQL\u8fde\u63a5|direction:in|level:action|service_name:MySQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728MySQL|server:src\";flow:from_server,established;content:\"|00 00 00|\";offset:1;depth:3;pcre:\"/^.\\0\\0\\0\\xff..Host .* is blocked because of many connection errors/\";sid:2019090012;gid:0;)", "2018020010": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:FTP\u767b\u5f55\u6210\u529f|tag:\u767b\u5f55|direction:in|service_name:FTP|service_class:file|src:external_net|dest:home_net|level:action|result:success|o_msg:ftp\u670d\u52a1\u767b\u5f55\u6210\u529f[1]|server:dest\";dsize:21;flow:to_server,established;content:\"|32 33 30 20 55 73 65 72 20 6c 6f 67 67 65 64 20 69 6e 2e 0d 0a|\";sid:2018020010;rev:1;)", "2013284": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DarkComet\u540e\u95e8\u6728\u9a6c|type:rat|tag:DarkComet|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230DarkComet-RAT\u670d\u52a1\u7aef\u52a0\u5165\u786e\u8ba4\";flow:to_server,established;dsize:12;content:\"|39 34 41 35 41 44 30 41 45 46 36 39|\";flowbits:isset,ET.DarkCometJoin;reference:url,www.darkcomet-rat.com;reference:url,anubis.iseclab.org/?action=result&task_id=1a7326f61fef1ecb4ed4fbf3de3f3b8cb&format=txt;classtype:trojan-activity;sid:2013284;rev:3;)", "2018062809": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:weevely\u8fde\u63a5\u8bf7\u6c42|tag:\u83dc\u5200|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230weevely\u8fde\u63a5php webshell\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;pcre:\"/^USRID=we\\;/C\";sid:2018062809;rev:1;)", "2020021027": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZendFramework\u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u547d\u4ee4\u6267\u884c)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:ZendFramework\u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Zend_Log\";content:\"*_writers\";distance:1;content:\"Zend_Log_Writer_Mail\";distance:1;content:\"*_eventsToMail\";distance:1;content:\"*_layoutEventsToMail\";distance:1;content:\"*_matchPattern\";distance:1;content:\"/(.*)/e\";distance:1;content:\"*_replacement\";distance:1;sid:2020021027;rev:1;)", "2016953": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Struts2\u6f0f\u6d1e\u5229\u7528|tag:Struts\u6f0f\u6d1e|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|success_by:execmd|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Struts2 OGNL Java Exec\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u7684payload\u653b\u51fb\u7cfb\u7edf|attacker:src\";flow:to_server,established;content:\"java.lang.Runtime@getRuntime().exec(\";http_uri;nocase;flowbits:set,cmd_reponse_echo;sid:2016953;rev:3;)", "2020030005": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u8681\u5251\u8fde\u63a5webshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:unknown|o_msg:\u8681\u5251\u8fde\u63a5webshell|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"%40eval(chr(\";nocase;http_client_body;pcre:\"/chr\\(\\d{1,3}\\)\\.chr\\(\\d{1,3}\\)/RPi\";flowbits:set, first_packet_send;flowbits:noalert;sid:2020030005;)", "2020061024": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:isset, tp_5_rce_1;content:\"s=admin/\\\\think\\\\\";http_uri;depth:100;nocase;sid:2020061024;rev:1;)", "2020072803": "alert tcp $HOME_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528wmiexec\u8c03\u7528\u6267\u884c\u547d\u4ee4|tag:\u8fdc\u7a0b\u63a7\u5236|tool:wmiexec|src:home_net|dest:home_net|level:attack|phase:exploit|attacker:src|result:success|severity:4|o_msg:\u4f7f\u7528wmiexec\u8c03\u7528\u6267\u884c\u547d\u4ee4\";flow:established, to_server;content:\"NTLMSSP\";fast_pattern;content:\"__PARAMETERS\";distance:0;content:\"c|00|m|00|d|00 2e 00|e|00|x|00|e|00|\";distance:2;within:14;content:\"|20 00 2f 00 51 00 20 00 2f 00 63 00|\";distance:0;within:12;sid:2020072803;rev:1;)", "2020052402": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:reGeorg\u8fde\u63a5\u6210\u529f|tag:\u653b\u51fb\u4ee3\u7406|tool:reGeorg|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u5185\u7f51\u6e17\u900f\u65f6\u7684\u5e38\u7528\u5de5\u5177reGeorg|failed_by:http_status_3XX,http_status_4XX\";flowbits:isset, regeory_connect;flow:from_server,established;content:\"200\";http_stat_code;content:\"X-STATUS: OK\";http_header;content:\"Connection: close\";http_header;sid:2020052402;rev:1;)", "2020051214": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Couchdb \u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2017-12636\uff09\u3010step_1\u3011|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:Couchdb \u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2017-12636\uff09\u3010step_1\u3011|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2017_12636;xbits:set, cve_2017_12636_xbit, track ip_dst, expire 60;content:\"PUT\";http_method;content:\"/_config/query_servers/cmd\";http_uri;pcre:\"/(ls|cd|pwd|wget|curl|adduser|cat|passwd|chmod|echo|netstat|uname|sysctl|mysql|history|bash|useradd|ps|ifconfig|find|id|grep|awk|last|lsof|iptables|find|whoami|touch|ping)/Pi\";sid:2020051214;rev:2;)", "2020061310": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PhpStudy\u540e\u95e8\u8fdc\u7a0b\u547d\u4ee4\u6ce8\u5165|tag:\u547d\u4ee4\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:PhpStudy\u540e\u95e8\u8fdc\u7a0b\u547d\u4ee4\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"|0d 0a|Accept-Charset: \";http_header;nocase;pcre:\"/^([A-Za-z0-9+\\/]{4})+([A-Za-z0-9+\\/]{4})+([A-Za-z0-9+\\/]{4}|[A-Za-z0-9+\\/]{3}=|[A-Za-z0-9+\\/]{2}==)/HR\";content:!\"utf-8\";http_header;nocase;distance:0;within:100;content:!\"iso-8859-1\";http_header;nocase;distance:0;within:100;sid:2020061310;rev:1;)", "2020041016": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic XXE\u6f0f\u6d1e\uff08CVE-2019-2649\uff09|tag:xxe|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic XXE\uff08CVE-2019-2649\uff09|attacker:src\";flow:established, to_server;xbits:set, weblogic_xxe, track ip_dst, expire 20;content:\"|ac ed 00 05|\";content:\"weblogic.wsee.message.MsgHeader\";distance:0;content:\"<!DOCTYPE\";distance:0;content:\"SYSTEM \";distance:0;pcre:\"/(http|https):\\/\\//Ri\";sid:2020041016;rev:1;)", "2019010115": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Nostromo Web\u670d\u52a1\u5668\u7684\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff08CVE-2019-16278\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Nostromo Web\u670d\u52a1\u5668\u7684\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff08CVE-2019-16278\uff09|attacker:src\";flow:to_server,established;content:\"POST\";http_method;pcre:\"/(\\/%0d..\\/)|(\\/.%0d.\\/)|(\\/..%0d\\/)/I\";sid:2019010115;rev:1;)", "2020050608": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:SaltStack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2020-11651,CVE-2020-11652)|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|src:home_net|level:attack|phase:exploit|result:success|o_msg:SaltStack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2020-11651,CVE-2020-11652)\u3010\u8bfb\u53d6\u6587\u4ef6\u3011|severity:2|attacker:dest\";flow:to_client, established;flowbits:isset, cve_2020_11651_read_file;content:\"salt/wheel\";pcre:\"/fun.wheel.file_roots.read/R\";sid:2020050608;rev:2;)", "2018060029": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u5217\u76ee\u5f55\u884c\u4e3a|tag:webshell\u8fde\u63a5|tool:\u83dc\u5200|direction:in|dest:home_net|src:external_net|level:attack|phase:control|severity:4|result:success|type:shell|o_msg:webshell\u5217\u76ee\u5f55\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX\";content:\"200\";nocase;http_stat_code;http_content_type;content:\"text/html\";pkt_data;http_content_len;byte_test:0,<,1000,0,string,dec;pkt_data;content:\"->|7c|\";http_server_body;within:600;pcre:\"/->\\|([\\w._/\\[\\]\\{\\}-]{1,255}\\x09\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\\x09\\d{1,5}\\x09\\d{1,4}\\x0a)+\\|<-/iQ\";flow:from_server,established;flowbits:isset,req;sid:2018060029;rev:1;)", "2020051010": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|dest:home_net|level:attack|phase:exploit|type:shell|severity:3|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, bingxie_webshell;noalert;content:\"GET\";http_method;content:\".jspx?\";http_uri;pcre:\"/[\\w.$@!%_-]+=\\d{3}$/iUR\";isdataat:!1,relative;content:\"Connection: keep-alive\";http_header;sid:2020051010;gid:0;rev:1;)", "2019090162": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cisco LDAP server|direction:in|level:action|service_name:Cisco LDAP server|service_class:auth|severity:1|result:unknown|o_msg:\u5b58\u5728Cisco LDAP server|server:src\";flow:from_server,established;content:\"0|0c 02 01 01|a\";depth:6;pcre:\"/^0\\x0c\\x02\\x01\\x01a\\x07\\n\\x011\\x04\\0\\x04\\0$/\";sid:2019090162;gid:0;)", "2026937": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"dm9rZS1XbWlNZXRob2\";distance:0;fast_pattern;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026937;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "202099996": "alert tcp $HOME_NET any -> $HOME_NET any (msg:\"name:\u68c0\u6d4bSMTP\u6307\u7eb9|tag:\u626b\u63cf|tool:Nmap|type:infil|direction:in|phase:post_exploit|src:home_net|attacker:src|dest:home_net|level:attack|severity:1|result:unknown|o_msg:NMAP\u626b\u63cf\u68c0\u6d4bSMTP\u6307\u7eb9\";dsize:22;content:\"EHLO nmap.scanme.org|0d 0a|\";flow:to_server,established;sid:202099996;rev:1;)", "2018010100": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4e0b\u8f7d*.sql\u6570\u636e\u5e93\u884c\u4e3a|tag:\u4e0b\u8f7d\u6570\u636e\u5e93\u6587\u4ef6|dest:home_net|phase:exploit|level:attack|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u4e0b\u8f7dSQL\u6570\u636e\u5e93|severity:1|attacker:src\";content:\"GET\";nocase;http_method;content:\".sql\";nocase;http_uri;pcre:\"/\\.sql$/iU\";within:1024;flow:to_server,established;flowbits:set, gid:0;sid:2018010100;rev:1;)", "2020081400": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08http\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884cipconfig\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"Windows IP \u914d\u7f6e\";http_server_body;fast_pattern;content:\"\u8fde\u63a5\u7279\u5b9a\u7684 DNS \u540e\u7f00 . . . . . . . : \";http_server_body;content:\"IPv4 \u5730\u5740 . . . . . . . . . . . . : \";http_server_body;sid:2020081400;)", "2008712": "alert tcp $HOME_NET any -> $HOME_NET 445 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";flow:established,to_server;content:\"|20 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"|5C|..|5C|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008712;classtype:attempted-admin;sid:2008712;rev:6;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2020082001": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874eWebshell\u901a\u8baf|tag:webshell|tool:\u51b0\u874e|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u51b0\u874eWebshell\u901a\u8baf|gray:true|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;http_content_len;byte_test:0,>=,3000,0,string,dec;pkt_data;content:\"PHPSESSID=\";http_cookie;depth:10;content:\"\\;PHPSESSID=\";http_cookie;distance:26;within:11;sid:2020082001;gid:0;rev:1;)", "2020062307": "alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5efa\u7acb ICMP \u901a\u9053\u4f20\u8f93\u6570\u636e|tag:\u653b\u51fb\u4ee3\u7406|tool:icmpsh|direction:in|dest:external_net|src:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u653b\u51fb\u8005\u5efa\u7acbICMP\u96a7\u9053\uff0c\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4|attacker:dest\";flow:established, to_server;itype:8;icode:0;content:\"uid=0(root)\";depth:30;sid:2020062307;rev:1;)", "2019090174": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Hmail\u8fde\u63a5|direction:in|level:action|service_name:Hmail(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Hmail|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([-\\w_.]+) ESMTP\\r\\n211 DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY\\r\\n/\";sid:2019090174;gid:0;)", "2020010031": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528\u6f0f\u6d1e\u6267\u884c\u547d\u4ee4|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u68c0\u6d4b\u5230\u8fdc\u7a0b\u547d\u4ee4\u6267\u884cwhoami|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;http_content_len;byte_test:0,<,6,0,string,dec;pkt_data;content:\"root\";http_server_body;flowbits:isset,cmd_reponse_echo;sid:2020010031;)", "2020010049": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Jenkins\u5efa\u7acb\u53cc\u5411\u901a\u9053|tag:\u5371\u9669\u884c\u4e3a|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Jenkins\u5efa\u7acb\u53cc\u5411\u901a\u9053|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, jenkins_build_cli;content:\"POST\";http_method;content:\"/cli\";http_uri;content:\"Session:\";http_header;content:\"Side: download\";http_header;sid:2020010049;rev:1;)", "2019000048": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u7591\u4f3cwebshell|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:weblogic\u6f0f\u6d1e\u5229\u7528|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;flowbits:isset,weblogic_write_file3;sid:2019000048;)", "2018020004": "alert tcp $HOME_NET 3306 -> $EXTERNAL_NET any (msg:\"name:MySQL\u767b\u5f55\u6210\u529f|tag:\u767b\u5f55|direction:in|service_name:MySQL|service_class:database|src:home_net|dest:external_net|level:action|o_msg:Mysql \u670d\u52a1\u767b\u5f55\u6210\u529f|server:src\";flow:from_server,established;content:\"|07 00 00 02 00 00 00 02 00 00 00|\";gid:3;sid:2018020004;rev:1;)", "2019000057": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Jenkins \u767b\u5f55\u884c\u4e3a|tag:\u767b\u5f55\u884c\u4e3a|dest:home_net|level:attack|severity:3|phase:exploit|result:success|o_msg:Jenkins \u767b\u5f55\u884c\u4e3a,\u7528\u6237\u540d\u5bc6\u7801\u90fd\u662fuser1|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, jenkins_login;content:\"302\";http_stat_code;content:\"X-Content-Type-Options: nosniff\";http_header;content:\"Location: \";http_header;content:!\"/loginError\";http_header;distance:0;within:50;sid:2019000057;rev:1;)", "2019060022": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"ASPSESSIONID\";http_cookie;pcre:\"/[a-zA-Z]+=[a-zA-Z0-9]{24}/CR\";http_content_len;byte_test:0,=,16,0,string,dec;pkt_data;content:\"d\";nocase;http_server_body;within:16;pcre:\"/^([a-f0-9A-F]{16})$/Q\";isdataat:!1,relative;noalert;flowbits:isset, bingxie_webshell_asp;flowbits:set, bingxie_webshell_step2_asp;sid:2019060022;gid:0;rev:1;)", "2019090199": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220[ -]([\\w._-]+) ESMTP\\r.*\\n521 5\\.7\\.0 Error: I can break rules, too\\. Goodbye\\.\\r\\n/\";sid:2019090199;gid:0;)", "2025804": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:payload\u4e2d\u5305\u542bbase64\u540e\u7684/bin/bash|tag:payload|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u653b\u51fbpayload\u4e2d\u4f7f\u7528base64\u7f16\u7801\u540e\u7684/bin/bash|attacker:src\";flow:established,to_server;content:\"L2Jpbi9iYXNo\";http_header;metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025804;rev:2;metadata:attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2026929": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"RhcnQtUHJvY2\";distance:0;fast_pattern;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026929;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2020051201": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHP-FPM Fastcgi \u672a\u6388\u6743\u8bbf\u95ee\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:PHP-FPM Fastcgi \u672a\u6388\u6743\u8bbf\u95ee\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server, established;flowbits:set, fastcgi_unauth;content:\"GATEWAY_INTERFACE\";content:\"FastCGI\";distance:0;within:7;content:\"SCRIPT_FILENAME\";distance:0;content:\"SCRIPT_NAME\";distance:0;content:\"SERVER_SOFTWARE\";distance:0;content:\"php/fcgiclient\";distance:0;within:14;content:\"auto_prepend_file\";distance:0;content:\"php://input\";distance:0;sid:2020051201;rev:2;)", "2831655": "alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike \u53cd\u8fde|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:\u5b58\u5728Cobalt Strike C2 M2 \u57df\u540d\";flow:established,to_server;tls_sni;content:\"wsus.azureedge.net\";isdataat:!1,relative;metadata:former_category TROJAN;reference:md5,c3e6a57547900c60472d52f597390020;classtype:trojan-activity;sid:2831655;rev:1;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2018_07_10, malware_family Cobalt_Strike, performance_impact Moderate, updated_at 2019_09_28;)", "2019060037": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u83b7\u53d6powershell\u811a\u672c|tag:\u4e0b\u8f7d\u6076\u610f\u6587\u4ef6|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|result:success|type:unknown_url|o_msg:\u7591\u4f3c\u4e0b\u8f7dpowershell\u811a\u672c|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;http_content_type;content:\"application/octet-stream\";pkt_data;content:\"(New-Object\";nocase;http_server_body;pcre:\"/\\s+(system\\.)?Net\\.WebClient\\)\\.DownloadString\\('(http|https)/QR\";gid:0;sid:2019060037;rev:1;)", "2019010093": "alert http $HOME_NET 9200 -> $EXTERNAL_NET any (msg:\"name:elasticsearch\u672a\u6388\u6743\u8bbf\u95ee|tag:elasticsearch|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:elasticsearch\u672a\u6388\u6743\u8bbf\u95ee|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, established_unauthorization;content:\"200\";http_stat_code;content:\"\\\"tagline\\\" \\: \\\"You Know, for Search\\\"\";http_server_body;sid:2019010093;)", "2011497": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528Hydra\u8fdb\u884c\u7206\u7834|tag:\u7206\u7834|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|result:unknown|o_msg:\u53d1\u73b0\u4f7f\u7528Hydra\u8fdb\u884cHTTP\u5bc6\u7801\u7206\u7834|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3A| Mozilla/5.0 (Hydra)\";nocase;http_header;fast_pattern:23,8;threshold:type limit, track by_src,count 2, seconds 60;reference:url,freeworld.thc.org/thc-hydra;classtype:attempted-recon;sid:2011497;rev:4;)", "2020032111": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Apache axis2 \u901a\u8fc7cat.arr\u6267\u884c\u547d\u4ee4|tag:\u547d\u4ee4\u6267\u884c|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Apache axis2 \u901a\u8fc7cat.arr\u6267\u884c\u547d\u4ee4|attacker:dest\";flow:established, from_server;xbits:isset, axis_nc, track ip_src;content:\"User:\t\";startswith;sid:2020032111;rev:1;)", "2020010009": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fc7bash\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4|tag:\u53cd\u5f39shell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:\u901a\u8fc7bash\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4\";flow:established,to_server;content:\"whoami|0a|\";content:\"apache\";distance:0;flowbits:unset,bash_whoami;flowbits:isset,bash_whoami;sid:2020010009;)", "2019010101": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:webshell\u547d\u4ee4\u6267\u884c|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u7b80\u964b\u7684webshell\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"cmd=\";pcre:\"/(&|\\?)cmd=\\b(ls|cd|pwd|wget|curl|adduser|cat|passwd|chmod|echo|netstat|uname|sysctl|mysql|history|bash|useradd|ps|ifconfig|find|id|grep|awk|last|lsof|iptables|find|whoami|touch|netstat|tasklist|ntsd|net|echo)\\b/I\";sid:2019010101;rev:1;)", "2019090156": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:LDAP\u8fde\u63a5|direction:in|level:action|service_name:LDAP|service_class:auth|severity:1|result:unknown|o_msg:\u5b58\u5728LDAP|server:src\";flow:from_server,established;content:\"0|84 00 00 00|\";depth:5;pcre:\"/^0\\x84\\0\\0\\0\\x10\\x02\\x01\\x01a\\x84\\0\\0\\0\\x07\\n\\x01\\0\\x04\\0\\x04\\0$/\";sid:2019090156;gid:0;)", "2101883": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u6267\u884ccmd\u547d\u4ee4id|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:unknown|o_msg:webshell\u8fde\u63a5\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"uid=\";within:100;http_server_body;pcre:\"/uid=\\d+\\(web\\) gid=\\d+\\(web\\) groups=\\d+\\(web\\)/QR\";flowbits:isset,req;sid:2101883;rev:7;)", "2019010059": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5229\u7528Supervisor XML-RPC\u670d\u52a1\u5668\u5b89\u5168\u6f0f\u6d1e(CVE-2017-11610)|tag:\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:exploit|severity:1|result:unknown|o_msg:Supervisor XML-RPC\u670d\u52a1\u5668\u5b89\u5168\u6f0f\u6d1e(CVE-2017-11610)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"/RPC2\";offset:0;depth:5;nocase;http_uri;content:\"<methodCall>\";http_client_body;content:\"<methodName>\";http_client_body;within:16;content:\"supervisor.\";nocase;http_client_body;within:14;pcre:\"/(startProcess|supervisord\\.(options\\.execve|options\\.fork|options\\.warnings\\.linecache\\.os\\.system))/iRP\";content:\"</methodName>\";http_client_body;flow:to_server,established;gid:0;sid:2019010059;)", "2020010001": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache ShardingSphere \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-1947)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Apache ShardingSphere \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-1947)|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/api/schema\";http_uri;content:\"dataSourceConfiguration\";http_client_body;content:\"!!\";http_client_body;distance:0;content:\"ScriptEngineManager\";http_client_body;distance:0;content:\"URLClassLoader\";http_client_body;distance:0;content:\"!!java.net.URL\";http_client_body;distance:0;sid:2020010001;rev:1;)", "2018112613": "alert smb $HOME_NET any -> $HOME_NET 445 (msg:\"name:\u6c38\u6052\u6d6a\u6f2b\u6f0f\u6d1e\u653b\u51fb|tag:smb|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|attacker:src|result:success|o_msg:Write AndX Request\";content:\"|ff 53 4d 42 2f|\";offset:4;depth:5;flowbits:isset,TRANS_REQUEST;flowbits:set,WRITE_ANDX_REQUEST;flowbits:noalert;sid:2018112613;)", "2020050919": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell\u4ea4\u4e92|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:webshell\u4ea4\u4e92|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, jsp_replace_shell_1;content:\"GET\";http_method;content:\".jsp?\";http_uri;nocase;content:\"help=\";http_uri;distance:0;nocase;content:\".jsp?\";http_uri;nocase;content:\"other\";http_uri;distance:0;nocase;noalert;sid:2020050919;gid:0;rev:1;)", "2018010051": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MSSQL\u6ce8\u5165|tag:\u6ce8\u5165\u68c0\u6d4b\u7248\u672c|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MSSQL\u6ce8\u5165 - \u68c0\u6d4bMSSQL\u7248\u672c|dest:home_net|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"and\";nocase;http_uri;pcre:\"/[ + ]+\\d[=<>]\\(select[ |+]@@version\\)/iUR\";content:\"CHR(\";nocase;http_uri;pcre:\"/chr\\(\\d{1,3}\\)/iU\";flow:to_server,established;gid:0;sid:2018010051;rev:1;)", "2018010049": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:SQLMAP|tag:SQLMAP\u6ce8\u5165|tool:SQLMAP|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:\u5229\u7528SQLMAP\u5de5\u5177\u8fdb\u884c\u6ce8\u5165|attack_type:target|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"union all select \";nocase;http_uri;pcre:\"/\\d,null,/iUR\";content:\"'<script>alert(\\\"XSS\\\")</script>',table_name FROM information_schema.tables WHERE \";nocase;http_uri;distance:0;pcre:\"/\\d>\\d--\\/\\*\\*\\/\\;EXEC xp_cmdshell/iUR\";flow:to_server,established;gid:0;sid:2018010049;rev:1;)", "2020041014": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic XXE\uff08CVE-2019-2647\uff09|tag:xxe|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic XXE\uff08CVE-2019-2647\uff09|attacker:src\";flow:established, to_server;xbits:set, weblogic_xxe, track ip_dst, expire 20;content:\"|ac ed 00 05|\";content:\"weblogic.wsee.wstx.internal.ForeignRecoveryContext\";distance:0;content:\"<!DOCTYPE\";distance:0;content:\"SYSTEM \";distance:0;pcre:\"/(http|https):\\/\\//Ri\";sid:2020041014;rev:1;)", "2020061305": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4e0a\u4f20Behinder webshell|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u4e0a\u4f20Behinder webshell|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"boundary=\";pkt_data;content:\"<%\";http_client_body;distance:0;content:\"Language=\\\"C#\\\"\";http_client_body;distance:0;content:\"Encoding.Default.GetBytes(Session\";http_client_body;distance:0;content:\"System.Security.Cryptography.RijndaelManaged()\";http_client_body;distance:0;sid:2020061305;rev:1;)", "2020060002": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5b58\u5728webshell\u8bbf\u95ee|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|type:shell|o_msg:webshell\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";http_content_type;content:\"text/html\";pkt_data;content:\"<a href=\\\"http://www.rookit.net.cn\\\" target=\";http_server_body;flow:from_server,established;sid:2020060002;rev:1;)", "2020010012": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fc7bash\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4|tag:\u53cd\u5f39shell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:\u901a\u8fc7bash\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4\";flow:established,to_server;content:\"whoami|0a|\";content:\"tomcat\";distance:0;flowbits:unset,bash_whoami;flowbits:isset,bash_whoami;sid:2020010012;)", "2019060017": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:success|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;content:\".asp\";http_uri;content:\"ASPSESSIONID\";http_cookie;pcre:\"/[a-zA-Z]+=[a-zA-Z0-9]{24}/CR\";http_content_len;byte_test:0,>=,7000,0,string,dec;pkt_data;http_accept;content:\"text/html, image/gif, image/jpeg, *\\; q=.2, */*\\; q=.2\";pkt_data;flowbits:isset, bingxie_webshell_step2_asp;sid:2019060017;gid:0;rev:1;)", "2019010071": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5c1d\u8bd5\u5229\u7528fastjson\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:ldap call|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u53ef\u80fd\u662f\u901a\u8fc7JNDI\u6ce8\u5165\u8c03\u7528\u8fdc\u7a0b\u65b9\u6cd5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"400\";http_stat_code;http_content_len;byte_test:0,<,250,0,string,dec;pkt_data;http_content_type;content:\"application/json\";pkt_data;content:\"\\\"message\\\":\\\"JSON parse error: set property error, autoCommit\\; nested exception is com.alibaba.fastjson.JSONException: set property error, autoCommit\\\"\";http_server_body;flowbits:isset, fastjson_exp;flow:from_server,established;gid:3;sid:2019010071;)", "2834196": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ETPRO POLICY External IP Address Lookup via api .ip138 .com|tag:TEST|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:dest\";flow:to_server,established;content:\"GET\";http_method;content:\"api.ip138.com\";http_host;depth:13;isdataat:!1,relative;fast_pattern;http_header_names;content:!\"Referer\";metadata:former_category POLICY;classtype:trojan-activity;sid:2834196;rev:1;metadata:affected_product Any, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Audit, created_at 2019_01_03, performance_impact Low, updated_at 2019_01_03;)", "2834373": "alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike\u8bf7\u6c42SSL\u8fde\u63a5|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike\u8bf7\u6c42SSL\u8fde\u63a5\";flow:to_server,established;tls_sni;content:\"secure-adnx.appspot.com\";isdataat:!1,relative;metadata:former_category TROJAN;classtype:trojan-activity;sid:2834373;rev:1;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag SSL_TLS_SNI, signatrue_severity Major, created_at 2019_01_14, malware_family CobaltStrike, performance_impact Low, updated_at 2019_09_28;)", "2018020005": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MSSQL\u767b\u5f55\u6210\u529f|tag:\u767b\u5f55|direction:in|service_name:MSSQL|service_class:database|src:home_net|dest:external_net|level:action|result:success|o_msg:\u68c0\u6d4b\u5230MSSQL(version:2012)\u767b\u9646\u6210\u529f|server:src\";dsize:150<>400;flow:to_client,established;content:\"|04 01|\";depth:2;content:\"Microsoft SQL Server|00 00|\";distance:0;nocase;content:\"|00 00|\";isdataat:!1,relative;sid:2018020005;rev:1;)", "2025810": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT php script double base64 encoded Remote Code Execution 1|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"THlvOFAzQm9jQ\";metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025810;rev:2;metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2019090090": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:FileZilla\u8fde\u63a5|direction:in|level:action|service_name:FileZilla|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728FileZilla|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220.*\\r\\n214-The following commands are recognized:\\r\\n   USER   PASS   QUIT   CWD    PWD    PORT   PASV   TYPE\\r\\n   LIST   REST   CDUP   RETR   STOR   SIZE   DELE   RMD \\r\\n   MKD    RNFR   RNTO   ABOR   SYST   NOOP   APPE   NLST\\r\\n   MDTM   XPWD   XCUP   XMKD   XRMD   NOP    EPSV   EPRT\\r\\n   AUTH   ADAT   PBSZ   PROT   FEAT   MODE   OPTS   HELP\\r\\n   ALLO   MLST   MLSD\\r\\n214 Have a nice day\\.\\r\\n/\";sid:2019090090;gid:0;)", "2018010027": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u89e3\u6790\u6f0f\u6d1e\u63a2\u6d4b|tag:\u89e3\u6790\u6f0f\u6d1e\u8bd5\u63a2|phase:exploit|dest:home_net|level:attack|severity:1|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:IIS6.0\u89e3\u6790\u6f0f\u6d1e\u63a2\u6d4b|attacker:src\";content:\"GET\";nocase;http_method;content:\".asa\";nocase;http_uri;within:200;pcre:\"/\\/[\\d\\w_-]\\.(jpg|gif|png)/iUR\";flow:to_server,established;gid:0;sid:2018010027;rev:1;)", "2020081003": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:nishang \u7aef\u53e3\u626b\u63cf|tag:webshell|type:shell|tool:nishang|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:nishang \u7aef\u53e3\u626b\u63cf(FireBuster),\u626b\u63cf\u7ed3\u679c\u901a\u8fc7web\u754c\u9762\u8fd4\u56de|failed_by:http_status_3XX,http_status_4XX\";content:\"200\";http_stat_code;flow:from_server,established;http_content_type;content:\"text/html\";pkt_data;content:\"Trying to connect to \";http_server_body;content:\"Sending....\";http_server_body;distance:0;content:\": Trying port \";http_server_body;distance:0;within:100;content:\"Data sent to all ports\";http_server_body;distance:0;sid:2020081003;)", "2020050721": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ElasticSearch \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2014-3120\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:ElasticSearch \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2014-3120\uff09|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, es_rce;content:\"POST\";http_method;content:\"/_search?pretty\";http_uri;content:\"script_fields\";http_client_body;content:\"script\";http_client_body;distance:0;pcre:\"/(ProcessBuilder)|(Runtime\\.getRuntime)/PR\";sid:2020050721;rev:2;)", "2020020000": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:phpmyadmin\u767b\u5f55\u6210\u529f|tag:phpmyadmin|dest:home_net|phase:exploit|level:attack|severity:1|result:success|o_msg:phpmyadmin\u767b\u5f55\u6210\u529f|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"pmaUser-1=%7B%22iv%22%3A%22\";http_cookie;content:\"<a href=\\\"logout.php\\\"\";http_server_body;flowbits:isset, phpmyadmin_login;flowbits:unset, phpmyadmin_login;gid:4;sid:2020020000;)", "2019010126": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Solr\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e \uff08CVE-2019-12409\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Apache Solr\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e \uff08CVE-2019-12409\uff09|attacker:src\";flow:established, to_server;flowbits:set, cve_2019_12409;content:\"P|ac ed 00 05|w\\\"U\";startswith;content:\"sr| 00 1b |javax.management.ObjectName\";distance:16;content:\"MLet\";distance:0;content:\"getMBeansFromURL\";distance:0;content:\"java.rmi.MarshalledObject\";distance:0;sid:2019010126;rev:1;)", "2019010111": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ThinkCMF \u4efb\u610f\u5185\u5bb9\u5305\u542b\u6f0f\u6d1e|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:ThinkCMF \u4efb\u610f\u5185\u5bb9\u5305\u542b\u6f0f\u6d1e|attacker:src\";flow:to_server,established;flowbits:set, thinkcmf_include_file;content:\"GET\";http_method;content:\"a=display\";http_uri;content:\"templateFile=\";http_uri;sid:2019010111;rev:1;)", "2018030033": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528Cobalt Strike\u626b\u63cf|tag:\u626b\u63cf\u5de5\u5177|tool:Cobalt Strike|phase:recon|dest:home_net|level:attack|severity:2|result:unknown|o_msg:\u4f7f\u7528Cobalt Strike\u626b\u63cf|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"HEAD\";nocase;http_method;content:\"/.cobalt/admin/.hta\";nocase;http_uri;within:1000;flow:to_server,established;sid:2018030033;rev:1;)", "2018010057": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MSSQL\u6ce8\u5165|tag:\u6ce8\u5165\u5224\u65ad\u7528\u6237\u6743\u9650|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MSSQL\u6ce8\u5165 -  \u5224\u65ad\u7528\u6237\u6743\u9650|dest:home_net|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"and\";nocase;http_uri;pcre:\"/[ +]+\\(select[ +]+is_srvrolemember\\(['\"]sysadmin/iUR\";flow:to_server,established;gid:0;sid:2018010057;rev:1;)", "2018030028": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Burpsuite\u653b\u51fb\u5c1d\u8bd5|tag:web\u6f0f\u6d1e\u626b\u63cf|tool:burpsuite|phase:recon|dest:home_net|level:attack|severity:2|result:unknown|o_msg:\u4f7f\u7528burp\u8fdb\u884c\u5404\u79cdweb\u6f0f\u6d1e\u653b\u51fb\u5c1d\u8bd5|failed_by:http_status_3XX,http_status_4XX|attack_type:target|attacker:src\";content:\"connect\";nocase;http_method;content:\".burpcollaborator.net\";nocase;http_uri;within:1024;pcre:\"/[\\d\\w]{30,40}.burpcollaborator.net/iU\";flow:to_server,established;sid:2018030028;rev:1;)", "2019010106": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Harbor\u4efb\u610f\u7ba1\u7406\u5458\u6ce8\u518c\u6f0f\u6d1e(CVE-2019-16097)|tag:\u6743\u9650\u7ed5\u8fc7|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Harbor\u4efb\u610f\u7ba1\u7406\u5458\u6ce8\u518c\u6f0f\u6d1e(CVE-2019-16097)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, harbor_privilege_escalation;content:\"POST\";http_method;content:\"/api/users\";http_uri;content:\"\\\"has_admin_role\\\":true\";http_client_body;fast_pattern;content:\"\\\"username\\\":\";http_client_body;content:\"\\\"email\\\":\";http_client_body;content:\"\\\"realname\\\":\";http_client_body;content:\"\\\"password\\\":\";http_client_body;sid:2019010106;rev:1;)", "2020051505": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:web.xml \u6587\u4ef6\u6cc4\u9732|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:web.xml \u6587\u4ef6\u6cc4\u9732|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;http_content_type;pcre:\"/(application\\/xml)|(text\\/html)/\";pkt_data;content:\"<?xml version=\";http_server_body;content:\"<web-app \";http_server_body;distance:0;content:\"</web-app>\";http_server_body;distance:200;sid:2020051505;rev:1;)", "2019090027": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:VNC\u8fde\u63a5|direction:in|level:action|service_name:VNC|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728VNC|server:src\";flow:from_server,established;content:\"RFB\";depth:3;pcre:\"/^RFB 009\\.123\\n/\";sid:2019090027;gid:0;)", "2020032110": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Apache axis2 \u901a\u8fc7cat.arr\u6267\u884c\u547d\u4ee4|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Apache axis2 \u901a\u8fc7cat.arr\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, axis2_exec_by_cat;content:\"500\";http_stat_code;http_content_type;content:\"application/xml\";pkt_data;content:\"<soapenv:Reason xmlns:soapenv=\";startswith;http_server_body;content:\"<soapenv:Text xml:\";http_server_body;distance:10;content:\"localname can not\";http_server_body;distance:0;content:!\"<faultstring>\";http_server_body;content:!\"The ServiceClass object does not implement\";http_server_body;sid:2020032110;rev:1;)", "2024364": "alert http $HOME_NET any -> any any (msg:\"name:Nmap \u626b\u63cf|tag:\u626b\u63cf|tool:Nmap|type:\u6307\u7eb9\u63a2\u6d4b|direction:in|phase:recon|src:home_net|dest:home_net|level:attack|severity:1|result:unknown|o_msg:NMAP\u626b\u63cf\u68c0\u6d4bHTTP\u548cweb\u5e94\u7528\u6307\u7eb9|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"|20|Nmap\";http_user_agent;fast_pattern;metadata:former_category SCAN;classtype:web-application-attack;sid:2024364;rev:3;metadata:affected_product Any, attack_target Client_and_Server, deployment Perimeter, signature_severity Informational, created_at 2017_06_08, performance_impact Low, updated_at 2017_06_13;)", "2019090053": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(POP3)|direction:in|level:action|service_name:Microsoft Exchange(POP3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange|server:src\";flow:from_server,established;content:\"*OK Microsoft Exchange\";depth:23;pcre:\"/^\\+OK Microsoft Exchange Server 2003 POP3 server version ([\\d.]+) \\(([-\\w_.]+)\\) ready\\.\\r\\n/\";sid:2019090053;gid:0;)", "2019030007": "alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528ngrok\u8fdb\u884c\u5185\u7f51\u7a7f\u900f|tag:tunnel|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|tool:ngrok|result:unknown|o_msg:\u5c1d\u8bd5\u4e0e\u516c\u7f51ngrok\u670d\u52a1\u5668\u5efa\u7acb\u63a7\u5236\u8fde\u63a5\uff0c\u53ef\u7528\u6765\u8fdb\u884c\u5185\u7f51\u7a7f\u900f\";flow:established,to_server;tls_sni;content:\"tunnel.au.ngrok.com\";flowbits:set,ngrok_state_findsni;flowbits:noalert;sid:2019030007;)", "2020061205": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Shiro \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Apache Shiro \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"rememberMe=\";http_cookie;pcre:\"/^([A-Za-z0-9+\\/]{4}){600}([A-Za-z0-9+\\/]{4})*([A-Za-z0-9+\\/]{4}|[A-Za-z0-9+\\/]{3}=|[A-Za-z0-9+\\/]{2}==)/CR\";content:\"Java/1.8.0_231\";http_user_agent;http_accept;content:\"text/html, image/gif, image/jpeg, *\\; q=.2, */*\\; q=.2\";pkt_data;sid:2020061205;rev:1;)", "2020030201": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:FasterXML/jackson-databind \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-9547\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:FasterXML/jackson-databind \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-9547\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig\";content:\"properties\";distance:0;content:\"UserTransaction\";distance:0;pcre:\"/(ldap|rmi):\\/\\//Ri\";sid:2020030201;rev:1;)", "2020051908": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring SpEL\u8868\u8fbe\u5f0f\u4ee3\u7801\u6ce8\u5165|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Spring SpEL\u8868\u8fbe\u5f0f\u4ee3\u7801\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"#{T(String).getClass().forName\";http_client_body;content:\"invoke(T(String).getClass().forName(\";http_client_body;distance:0;content:\"new String[]\";http_client_body;distance:0;sid:2020051908;rev:1;)", "2020060220": "alert TCP $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(CommonsCollections4-TCP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|attacker:src\";flow:established, to_server;content:\"|ac ed 00 05|\";fast_pattern;content:\"java.util.PriorityQueue\";content:\"org.apache.commons.collections4.functors.InstantiateTransformer\";content:\"getRuntime()\";sid:2020060220;rev:1;)", "2019090263": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"E|00 00 00|\";depth:4;pcre:\"/^E\\0\\0\\0.S[^\\0]+\\0VFATAL\\0C0A000\\0M.*?65363\\.19778.*\\0F\\.\\\\src\\\\backend\\\\postmaster\\\\postmaster\\.c\\0L\\d{4}\\0RProcessStartupPacket\\0\\0$/\";sid:2019090263;gid:0;)", "2019060023": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"ASPSESSIONID\";http_cookie;pcre:\"/[a-zA-Z]+=[a-zA-Z0-9]{24}/CR\";http_content_len;byte_test:0,=,16,0,string,dec;pkt_data;content:\"c\";nocase;http_server_body;within:16;pcre:\"/^([a-f0-9A-F]{16})$/Q\";isdataat:!1,relative;noalert;flowbits:isset, bingxie_webshell_asp;flowbits:set, bingxie_webshell_step2_asp;sid:2019060023;gid:0;rev:1;)", "2019010025": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u547d\u4ee4\u6ce8\u5165\u5c1d\u8bd5|tag:\u547d\u4ee4\u6ce8\u5165|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u5c1d\u8bd5\u8fdb\u884c\u547d\u4ee4\u6ce8\u5165\uff0c\u6709\u6781\u5927\u53ef\u80fd\u662f\u626b\u63cf\u5668\u6216\u8815\u866b|attacker:src\";flow:to_server,established;content:\"\\;wget http://\";http_uri;nocase;content:\"\\;chmod 777\";http_uri;within:60;nocase;gid:3;sid:2019010025;rev:1;)", "202099995": "alert tcp $HOME_NET any -> $HOME_NET any (msg:\"name:\u68c0\u6d4bSSH\u6307\u7eb9|tag:\u626b\u63cf|tool:Nmap|type:infil|direction:in|phase:post_exploit|src:home_net|attacker:src|dest:home_net|level:attack|severity:1|result:unknown|o_msg:NMAP \u68c0\u6d4bSSH\u6307\u7eb9\";dsize:20;content:\"SSH\";nocase;offset:0;pcre:\"/-\\d\\.\\d-NmapNSE_\\d\\.\\d/iR\";flow:to_server,established;sid:202099995;rev:1;)", "2016956": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Struts2\u6f0f\u6d1e\u5229\u7528|tag:Struts\u6f0f\u6d1e|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|success_by:execmd|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Struts2 OGNL Java Exec\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u7684payload\u653b\u51fb\u7cfb\u7edf|attacker:src\";flow:to_server,established;content:\"memberAccess\";http_uri;nocase;content:\"allowStaticMethodAccess\";http_uri;nocase;flowbits:set,cmd_reponse_echo;sid:2016956;)", "2020062204": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:jboss\u5185\u5b58webshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:success|o_msg:jboss\u5185\u5b58webshellwebshell|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"jboss_init_redhat.sh|0a|\";http_server_body;content:\"jbosssvc.exe|0a|\";http_server_body;content:\"service.bat|0a|\";http_server_body;content:\"shutdown.sh|0a|\";http_server_body;content:\"jboss_init_solaris.sh|0a|\";http_server_body;content:\"jboss_init_hpux.sh|0a|\";http_server_body;sid:2020062204;rev:1;)", "2012309": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"name:NightDragon\u540e\u95e8\u6728\u9a6c|type:rat|tag:NightDragon|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230Night Dragon \u670d\u52a1\u5668\u8ba4\u8bc1\u6728\u9a6c\";flow:established,from_server;dsize:29;content:\"|00 00|password|00 00 00|\";offset:3;depth:13;reference:url,www.mcafee.com/us/resources/white-papers/wp-global-energy-cyberattacks-Night-dragon.pdf;classtype:trojan-activity;sid:2012309;rev:1;)", "2019070004": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ThinkPHP\u6f0f\u6d1e|tag:ThinkPHP\u6f0f\u6d1e\u5229\u7528|direction:out|src:home_net|dest:external_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:attack_out|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728ThinkPHP\u6f0f\u6d1e\";content:\"GET\";nocase;http_method;content:\"/index.php\";nocase;http_uri;within:100;pcre:\"/(\\/)?\\?s=(\\/)?index\\/\\\\think\\\\Request/input&filter=/iUR\";flow:to_server,established;gid:0;sid:2019070004;rev:1;)", "2008440": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (Download App)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| Download App\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008440;classtype:trojan-activity;sid:2008440;rev:11;)", "2020062903": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u670d\u52a1\u5668\u88ab\u4e0a\u4f20 reDuh \u4ee3\u7406\u6587\u4ef6|tag:\u653b\u51fb\u4ee3\u7406|tool:reDuh|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:4|result:unknown|o_msg:\u670d\u52a1\u5668\u88ab\u4e0a\u4f20 reDuh \u4ee3\u7406\u6587\u4ef6|attacker:dest|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"[reDuhError]Undefined Request\";depth:100;http_server_body;sid:2020062903;rev:1;)", "2019000070": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ThinkPHP 6.0 \u4efb\u610f\u6587\u4ef6\u521b\u5efa\u6f0f\u6d1e|tag:\u4efb\u610f\u6587\u4ef6\u521b\u5efa|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:ThinkPHP 6.0 \u4efb\u610f\u6587\u4ef6\u521b\u5efa\u6f0f\u6d1e|attacker:src\";flow:established, to_server;flowbits:set, thinkphp_upload;content:\"phpsession=\";http_cookie;nocase;content:\"%2E%2E%2F\";http_cookie;sid:2019000070;rev:1;)", "2008720": "alert tcp $HOME_NET any -> $HOME_NET 139 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";flow:established,to_server;content:\"|20 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"|00 2E 00 2E 00 5C 00 2E 00 2E 00 5C|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008720;classtype:attempted-admin;sid:2008720;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2019010015": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:weblogic\u6f0f\u6d1e\u5229\u7528|tag:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|dest:home_net|level:attack|severity:1|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Weblogic wls9_async_response.war\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"/_async/AsyncResponseService\";http_uri;flowbits:set, weblogic_1;gid:3;sid:2019010015;rev:1;)", "2020070807": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6587\u4ef6\u5305\u542b\u8bfb\u53d6|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u6587\u4ef6\u8bfb\u53d6\u5c1d\u8bd5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, file_read_general;content:\"logs\";http_client_body;fast_pattern;pcre:\"/access(\\.|_)log/P\";sid:2020070807;rev:1;)", "2020080322": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7 Metasploit \u8fde\u63a5\u670d\u52a1\u5668(tcp)|tag:\u53cd\u5f39shell|dest:home_net|level:attack|phase:exploit|severity:3|attack_type:target|result:unknown|o_msg:Metasploit \u8fde\u63a5(windows/shell/bind_tcp)|attacker:src\";flags:P, A;flow:to_server, established;flowbits:isset, windows_shell_bind_tcp;flowbits:set, windows_shell_bind_tcp_1;dsize:267;content:\"|c9 b1 3d|\";offset:13;depth:3;sid:2020080322;)", "2027030": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"hpcyBwcm9ncm\";distance:0;fast_pattern;metadata:former_category ATTACK_RESPONSE;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027030;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_03_05, malware_family DNSlivery, updated_at 2019_03_05;)", "180805101": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:XorDDoS|type:botnet|tag:XorDDoS|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u6728\u9a6c\u6837\u672cWin32/Linux.Xor.DDos\u4e0a\u7ebf\";flow:to_server,established;content:\"|36 a0 26 b8 10 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|\";dsize:28;depth:28;classtype:trojan-activity;sid:180805101;rev:1;)", "2020062901": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|attacker:src\";flow:established, to_server;flowbits:set, cve_2016_0638;flowbits:set, cve_2017_3248;flowbits:set, cve_2016_3510;flowbits:set, cve_2018_3191;flowbits:set, cve_2018_2893;flowbits:set, cve_2017_3248_or_2018_2628;xbits:set, weblogic_link_jrmp, track ip_dst, expire 60;content:\"t3\";depth:2;content:\"|ac ed 00 05|\";distance:0;pcre:\"/org\\.apache\\.commons\\.collections\\.functors|com\\.sun\\.org\\.apache\\.xalan\\.internal\\.xsltc\\.trax|javassist|java\\.rmi\\.activation|sun\\.rmi\\.server|org\\.jboss\\.interceptor\\.builder|org\\.jboss\\.interceptor\\.reader|org\\.jboss\\.interceptor\\.proxy|org\\.jboss\\.interceptor\\.spi\\.metadata|org\\.jboss\\.interceptor\\.spi\\.model|com\\.bea\\.core\\.repackaged\\.springframework\\.aop\\.aspectj|com\\.bea\\.core\\.repackaged\\.springframework\\.aop\\.aspectj\\.annotation|com\\.bea\\.core\\.repackaged\\.springframework\\.aop\\.aspectj\\.autoproxy|com\\.bea\\.core\\.repackaged\\.springframework\\.beans\\.factory\\.support|org\\.python\\.core|org\\.codehaus\\.groovy\\.runtime\\.ConvertedClosure|org\\.codehaus\\.groovy\\.runtime\\.ConversionHandler|org\\.codehaus\\.groovy\\.runtime\\.MethodClosure|org\\.springframework\\.transaction\\.support\\.AbstractPlatformTransactionManager|java\\.rmi\\.server\\.UnicastRemoteObject|java\\.rmi\\.server\\.RemoteObjectInvocationHandler|com\\.bea\\.core\\.repackaged\\.springframework\\.transaction\\.support\\.AbstractPlatformTransactionManager|java\\.rmi\\.server\\.RemoteObject|java\\.lang\\.Runtime|com\\.tangosol\\.util\\.extractor\\.ChainedExtractor|com\\.tangosol\\.util\\.filter\\.LimitFilter/R\";sid:2020062901;rev:1;)", "2020062215": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:success|o_msg:\u653b\u51fb\u8005\u5c1d\u8bd5\u901a\u8fc7webshell\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, mem_webshell_interaction;content:\"200\";http_stat_code;content:\"sun.net.www.protocol.http.HttpURLConnection cannot be cast to javax.net.ssl.HttpsURLConnectionsun.net.www.protocol.http.HttpURLConnection cannot be cast to javax.net.ssl.HttpsURLConnection\";http_server_body;sid:2020062215;rev:1;)", "2018040004": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf|tag:SYN\u626b\u63cf|type:\u6307\u7eb9\u63a2\u6d4b|direction:in|phase:recon|src:external_net|dest:home_net|level:attack|severity:1|result:unknown|o_msg:syn\u626b\u63cf\";flow:to_server;flags:S,CE;threshold:type both, track by_dst, count 120000, seconds 60;sid:2018040004;rev:1;)", "2019090116": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(imap)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"* OK \";depth:5;pcre:\"/^\\* OK \\[CAPABILITY IMAP4rev1 LITERAL\\+ SASL-IR LOGIN-REFERRALS ID ENABLE IDLE AUTH=PLAIN AUTH=CRAM-MD5/\";sid:2019090116;gid:0;)", "2020021010": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Laravel \u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u6267\u884c\u547d\u4ee4)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Laravel \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Illuminate\";content:\"Broadcasting\";distance:1;content:\"PendingBroadcast\";distance:1;content:\"*events\";distance:1;content:\"Illuminate\";distance:1;content:\"Validation\";distance:1;content:\"Validator\";distance:1;content:\"extensions\";distance:1;content:\"*event\";distance:1;sid:2020021010;rev:1;)", "2018010044": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"information_schema.tables\";nocase;http_uri;pcre:\"/from(%20| )information_schema(%2e|\\.)tables/U\";flow:to_server,established;gid:0;sid:2018010044;rev:1;)", "2018010107": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165\u5199\u5165\u6587\u4ef6|tag:\u6ce8\u5165\u5199\u6587\u4ef6|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:\u5c1d\u8bd5\u5229\u7528MySQL\u6ce8\u5165\u5199\u5165\u6587\u4ef6|attacker:src\";content:\"select\";nocase;http_header;pcre:\"/[\\s\\w/\\\\.*\\d()\"'=,:\\;+<>_-]+into[(\\/\\*.*\\*\\/)| ]dumpfile[(\\/\\*.*\\*\\/)| ]['\"][0-9A-Za-z/\\\\._:-]+['\"]/iHR\";flow:to_server,established;gid:0;sid:2018010107;rev:1;)", "2020052407": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:reGeorg\u8fde\u63a5\u6210\u529f|tag:\u653b\u51fb\u4ee3\u7406|tool:reGeorg|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u5185\u7f51\u6e17\u900f\u65f6\u7684\u5e38\u7528\u5de5\u5177reGeorg|failed_by:http_status_3XX,http_status_4XX\";flowbits:isset, regeory_read;flow:from_server,established;content:\"200\";http_stat_code;content:\"X-STATUS: OK\";http_header;content:\"Connection: Keep-Alive\";http_header;threshold:type limit, track by_dst, count 1, seconds 60;sid:2020052407;rev:1;)", "2020060903": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5229\u7528Header\u8fdb\u884c\u547d\u4ee4\u6ce8\u5165|tag:\u547d\u4ee4\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|type:exploit|severity:3|result:unknown|o_msg:\u5c1d\u8bd5\u901a\u8fc7header\uff0c\u8fdb\u884c\u547d\u4ee4\u6ce8\u5165\uff0c\u5e38\u89c1\u4e8eweblogic\u6f0f\u6d1e\u53caShiro\u6f0f\u6d1e\u7b49|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"|0d 0a|cmd: \";http_header;nocase;pcre:\"/^(ls|cd|pwd|wget|curl|adduser|cat|passwd|chmod|echo|netstat|uname|sysctl|mysql|history|bash|useradd|ps|ifconfig|find|id|grep|awk|last|lsof|iptables|find|whoami|touch|ping)/HR\";sid:2020060903;rev:1;)", "2020010019": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:XSS\u6f0f\u6d1e\u5c1d\u8bd5|tag:xss|dest:home_net|level:attack|phase:exploit|severity:1|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Xss\u6f0f\u6d1e\u5c1d\u8bd5|attacker:src\";flow:to_server,established;content:\"|3C|embed src=\";nocase;http_header;sid:2020010019;rev:1;)", "2020020703": "alert tcp $EXTERNAL_NET any -> $HOME_NET 6379 (msg:\"name:redis\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:redis\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff08\u57fa\u4e8e\u4e3b\u4ece\u590d\u5236\uff09|attacker:src\";flow:established, to_server;flowbits:isset, dbfilename;flowbits:unset, dbfilename;flowbits:set, load_exp;content:\"|24 36 0d 0a|MODULE\";nocase;content:\"|24 34 0d 0a|LOAD\";nocase;distance:2;within:10;content:\".so\";nocase;distance:2;within:20;sid:2020020703;rev:1;)", "2020022501": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Fastjson <=1.2.62 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Fastjson <=1.2.62 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"@type\";content:\"org.apache.xbean.propertyeditor.JndiConverter\";distance:0;content:\"asText\";distance:0;nocase;pcre:\"/(ldap|rmi):\\/\\//Ri\";sid:2020022501;rev:1;)", "2018081325": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u8fdb\u884c\u7aef\u53e3\u626b\u63cf\";dsize:10;flow:from_server,established;content:\"PortScan|0D 0A|\";nocase;flowbits:isset,TB_ZxShell;sid:2018081325;rev:1;)", "2020062220": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:success|o_msg:\u653b\u51fb\u8005\u5c1d\u8bd5\u901a\u8fc7webshell\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, mem_webshell_interaction;content:\"200\";http_stat_code;http_content_len;content:\"28\";pkt_data;content:\"Georg says, 'All seems fine'\";http_server_body;depth:28;sid:2020062220;rev:1;)", "2020010028": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528\u6f0f\u6d1e\u6267\u884c\u547d\u4ee4|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u68c0\u6d4b\u5230\u8fdc\u7a0b\u547d\u4ee4\u6267\u884cwhoami|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;http_content_len;byte_test:0,<,7,0,string,dec;pkt_data;content:\"mysql\";http_server_body;flowbits:isset,cmd_reponse_echo;sid:2020010028;)", "2019010081": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:php create_function\u6f0f\u6d1e\u5229\u7528|tag:webshell php|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u901a\u8fc7create_function\u95f4\u63a5\u8c03\u7528eval\u89e6\u53d1rce|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established,to_server;http_request_line;content:\".php?\";content:\"=\";distance:0;content:\"}\";distance:0;content:\"\\;//\";distance:0;pcre:\"/\\.php\\?\\w+=[\\w\\s@()\\;.'\"_-]*}\\s*@?(?:echo )?(?:system|assert|eval|exec|shell_exec|passthru|popen|proc_open|)\\([\\s\\w'\"$_\\[\\]()%]*?\\)\\s*\\;\\s*\\/[*/]/U\";flowbits:set,php_create_function;sid:2019010081;)", "2020071444": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|severity:3|result:success|phase:control|o_msg:webshell\u4ea4\u4e92|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"FAction==\\\"CopyFile\\\"\";http_server_body;content:\"FAction==\\\"MoveFile\\\"\";http_server_body;content:\"FAction==\\\"CopyFolder\\\"\";http_server_body;content:\"FAction==\\\"MoveFolder\\\"\";http_server_body;content:\"FAction==\\\"NewFolder\\\"\";http_server_body;sid:2020071444;)", "2020060230": "alert TCP $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(BeanShell1-TCP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|attacker:src\";flow:established, to_server;content:\"|ac ed 00 05|\";fast_pattern;content:\"java.util.PriorityQueue\";content:\"bsh.BSHAllocationExpression\";content:\"bsh.BSHAmbiguousName\";content:\"bsh.BSHArrayDimensions\";content:\"bsh.BSHLiteral\";sid:2020060230;rev:1;)", "2019060027": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"ASP.NET_SessionId=\";http_cookie;pcre:\"/[a-zA-Z0-9]{24}/CR\";http_content_len;byte_test:0,=,16,0,string,dec;pkt_data;content:\"f\";nocase;http_server_body;within:16;pcre:\"/^([a-f0-9A-F]{16})$/Q\";isdataat:!1,relative;noalert;flowbits:isset, bingxie_webshell_aspx;flowbits:set, bingxie_webshell_step2_aspx;sid:2019060027;gid:0;rev:1;)", "2020072218": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Apache Server Status\u4fe1\u606f\u6cc4\u6f0f|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:1|result:success|o_msg:Apache Server Status\u4fe1\u606f\u6cc4\u6f0f|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;content:\"<title>Apache Status</title>\";http_server_body;fast_pattern;content:\"Current Time:\";http_server_body;distance:0;content:\"Restart Time:\";http_server_body;distance:0;content:\"Server uptime:\";http_server_body;distance:0;content:\"CPU Usage:\";http_server_body;distance:0;sid:2020072218;rev:1;)", "2020081445": "alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08udp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884c\u547d\u4ee4ifconfig\";content:\" flags=\";fast_pattern;pcre:\"/^\\d+<[a-zA-Z,]+> {2}mtu \\d+\\x0a/Ri\";content:\"inet \";distance:8;content:\"netmask \";distance:7;within:35;content:\"broadcast \";distance:7;within:45;content:\"ether \";distance:7;sid:2020081445;)", "2019000041": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6f0f\u6d1e\u5229\u7528\u6267\u884cdir|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:4|gray:true|result:success|o_msg:webshell\u6267\u884cnet user|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"<DIR>\";nocase;http_server_body;pcre:\"/\\d{4}\\/\\d{2}\\/\\d{2}\\s+\\d{2}:\\d{2}\\s+<DIR>\\s+\\./Q\";flowbits:isset,cmd_reponse_echo;flowbits:unset,cmd_reponse_echo;sid:2019000041;)", "2826446": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u77ff\u6c60\u5730\u5740|type:mining|tag:BitCoinMiner|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u6316\u77ff\u6728\u9a6c\u534f\u8bae\u7279\u5f81\";flow:established,to_server;content:\"|22|id|22 3A|\";content:\"|22|method|22 3a|\";pcre:\"/(?:\\x22mining\\.authorize\\x22\\x2c|\\x22login\\x22\\x2c)/R\";content:\"|22|params|22|\";within:50;pcre:\"/(?:\\x22login\\x22\\x3a\\x20\\x2247qvYMnvsatLmowtUDk2zF5vpzUver4iiQYg381Un46kBMfeTAZvy8F6iGtbcWsqbW37Ts2ejupKobb6Q73vJaxVRnhdCHf\\x22\\x2c\\x20\\x22pass\\x22\\x3a\\x20\\x22x\\x22|\\x22login\\x22\\x3a\\x20\\x224AUwCvi1ySzCsVrmmMQp9BEsSDMv2sRL6bRFy5UmwkEyXwVNwRUqi3nS94kNxGbVNn6Yg3aposmb3eWbFwGAZzvVQKmgpmX\\x22\\x2c\\x20\\x22pass\\x22\\x3a\\x20\\x22x\\x22|\\x22login\\x22\\x3a\\x20\\x2242hDr4Lh2QbiLxrZbRZVmxgKGkMaSKWHSfTG6cBHb3yZ8NNEMuZKta74FqMvejvejyhvyT8C8pXY1TqpRS4czWvf744JjqP\\x22\\x2c\\x20\\x22pass\\x22\\x3a\\x20\\x22x\\x22|\\x22login\\x22\\x3a\\x20\\x2249gM2fQLSyy8K3cku8kVD3QVJ8jk3w8Ami4AZZctnUusPrN4p1uJN95aYKm7hc28yrYtCSkrD1kucJphXbWsbiNuMGHUxab\\x22\\x2c\\x20\\x22pass\\x22\\x3a\\x20\\x22x\\x22)/R\";reference:url,research.zscaler.com/2013/12/bitcoin-mining-operation-seen-across.html;reference:url,www.btcguild.com/new_protocol.php;reference:url,mining.bitcoin.cz/stratum-mining;reference:md5,e01010afd19ca4c0a7afa4002fa2ff1c;classtype:trojan-activity;sid:2826446;rev:2;)", "2806280": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u60e0\u666eIMC\u76ee\u5f55\u904d\u5386|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:2|gray:true|result:unknown|o_msg:\u60e0\u666eIMC\u6f0f\u6d1e\u5229\u7528|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"/reportImg?path=\";http_uri;content:\"|2e 2e 2f|\";depth:200;reference:cve,2012-5203;reference:bugtraq,58672;reference:url,zerodayinitiative.com/advisories/ZDI-13-052/;classtype:attempted-admin;sid:2806280;rev:2;metadata:created_at 2013_04_19, updated_at 2013_04_19;)", "2831299": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:D-Link\u8def\u7531\u5668\u6f0f\u6d1e|tag:\u968f\u673a\u626b\u63cf|type:\u626b\u63cf|direction:in|phase:recon|src:external_net|dest:home_net|level:attack|severity:1|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:D-Link DSL-2750B \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u8bd5\u63a2\u6027\u5c1d\u8bd5\";flow:to_server,established;content:\"/login.cgi?cli=\";http_uri;content:\"$\";http_uri;distance:0;metadata:former_category EXPLOIT;reference:url,www.quantumleap.it/d-link-router-dsl-2750b-firmware-1-01-1-03-rce-no-auth;reference:url,www.exploit-db.com/exploits/44760;classtype:attempted-admin;sid:2831299;rev:2;metadata:affected_product HTTP_Server, attack_target Networking_Equipment, created_at 2018_06_18, malware_family Satori, updated_at 2018_06_18;)", "2020063006": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Nexus Repository Manager 3 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2019-7238\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Nexus Repository Manager 3 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2019-7238\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2019_7238;content:\"POST\";http_method;content:\"/service/extdirect\";http_uri;depth:30;http_content_type;content:\"application/json\";pkt_data;content:\"\\\"type\\\"\";http_client_body;content:\"\\\"jexl\\\"\";http_client_body;distance:0;within:40;content:\".class.forName(\";http_client_body;sid:2020063006;rev:1;)", "2019090256": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"EFATAL 1:\";depth:9;pcre:\"/^EFATAL 1:  invalid length of startup packet\\n\\0/\";sid:2019090256;gid:0;)", "2020051929": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee(loggers)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, spring_actuator_loggers;content:\"/actuator/loggers\";http_uri;sid:2020051929;rev:1;)", "2019010099": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6cdb\u5faeOA E-cology \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u6cdb\u5faeOA E-cology \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|attacker:src\";flow:to_server,established;flowbits:set, ecology_oa_beanbash_rce;noalert;content:\"POST\";http_method;content:\"/\";http_uri;depth:1;pcre:\"/(\\/bsh.servlet.BshServlet|\\/weaver\\/bsh.servlet.BshServlet|\\/weaveroa\\/bsh.servlet.BshServlet|\\/oa\\/bsh.servlet.BshServlet)/Ui\";content:\"bsh.script=\";http_client_body;fast_pattern;pcre:\"/((e|((\\\\|%5c)u0065))(x|(\\\\|%5c)u0078)(e|(\\\\|%5c)u0065)(c|(\\\\|%5c)u0063))/RPi\";sid:2019010099;rev:1;)", "2020060104": "alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u68c0\u6d4b\u5230Cobalt Strike|tag:cs|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:cobaltstrike|attacker:src\";flow:established, to_client;tls_cert_subject;content:\"C=, ST=, L=, O=, OU=, CN=\";sid:2020060104;rev:2;)", "20258051": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:payload\u4e2d\u5305\u542bbase64\u540e\u7684/bin/bash|tag:payload|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u653b\u51fbpayload\u4e2d\u4f7f\u7528base64\u7f16\u7801\u540e\u7684/bin/bash|attacker:src\";flow:to_server,established;content:\"9iaW4vYmFza\";http_client_body;metadata:former_category EXPLOIT;classtype:attempted-user;sid:20258051;rev:2;metadata:attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2019090045": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(SMTP)|direction:in|level:action|service_name:Microsoft Exchange(SMTP)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange Server|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 ([-.+\\w]+) ESMTP Server \\(Microsoft Exchange Internet Mail Service ([-\\w.]+)\\) ready/\";sid:2019090045;gid:0;)", "2020051108": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:kindeditor 4.1.5 \u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:success|o_msg:kindeditor 4.1.5 \u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e|gray:true|attacker:src\";flow:from_server,established;flowbits:isset, kindeditor_upload;content:\"200\";http_stat_code;content:\"\\\"error\\\":0\";http_server_body;sid:2020051108;rev:1;)", "2008214": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (sickness29a/0.1)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| sickness\";nocase;http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008214;classtype:trojan-activity;sid:2008214;rev:8;)", "2020062203": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:tomcat\u5185\u5b58webshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:success|o_msg:tomcat\u5185\u5b58webshellwebshell|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"bootstrap.jar|0a|\";http_server_body;content:\"setclasspath.bat|0a|setclasspath.sh|0a|\";http_server_body;content:\"shutdown.bat|0a|shutdown.sh|0a|\";http_server_body;content:\"startup.bat|0a|startup.sh|0a|\";http_server_body;content:\"tomcat-juli.jar|0a|\";http_server_body;sid:2020062203;rev:1;)", "2019090227": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Courier\u8fde\u63a5|direction:in|level:action|service_name:Courier(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Courier pop3|server:src\";flow:from_server,established;content:\"-ERR \";depth:5;pcre:\"/^-ERR Invalid command\\.\\r\\n-ERR Invalid command\\.\\r\\n/\";sid:2019090227;gid:0;)", "2019010117": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Solr\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2019-0192)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Apache Solr\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2019-0192)\uff09|attacker:src\";flow:to_server,established;flowbits:set, cve_2019_0193;content:\"POST\";http_method;content:\"/solr/\";http_uri;startswith;content:\"/config\";http_uri;distance:0;content:\"set-property\";http_client_body;content:\"jmx.serviceUrl\";http_client_body;distance:3;content:\"service:jmx:rmi:///jndi/rmi://\";http_client_body;distance:3;sid:2019010117;rev:1;)", "2026921": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"ctT2J\";fast_pattern;distance:0;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026921;rev:3;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2020022401": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:FasterXML/jackson-databind \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-8840\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:FasterXML/jackson-databind \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-8840\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"org.apache.xbean.propertyeditor.JndiConverter\";content:\"asText\";distance:0;pcre:\"/(ldap|rmi):\\/\\//Ri\";sid:2020022401;rev:1;)", "2019010130": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165\u5199\u5165\u6587\u4ef6|tag:\u6ce8\u5165\u5199\u6587\u4ef6|dest:home_net|level:attack|phase:exploit|severity:2|success_by:sql_inject_success|o_msg:\u5c1d\u8bd5\u5229\u7528MySQL\u6ce8\u5165\u5199\u5165\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"select\";nocase;http_client_body;pcre:\"/[\\s\\w/\\\\.*\\d()\"'=,:\\;+<>_-]+/iPR\";content:\"into outfile \";nocase;http_client_body;distance:1;within:100;pcre:\"/['\"][0-9A-Za-z/\\\\._:-]+['\"]/iPR\";flow:to_server,established;gid:0;sid:2019010130;rev:1;)", "2019000076": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Fastjson <=1.2.61 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Fastjson <=1.2.61 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, fastjson_jndi;content:\"@type\";http_client_body;fast_pattern;content:\"org.apache.commons.proxy.provider.remoting.SessionBeanProvider\";http_client_body;distance:0;content:\"jndiName\";http_client_body;nocase;pcre:\"/(ldap|rmi):\\/\\//PRi\";sid:2019000076;rev:1;)", "2018010007": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:weblogic\u6f0f\u6d1e\u5229\u7528|tag:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6210\u529f\u653b\u51fbweblogic\u670d\u52a1\u5668\u5e94\u7528|attacker:src\";flow:from_server,established;content:\"500\";http_stat_code;content:\"Servlet\";nocase;http_header;content:\"java.lang.ProcessBuilder\";nocase;content:\"java.lang.ClassCastException\";nocase;content:\"WorkContextXmlInputAdapter.java\";nocase;content:\"WorkContextServerTube.java\";nocase;content:\"weblogic.wsee.workarea.WorkContextXmlInputAdapter\";nocase;gid:3;sid:2018010007;rev:1;)", "2019090079": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Serv-U\u8fde\u63a5|direction:in|level:action|service_name:Serv-U|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728Serv-U|server:src\";flow:from_server,established;content:\"431\";depth:3;pcre:\"/^431 Unable to negotiate secure command connection\\.\\r\\n/\";sid:2019090079;gid:0;)", "2020022604": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:joomscan\u626b\u63cf(\u679a\u4e3e\u5df2\u5b89\u88c5\u7684\u7ec4\u4ef6)|tag:scan|dest:home_net|level:attack|phase:recon|severity:3|result:unknown|o_msg:joomscan\u626b\u63cf(\u679a\u4e3e\u5df2\u5b89\u88c5\u7684\u7ec4\u4ef6)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"GET\";http_method;content:\"/components/\";http_uri;nocase;pcre:\"/\\.(txt|xml|log|md)/URi\";threshold:type both,track by_src,count 10,seconds 10;sid:2020022604;)", "2019010070": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:JNDI\u6ce8\u5165\u8c03\u7528\u53cd\u5f39|tag:ldap call|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u53ef\u80fd\u662f\u901a\u8fc7JNDI\u6ce8\u5165\u8c03\u7528\u8fdc\u7a0b\u65b9\u6cd5(ldap\u534f\u8bae)|attacker:dest\";dsize:<20;content:\"|30|\";offset:0;content:\"|02 01 01 60|\";offset:1;content:\"|02 01 03|\";offset:1;flow:to_server, established;xbits:isset,is_exploit_fastjson_ldap,track ip_src;gid:3;sid:2019010070;)", "2019010028": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165referer|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|success_by:sql_inject_success|o_msg:\u5c1d\u8bd5\u5229\u7528MySQL\u6ce8\u5165refer|attacker:src\";http_referer;content:\"union select 1,\";nocase;pkt_data;flow:to_server,established;gid:0;sid:2019010028;rev:1;)", "2020060803": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Atlassian Jira \u6a21\u677f\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2019-11581\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Atlassian Jira \u6a21\u677f\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2019-11581\uff09\uff0c\u7ba1\u7406\u5458\u5f00\u542f\u8054\u7cfb\u7ba1\u7406\u5458\u529f\u80fd|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/secure/\";http_uri;depth:10;pcre:\"/^((ContactAdministrators)|(admin\\/SendBulkMail))\\.jspa/UR\";content:\"subject=\";http_client_body;content:\"%24\";distance:0;within:20;http_client_body;content:\".getClass\";distance:0;http_client_body;content:\".forName\";distance:0;http_client_body;sid:2020060803;rev:1;)", "2020072907": "alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528\u5411\u65e5\u8475\u8fdc\u63a7|tag:\u5411\u65e5\u8475\u8fdc\u63a7|direction:in|level:action|service_name:\u5411\u65e5\u8475\u8fdc\u63a7|severity:1|service_class:rlogin|result:unknown|o_msg:\u4f7f\u7528\u5411\u65e5\u8475\u8fdc\u63a7|server:src\";dsize:30;flow:to_server;flowbits:set, sunlogin_1;noalert;content:\"|6f 72 61 79|\";depth:4;content:\"|03 04 00 18 04 00|\";distance:0;within:6;sid:2020072907;rev:2;)", "2019090212": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:qmail\u8fde\u63a5|direction:in|level:action|service_name:Qmail|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728qmail|server:src\";flow:from_server,established;content:\"451 \";depth:4;pcre:\"/^451 Temporary local problem - please try later\\r\\n/\";sid:2019090212;gid:0;)", "2020081725": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528Netsparker\u626b\u63cf|tag:\u626b\u63cf\u5668|dest:home_net|level:attack|phase:recon|severity:2|result:unknown|o_msg:\u4f7f\u7528Netsparker\u8fdb\u884c\u626b\u63cf|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Location: Netsparker\";http_header;sid:2020081725;rev:1;)", "201702500": "alert tcp $HOME_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528net user\u547d\u4ee4|tag:netuser|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:dest|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51Net User\u547d\u4ee4\u7684\u56de\u5305\";flow:established;content:\"User accounts for |5C 5C|\";fast_pattern;content:\"-------------------------------------------------------------------------------\";distance:0;content:\"Administrator\";within:20;classtype:successful-user;sid:201702500;rev:3;metadata:created_at 2013_06_17, updated_at 2013_06_17;)", "2020042601": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Axis2 \u5f31\u53e3\u4ee4\u767b\u5f55\u884c\u4e3a|tag:\u767b\u5f55\u884c\u4e3a|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Apache Axis2 \u767b\u5f55\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, axis2_login;content:\"POST\";http_method;content:\"/axis2-admin/login\";http_uri;nocase;http_content_type;content:\"application/x-www-form-urlencoded\";pkt_data;content:\"userName=\";http_client_body;content:\"admin\";http_client_body;distance:0;content:\"password=\";http_client_body;content:\"axis2\";http_client_body;distance:0;sid:2020042601;rev:1;)", "2019030003": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u8fde\u63a5\u5230\u516c\u7f51frp\u670d\u52a1\u5668|tag:tunnel|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|tool:frp|result:success|o_msg:frp\u96a7\u9053\u5efa\u7acb\u6210\u529f\uff0c\u53ef\u7528\u6765\u8fdb\u884c\u5185\u7f51\u7a7f\u900f\";flow:established,from_server;dsize:12;content:\"|00 01 00 02 00 00 00 01 00 00 00 00|\";flowbits:unset,frp_state_2;flowbits:isset,frp_state_2;sid:2019030003;)", "2019010137": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"extractvalue(\";nocase;http_client_body;pcre:\"/\\d, *concat\\(0x\\w\\w,/iP\";flow:to_server,established;gid:0;sid:2019010137;rev:1;)", "2020052510": "alert dns $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528burpcollaborator.net\u8fdb\u884c\u53cd\u5f39|tag:dnslog|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u5229\u7528dnslog\u8fdb\u884c\u53cd\u5f39|attacker:dest\";flow:established, to_server;dns_query;content:!\"polling\";pkt_data;dns_query;content:\".burpcollaborator.net\";pkt_data;sid:2020052510;rev:1;)", "2025811": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT php script double base64 encoded Remote Code Execution 2|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"x5bzhQM0JvY0\";metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025811;rev:2;metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2020052108": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fc7webshell\u6267\u884c\u547d\u4ee4|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u901a\u8fc7webshel\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"|20 20 0a 20 20 20 0a 20|\";http_server_body;depth:8;content:\"<HTML><BODY>|20 20 0a 20|\";http_server_body;distance:0;within:16;content:\"Commands with JSP|20 20 0a 20|\";http_server_body;distance:0;sid:2020052108;rev:1;)", "2020060406": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ThinkPHP 5.x \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:ThinkPHP 5.x \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, tp_5_23_rce;content:\"200\";http_stat_code;content:\"<!DOCTYPE html>\";http_server_body;content:\"<title>System Error</title>\";http_server_body;distance:30;within:200;content:!\"<!DOCTYPE html>\";http_server_body;depth:16;sid:2020060406;rev:1;)", "2019090031": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:VNC\u8fde\u63a5|direction:in|level:action|service_name:VNC|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728VNC|server:src\";flow:from_server,established;content:\"RFB\";depth:3;pcre:\"/^RFB 003\\.00(\\d)\\n\\0\\0\\0\\0\\0\\0\\0:Unable to open license file: No such file or directory \\(2\\)/\";sid:2019090031;gid:0;)", "2020052408": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:reGeorg\u8fde\u63a5\u6210\u529f|tag:\u653b\u51fb\u4ee3\u7406|tool:reGeorg|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u5185\u7f51\u6e17\u900f\u65f6\u7684\u5e38\u7528\u5de5\u5177reGeorg|failed_by:http_status_3XX,http_status_4XX\";flowbits:isset, regeory_read;flow:from_server,established;content:\"200\";http_stat_code;content:\"X-STATUS: FAIL\";http_header;content:\"X-ERROR: RemoteSocket read filed\";http_header;threshold:type limit, track by_dst, count 1, seconds 60;sid:2020052408;rev:1;)", "2018020060": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528TRACE\u8bf7\u6c42|direction:in|src:external_net|dest:home_net|level:action|o_msg:HTTP\u7684TRACE\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"TRACE\";nocase;http_method;gid:0;sid:2018020060;rev:1;)", "2019090008": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MySQL\u8fde\u63a5|direction:in|level:action|service_name:MySQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728MySQL|server:src\";flow:from_server,established;content:\"|10 00 00 01 ff 13 04|Bad handshake\";depth:20;sid:2019090008;gid:0;)", "2020081441": "alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08udp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884c\u547d\u4ee4ll\u6216ls -l\";content:\"total \";fast_pattern;content:\"|0a|d\";distance:2;within:80;pcre:\"/^((r|-)(w|-)(x|-)){3}\\s+\\d+\\s\\S+[ ]{2}\\S+[ ]+\\d+\\s/R\";sid:2020081441;)", "2019000059": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Jenkins\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2019-1003000\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Jenkins\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2019-1003000\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2019_1003000;content:\"POST\";http_method;content:\"config.xml\";http_uri;http_content_type;content:\"text/xml\";pkt_data;content:\"Authorization: Basic\";http_header;content:\"|3c|script|3e 0a|\";http_client_body;content:\"@Grab(\";http_client_body;distance:0;sid:2019000059;rev:1;)", "2020011401": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JBoss \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2006-3734\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JBOSS\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/jmx-console/HtmlAdaptor\";http_uri;within:40;http_content_type;content:\"application/x-www-form-urlencoded\";pkt_data;content:\"action=invokeOp\";http_client_body;content:\"name=jboss.scripts\";http_client_body;content:\"arg0=Runtime.getRuntime\";http_client_body;sid:2020011401;rev:1;)", "2018041805": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DRAT2009\u540e\u95e8\u6728\u9a6c|type:rat|tag:DRAT2009|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cDRat2009\u4e0a\u7ebf\u5305\";dsize:80<>300;flow:to_server,established;content:\"000\";pcre:\"/^000\\|\\w+\\|Windows.+\\|.+CPU\\s+@\\s+.+?GHz\\|.+\\|\\x0a$/i\";flowbits:isset,TB_DRAT2009_A;flowbits:set,TB_DRAT2009_B;sid:2018041805;rev:1;)", "2019000082": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Fastjson <=1.2.62 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Fastjson <=1.2.62 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, fastjson_jndi;content:\"@type\";http_client_body;fast_pattern;content:\"com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig\";http_client_body;distance:0;content:\"properties\";http_client_body;nocase;content:\"java.util.Properties\";http_client_body;content:\"UserTransaction\";http_client_body;nocase;pcre:\"/(ldap|rmi):\\/\\//PRi\";sid:2019000082;rev:1;)", "2008048": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (Version 1.23)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| Version \";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008048;classtype:trojan-activity;sid:2008048;rev:9;)", "2020062815": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Stowaway-\u6b63\u5411\u4ee3\u7406)|tag:\u653b\u51fb\u4ee3\u7406|tool:Stowaway|dest:home_net|level:attack|phase:exploit|type:exploit|severity:4|result:success|o_msg:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Stowaway-\u6b63\u5411\u4ee3\u7406)|attacker:src\";flow:established, to_server;flowbits:set, Stowaway_link_type_2_1;content:\"d41d8cd98f00b204\";depth:16;content:\"|30 30 30 30 30 30 30 30 30 31 00 00 00 00 00 00|\";distance:0;within:16;content:\"COMMAND\";distance:2;within:7;content:\"STOWAWAYADMIN\";distance:4;within:13;sid:2020062815;rev:1;)", "2020021301": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6d4f\u89c8Web\u76ee\u5f55|tag:\u76ee\u5f55\u904d\u5386|direction:in|dest:home_net|src:external_net|level:action|severity:0|result:success|o_msg:\u68c0\u6d4b\u5230\u76ee\u5f55\u904d\u5386\u884c\u4e3a(tomcat)|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"<html>|0d 0a|<head>|0d 0a|<title>Directory Listing For\";http_server_body;nocase;offset:0;depth:100;gid:0;sid:2020021301;)", "2020011413": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Citrix ADC \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2019-19781\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:Citrix ADC|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2019_19781;content:\"200\";http_stat_code;content:\"//parent.window.ns_reload()\\;|0a|window.close()\\;\";http_server_body;sid:2020011413;rev:1;)", "2020010010": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fc7bash\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4|tag:\u53cd\u5f39shell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:\u901a\u8fc7bash\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4\";flow:established,to_server;content:\"whoami|0a|\";content:\"nginx\";distance:0;flowbits:unset,bash_whoami;flowbits:isset,bash_whoami;sid:2020010010;)", "2019010031": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u70df\u8349\u7cfb\u7edf0day\u6f0f\u6d1e|tag:0day|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|o_msg:\u68c0\u6d4b\u5230\u70df\u8349\u7cfb\u7edf\u7684\u67d0\u4e2a0day\u6f0f\u6d1e|attacker:src\";content:\"/downexcelfile?mimeType=\";http_uri;nocase;content:\"&filename=\";http_uri;nocase;within:30;pcre:\"/\\/(etc|bin|data|home|lib|opt|usr|var|tmp|sbin|root|..)\\//iUR\";content:\"&saveasfilename=\";http_uri;nocase;flow:to_server,established;gid:0;sid:2019010031;rev:1;)", "2018041700": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Gh0st2011\u540e\u95e8\u6728\u9a6c|type:rat|tag:Gh0st2011|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cGh0st2011\u4e0a\u7ebf\u5305\uff081\uff09\";dsize:20;flow:to_server,established;content:\"|14 00 00 00 04 00 00 00 78 9c 63 60 60 60 00 00 00 04 00 01|\";depth:20;flowbits:noalert;flowbits:set,TB_Gh0st2011_1;sid:2018041700;rev:1;)", "2018011707": "alert udp $HOME_NET any -> $EXTERNAL_NET 123 (msg:\"name:\u50f5\u5c38\u7f51\u7edc\u884c\u4e3a|type:botnet|tag:ntp flood|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5bf9\u5916\u7684NTP Flood\u653b\u51fb\";dsize:64<>500;content:\"|2a|\";offset:3;depth:1;content:\"|00 00 00 00 00 00|\";distance:20;threshold:type both, track by_src, count 2000, seconds 1;sid:2018011707;rev:1;)", "2019090150": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:OpenLDAP\u8fde\u63a5|direction:in|level:action|service_name:OpenLDAP|service_class:auth|severity:1|result:unknown|o_msg:\u5b58\u5728OpenLDAP|server:src\";flow:from_server,established;content:\"02|02 01 01|a\";depth:6;pcre:\"/^02\\x02\\x01\\x01a-\\n\\x01\\x02\\x04\\0\\x04&requested protocol version not allowed$/\";sid:2019090150;gid:0;)", "2020062313": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Dubbo \u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(spring-aop\u94fe-dubbo\u534f\u8bae)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Apache Dubbo \u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(spring-aop\u94fe-dubbo\u534f\u8bae)|attacker:src\";flow:established, to_server;xbits:set, dubbo_link_jrmp, track ip_dst, expire 20;content:\"|da bb|\";depth:2;fast_pattern;content:\"org.springframework.aop.support.DefaultBeanFactory\";distance:0;pcre:\"/(ldap|rmi)\\:\\/\\//Ri\";content:\"org.springframework.jndi.support.SimpleJndiBeanFactory\";distance:8;sid:2020062313;rev:1;)", "2018080195": "alert tcp $HOME_NET 21 -> $HOME_NET any (msg:\"name:FTP\u767b\u9646\u6210\u529f|tag:ftp|direction:lateral|type:infil|src:home_net|dest:home_net|level:action|phase:post_exploit|severity:1|gray:|result:success|o_msg:ftp\u670d\u52a1\u767b\u5f55\u6210\u529f\";dsize:<40;flow:to_client,established;content:\"230 \";depth:4;flowbits:isset,TB_FTPBrute0;sid:2018080195;rev:1;)", "2019090123": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(imap)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"* OK \";depth:5;pcre:\"/^\\* OK \\[CAPABILITY IMAP4rev1 LITERAL\\+ SASL-IR LOGIN-REFERRALS ID ENABLE IDLE AUTH=PLAIN\\] Dovecot DA ready\\.\\r\\n/\";sid:2019090123;gid:0;)", "2020063004": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Nexus \u4f7f\u7528\u9ed8\u8ba4\u5bc6\u7801|tag:\u5f31\u53e3\u4ee4|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Nexus \u4f7f\u7528\u9ed8\u8ba4\u5bc6\u7801|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;flowbits:set, nexus_weak_passwd;noalert;content:\"|0d 0a|Authorization: Basic YWRtaW46YWRtaW4xMjM=|0d 0a|\";http_header;sid:2020063004;rev:1;)", "2018030030": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528CertUtil\u4e0b\u8f7d\u5de5\u5177|tag:\u4e0b\u8f7d\u6587\u4ef6|tool:CertUtil|phase:recon|dest:home_net|level:action|severity:2|result:unknown|o_msg:\u4f7f\u7528CertUtil\u4e0b\u8f7d\u5de5\u5177|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"CertUtil URL Agent\";nocase;http_user_agent;within:1024;flow:to_server,established;sid:2018030030;rev:1;)", "2100497": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u6267\u884c\u547d\u4ee4|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:success|o_msg:webshell\u8fde\u63a5\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"1 file|28|s|29| copied\";nocase;http_server_body;sid:2100497;)", "2018120301": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6ce2\u5c14\u540e\u95e8\u6728\u9a6c|type:rat|tag:Boer\u8fdc\u63a7|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6c\u6ce2\u5c14\u8fdc\u63a7\u5165\u7ad9\u6d41\u91cf\";flow:established;content:\"EMSG00\";depth:6;nocase;content:\"<Msg00\";distance:0;content:\"</Msg00\";distance:0;sid:2018120301;rev:1;)", "2020051105": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:FCKeditor\u7f16\u8f91\u5668\u5229\u7528\u884c\u4e3a|tag:\u7f16\u8f91\u5668\u5229\u7528|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:FCKeditor\u7f16\u8f91\u5668\u5229\u7528\u884c\u4e3a|severity:2|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"FCKeditor/\";http_uri;nocase;fast_pattern;pcre:\"/(_whatsnew\\.html)|(editor\\/filemanager\\/connectors\\/asp\\/connector\\.asp)|(editor\\/filemanager\\/browser\\/default\\/connectors\\/asp\\/connector\\.asp)|(editor\\/filemanager\\/browser\\/default\\/connectors\\/test\\.html)|(editor\\/filemanager\\/upload\\/test\\.html)|(editor\\/filemanager\\/connectors\\/test\\.html)|(editor\\/filemanager\\/connectors\\/uploadtest\\.html)|(editor\\/filemanager\\/browser\\/default\\/browser\\.html)|(_samples\\/default\\.html)|(_samples\\/asp\\/sample\\d{2}\\.asp)|(editor\\/filemanager\\/browser\\/default\\/connectors\\/aspx\\/connector\\.aspx)|(editor\\/filemanager\\/browser\\/default\\/connectors\\/jsp\\/connector)|(editor\\/fckeditor\\.html)|(editor\\/fckdialog\\.html)|(editor\\/dialog\\/fck_about\\.html)|(editor\\/dialog\\/fck_spellerpages\\/spellerpages\\/server-scripts\\/spellchecker\\.php)/URi\";threshold:type both,track by_src,count 10,seconds 10;sid:2020051105;rev:2;)", "2020070808": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6587\u4ef6\u5305\u542b\u8bfb\u53d6|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u6587\u4ef6\u8bfb\u53d6\u5c1d\u8bd5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, file_read_general;content:\"/apache\";http_uri;fast_pattern;pcre:\"/access(\\.|_)log/U\";sid:2020070808;rev:1;)", "2019090304": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:CouchDB\u8fde\u63a5|direction:in|level:action|service_name:CouchDB|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728CouchDB|failed_by:http_status_3XX,http_status_4XX|server:dest\";flow:from_server,established;content:\"401\";http_stat_code;content:\"WWW-Authenticate: Basic realm=\";http_raw_header;content:\"Server: CouchDB|2f|\";http_raw_header;pcre:\"/Server: CouchDB/([\\w._-]+) \\(Erlang ([^)]*)\\)/H\";sid:2019090304;gid:0;)", "2019090146": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Exim\u8fde\u63a5|direction:in|level:action|service_name:Exim(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Exim|server:src\";flow:from_server,established;content:\"554\";depth:3;pcre:\"/^554 SMTP synchronization error\\r\\n$/\";sid:2019090146;gid:0;)", "2019090148": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:OpenLDAP\u8fde\u63a5|direction:in|level:action|service_name:OpenLDAP|service_class:auth|severity:1|result:unknown|o_msg:\u5b58\u5728OpenLDAP|server:src\";flow:from_server,established;content:\"0%|02 01 01|a\";depth:6;pcre:\"/^0%\\x02\\x01\\x01a \\n\\x010\\x04\\0\\x04\\x19anonymous bind disallowed$/\";sid:2019090148;gid:0;)", "2010643": "alert tcp $HOME_NET any -> $HOME_NET 21 (msg:\"name:FTP Administrtor\u7528\u6237\u7206\u7834|direction:in|dest:home_net|src:home_net|level:attack|phase:post_exploit|severity:2|result:unknown|o_msg:FTP Administrtor\u7528\u6237\u7206\u7834|type:infil\";flow:established,to_server;content:\"USER \";nocase;depth:5;content:\"administrator\";within:25;nocase;threshold:type threshold, track by_src, count 5, seconds 60;reference:url,doc.emergingthreats.net/2010643;classtype:attempted-recon;sid:2010643;rev:3;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2018010053": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MSSQL\u6ce8\u5165|tag:\u6ce8\u5165\u5224\u65ad\u6570\u636e\u5e93|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MSSQL\u6ce8\u5165 - \u5224\u65ad\u662f\u4e0d\u662fMSSQL|dest:home_net|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"and\";nocase;http_uri;pcre:\"/[ +]+exists[ +]*\\(select[ +](count\\(){0,1}\\*\\)*[ +]+from[ +]+sysobjects/iUR\";pcre:\"/chr\\(\\d{1,3}\\)/iU\";flow:to_server,established;gid:0;sid:2018010053;rev:1;)", "2018010013": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Jboss\u6f0f\u6d1e\u5229\u7528|tag:Jboss\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|severity:2|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6210\u529f\u653b\u51fbjboss\u670d\u52a1\u5668\u5e94\u7528|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"500\";http_stat_code;content:\"Apache-Coyote\";nocase;content:\"org.jboss.invocation.http.servlet.ReadOnlyAccessFilter.doFilter\";nocase;content:\"ReadOnlyAccessFilter.java\";nocase;sid:2018010013;rev:1;)", "2025800": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT Generic system shell command to php base64 encoded Remote Code Execution 6|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"zeXN0ZW0oInBoc\";metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025800;rev:2;metadata:created_at 2018_07_09, updated_at 2018_07_18;)", "2008919": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent pricers.info related (section)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| sections|0d 0a|\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008919;classtype:trojan-activity;sid:2008919;rev:8;)", "2020020506": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528\u5de5\u5177QuarksPwDump\u63d0\u53d6\u672c\u5730\u8d26\u6237|tag:QuarksPwDump|tool:QuarksPwDump|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:QuarksPwDump|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"________\";http_server_body;content:\"                          __            __________          ________                            |0d 0d 0a|\";http_server_body;distance:0;within:100;content:\"|5c|_____  |5c|   __ __ _____  _______ |7c|  |7c|\";http_server_body;distance:0;content:\" __  ______|5c|\";http_server_body;distance:0;content:\" -<(QuarksLab)>-|0d 0d 0a|\";http_server_body;distance:300;content:\"[+] Setting BACKUP and RESTORE privileges...\";http_server_body;distance:2;content:\"[+] Parsing SAM registry hive...\";http_server_body;distance:2;content:\"[+] BOOTKEY retrieving...\";http_server_body;distance:2;sid:2020020506;rev:1;)", "2019010147": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:SQLMAP|tag:SQLMAP\u6ce8\u5165|tool:SQLMAP|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:\u5229\u7528SQLMAP\u5de5\u5177\u8fdb\u884c\u6ce8\u5165|attack_type:target|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"sqlmap\";nocase;http_user_agent;flow:to_server,established;gid:0;sid:2019010147;rev:1;)", "2019090271": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"E|00 00 00|\";depth:4;pcre:\"/^E\\0\\0\\0.S[^\\0]+\\0C0A000\\0M.*?65363\\.19778.*?1\\.0.*?3\\.0.*?\\0Fpostmaster\\.c\\0/\";sid:2019090271;gid:0;)", "2020032602": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Discuz!X \u22643.4 \u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e|tag:\u4efb\u610f\u6587\u4ef6\u5220\u9664|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Discuz!X \u22643.4 \u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, discuz_3_4_afd;content:\"200\";http_stat_code;content:\"<script type=\\\"text/javascript\\\">\";http_server_body;startswith;content:\"parent.show_success('')\\;</script>\";http_server_body;distance:0;sid:2020032602;rev:1;)", "2019000045": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:weblogic\u6f0f\u6d1e\u5229\u7528|tag:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:weblogic\u6f0f\u6d1e\u5229\u7528|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"500\";http_stat_code;http_content_type;content:\"text/xml\";pkt_data;content:\"java.io.PrintWriter cannot be cast to java.lang.String<faultstring>\";http_server_body;flowbits:isset,weblogic_write_file;sid:2019000045;)", "2835545": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:AirLink101\u8def\u7531\u5668\u6f0f\u6d1e|tag:\u8def\u7531\u6f0f\u6d1e|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknow|o_msg:AirLink101 SkyIPCam1620W\u8def\u7531\u5668\u6f0f\u6d1e\u547d\u4ee4\u6267\u884c\";flow:to_server,established;content:\"/snwrite.cgi?mac=\";http_uri;fast_pattern;pcre:\"/^[a-f0-9]+?\\x3b/URi\";metadata:former_category EXPLOIT;reference:cve,2015-2280;reference:url,www.exploit-db.com/exploits/37527;classtype:trojan-activity;sid:2835545;rev:1;metadata:attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_03_26, performance_impact Low, updated_at 2019_03_26;)", "2018010084": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:SSRF\u6f0f\u6d1e\u5c1d\u8bd5|tag:SSRF\u653b\u51fb|dest:home_net|level:attack|severity:3|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528SSRF\u5c1d\u8bd5\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"GET\";http_method;content:\".php?s=dict&\";http_uri;within:1000;pcre:\"/(i|ip)=((^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$)|(\\b([a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,}\\b))&(port|p)=\\d{2,5}/iUR\";gid:0;sid:2018010084;rev:1;)", "2020081446": "alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08udp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u8bfb\u53d6\u6587\u4ef6/etc/passwd\";content:\"root:x:0:0:root:/root:/bin/\";sid:2020081446;)", "2019090295": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Serv-U\u8fde\u63a5|direction:in|level:action|service_name:Serv-U|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728Serv-U|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220-FTP Server v([\\d.]+) for WinSock ready\\./\";sid:2019090295;gid:0;)", "2019060011": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\".php?\";http_uri;pcre:\"/[\\w.$@!%_-]+=\\d{3}/iUR\";http_accept;content:\"text/html, image/gif, image/jpeg, *\\; q=.2, */*\\; q=.2\";pkt_data;noalert;flowbits:set, bingxie_webshell;sid:2019060011;gid:0;rev:1;)", "2025806": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:payload\u4e2d\u5305\u542bbase64\u540e\u7684/bin/bash|tag:payload|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u653b\u51fbpayload\u4e2d\u4f7f\u7528base64\u7f16\u7801\u540e\u7684/bin/bash|attacker:src\";flow:established,to_server;content:\"vYmluL2Jhc2\";http_header;metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025806;rev:2;metadata:attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2018010088": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Redis\u672a\u6388\u6743\u6f0f\u6d1e\u5229\u7528|tag:\u672a\u6388\u6743\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Redis\u56e0\u914d\u7f6e\u4e0d\u5f53\u53ef\u4ee5\u672a\u6388\u6743\u8bbf\u95ee\u3002\u653b\u51fb\u8005\u65e0\u9700\u8ba4\u8bc1\u8bbf\u95ee\u5230\u5185\u90e8\u6570\u636e\uff0c\u76f4\u63a5\u5199shell\u5230crontab|attacker:src\";content:\"set\";nocase;offset:0;content:\"\\\"\";within:10;pcre:\"/(\\x0a)*(\\* ){5}bash\\s+-i\\s+>&\\s+\\/dev\\/tcp\\/\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\/\\d{1,5}/iR\";flow:to_server,established;flowbits:set, redis_shell_req_1;xbits:set, is_redis_exec, track ip_pair;gid:0;sid:2018010088;rev:1;)", "2024220": "alert smb $HOME_NET any -> $HOME_NET any (msg:\"name:\u5229\u7528MS17-010\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u7591\u4f3c\u5b58\u5728\u6c38\u6052\u4e4b\u84dd\u6f0f\u6d1eEcho\u547d\u4ee4\u8bf7\u6c42 - MS17-010 (set)\";flow:to_server,established;content:\"|00 00 00 31 ff|SMB|2b 00 00 00 00 18 07 c0|\";depth:16;fast_pattern;content:\"|4a 6c 4a 6d 49 68 43 6c 42 73 72 00|\";distance:0;flowbits:set,TB.ETERNALBLUE;flowbits:noalert;metadata:former_category EXPLOIT;classtype:trojan-activity;sid:2024220;rev:1;metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_04_18;)", "2020072011": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u6f0f\u6d1e\u653b\u51fb\uff08\u673a\u5668\u5b66\u4e60\uff09|tag:exploit|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u901a\u7528\u6f0f\u6d1e\u653b\u51fb\uff08\u673a\u5668\u5b66\u4e60\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"dnslog.\";http_uri;fast_pattern;pcre:\"/^(cn|bid|link)/URi\";sid:2020072011;rev:1;)", "2018081326": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u8fdb\u884cShell\u5171\u4eab\";dsize:12;flow:from_server,established;content:\"ShareShell|0D 0A|\";nocase;flowbits:isset,TB_ZxShell;sid:2018081326;rev:1;)", "2017120101": "alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:\"name:\u5efa\u7acb\u901a\u4fe1\u96a7\u9053|type:tunneling|tag:DNS\u96a7\u9053|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:2|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u7578\u5f62\u7684DNS\u8bf7\u6c42\uff08A\u7c7b\u578b\uff09\";content:!\"|00|\";offset:12;depth:1;byte_test:1, >, 63, 12, big;content:\"|00 01 00 01|\";isdataat:!1, relative;sid:2017120101;rev:1;)", "2020081411": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08tcp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u8bfb\u53d6\u6587\u4ef6/etc/shadow\";flow:established;content:\"bin\";fast_pattern;pcre:\"/^\\:\\*\\:\\d{5}\\:0\\:99999\\:7\\:\\:\\:\\x0a/R\";content:\"mail\";distance:0;pcre:\"/^\\:\\*\\:\\d{5}\\:0\\:99999\\:7\\:\\:\\:\\x0a/R\";content:\"nobody\";distance:0;pcre:\"/^\\:\\*\\:\\d{5}\\:0\\:99999\\:7\\:\\:\\:\\x0a/R\";sid:2020081411;)", "2020081703": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4e0a\u4f20\u51b0\u874eWebshell|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:\u4e0a\u4f20\u51b0\u874eWebshell|failed_by:http_status_3XX,http_status_4XX|success_by:resp_body_upload_success_str|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"boundary=\";pkt_data;content:\"file_get_contents(\\\"php://input\\\")\";http_client_body;content:\"extension_loaded('openssl')\";http_client_body;distance:0;content:\"\\\"base64_\\\".\\\"decode\\\"\";http_client_body;distance:0;content:\"openssl_decrypt\";http_client_body;distance:0;sid:2020081703;rev:1;)", "2019090126": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK [Dd]ovecot ready\\. ?<.*@([-\\w_.]+)>\\r\\n/\";sid:2019090126;gid:0;)", "2020052604": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:weblogic_name|tag:weblogic,exploit|tool:weblogic_tool|level:attack|phase:exploit|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6210\u529f\u653b\u51fbweblogic\u670d\u52a1\u5668\u5e94\u7528--\u4ec5\u54cd\u5e94\u5305\u7070\u5ea62017-10271|gray:true|severity:1|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"500\";http_stat_code;content:\"Servlet\";http_header;content:\"WorkContextXmlInputAdapter.java\";content:\"111\";content:\"WorkContextServerTube.java\";content:\"71\";content:\"weblogic.wsee.workarea.WorkContextXmlInputAdapter\";sid:2020052604;rev:1;)", "2008262": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (WebForm 1)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| WebForm\";http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008262;classtype:trojan-activity;sid:2008262;rev:7;)", "2020000083": "alert dns any 53 -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bPowershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"FromBase64String|28|\";fast_pattern;distance:0;sid:2020000083;rev:1;)", "2018040030": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:\u626b\u63cf\u9ed1\u5ba2\u540e\u95e8|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|phase:exploit|failed_by:http_status_3XX,http_status_4XX|severity:2|result:unknown|o_msg:\u68c0\u6d4b\u5230\u626b\u63cf\u83dc\u5200\u540e\u95e8\u884c\u4e3a(\u9ed1\u5403\u9ed1\u884c\u4e3a)\uff0c\u9ed1\u5ba2\u4ee5\u7206\u7834\u65b9\u5f0f\u5927\u8303\u56f4\u626b\u63cf\u522b\u7684\u9ed1\u5ba2\u7559\u4e0b\u7684\u540e\u95e8\";content:\"POST\";nocase;http_method;content:\"=\";nocase;http_client_body;within:20;pcre:\"/^(@|%40)?\\s*eval\\s*(\\(|%28)/iPR\";flowbits:set, caidao_request;flowbits:set,webshell.scan;flow:to_server,established;gid:0;sid:2018040030;rev:1;)", "2020073103": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874eWebshell\u901a\u8baf|tag:webshell|tool:\u51b0\u874e|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u7591\u4f3c\u51b0\u874ewebshell\u901a\u8baf|gray:true|decode_by:bingxie_2|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;content:\".\";http_uri;pcre:\"/^((php\\d?)|jsp|asp|aspx|jspx|asa|cdx|cer)/URi\";content:\"sess\";http_cookie;nocase;http_content_len;byte_test:0,>=,1000,0,string,dec;pkt_data;pcre:\"/^([A-Za-z0-9+\\/]{4}){200,}([A-Za-z0-9+\\/]{4}|[A-Za-z0-9+\\/]{3}=|[A-Za-z0-9+\\/]{2}==)$/P\";sid:2020073103;gid:0;rev:1;)", "2020010015": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u8fbeOA\u6587\u4ef6\u5305\u542b|tag:\u6587\u4ef6\u5305\u542b|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u901a\u8fbeOA\u6587\u4ef6\u5305\u542b|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"gateway.php\";http_uri;pcre:\"/(\\/ispirit\\/interface\\/gateway.php)|(\\/mac\\/gateway.php)/I\";content:!\"P=\";http_client_body;content:\"json=\";http_client_body;content:\"url\";http_client_body;distance:0;pcre:\"/(ispirit|general|module)/PR\";sid:2020010015;rev:1;)", "2018010043": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6d4b\u8bd5SQL\u6ce8\u5165\u6f0f\u6d1e|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"and\";nocase;http_uri;pcre:\"/and(%20| )\\d+(%3d|=)\\d+/iU\";flow:to_server,established;gid:0;sid:2018010043;rev:1;)", "2009579": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u68c0\u6d4b\u5230metasploit\u7684\u4ea4\u4e92\u884c\u4e3a|tag:\u626b\u63cf\u5de5\u5177|tool:Metasploit|direction:in|phase:control|src:external_net|dest:home_net|level:attack|severity:4|gray:true|result:success|o_msg:\u4f7f\u7528metasploit\u8fdb\u884c\u6210\u529f\u653b\u51fb\";flow:from_server,established;content:\"stdapi_registry_create_key\";depth:60;reference:url,www.nologin.org/Downloads/Papers/meterpreter.pdf;reference:url,doc.emergingthreats.net/2009579;classtype:successful-user;sid:2009579;rev:2;metadata:affected_product Any, attack_target Client_and_Server, deployment Perimeter, deployment Internet, deployment Internal, deployment Datacenter, tag Metasploit, signatrue_severity Critical, created_at 2010_07_30, updated_at 2016_07_01;)", "2019090006": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MySQL\u8fde\u63a5|direction:in|level:action|service_name:MySQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728MySQL|server:src\";flow:from_server,established;content:\"|00 00 00|\";offset:1;depth:3;pcre:\"/^.\\0\\0\\0\\x0a(3\\.[-_~.+\\w]+)\\0...\\0/\";sid:2019090006;gid:0;)", "2020081404": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08http\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884c\u547d\u4ee4ifconfig|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\" flags=\";http_server_body;fast_pattern;pcre:\"/^\\d+<[a-zA-Z,]+> {2}mtu \\d+\\x0a/QRi\";content:\"inet \";http_server_body;distance:8;content:\"netmask \";http_server_body;distance:7;within:35;content:\"broadcast \";http_server_body;distance:7;within:45;content:\"ether \";http_server_body;distance:7;sid:2020081404;)", "2019090208": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([-\\w_.]+) SMTP READY\\r\\n502 5\\.5\\.2 Error: command not recognized\\r\\n/\";sid:2019090208;gid:0;)", "2009127": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Banker\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230General Banker.PWS\u901a\u8fc7POST\u65b9\u5f0f\u4e0a\u7ebf|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";nocase;http_method;content:\"User-Agent|3a| Mozilla/3.0 (compatible|3b| Indy Library)\";http_header;content:\"IDMAQUINA=\";http_client_body;reference:url,doc.emergingthreats.net/2009127;classtype:trojan-activity;sid:2009127;rev:7;)", "2835196": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ETPRO POLICY Observed External IP Check (whatsmyip .net)|tag:TEST|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:dest\";flow:established,to_server;content:\"whatsmyip.net\";http_host;within:20;isdataat:!1,relative;metadata:former_category POLICY;classtype:policy-violation;sid:2835196;rev:1;metadata:attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Audit, created_at 2019_03_06, performance_impact Low, updated_at 2019_03_06;)", "2008216": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (NSIS_DOWNLOAD)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| NSIS_DOWNLOAD\";nocase;http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008216;classtype:trojan-activity;sid:2008216;rev:8;)", "2018030011": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6b63\u5e38ASP\u8bf7\u6c42|tag:php|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:2|result:unknown|o_msg:\u6b63\u5e38asp\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";content:\"POST\";nocase;http_method;content:\".asp\";nocase;http_uri;pcre:\"/\\.(asp|aspx)$/iU\";flow:to_server,established;flowbits:set,req;flowbits:noalert;gid:0;sid:2018030011;rev:1;)", "2020061804": "alert tcp $HOME_NET 3389 -> $EXTERNAL_NET any (msg:\"name:\u7206\u7834 windows \u8fdc\u7a0b\u684c\u9762\u670d\u52a1|tag:\u7206\u7834\u7834\u89e3|src:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u653b\u51fb\u8005\u7206\u7834 windows \u8fdc\u7a0b\u684c\u9762\u670d\u52a1\uff0c\u5c1d\u8bd5\u767b\u9646\u8fdc\u7a0b\u684c\u9762|attacker:dest\";flow:established, from_server;flowbits:isset, rdp_blasting;threshold:type both,track by_dst,count 30, seconds 5;dsize:19;content:\"|03 00 00 13 0e d0 00 00 12 34 00 02 1f 08 00 08 00 00 00|\";depth:19;sid:2020061804;rev:1;)", "2018060025": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:JSP Webshell\u8fde\u63a5\u6210\u529f|tag:webshell\u8fde\u63a5\u6210\u529f|direction:in|dest:home_net|src:external_net|level:attack|severity:4|phase:control|type:shell|result:success|o_msg:\u68c0\u6d4b\u5230JSP webshell,\u6210\u529f\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;http_content_len;byte_test:0,=,24,0,string,dec;pkt_data;content:\"|0d 0a 0d 0a 20 20 20 20 20 0d 0a 20 20 20 20 20 0d 0a 2d 3e 7c 7c 3c 2d|\";http_server_body;flow:from_server,established;flowbits:isset,jsp_req;gid:0;sid:2018060025;rev:1;)", "2018030014": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u83dc\u5200webshell\u5217\u76ee\u5f55\u884c\u4e3a|tag:webshell\u8fde\u63a5|tool:\u83dc\u5200|direction:in|dest:home_net|src:external_net|level:attack|type:shell|phase:control|severity:4|result:success|o_msg:\u83dc\u5200webshell\u5217\u76ee\u5f55\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX\";content:\"200\";nocase;http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"|09|\";http_server_body;within:100;pcre:\"/([\\d\\w`~!@#$%^&*()+=_<>?,./:\"\\;'\\\\{}\\[\\]]{3})([\\w\\d._/\\[\\]\\{\\}-]{1,255}\\x09\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\\x09\\d{1,5}\\x09\\d{2,5}\\x0a)+\\1/iQ\";flowbits:isset,req;flow:from_server,established;sid:2018030014;rev:1;)", "2019090077": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Serv-U\u8fde\u63a5|direction:in|level:action|service_name:Serv-U|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728Serv-U|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220-SECURE FTP SERVER VERSION ([\\d.]+) \\(([-\\w_.]+)\\)\\r\\n/\";sid:2019090077;gid:0;)", "2020081030": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:vBulletin \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:vBulletin 5.x \u524d\u53f0\u4ee3\u7801\u6267\u884c(CVE-2019-16759)|success_by:execmd|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/ajax/render/widget_tabbedcontainer_tab_panel\";http_uri;content:\"subWidgets\";http_client_body;pcre:\"/(\\[|(%5b))0(\\]|(%5d))(\\[|(%5b))template(\\]|(%5d))=widget_php/PRi\";content:\"subWidgets\";http_client_body;pcre:\"/(\\[|(%5b))0(\\]|(%5d))(\\[|(%5b))config(\\]|(%5d))(\\[|(%5b))code(\\]|(%5d))/PRi\";sid:2020081030;rev:1;)", "2020060401": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u9ed1\u5ba2\u5de5\u5177BBScan\u626b\u63cf\u884c\u4e3a|tag:\u626b\u63cf|tool:BBScan|dest:home_net|level:attack|phase:recon|severity:3|result:unknown|o_msg:\u9ed1\u5ba2\u5de5\u5177BBScan\u626b\u63cf\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"BBScan/\";http_user_agent;sid:2020060401;rev:1;)", "2019010139": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"select\";nocase;http_client_body;within:2000;pcre:\"/\\s+count\\(\\*\\)\\s*,\\s*concat\\(/iPR\";flow:to_server,established;gid:0;sid:2019010139;rev:1;)", "2020061023": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5c1d\u8bd5\u4f7f\u7528weblogic\u4e0a\u4f20war\u5305\u90e8\u7f72\u5e94\u7528|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u5c1d\u8bd5\u4f7f\u7528weblogic\u4e0a\u4f20war\u5305\u90e8\u7f72\u5e94\u7528|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, weblogic_upload_war;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"<span class=\\\"message_SUCCESS\\\">\";http_server_body;offset:600;sid:2020061023;rev:1;)", "2019090054": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(POP3)|direction:in|level:action|service_name:Microsoft Exchange(POP3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange|server:src\";flow:from_server,established;content:\"*OK Microsoft Exchange\";depth:23;pcre:\"/^\\+OK Microsoft Exchange 2000 POP3 server version (\\S+).* ready\\.\\r\\n/\";sid:2019090054;gid:0;)", "2020051209": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Adobe ColdFusion \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e (CVE-2018-15961)|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|result:success|o_msg:Adobe ColdFusion \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e (CVE-2018-15961)|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2018_15961;content:\"200\";http_stat_code;content:\"<script type=\";http_server_body;content:\"parent.fm.fmreturnhome()\";http_server_body;distance:0;sid:2020051209;rev:2;)", "2020080301": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Metasploit \u8fde\u63a5(tcp)|tag:\u53cd\u5f39shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:Metasploit \u8fde\u63a5(linux/x64/shell/reverse_tcp)\";flags:P, A;flow:from_server, established;dsize:38;content:\"|6a 03 5e 48 ff|\";depth:5;content:\"/bin/sh|00|\";distance:14;within:8;sid:2020080301;)", "2018011703": "alert tcp $HOME_NET any -> $EXTERNAL_NET 25 (msg:\"name:Grum_spam|type:trojan|tag:Grum|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u7591\u4f3cGrum\u6728\u9a6c\u53d1\u9001\u5783\u573e\u90ae\u4ef6(Empty HELO argument)\";dsize:7;flow:to_server,established;content:\"helo |0D 0A|\";nocase;depth:7;threshold:type both, track by_src, count 30, seconds 60;sid:2018011703;rev:1;)", "2016957": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Struts2\u6f0f\u6d1e\u5229\u7528|tag:Struts\u6f0f\u6d1e|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|success_by:execmd|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Struts2 OGNL Java Exec\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u7684payload\u653b\u51fb\u7cfb\u7edf|attacker:src\";flow:to_server,established;content:\"java.lang.Runtime@getRuntime().exec(\";http_client_body;nocase;flowbits:set,cmd_reponse_echo;sid:2016957;)", "2020052110": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Webshell\u6267\u884cwhoami|tag:\u6267\u884c\u547d\u4ee4|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u68c0\u6d4b\u5230\u9ed1\u5ba2\u6267\u884c\u547d\u4ee4whoami /all|failed_by:http_status_3XX,http_status_4XX\";content:\"200\";http_stat_code;content:\"|0d 0a|----------------|0d 0a 0d 0a|\";http_server_body;content:\"SID                                          \";http_server_body;distance:8;content:\"|0d 0a|============== =============================================|0d 0a|\";http_server_body;distance:0;content:\"S-1-\";http_server_body;distance:8;content:\"Everyone\";http_server_body;distance:100;content:\"S-1-1-0\";http_server_body;distance:20;within:60;flow:from_server,established;sid:2020052110;rev:1;)", "2018010099": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:/etc/passwd\u5c1d\u8bd5|tag:\u76ee\u5f55\u904d\u5386\u5c1d\u8bd5|dest:home_net|level:attack|phase:exploit|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:URL\u4e2d\u5305\u542b/etc/passwd|severity:1|attacker:src\";content:\"GET\";nocase;http_method;content:\"/etc/passwd\";nocase;http_uri;within:1500;flow:to_server,established;flowbits:set,etc.passwd;gid:0;sid:2018010099;rev:1;)", "2019090297": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:FileZilla\u8fde\u63a5|direction:in|level:action|service_name:FileZilla|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728FileZilla|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220-Welcome to XBOX FileZilla/\";sid:2019090297;gid:0;)", "2020072809": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Apache Axis2 \u4fe1\u606f\u6cc4\u6f0f|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:1|result:success|o_msg:Apache Axis2 \u4fe1\u606f\u6cc4\u6f0f|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;content:\"<title>Axis2 Happiness Page</title>\";http_server_body;fast_pattern;content:\"<h1>Axis2 Happiness Page</h1>\";http_server_body;distance:0;content:\"<h2>Examining webapp configuration</h2>\";http_server_body;distance:0;content:\"<h2>Examining Version Service</h2>\";http_server_body;distance:0;content:\"<h2>Examining Application Server</h2>\";http_server_body;distance:0;sid:2020072809;rev:1;)", "2020052103": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u5efa\u7acbsocks5\u8fde\u63a5|tag:\u4ee3\u7406|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:unknown|o_msg:\u653b\u51fb\u8005\u8fdb\u5165\u5185\u7f51\u7684\u5e38\u7528\u624b\u6bb5\uff0c\u9700\u8981\u4e00\u53f0\u88ab\u63a7\u5236\u7684\u5916\u7f51\u53ef\u8bbf\u95ee\u4e3b\u673a|gray:true\";flow:established, to_server;flowbits:isset, s5_step_2;noalert;flowbits:set, s5_step_3;content:\"|05 01 00|\";depth:3;sid:2020052103;rev:1;)", "2019060043": "alert udp $HOME_NET any -> any 53 (msg:\"name:\u5229\u7528nslog.0kee.360.cn\u8fdb\u884cdnslog\u53cd\u5f39|tag:dns\u53cd\u5f39|direction:out|level:attack|phase:control|severity:3|result:success|o_msg:\u68c0\u6d4bnslog.0kee.360.cn\u7684dns\u8bf7\u6c42\";content:\"|01 00|\";offset:2;content:\"|05|nslog|04|0kee|03|360|02|cn|00|\";nocase;sid:2019060043;)", "2018000017": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5b58\u5728webshell\u8bbf\u95ee|tag:\u626b\u63cf\u9ed1\u5ba2\u540e\u95e8|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:2|result:success|type:shell|o_msg:webshell\u8fde\u63a5\u5931\u8d25|failed_by:http_status_3XX,http_status_4XX\";http_content_type;content:\"text/html\";pkt_data;content:\"Warning</b>:\";within:300;http_server_body;content:\"Cannot call func_num_args() dynamically in\";http_server_body;flow:from_server,established;sid:2018000017;rev:1;)", "2020071448": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Citrix \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e(CVE-2020-8194)|tag:\u672a\u6388\u6743\u8bbf\u95ee|dest:home_net|level:attack|severity:3|result:success|phase:exploit|o_msg:Citrix \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u5b83\u6765\u521b\u5efa\u6076\u610f\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2020_8194;content:\"200\";http_stat_code;http_content_type;content:\"application/x-java-jnlp-file\";pkt_data;http_header_names;content:!\"|0d 0a|Cookie|0d 0a|\";pkt_data;content:\"<jnlp codebase=\";http_server_body;fast_pattern;content:\"protocol=\";http_server_body;distance:0;content:\"id=\";http_server_body;distance:0;content:\"nsvpx=\";http_server_body;distance:0;sid:2020071448;)", "2018060005": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Webshell(\u4f5c\u8005:YangFei)\u64cd\u4f5c\u8bf7\u6c42|tag:webshell\u8fde\u63a5\u6210\u529f|direction:in|src:external_net|dest:home_net|level:attack|severity:4|phase:control|type:shell|result:unknown|o_msg:\u68c0\u6d4b\u5230webshell\u6210\u529f\u8fde\u63a5,\u4f5c\u8005yangfei,\u4f7f\u7528\u57df\u540dthisdoor.com, \u90ae\u7bb1:lcxcc007@gmail.com|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";nocase;http_method;content:\".php\";nocase;http_uri;pcre:\"/(.php)$/iU\";content:\"getpwd=\";nocase;http_client_body;offset:0;pcre:\"/getpwd=[\\d\\w_.!@#$%^&*()+-]+&go=(backshell|antivirus|exec|phpeval|sql|info&godir=[\\d\\w:.\\\\/-_]+&(govar=[\\w\\d]{1,32})$)/iP\";flowbits:noalert;flowbits:set, yangfei_webshell_op;gid:0;sid:2018060005;rev:1;)", "2020080316": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Metasploit \u8fde\u63a5(tcp)|tag:\u53cd\u5f39shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:Metasploit \u8fde\u63a5(windows/shell/reverse_tcp)\";flags:P, A;flow:from_server, established;flowbits:isset, windows_shell_reverse_tcp;dsize:267;content:\"|c9 b1 3d|\";offset:13;depth:3;sid:2020080316;)", "2020022602": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:joomla\u901a\u8fc7\u6a21\u677f\u4e0a\u4f20getshell|tag:\u4e0a\u4f20shell|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg::joomla\u901a\u8fc7\u6a21\u677f\u4e0a\u4f20shell|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, joomla_temp_getshell;content:\"200\";http_stat_code;content:\"<div class=\\\"alert alert-success\\\">\";http_server_body;sid:2020022602;rev:1;)", "2020071417": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-14645)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-14645)|attacker:src\";flow:established, to_server;xbits:set, weblogic_link_jrmp, track ip_dst, expire 60;content:\"|ac ed 00 05|\";content:\"java.util.PriorityQueue\";distance:2;content:\"com.tangosol.util.extractor.UniversalExtractor\";distance:0;sid:2020071417;rev:1;)", "2025788": "alert tcp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2018-2628)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2018-2628)|attacker:src\";flow:established,to_server;content:\"java.rmi.registry.Registry\";fast_pattern;content:\"java.lang.reflect.Proxy\";content:\"java.rmi.server.RemoteObjectInvocationHandler\";content:\"UnicastRef\";metadata:former_category EXPLOIT;reference:url,exploit-db.com/exploits/44553/;reference:cve,2018-2628;classtype:attempted-user;sid:2025788;rev:1;metadata:attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2018_07_05, performance_impact Low, updated_at 2018_07_18;)", "2019090134": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK Dovecot POP3 at ([\\w._-]+) ready\\.\\r\\n/\";sid:2019090134;gid:0;)", "2008691": "alert udp $HOME_NET any -> $HOME_NET 139 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";content:\"|1F 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"..|5C|..|5C|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008691;classtype:attempted-admin;sid:2008691;rev:6;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2020060218": "alert TCP $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(CommonsCollections3-TCP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|attacker:src\";flow:established, to_server;content:\"|ac ed 00 05|\";fast_pattern;content:\"sun.reflect.annotation.AnnotationInvocationHandler\";content:\"org.apache.commons.collections.map.LazyMap\";content:\"sun.reflect.annotation.AnnotationInvocationHandler\";sid:2020060218;rev:1;)", "2020081422": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08tcp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884c\u547d\u4ee4ll\u6216ls -l\";flow:established;content:\"total \";fast_pattern;content:\"|0a|-\";distance:2;within:80;pcre:\"/^((r|-)(w|-)(x|-)){3}\\s+1\\s\\S+[ ]{2}\\S+[ ]+\\d+\\s/R\";sid:2020081422;gid:0;rev:1;)", "2008698": "alert udp $HOME_NET any -> $HOME_NET 139 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";content:\"|20 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"|00 2E 00 2E 00 2F 00 2E 00 2E 00 2F|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008698;classtype:attempted-admin;sid:2008698;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2018010040": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165\u8bfb\u53d6\u6587\u4ef6|tag:\u6ce8\u5165\u8bfb\u6587\u4ef6|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:\u5c1d\u8bd5\u5229\u7528MySQL\u6ce8\u5165\u8bfb\u53d6\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"union\";nocase;http_uri;pcre:\"/[(\\/\\*.*\\*\\/)| ]select/iUR\";content:\"load_file(\";nocase;http_uri;distance:1;within:40;flow:to_server,established;gid:0;sid:2018010040;rev:1;)", "2019010131": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165\u5199\u5165\u6587\u4ef6|tag:\u6ce8\u5165\u5199\u6587\u4ef6|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:\u5c1d\u8bd5\u5229\u7528MySQL\u6ce8\u5165\u5199\u5165\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"select\";nocase;http_client_body;pcre:\"/[\\s\\w/\\\\.*\\d()\"'=,:\\;+<>_-]+into[(\\/\\*.*\\*\\/)| ]dumpfile[(\\/\\*.*\\*\\/)| ]['\"][0-9A-Za-z/\\\\._:-]+['\"]/iPR\";flow:to_server,established;gid:0;sid:2019010131;rev:1;)", "2025635": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike Beacon\u8fde\u63a5|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:\u5b58\u5728Cobalt Strike Beacon\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\"|43 6f 62 61 6c 74 20 53 74 72 69 6b 65 20 42 65 61 63 6f 6e 29|\";fast_pattern;http_user_agent;isdataat:!1,relative;http_header_names;content:!\"Referer\";metadata:former_category TROJAN;classtype:trojan-activity;sid:2025635;rev:2;metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2018_07_03, updated_at 2019_09_28;)", "2020052002": "alert dns $HOME_NET any -> $EXTERNAL_NET 53 (msg:\"name:\u901a\u8fc7DNS\u4f20\u8f93\u6587\u4ef6|tag:\u4fe1\u606f\u6cc4\u9732|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:4|result:success|tool:dnsteal|o_msg:\u901a\u8fc7DNS\u4f20\u8f93\u6587\u4ef6\";flow:to_server;dns_query;content:\"-\";pcre:\"/([a-zA-Z0-9\\*\\/]{40}[a-zA-Z0-9\\*\\/]*-\\.){2}/\";pkt_data;sid:2020052002;rev:1;)", "2020041034": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:WebLogic XXE|tag:xxe|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:WebLogic XXE|failed_by:http_status_3XX,http_status_4XX|attacker:dest\";flow:to_server,established;xbits:isset, weblogic_xxe, track ip_src;content:\".dtd\";http_uri;depth:100;sid:2020041034;rev:1;)", "2018062904": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5229\u7528etherworm\u5efa\u7acb\u901a\u4fe1\u96a7\u9053|type:infil|tag:\u7aef\u53e3\u6620\u5c04|direction:lateral|src:external_net|dest:home_net|level:attack|phase:post_exploit|severity:4|result:success|o_msg:\u9ed1\u5ba2\u5de5\u5177etherworm\u7684lcx\u6a21\u5757\u5c06\u5185\u7f51\u4e3b\u673a\u7aef\u53e3\u6620\u5c04\u5230\u5916\u7f51\";dsize:6;flow:established,to_client;content:\"|01 05 00 00 00 00|\";flowbits:isset,TB_tool_exe_02packet;sid:2018062904;rev:1;)", "2020072204": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:JBOSS \u654f\u611f\u4fe1\u606f\u6cc4\u9732|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:JBOSS\u654f\u611f\u4fe1\u606f\u6cc4\u9732|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;content:\"JBoss\";http_header;content:\"<?xml\";http_server_body;depth:80;content:\"Free memory:\";http_server_body;distance:0;content:\"Max memory:\";http_server_body;distance:0;content:\"Max threads:\";http_server_body;distance:0;sid:2020072204;rev:1;)", "2020051212": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Couchdb \u5782\u76f4\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\uff08CVE-2017-12635\uff09|tag:\u6743\u9650\u7ed5\u8fc7|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:Couchdb \u5782\u76f4\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\uff08CVE-2017-12635\uff09|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2017_12635;content:\"PUT\";http_method;content:\"/_users/org.couchdb.user\";http_uri;http_content_type;content:\"application/json\";pkt_data;content:\"roles\";http_client_body;content:\"roles\";http_client_body;distance:0;sid:2020051212;rev:2;)", "2020070104": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Netflix Conductor \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Netflix Conductor \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/api/metadata/taskdefs\";http_uri;depth:30;http_content_type;content:\"application/json\";pkt_data;content:\"\\\"name\\\"\";http_client_body;content:\".getClass().forName\";http_client_body;distance:2;within:100;sid:2020070104;rev:1;)", "2020032108": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache axis2 \u901a\u8fc7cat.arr\u6267\u884c\u547d\u4ee4|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Apache axis2 \u901a\u8fc7cat.arr\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, axis2_exec_by_cat;xbits:set, axis_nc, track ip_dst, expire 60;content:\"/services/Cat/\";http_uri;nocase;pcre:\"/getClassPath|exec|writeStringToFile|shell/URi\";sid:2020032108;rev:1;)", "2019090067": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Redis\u8fde\u63a5|direction:in|level:action|service_name:Redis|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728Redis|server:src\";flow:from_server,established;content:\"-ERR\";depth:4;pcre:\"/-ERR wrong number of arguments for 'get' command\\x0d\\x0a/\";sid:2019090067;gid:0;)", "2019090107": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:vsFTPd\u8fde\u63a5|direction:in|level:action|service_name:vsFTPd|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728vsFTPd|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 \\(vsFTPd ([-.\\w]+)\\)\\r\\n$/\";sid:2019090107;gid:0;)", "2020050915": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|dest:home_net|level:attack|phase:exploit|type:shell|severity:3|result:success|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:isset, bingxie_webshell_step2;content:\"POST\";http_method;content:\".aspx\";http_uri;isdataat:!1,relative;content:\"ASP.NET_SessionId=\";http_cookie;content:\"Pragma: no-cache\";http_header;content:\"Connection: keep-alive\";http_header;http_content_len;byte_test:0,>,7000,0,string,dec;pkt_data;sid:2020050915;gid:0;rev:1;)", "2008514": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (AVP2006IE)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| AVP200\";http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008514;classtype:trojan-activity;sid:2008514;rev:7;)", "2020010013": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fc7bash\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4|tag:\u53cd\u5f39shell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:\u901a\u8fc7bash\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4\";flow:established,to_server;content:\"whoami|0a|\";content:\"www-data\";distance:0;flowbits:unset,bash_whoami;flowbits:isset,bash_whoami;sid:2020010013;)", "2018041703": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Gh0st2011\u540e\u95e8\u6728\u9a6c|type:rat|tag:Gh0st2011|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cGh0st2011\u5378\u8f7d\u81ea\u8eab\";dsize:20;flow:from_server,established;content:\"|14 00 00 00 04 00 00 00 78 9c e3 67 60 60 00 00 00 40 00 10|\";depth:20;flowbits:isset,TB_Gh0st2011_2;sid:2018041703;rev:1;)", "2019090287": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DNS\u8fde\u63a5|direction:in|level:action|service_name:Microsoft DNS|service_class:other|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft DNS|server:src\";flow:from_server,established;content:\"|07|version|04|bind\";within:27;pcre:\"/\\x07version\\x04bind\\0\\0\\x10\\0\\x03\\xc0\\x0c\\0\\x10\\0\\x01.{7}Microsoft DNS (6\\.2)$/\";sid:2019090287;gid:0;)", "2020063003": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Nexus 2 yum\u63d2\u4ef6\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Nexus 2 yum\u63d2\u4ef6\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2019_5475;content:\"200\";http_stat_code;http_content_type;content:\"application/json\";pkt_data;content:\"\\\"properties\\\"\";http_server_body;pcre:\"/(\\:\\\\{1,2}Windows\\\\{1,2}System32\\\\{1,2})|(bash (-i|-c))|(\\/bin\\/)/QR\";content:\"\\\"value\\\" : \\\"Yum\\\"\";http_server_body;distance:40;content:!\"Attempt to execute unsupported executable \";http_server_body;sid:2020063003;rev:1;)", "2020063007": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Nexus \u4f7f\u7528\u9ed8\u8ba4\u5bc6\u7801|tag:\u5f31\u53e3\u4ee4|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Nexus \u4f7f\u7528\u9ed8\u8ba4\u5bc6\u7801|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2019_7238;content:\"200\";http_stat_code;content:\"|0d 0a|Server: Nexus/\";http_header;http_content_type;content:\"application/json\";pkt_data;content:\"\\\"result\\\"\";http_server_body;content:\"\\\"success\\\":true\";http_server_body;distance:0;within:40;sid:2020063007;rev:1;)", "2020060813": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u8fc7MOVE\u65b9\u6cd5\u79fb\u52a8\u6587\u4ef6|tag:\u6587\u4ef6\u64cd\u4f5c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u901a\u8fc7MOVE\u65b9\u6cd5\u79fb\u52a8\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, move_update;content:\"MOVE\";http_method;http_header_names;content:\"|0d 0a|Destination|0d 0a|\";pkt_data;sid:2020060813;rev:1;)", "2809849": "alert tcp any 53 -> $HOME_NET any (msg:\"name:Cobalt Strike\u53cd\u5f39\u8bf7\u6c42|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|dest:home_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike DNS\u53cd\u5f39\";flow:established,from_server;content:\"|05|stage\";fast_pattern;content:\"|03|\";distance:-10;within:1;pcre:\"/^[a-z]{3}/R\";content:\"|C0 0C 00 10 00 01|\";distance:0;content:\"|01 00 ff|\";distance:4;within:3;content:!\"v=spf\";distance:0;content:!\"spf2.0\";distance:0;content:!\"v=DKIM1\";distance:0;threshold:type limit, track by_dst, count 1, seconds 60;reference:md5,d370c5360b01054028d0792f7505c1d6;classtype:trojan-activity;sid:2809849;rev:6;metadata:created_at 2015_02_20, updated_at 2016_10_18;)", "2010781": "alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:\"name:\u4f7f\u7528psexec\u5de5\u5177\u8fdc\u7a0b\u64cd\u4f5c|tag:PsExec|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|attacker:src|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u53d1\u73b0\u5f53\u524d\u4e3b\u673a\u4f7f\u7528psexec\u5de5\u5177\u5bf9\u76ee\u6807Windows\u7cfb\u7edf\u6210\u529f\u8fdb\u884c\u8fdc\u7a0b\u64cd\u4f5c\";flow:to_server,established;dsize:<360;content:\"|5c 00 50 00 53 00 45 00 58 00 45 00 53 00 56 00 43 00 2e 00 45 00 58 00 45|\";reference:url,xinn.org/Snort-psexec.html;reference:url,doc.emergingthreats.net/2010781;classtype:suspicious-filename-detect;sid:2010781;rev:3;)", "2020032105": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache axis2 \u4e0a\u4f20Cat.arr|tag:\u4e0a\u4f20shell|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Apache axis2 \u4e0a\u4f20Cat.arr|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, axis2_upload;content:\"POST\";http_method;content:\"/axis2-admin/doUpload\";http_uri;nocase;http_content_type;content:\"multipart/form-data\";pkt_data;content:\"WebKitFormBoundary\";http_client_body;content:\"filename=\\\"Cat.aar\\\"\";http_client_body;distance:0;content:\"|50 4b 03 04|\";http_client_body;distance:0;content:\"Cat.class\";distance:0;http_client_body;content:\"META-INF/services.xml\";distance:0;http_client_body;sid:2020032105;rev:1;)", "2809647": "alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:\"name:\u5229\u7528SMB\u4f20\u8f93mimikatz|tag:smb|direction:lateral|type:infil|src:home_net|dest:home_net|attacker:src|level:attack|phase:post_exploit|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5728\u5185\u7f51\u901a\u8fc7SMB\u534f\u8bae\u4f20\u8f93\u9ed1\u5ba2\u5de5\u5177Mimikatz\u7684mimikatz.exe\u6587\u4ef6\uff08Ascii\uff09\";flow:established,to_server;content:\"|FF|SMB|a2|\";offset:4;depth:5;byte_test:1,!&,0x80,6,relative;content:\"mimikatz.exe\";distance:0;reference:url,github.com/gentilkiwi/mimikatz;classtype:trojan-activity;sid:2809647;rev:1;metadata:created_at 2015_01_30, updated_at 2015_01_30;)", "2011592": "alert tcp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:\"name:Yoyo-DDoS|type:botnet|tag:Yoyo-DDoS|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u50f5\u5c38\u7f51\u7edcYoyo-DDoS\u5bb6\u65cf\u4e0b\u8f7d\u6267\u884c\u53ef\u6267\u884c\u6587\u4ef6\u6d88\u606f\";flow:established,from_server;dsize:124;content:\"|00 00 00 04|ftp|3a|//\";depth:10;reference:url,asert.arbornetworks.com/2010/08/yoyoddos-a-new-family-of-ddos-bots/;classtype:trojan-activity;sid:2011592;rev:1;)", "2020010100": "alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-2555\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-2555\uff09|attacker:src\";flow:established, to_server;content:\"|fe 01 00 00|\";content:\"|ac ed|\";distance:0;within:2;content:\"javax.management.BadAttributeValueExpException\";distance:2;content:\"com.tangosol.util.filter.LimitFilter\";distance:0;content:\"com.tangosol.util.extractor.ChainedExtractorC\";distance:0;content:\"com.tangosol.util.extractor.ReflectionExtractor\";distance:0;sid:2020010100;rev:1;)", "2020070320": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|tag:\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\".php\";http_uri;content:\"die\";http_client_body;fast_pattern;distance:0;pcre:\"/die\\(\\@?md5\\(\\S+\\)\\)/Pi\";sid:2020070320;rev:1;)", "2020052403": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:reGeorg\u8fde\u63a5\u6210\u529f|tag:\u653b\u51fb\u4ee3\u7406|tool:reGeorg|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u5185\u7f51\u6e17\u900f\u65f6\u7684\u5e38\u7528\u5de5\u5177reGeorg|failed_by:http_status_3XX,http_status_4XX\";flowbits:isset, regeory_connect;flow:from_server,established;content:\"200\";http_stat_code;content:\"X-STATUS: FAIL\";http_header;content:\"X-ERROR: \";http_header;pcre:\"/(Failed writing socket)|(Failed reading from socket)|(Failed connecting to target)/HR\";sid:2020052403;rev:1;)", "2020062830": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Apache Dubbo \u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Apache Dubbo \u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u5229\u7528\u6210\u529f\uff0c\u5916\u8fdeldap/rmi\u670d\u52a1\u5668|attacker:dest\";flow:established, to_server;xbits:isset, dubbo_link_jrmp, track ip_src;content:\"|30 0c 02 01|\";startswith;content:\"|01 60 07 02|\";distance:0;within:4;content:\"|01 03 04 00 80 00|\";distance:0;within:6;sid:2020062830;rev:1;)", "2020010021": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:XML\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165|tag:XML\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:XML\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:!\"boundary=\";pkt_data;content:\"<!DOCTYPE\";http_client_body;distance:0;content:\"<!ENTITY\";http_client_body;distance:0;content:\"SYSTEM \";http_client_body;distance:0;pcre:\"/(file|http|https|php|expect):\\/\\//PRi\";sid:2020010021;rev:1;)", "2020021023": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Symfony\u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u547d\u4ee4\u6267\u884c)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Symfony\u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Symfony\";content:\"Component\";distance:1;content:\"Process\";distance:1;content:\"ProcessPipes\";distance:1;content:\"ProcessPipesfiles\";distance:1;content:\"Expression\";distance:1;content:\"Expressionvalue\";distance:1;content:\"StringStorage\";distance:1;content:\"*template\";distance:1;sid:2020021023;rev:1;)", "2019090296": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:FileZilla\u8fde\u63a5|direction:in|level:action|service_name:FileZilla|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728FileZilla|server:src\";flow:from_server,established;content:\"431\";depth:3;pcre:\"/^431 Could not initialize SSL connection\\r\\n/\";sid:2019090296;gid:0;)", "2019000081": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Fastjson <=1.2.66 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Fastjson <=1.2.66 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, fastjson_jndi;content:\"@type\";http_client_body;fast_pattern;content:\"org.apache.ignite.cache.jta.jndi.CacheJndiTmLookup\";http_client_body;distance:0;content:\"jndiNames\";http_client_body;nocase;pcre:\"/(ldap|rmi):\\/\\//PRi\";sid:2019000081;rev:1;)", "2019010007": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5Jenkins\u6f0f\u6d1e|tag:Jenkins\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728Jenkins\u7ed5\u8fc7\u767b\u5f55\u6267\u884c\u547d\u4ee4\u7684\u6f0f\u6d1e|attacker:src\";content:\"GET\";nocase;http_method;content:\"/descriptorByName/org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition/checkScriptCompile?value=@\";nocase;http_uri;within:100;flow:to_server,established;gid:0;sid:2019010007;rev:1;)", "2018041801": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DarkstRat2008\u540e\u95e8\u6728\u9a6c|type:rat|tag:DarkstRat2008|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cDarkstRat\u4e0a\u7ebf\u5305\";dsize:80<>300;flow:to_server,established;content:\"MAININFO\";pcre:\"/^MAININFO\\|((2[0-4]\\d|25[0-5]|[01]?\\d\\d?)\\.){3}(2[0-4]\\d|25[0-5]|[01]?\\d\\d?)\\|.+CPU\\s+@\\s+.+?GHz\\|.+\\|\\x0a$/i\";flowbits:isset,TB_DarkstRat2008;sid:2018041801;rev:1;)", "2020051103": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Zabbix SQL(jsrpc.php) \u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2016-10134\uff09|tag:SQL\u6ce8\u5165\u6f0f\u6d1e|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:Zabbix SQL(jsrpc.php) \u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2016-10134\uff09|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, CVE-2016-10134;content:\"jsrpc.php\";http_uri;nocase;content:\"profileIdx2=\";http_uri;distance:1;nocase;pcre:\"/select|union|order|convert|concat|group_concat|sleep|waitfor|substr|updatexml/URi\";sid:2020051103;rev:2;)", "2019060003": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6b63\u5e38jsp\u8bf7\u6c42|tag:jsp|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:1|result:unknown|o_msg:\u6b63\u5e38JSP\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";content:\"POST\";nocase;http_method;content:\".jsp\";nocase;http_uri;pcre:\"/\\.jsp(\\?)?/iU\";flow:to_server,established;flowbits:set,post_req;flowbits:noalert;gid:0;sid:2019060003;rev:1;)", "2020060805": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Adobe ColdFusion \u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e(CVE-2010-2861)|tag:\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Adobe ColdFusion \u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e(CVE-2010-2861)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2010_2861;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"<LINK REL=\";http_server_body;content:\"/CFIDE/administrator/favicon.ico\";http_server_body;distance:0;content:!\"<title>ColdFusion Administrator Login</title>\";http_server_body;distance:0;sid:2020060805;rev:1;)", "2019010038": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u5229\u7528fastjson\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:JAVA\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u901a\u8fc7http POST\u89e6\u53d1fastjson\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(JNDI\u6ce8\u5165)|attacker:src\";flow:to_server,established;content:\"@type\";http_client_body;content:\"org.apache.ibatis.datasource.jndi.JndiDataSourceFactory\";distance:1;nocase;http_client_body;content:\"ldap|3A|//\";http_client_body;flowbits:set, fastjson_exp;xbits:set,is_exploit_fastjson_ldap,track ip_dst;gid:3;sid:2019010038;)", "2020072910": "alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528\u5411\u65e5\u8475\u8fdc\u63a7|tag:\u5411\u65e5\u8475\u8fdc\u63a7|level:attack|tool:\u5411\u65e5\u8475\u8fdc\u63a7|severity:1|src:home_net|phase:exploit|type:rat|result:unknown|o_msg:\u4f7f\u7528\u5411\u65e5\u8475\u8fdc\u63a7|attacker:dest\";flow:established, to_server;tls_sni;content:\"sl-log.oray.net\";depth:15;isdataat:!1,relative;pkt_data;sid:2020072910;rev:2;)", "2019010054": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u6267\u884cphpinfo|tag:\u626b\u63cf|dest:home_net|level:attack|phase:exploit|severity:1|result:unknown|o_msg:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"=phpinfo()\";nocase;http_client_body;within:80;flow:to_server,established;gid:0;sid:2019010054;)", "20258021": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:\u626b\u63cf|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:recon|result:unknown|o_msg:\u626b\u63cf\u53ef\u80fd\u5b58\u5728\u7684\u9ed1\u5ba2\u540e\u95e8\";flow:to_server,established;content:\"ZpbGVfcHV0X2NvbnRlbnRz\";http_client_body;metadata:former_category EXPLOIT;classtype:attempted-user;flowbits:set,webshell.scan;sid:20258021;rev:2;metadata:affected_product Web_Server_Applications, affected_product PHP, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2020021001": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:CodeIgniter4 \u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u547d\u4ee4\u6267\u884c)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:CodeIgniter4 \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"CodeIgniter\";content:\"RedisHandler\";distance:0;content:\"*redis\";distance:2;content:\"MemcachedHandler\";distance:30;content:\"*memcached\";distance:2;content:\"BaseBuilder\";distance:30;content:\"*validationRules\";distance:30;content:\"*lockKey\";distance:0;sid:2020021001;rev:1;)", "2019010013": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5XSS\u6f0f\u6d1e|tag:XSS|dest:home_net|level:attack|severity:1|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728XSS|attacker:src\";content:\"GET\";nocase;http_method;content:\"<script>alert(\";http_uri;nocase;pcre:\"/'?\\w+'?\\)<\\/script>/iUR\";flow:to_server,established;gid:0;sid:2019010013;rev:1;)", "2008422": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (Inet_read)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| Inet_read\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008422;classtype:trojan-activity;sid:2008422;rev:9;)", "2018030003": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5fa1\u5251\u540e\u53f0\u626b\u63cf|tag:\u626b\u63cf|tool:\u5fa1\u5251|phase:exploit|dest:home_net|level:attack|severity:2|result:unknown|o_msg:\u4f7f\u7528\u5fa1\u5251\u8fdb\u884c\u654f\u611f\u76ee\u5f55\u626b\u63cf|attacker:src\";content:\"GET\";nocase;content:\"Host: \";nocase;http_raw_header;offset:0;pcre:\"/[\\d\\w._-]+(\\x0d\\x0a)$/iDR\";flow:to_server,established;threshold:type both, track by_src, count 300, seconds 1;sid:2018030003;rev:1;)", "2020051249": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:D-Link DIR600 command.php \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|tag:\u547d\u4ee4\u6267\u884c\u6f0f|dest:home_net|level:attack|phase:exploit|result:success|o_msg:D-Link DIR600 command.php \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, d_link_600_rce;content:\"200\";http_stat_code;content:\"RUNNING MULTICAST\";http_server_body;sid:2020051249;rev:2;)", "2020061304": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4e0a\u4f20Behinder webshell|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u4e0a\u4f20Behinder webshell|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"boundary=\";pkt_data;content:\"<%\";http_client_body;distance:0;content:\"RANDOMIZE\";http_client_body;distance:0;content:\"=Session(\";http_client_body;distance:0;content:\"Request.TotalBytes\";http_client_body;distance:0;content:\"=Request.BinaryRead(\";http_client_body;distance:0;content:\")) Xor Asc(Mid(\";http_client_body;distance:0;sid:2020061304;rev:1;)", "2020081405": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08http\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u8bfb\u53d6\u6587\u4ef6/etc/shadow|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"bin\";http_server_body;fast_pattern;pcre:\"/^\\:\\*\\:\\d{5}\\:0\\:99999\\:7\\:\\:\\:\\x0a/QR\";content:\"mail\";http_server_body;distance:0;pcre:\"/^\\:\\*\\:\\d{5}\\:0\\:99999\\:7\\:\\:\\:\\x0a/QR\";content:\"nobody\";http_server_body;distance:0;pcre:\"/^\\:\\*\\:\\d{5}\\:0\\:99999\\:7\\:\\:\\:\\x0a/QR\";sid:2020081405;)", "2019010036": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:JNDI\u6ce8\u5165\u8c03\u7528\u53cd\u5f39|tag:rmi call|src:home_net|level:suspicious|phase:exploit|severity:3|result:success|o_msg:\u53ef\u80fd\u662f\u901a\u8fc7JNDI\u6ce8\u5165\u8c03\u7528\u8fdc\u7a0b\u65b9\u6cd5(jrmi\u534f\u8bae)|attacker:dest\";content:\"|50 ac ed|\";startswith;xbits:isset,is_exploit_fastjson,track ip_src;gid:3;sid:2019010036;)", "2018020002": "alert tcp $HOME_NET 2323 -> $EXTERNAL_NET any (msg:\"name:\u767b\u5f55telnet|tag:\u767b\u5f55|direction:in|service_name:TELNET|service_class:rlogin|src:home_net|dest:external_net|level:action|o_msg:TELNET \u670d\u52a1\u767b\u5f55\u6210\u529f|server:src\";flow:from_server,established;content:\"welcome to\";nocase;content:\"@\";gid:3;sid:2018020002;rev:1;)", "2020062802": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u8fde\u63a5 nps \u4ee3\u7406\u670d\u52a1\u5668\u6210\u529f|tag:\u653b\u51fb\u4ee3\u7406|tool:nps|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u8fde\u63a5 nps \u4ee3\u7406\u670d\u52a1\u5668\u6210\u529f\";flow:established, from_server;flowbits:isset, nps_link;content:\"sucs\";offset:32;depth:4;sid:2020062802;rev:1;)", "2024218": "alert smb $HOME_NET any -> $HOME_NET any (msg:\"name:\u5229\u7528MS17-010\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|attacker:dest|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u7591\u4f3c\u5b58\u5728\u6c38\u6052\u4e4b\u84dd\u6f0f\u6d1eEcho\u547d\u4ee4 - MS17-010\";flow:from_server,established;content:\"|00 00 00 31 ff|SMB|2b 00 00 00 00 98 07 c0|\";depth:16;fast_pattern;content:\"|4a 6c 4a 6d 49 68 43 6c 42 73 72 00|\";distance:0;flowbits:isset,TB.ETERNALBLUE;metadata:former_category EXPLOIT;classtype:trojan-activity;sid:2024218;rev:1;metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_04_17;)", "2020051504": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Fastjson \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Fastjson \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, fastjson_jndi;http_content_type;content:\"application/json\";pkt_data;content:\"@type\";http_client_body;fast_pattern;content:\"com.sun.rowset.JdbcRowSetImpl\";http_client_body;distance:0;content:\"dataSourceName\";http_client_body;nocase;pcre:\"/(ldap|rmi):\\/\\//PRi\";sid:2020051504;rev:1;)", "2020020702": "alert tcp $EXTERNAL_NET any -> $HOME_NET 6379 (msg:\"name:redis\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:redis\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff08\u57fa\u4e8e\u4e3b\u4ece\u590d\u5236\uff09|attacker:src\";flow:established, to_server;flowbits:isset, SLAVEOF;noalert;flowbits:unset, SLAVEOF;flowbits:set, dbfilename;content:\"|24 36 0d 0a|CONFIG\";nocase;content:\"|24 33 0d 0a|SET\";nocase;distance:2;within:10;content:\"dbfilename\";nocase;distance:2;within:25;content:\".so\";nocase;distance:2;within:20;sid:2020020702;rev:1;)", "2018010061": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4e0b\u8f7dinc\u6587\u4ef6|tag:\u4e0b\u8f7d\u6587\u4ef6\u884c\u4e3a|dest:home_net|level:action|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u4e0b\u8f7dinc\u6587\u4ef6|attacker:src\";content:\"GET\";nocase;http_method;content:\".inc\";nocase;http_uri;pcre:\"/\\.inc$/iU\";within:1024;flowbits:set,sensitive_file;flowbits:noalert;flow:to_server,established;sid:2018010061;rev:1;)", "2019090272": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"E|00 00 00|\";depth:4;pcre:\"/^E\\0\\0\\0.S[^\\0]+\\0C0A000\\0M.*?65363\\.19778.*?1\\.0.*?3\\.0.*?\\0F\\.\\\\src\\\\backend\\\\postmaster\\\\postmaster\\.c\\0/\";sid:2019090272;gid:0;)", "2019020001": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:FTP\u767b\u5f55\u6210\u529f|tag:ftp|direction:in|src:external_net|dest:home_net|level:action|severity:1|result:success|o_msg:FTP\u767b\u5f55\u6210\u529f\";flow:established,to_server;content:\"PASS\";nocase;offset:0;depth:4;flowbits:isset,send_220;flowbits:isset,send_user;flowbits:set,send_pwd;noalert;gid:3;sid:2019020001;)", "2018062900": "alert tcp $HOME_NET any -> $EXTERNAL_NET !3389 (msg:\"name:lcx\u7aef\u53e3\u6620\u5c04|tag:\u7aef\u53e3\u6620\u5c04|direction:lateral|type:infil|src:home_net|dest:external_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u53d1\u73b0\u9ed1\u5ba2\u5de5\u5177lcx.exe\u5c06\u5185\u7f51\u4e3b\u673a\u7aef\u53e3\u6620\u5c04\u5230\u5916\u7f51\";noalert;flow:established,to_server;flags:S;flowbits:set,lcx_syn;sid:2018062900;rev:1;)", "2018081300": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DeSpy\u540e\u95e8\u6728\u9a6c|type:rat|tag:DeSpy|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u94f6\u884c\u7a83\u5bc6\u6728\u9a6cWin.Banker.DeSpy.a\u4e0a\u7ebf\uff081\uff09|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;content:\"GENERAL=\";http_client_body;content:\"&VERSAO=\";http_client_body;distance:0;content:\"&WIN=\";http_client_body;distance:0;content:\"&NAVEGADOR=\";http_client_body;distance:0;flowbits:set,TB_DESPY;flowbits:noalert;sid:2018081300;rev:1;)", "2020072707": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell \u8fde\u63a5\u6210\u529f|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:webshell \u8fde\u63a5\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"Commands with JSP\";http_server_body;nocase;content:\"NAME=\\\"cmd\\\"\";http_server_body;nocase;distance:0;sid:2020072707;rev:1;)", "2020070803": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6587\u4ef6\u5305\u542b\u8bfb\u53d6|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u6587\u4ef6\u8bfb\u53d6\u5c1d\u8bd5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, file_read_general;content:\"var\";http_client_body;fast_pattern;pcre:\"/(log((\\/)|(%2f)|(%2F))apache2((\\/)|(%2f)|(%2F))access\\.log)|(((\\/)|(%2f)|(%2F))log((\\/)|(%2f)|(%2F))apache((\\/)|(%2f)|(%2F))access\\.log)|(((\\/)|(%2f)|(%2F))log((\\/)|(%2f)|(%2F))httpd((\\/)|(%2f)|(%2F))access\\.log)|(((\\/)|(%2f)|(%2F))log((\\/)|(%2f)|(%2F))apache2((\\/)|(%2f)|(%2F))access_log)|(((\\/)|(%2f)|(%2F))log((\\/)|(%2f)|(%2F))apache((\\/)|(%2f)|(%2F))access_log)|(((\\/)|(%2f)|(%2F))log((\\/)|(%2f)|(%2F))httpd((\\/)|(%2f)|(%2F))access_log)|(((\\/)|(%2f)|(%2F))httpd((\\/)|(%2f)|(%2F))logs((\\/)|(%2f)|(%2F))access_log)|(((\\/)|(%2f)|(%2F))httpd((\\/)|(%2f)|(%2F))logs((\\/)|(%2f)|(%2F))access\\.log)|(((\\/)|(%2f)|(%2F))www((\\/)|(%2f)|(%2F))logs((\\/)|(%2f)|(%2F))access_log)|(((\\/)|(%2f)|(%2F))www((\\/)|(%2f)|(%2F))logs((\\/)|(%2f)|(%2F))access\\.log)|(((\\/)|(%2f)|(%2F))log((\\/)|(%2f)|(%2F))access_log)|(((\\/)|(%2f)|(%2F))log((\\/)|(%2f)|(%2F))access\\.log)/P\";sid:2020070803;rev:1;)", "2020071409": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JDWP \u63a2\u6d4b|tag:\u5371\u9669\u914d\u7f6e|dest:home_net|level:attack|severity:1|result:unknown|phase:exploit|o_msg:JDWP \u63a2\u6d4b|attacker:src\";flow:to_server, established;flowbits:set, jdwp_server_discover;noalert;content:\"JDWP-Handshake\";depth:14;dsize:14;sid:2020071409;)", "2020071443": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell|dest:home_net|level:attack|severity:3|result:unknown|phase:exploit|o_msg:webshell\u4ea4\u4e92|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;noalert;content:\"GET\";http_method;content:\"Action=MainMenu\";http_uri;sid:2020071443;)", "2020021008": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Laravel \u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u6267\u884c\u547d\u4ee4)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Laravel \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Illuminate\";content:\"Broadcasting\";distance:1;content:\"PendingBroadcast\";distance:1;content:\"*events\";distance:1;content:\"Illuminate\";distance:1;content:\"Events\";distance:1;content:\"Dispatcher\";distance:1;content:\"*listeners\";distance:1;content:\"*event\";distance:1;sid:2020021008;rev:1;)", "2020081702": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4e0a\u4f20\u51b0\u874eWebshell|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:\u4e0a\u4f20\u51b0\u874eWebshell|failed_by:http_status_3XX,http_status_4XX|success_by:resp_body_upload_success_str|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"boundary=\";pkt_data;content:\"Language=\\\"C#\\\"\";http_client_body;content:\"Session.Add(\";http_client_body;distance:0;content:\"System.Security.Cryptography.RijndaelManaged().CreateDecryptor(\";http_client_body;distance:0;sid:2020081702;rev:1;)", "2020041008": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08cve-2019-2725\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08cve-2019-2725\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, weblogic_xmldecode_1;flowbits:set, weblogic_xmldecode_2;content:\"POST\";http_method;http_content_type;content:\"text/xml\";pkt_data;pcre:\"/(\\/_async\\/)|(\\/wls-wsat\\/)/Ii\";content:\"<soapenv:Envelope\";http_client_body;nocase;content:\"<class>\";http_client_body;distance:0;nocase;pcre:\"/(oracle\\.toplink\\.internal\\.sessions\\.UnitOfWorkChangeSet)|(com\\.sun.rowset\\.JdbcRowSetImpl)|(org\\.slf4j\\.ext\\.EventData)|(com\\.bea\\.core\\.repackaged\\.springframework\\.context\\.support\\.FileSystemXmlApplicationContext)/PRi\";sid:2020041008;rev:1;)", "2026941": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"52b2tlLUNvbW1\";distance:0;fast_pattern;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026941;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2020081448": "alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08udp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884c\u547d\u4ee4ps -aux\";content:\"USER\";content:\"PID\";distance:0;content:\"%CPU\";distance:0;pcre:\"/USER\\s+PID\\s+%CPU\\s+%MEM\\s+VSZ\\s+RSS\\s+TTY\\s+STAT\\s+START\\s+TIME\\s+COMMAND\\x0a/\";sid:2020081448;)", "2008460": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (hacker)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| hacker\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008460;classtype:trojan-activity;sid:2008460;rev:10;)", "2020000084": "alert dns any 53 -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bPowershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"RnJvbUJhc2U2NFN0cmluZyg\";fast_pattern;distance:0;sid:2020000084;rev:1;)", "2020052009": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6cdb\u5faeOA\u4e0a\u4f20GetShell|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u6cdb\u5faeOA\u4e0a\u4f20GetShell|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/ueditor/custbtn/wordtohtml.jsp\";http_uri;http_content_type;content:\"multipart/form-data\";content:\"boundary=\";distance:0;pkt_data;content:\"filename=\";http_client_body;content:\".jsp\";http_client_body;distance:1;within:20;content:\"<%\";http_client_body;distance:0;sid:2020052009;rev:1;)", "2020032104": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Apache axis2 \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\uff08\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\uff09|tag:\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Apache axis2 \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\uff08\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, axis2_xml_disclosure;content:\"<axisconfig name=|22|AxisJava\";http_server_body;sid:2020032104;rev:1;)", "2018030008": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:webshell\u5c1d\u8bd5\u8fde\u63a5|tool:\u83dc\u5200|failed_by:http_status_3XX,http_status_4XX|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u83dc\u5200\u901a\u7528\u8bf7\u6c42asp|attacker:src\";content:\"POST\";nocase;http_method;content:\".asp\";nocase;http_uri;pcre:\"/\\.(asp|aspx|asp\\;\\.(jpg|gif|png|jpgn))$/iU\";content:\"=execute\";nocase;http_client_body;within:21;pcre:\"/execute(\\+)*/iP\";flowbits:set, caidao_request;flow:to_server,established;gid:0;sid:2018030008;rev:1;)", "2019090016": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Memcached\u8fde\u63a5|direction:in|level:action|service_name:Memcached|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728Memcached|server:src\";flow:from_server,established;content:\"STAT\";depth:4;pcre:\"/^STAT pid \\d+\\r\\nSTAT uptime (\\d+)\\r\\nSTAT time \\d+\\r\\nSTAT version ([.\\d]+)\\r\\n/\";sid:2019090016;gid:0;)", "2019090023": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:RDP\u8fde\u63a5|direction:in|level:action|service_name:RDP|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728RDP|server:src\";flow:from_server,established;content:\"|03 00 00|\";depth:3;pcre:\"/^\\x03\\0\\0\\x17\\x08\\x02\\0\\0Z~\\0\\x0b\\x05\\x05@\\x06\\0\\x08\\x91J\\0\\x02X$/\";sid:2019090023;gid:0;)", "2020070601": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHPCMS v9.6.0 wap\u6a21\u5757 SQL\u6ce8\u5165|tag:sql\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:PHPCMS v9.6.0 wap\u6a21\u5757 SQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"a=swfupload_json\";http_uri;fast_pattern;content:\"src=\";http_uri;content:\"%*27\";http_uri;distance:0;within:100;content:\"userid\";http_cookie;sid:2020070601;rev:1;)", "2009862": "alert tcp $HOME_NET any -> $EXTERNAL_NET 1024: (msg:\"name:Banker\u94f6\u884c\u6728\u9a6c|type:rat|tag:Banker|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u94f6\u884c\u6728\u9a6cC&C\u589e\u52a0\u65b0\u7684\u547d\u4ee4\";flow:established,to_server;dsize:<120;content:\"[S]ADDNEW|7c|\";depth:10;reference:url,doc.emergingthreats.net/2009862;classtype:trojan-activity;sid:2009862;rev:3;)", "2020050923": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell\u4ea4\u4e92|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:webshell\u4ea4\u4e92|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, jsp_replace_shell_2;content:\"POST\";http_method;content:\".jsp\";http_uri;nocase;content:\"help=\";http_client_body;nocase;content:!\"other\";http_client_body;nocase;noalert;sid:2020050923;gid:0;rev:1;)", "2019010049": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:nosql\u6ce8\u5165(mongo)|tag:nosql\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u901a\u8fc7php\u548cmongodb\u7684\u7279\u6027\u6ce8\u5165\u6761\u4ef6\u8868\u8fbe\u5f0f\u7ed5\u8fc7\u9a8c\u8bc1\uff0c\u6216\u76f2\u6ce8\u51fa\u654f\u611f\u6570\u636e|attacker:src\";flow:to_server,established;content:\"[$\";http_uri;pcre:\"/\\w\\[\\$(:?eq|gt|gte|in|lt|lte|ne|nin|and|not|nor|or|exists|type|expr|jsonSchema|mod|regex|text|where|geoIntersects|geoWithin|near|nearSphere|all|elemMatch|size|bitsAllClear|bitsAllSet|bitsAnyClear|bitsAnySet|comment|elemMatch|meta|slice)\\]/U\";flowbits:set,nosqli;flowbits:noalert;gid:3;sid:2019010049;)", "2020060001": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5b58\u5728webshell\u8bbf\u95ee|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|type:shell|o_msg:webshell\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";http_content_type;content:\"text/html\";pkt_data;content:\">CmdShell</a>\";http_server_body;content:\">IIS spy</a>\";http_server_body;content:\">UserInfo</a>\";http_server_body;content:\">RegShell</a>\";http_server_body;content:\">PortScan</a>\";http_server_body;flow:from_server,established;sid:2020060001;rev:1;)", "2019090009": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MySQL\u8fde\u63a5|direction:in|level:action|service_name:MySQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728MySQL|server:src\";flow:from_server,established;content:\"|00 00 00|\";offset:1;depth:3;pcre:\"/^.\\0\\0\\0\\xff..Host .* is not allowed to connect to this MySQL server$/\";sid:2019090009;gid:0;)", "2018040035": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Botnet January\u626b\u63cf\u540e\u95e8|tag:\u626b\u63cf\u9ed1\u5ba2\u540e\u95e8|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|phase:recon|failed_by:http_status_3XX,http_status_4XX|severity:2|result:unknown|o_msg:\u53ebJanuary\u7684botnet\u81ea\u52a8\u626b\u63cf\u540e\u9762\u7684\u884c\u4e3a\";content:\"POST\";nocase;http_method;content:\"=die(@md5(J4nur4ry))\";nocase;http_client_body;within:30;flowbits:set,webshell.scan;flow:to_server,established;gid:0;sid:2018040035;rev:1;)", "2020082008": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08tcp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884cnetsh firewall show config\u547d\u4ee4|gray:true\";flow:established;content:\":|0d 0a|-------------------------------------------------------------------|0d 0a|\";content:\"\\\"netsh firewall\\\" \";distance:0;content:\"\\\"netsh advfirewall firewall\\\" \";distance:0;sid:2020082008;)", "2019010102": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Joomla 3.4.6\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Joomla 3.4.6 \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a|attacker:src\";flow:to_server,established;flowbits:isset, Joomla_3_4_6_rce_1;noalert;flowbits:set, Joomla_3_4_6_rce_2;content:\"/index.php/component/users/?view=login\";http_uri;sid:2019010102;rev:1;)", "2809507": "alert tcp $EXTERNAL_NET any -> $HOME_NET 27017 (msg:\"name:\u653b\u51fbMongoDB\u547d\u540d\u7a7a\u95f4|tag:MongoDB|direction:lateral|type:infil|src:external_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5bf9MongoDB\u547d\u540d\u7a7a\u95f4\u7684\u653b\u51fb\";flow:to_server,established;content:\"|d4 07 00 00|\";offset:12;depth:4;fast_pattern;content:\"admin.system.namespaces|00|\";distance:0;reference:url,github.com/tcstool/NoSQLMap/blob/0.5/README.md;classtype:successful-admin;sid:2809507;rev:1;metadata:created_at 2015_01_13, updated_at 2015_01_13;)", "2018062901": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528etherworm\u5efa\u7acb\u901a\u4fe1\u96a7\u9053|type:infil|tag:\u7aef\u53e3\u6620\u5c04|direction:lateral|src:home_net|dest:external_net|level:attack|phase:post_exploit|severity:4|result:unknown|o_msg:\u53d1\u73b0\u9ed1\u5ba2\u5de5\u5177etherworm\u7684sock\u6a21\u5757\u5c06\u5185\u7f51\u4e3b\u673a\u4f5c\u4e3a\u53cd\u5411\u4ee3\u7406\u5bf9\u5185\u7f51\u8fdb\u884c\u6e17\u900f(set)\";dsize:6;flow:established,to_server;content:\"|01 01 00 00 00 00|\";flowbits:set,TB_tool_exe_01packet;flowbits:noalert;sid:2018062901;rev:1;)", "2806279": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u60e0\u666eIMC\u76ee\u5f55\u904d\u5386|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:2|gray:true|result:unknown|o_msg:\u60e0\u666eIMC\u6f0f\u6d1e\u5229\u7528|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"/ict/\";http_uri;content:\"/download?fileName=\";http_uri;content:\"|2e 2e 2f|\";depth:200;reference:cve,2012-5204;reference:bugtraq,58676;reference:url,zerodayinitiative.com/advisories/ZDI-13-053/;classtype:attempted-admin;sid:2806279;rev:2;metadata:created_at 2013_04_19, updated_at 2013_04_19;)", "2019090306": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:CouchDB\u8fde\u63a5|direction:in|level:action|service_name:CouchDB|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728CouchDB|failed_by:http_status_3XX,http_status_4XX|server:dest\";flow:from_server,established;content:\"200\";http_stat_code;content:\"|22|couchdb|22 3a 20 22|Welcome|22 2c 20 22|version|22 2c 20 22|\";http_server_body;sid:2019090306;gid:0;)", "2020030002": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u8681\u5251\u8fde\u63a5webshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u8681\u5251\u8fde\u63a5webshell|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"LwlMaW51\";http_server_body;content:\"VVRD\";distance:0;http_server_body;flowbits:isset,first_packet_send;flowbits:unset,first_packet_send;sid:2020030002;)", "2020072007": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u6f0f\u6d1e\u653b\u51fb\uff08\u673a\u5668\u5b66\u4e60\uff09|tag:exploit|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u901a\u7528\u6f0f\u6d1e\u653b\u51fb\uff08\u673a\u5668\u5b66\u4e60\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\".io\";http_client_body;fast_pattern;pcre:\"/(xip|sslip|nip|ceye)\\.io/Pi\";sid:2020072007;rev:1;)", "2019090214": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:qmail\u8fde\u63a5|direction:in|level:action|service_name:Qmail|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728qmail|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([\\w._-]+) ESMTP\\r\\n250-\\1\\r\\n250-STARTTLS\\r\\n250-SIZE 50000000\\r\\n250-PIPELINING\\r\\n250 8BITMIME\\r\\n/\";sid:2019090214;gid:0;)", "2019090070": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MSSQL\u8fde\u63a5|direction:in|level:action|service_name:MSSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728MSSQL|server:src\";flow:from_server,established;content:\"|04 01 0C|\";depth:3;pcre:\"/^\\x04\\x01\\0C..\\0\\0\\xaa\\0\\0\\0\\/\\x0f\\xa2\\x01\\x0e.. Login failed\\r\\n\\x14Microsoft SQL Server\\0\\0\\0\\xfd\\0\\xfd\\0\\0\\0\\0\\0\\x02$/\";sid:2019090070;gid:0;)", "2020081407": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08http\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884c\u547d\u4ee4ps -ef|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"UID\";http_server_body;content:\"PID\";http_server_body;distance:0;content:\"PPID\";http_server_body;distance:0;pcre:\"/UID\\s+PID\\s+PPID\\s+C\\s+STIME\\s+TTY\\s+TIME\\s+CMD\\x0a/Q\";sid:2020081407;)", "2020070830": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6587\u4ef6\u5305\u542b\u8bfb\u53d6|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u6587\u4ef6\u8bfb\u53d6(\u6210\u529f)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, file_read_general;content:\"200\";http_stat_code;content:\"HTTP\";http_server_body;fast_pattern;pcre:\"/((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(\\.((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3} - \\S+ \\[[0123]\\d\\/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sept|Oct|Nov|Dec)\\/\\d{4}\\:\\d{2}\\:\\d{2}\\:\\d{2} (\\+|-)\\d{4}\\] \\\"(GET|POST) \\/((\\S)+)? HTTP\\/[12]\\.[012]\\\" [12345][01]\\d \\d+/Q\";sid:2020070830;rev:1;)", "2020061808": "alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 (msg:\"name:\u7206\u7834 windows \u8fdc\u7a0b\u684c\u9762\u670d\u52a1|tag:\u7206\u7834\u7834\u89e3|tool:hydra|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u653b\u51fb\u8005\u4f7f\u7528\u5de5\u5177 hydra \u7206\u7834 windows \u8fdc\u7a0b\u684c\u9762\u670d\u52a1\uff0c\u5c1d\u8bd5\u767b\u9646\u8fdc\u7a0b\u684c\u9762|attacker:src\";flow:established, to_server;flowbits:isset, is_hydra;content:\"h|00|y|00|d|00|r|00|a|00|\";offset:144;depth:64;threshold:type limit, track by_src, count 1, seconds 60;sid:2020061808;rev:1;)", "2019090048": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(SMTP)|direction:in|level:action|service_name:Microsoft Exchange(SMTP)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange Server|server:src\";flow:from_server,established;content:\"421\";depth:3;pcre:\"/^421 [\\d.]+ Service not available, closing transmission channel\\r\\n/\";sid:2019090048;gid:0;)", "2020081408": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08http\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884c\u547d\u4ee4netstat|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"Active Internet connections (servers and established)\";http_server_body;content:\"|0a|Proto \";http_server_body;distance:0;within:8;sid:2020081408;)", "2008717": "alert tcp $HOME_NET any -> $HOME_NET 139 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";flow:established,to_server;content:\"|20 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"..|5C|..|5C|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008717;classtype:attempted-admin;sid:2008717;rev:6;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2020060807": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache HTTPD \u6362\u884c\u89e3\u6790\u6f0f\u6d1e\uff08CVE-2017-15715\uff09|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u653b\u51fb\u8005\u5c1d\u8bd5\u5229\u7528Apache HTTPD \u6362\u884c\u89e3\u6790\u6f0f\u6d1e\uff08CVE-2017-15715\uff09,\u4e0a\u4f20php\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"boundary=\";pkt_data;content:\"filename=\";http_client_body;nocase;content:\".php|0a|\";http_client_body;nocase;distance:0;pcre:\"/filename=\\\"[\\w\\/\\s._-]+\\.php\\x0a/Pi\";pcre:\"/(<\\?php)|(<script language=\\\"php\\\")/Pi\";sid:2020060807;rev:1;)", "2019090097": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Pure-FTPd\u8fde\u63a5|direction:in|level:action|service_name:PureFTPd|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728PureFTPd|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220.*Welcome to .*Pure-?FTPd (\\d\\S+\\s*)/\";sid:2019090097;gid:0;)", "2020052506": "alert dns $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528vcap.me\u8fdb\u884c\u53cd\u5f39|tag:dnslog|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u5229\u7528dnslog\u8fdb\u884c\u53cd\u5f39|attacker:dest\";flow:established, to_server;dns_query;content:\".vcap.me\";pkt_data;sid:2020052506;rev:1;)", "2019000022": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fc7nc\u6267\u884c\u547d\u4ee4|tag:\u53cd\u5f39shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:\u901a\u8fc7nc\u6267\u884c\u547d\u4ee4\";flags:P,A;dsize:<10;flow:established;content:\"root|0a|\";pcre:\"/^root\\n$/\";flowbits:isset,whoami_send;flowbits:unset,whoami_send;sid:2019000022;)", "2024771": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7591\u4f3cCobalt Strike\u4f7f\u7528\u7684Payload|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|dest:external_net|src:home_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike DNS\u53cd\u5f39|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"Content-Length|3a 20|\";http_header;content:\"|0d 0a|\";http_header;distance:5;within:4;file_data;content:\"|fc e8 00 00 00 00 eb|\";depth:7;fast_pattern;metadata:former_category TROJAN;classtype:trojan-activity;sid:2024771;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2017_09_27, malware_family CobaltStrike, performance_impact Low, updated_at 2019_04_19;)", "2018010105": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Tomcat\u6f0f\u6d1e\u5229\u7528|tag:\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Tomcat PUT\u65b9\u6cd5\u4efb\u610f\u5199\u6587\u4ef6\u6f0f\u6d1e(CVE-2017-12615)\u653b\u51fb\u7cfb\u7edf[1]|attacker:src\";flow:from_server,established;content:\"201\";http_stat_code;flowbits:isset,tomcat_put;sid:2018010105;rev:1;)", "2027093": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT Possible Netgear DGN2200 RCE (CVE-2017-6077)|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/ping.cgi\";http_uri;depth:9;isdataat:!1,relative;content:\"DIAG_diag.htm|0d 0a|\";http_header;fast_pattern;content:\"&ping_IPAddr=\";http_client_body;content:\"|3b|\";http_client_body;distance:0;metadata:former_category EXPLOIT;reference:url,www.exploit-db.com/exploits/41394;reference:cve,2017-6077;classtype:attempted-user;sid:2027093;rev:1;metadata:attack_target IoT, deployment Perimeter, signatrue_severity Major, created_at 2019_03_18, performance_impact Low, updated_at 2019_03_18;)", "2019090074": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Serv-U\u8fde\u63a5|direction:in|level:action|service_name:Serv-U|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728Serv-U|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220[ -]Serv-U FTP[ -]Server v([\\w._-]+) /\";sid:2019090074;gid:0;)", "2019090025": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:RDP\u8fde\u63a5|direction:in|level:action|service_name:RDP|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728RDP|server:src\";flow:from_server,established;content:\"|03 00 00|\";depth:3;pcre:\"/\\x03\\0\\0\\x13\\x0e\\xd0\\0\\0\\x124\\0\\x02\\x1f\\x08\\0\\x02\\0\\0\\0/\";sid:2019090025;gid:0;)", "2020020504": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528\u5de5\u5177Procdump|tag:Procdump|tool:Procdump|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Procdump|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"|0d 0a|ProcDump \";http_server_body;content:\" - Sysinternals process dump utility\";http_server_body;distance:2;pcre:\"/\\x0d\\x0a\\x0d\\x0a\\[\\d{2}\\:\\d{2}\\:\\d{2}\\] Dump /QR\";content:\" initiated: \";http_server_body;distance:1;sid:2020020504;rev:1;)", "2025799": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT Generic system shell command to php base64 encoded Remote Code Execution 5|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"N5c3RlbSgicGhw\";metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025799;rev:2;metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2018081314": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u8fdb\u884c\u6d4f\u89c8H\u76d8\";dsize:9;flow:from_server,established;content:\"LIST H:|0d 0a|\";depth:9;nocase;flowbits:isset,TB_ZxShell_2;sid:2018081314;rev:1;)", "2018010111": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|attacker:src\";content:\"select\";nocase;http_header;within:2000;pcre:\"/\\s+count\\(\\*\\)\\s*,\\s*concat\\(/iHR\";flow:to_server,established;gid:0;sid:2018010111;rev:1;)", "2020070205": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:JNDI \u6ce8\u5165\u6210\u529f\uff0c\u5916\u8fdeldap/rmi\u670d\u52a1\u5668|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Apache Dubbo \u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u5229\u7528\u6210\u529f\uff0c\u5916\u8fdeldap/rmi\u670d\u52a1\u5668|attacker:dest\";flow:established, to_server;xbits:isset, jndi_link_jrmp, track ip_src;content:\"|30 0c 02 01|\";startswith;content:\"|01 60 07 02|\";distance:0;within:4;content:\"|01 03 04 00 80 00|\";distance:0;within:6;sid:2020070205;rev:1;)", "2834511": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ETPRO POLICY External IP Address Lookup via ru .smart-ip .net|tag:TEST|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:dest\";flow:to_server,established;content:\"GET\";http_method;content:\"ru.smart-ip.net\";http_host;depth:15;isdataat:!1,relative;fast_pattern;http_header_names;content:!\"Referer\";metadata:former_category POLICY;classtype:policy-violation;sid:2834511;rev:1;metadata:affected_product Any, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Audit, created_at 2019_01_23, performance_impact Low, updated_at 2019_01_23;)", "2027041": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"YXJnb3JwIHN\";distance:0;fast_pattern;metadata:former_category ATTACK_RESPONSE;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027041;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_03_05, malware_family DNSlivery, updated_at 2019_03_05;)", "2020080305": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Metasploit \u8fde\u63a5(http)|tag:\u53cd\u5f39shell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:Metasploit \u8fde\u63a5(win_linux/x64/meterpreter_reverse_http)|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, win_linux_x64_meterpreter_reverse_http;content:\"200\";http_stat_code;http_content_type;content:\"application/octet-stream\";depth:24;pkt_data;http_header_names;content:\"|0d 0a|Content-Type\";depth:14;content:\"|0d 0a|Connection|0d 0a|Server|0d 0a|Content-Length|0d 0a 0d 0a|\";distance:0;within:40;pkt_data;threshold:type both,track by_dst,count 10,seconds 10;sid:2020080305;)", "2020061813": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528goby\u626b\u63cf\u5668\u626b\u63cf|tag:\u626b\u63cf\u5668|dest:home_net|level:attack|phase:recon|severity:3|result:unknown|tool:goby|o_msg:\u4f7f\u7528goby\u626b\u63cf\u5668\u8fdb\u884c\u626b\u63cf\uff0c\u5904\u4e8e\u6f0f\u6d1e\u626b\u63cf\u9636\u6bb5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"/upnpdev.xml\";http_uri;depth:20;content:\"rememberMe=+2ewny/4XWAbAc9751f01TtmSLcxlwGmpMy2PSdrBq0=\";http_cookie;sid:2020061813;rev:1;)", "2020010901": "alert tcp $EXTERNAL_NET any -> $HOME_NET 27017 (msg:\"name:MongoDB\u6570\u636e\u5e93\u679a\u4e3e|tag:\u672a\u6388\u6743\u6f0f\u6d1e|direction:in|src:external_net|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:MongoDB\u6570\u636e\u5e93\u679a\u4e3e\";flow:to_server,established;flowbits:set, mongodb_link;content:\"|d4 07 00 00|\";offset:12;depth:4;fast_pattern;content:\"admin.$cmd|00|\";distance:0;content:\"listDatabases|00|\";distance:0;sid:2020010901;rev:1;)", "2020010030": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528\u6f0f\u6d1e\u6267\u884c\u547d\u4ee4|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u68c0\u6d4b\u5230\u8fdc\u7a0b\u547d\u4ee4\u6267\u884cwhoami|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;http_content_len;byte_test:0,<,10,0,string,dec;pkt_data;content:\"www-data\";http_server_body;flowbits:isset,cmd_reponse_echo;sid:2020010030;)", "2027098": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT Possible ZTE ZXV10 H108L Router Root RCE Attempt|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:to_server,established;content:\"GET\";http_method;content:\"/getpage.gch?pid=\";http_uri;depth:17;content:\"&Host=|3b|\";http_uri;distance:0;fast_pattern;content:\"&DataBlockSize=\";http_uri;distance:0;metadata:former_category EXPLOIT;reference:url,github.com/stasinopoulos/ZTExploit/blob/master/ZTExploit_Source/ztexploit.py;classtype:attempted-user;sid:2027098;rev:2;metadata:attack_target IoT, deployment Perimeter, signatrue_severity Major, created_at 2019_03_19, performance_impact Low, updated_at 2019_03_19;)", "2805860": "alert tcp $EXTERNAL_NET any -> $HOME_NET 1433 (msg:\"name:ETPRO EXPLOIT Microsoft SQL Server Database Link Crawling Command Execution (Metasploit Module Method for enabling xp_cmdshell)|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"s|00|p|00|_|00|c|00|o|00|n|00|f|00|i|00|g|00|u|00|r|00|e|00| |00|'|00|x|00|p|00|_|00|c|00|m|00|d|00|s|00|h|00|e|00|l|00|l|00|'|00|,|00|1|00 3b 00|r|00|e|00|c|00|o|00|n|00|f|00|i|00|g|00|u|00|r|00|e|00|\";reference:url,msdn.microsoft.com/en-us/library/ms188279.aspx;reference:url,dev.metasploit.com/redmine/projects/framework/repository/entry/modules/exploits/windows/mssql/mssql_linkcrawler.rb;classtype:attempted-user;sid:2805860;rev:1;metadata:affected_product Any, attack_target Client_and_Server, deployment Perimeter, deployment Internet, deployment Internal, deployment Datacenter, tag Metasploit, signatrue_severity Critical, created_at 2013_01_04, updated_at 2016_07_01;)", "2019010122": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Apache Solr\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2019-0193)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Apache Solr\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2019-0193)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2019_0193;content:\"200\";http_stat_code;http_content_type;content:\"application/json\";pkt_data;content:\"\\\"status\\\"\\:0\";http_server_body;content:\"statusMessages\";http_server_body;sid:2019010122;rev:1;)", "2020080309": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Metasploit \u8fde\u63a5(tcp)|tag:\u53cd\u5f39shell|dest:home_net|level:attack|phase:exploit|severity:3|attack_type:target|result:success|o_msg:Metasploit \u8fde\u63a5(linux/x86/shell/bind_tcp)|attacker:src\";flags:P, A;flow:to_server, established;dsize:36;content:\"|89 fb 6a 02|\";depth:5;content:\"|2f 2f|shh|2f|bin\";distance:15;within:9;sid:2020080309;)", "2019090127": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK [Dd]ovecot on ([\\w._-]+) ready\\.\\r\\n/\";sid:2019090127;gid:0;)", "2019020006": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:tomcat\u767b\u5f55\u6210\u529f|tag:tomcat|direction:in|src:external_net|dest:home_net|level:action|phase:control|severity:1|result:success|o_msg:tomcat\u767b\u5f55\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"/manager\";http_uri;content:\"GET\";http_method;content:\"Authorization: Basic\";http_header;flowbits:isset,http_ba;flowbits:unset,http_ba;flowbits:set, tomcat_login;flowbits:noalert;gid:3;sid:2019020006;)", "2008756": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (Kvadrlson 1.0)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| Kvadrlson \";http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008756;classtype:trojan-activity;sid:2008756;rev:7;)", "2020072012": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u6f0f\u6d1e\u653b\u51fb\uff08\u673a\u5668\u5b66\u4e60\uff09|tag:exploit|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u901a\u7528\u6f0f\u6d1e\u653b\u51fb\uff08\u673a\u5668\u5b66\u4e60\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\".io\";http_uri;fast_pattern;pcre:\"/(xip|sslip|nip|ceye)\\.io/Ui\";sid:2020072012;rev:1;)", "2019000042": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528\u6f0f\u6d1e\u6267\u884c\u547d\u4ee4|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u68c0\u6d4b\u5230\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\". . . . . . . . :\";http_server_body;pcre:\"/[0-9a-f]{4}::[0-9a-f]{4}:[0-9a-f]{4}:[0-9a-f]{4}:[0-9a-f]{4}%[0-9a-f]{2}/RQ\";content:\". . . . . . . :\";http_server_body;pcre:\"/\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}/RQ\";flowbits:isset,cmd_reponse_echo;sid:2019000042;)", "2020061020": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fc7\u4f2a\u534f\u8bae\u6267\u884c\u547d\u4ee4|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u901a\u8fc7\u4e3a\u534f\u8bae\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, pseudo_rce;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"<?php\";http_server_body;depth:80;sid:2020061020;rev:1;)", "2018010060": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:SQLMAP|tag:SQLMAP\u6ce8\u5165|tool:SQLMAP|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:\u5229\u7528SQLMAP\u5de5\u5177\u8fdb\u884c\u6ce8\u5165|attack_type:target|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\",((',\\\".).)\";nocase;http_uri;within:1000;flow:to_server,established;sid:2018010060;rev:1;)", "2019090309": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Oracle-tns\u8fde\u63a5|direction:in|level:action|service_name:Oracle-tns|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728Oracle-tns|server:src\";flow:from_server,established;content:\"|00|\";pcre:\"/^..\\0\\0\\x04\\0\\0\\0\\\"\\0..\\(DESCRIPTION=\\(ERR=12504\\)\\)\\0/\";sid:2019090309;gid:0;)", "2018112912": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:Spring-Data-Commons \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230Lucky\u4f7f\u7528Spring-Data-Commons \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2018-1273\uff09|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"post\";nocase;http_method;content:\"/users\";http_uri;pcre:\"/.*username\\[#.*&password.*&repeatedPassword|.*username.*&password\\[#.*&repeatedPassword.*|.*username.*&password.*&repeatedPassword\\[#.*/i\";sid:2018112912;)", "2019090125": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK dovecot MUA ready\\r\\n/\";sid:2019090125;gid:0;)", "2020072006": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u6f0f\u6d1e\u653b\u51fb\uff08\u673a\u5668\u5b66\u4e60\uff09|tag:exploit|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u901a\u7528\u6f0f\u6d1e\u653b\u51fb\uff08\u673a\u5668\u5b66\u4e60\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"dnslog.\";http_client_body;fast_pattern;pcre:\"/^(cn|bid|link)/PRi\";sid:2020072006;rev:1;)", "2018010028": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u89e3\u6790\u6f0f\u6d1e\u63a2\u6d4b|tag:\u89e3\u6790\u6f0f\u6d1e\u8bd5\u63a2|phase:exploit|dest:home_net|level:attack|severity:1|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:IIS6.0\u89e3\u6790\u6f0f\u6d1e\u63a2\u6d4b|attacker:src\";content:\"GET\";nocase;http_method;content:\".php\";nocase;http_uri;within:200;pcre:\"/\\/[\\d\\w_-]\\.(jpg|gif|png)/iUR\";flow:to_server,established;gid:0;sid:2018010028;rev:1;)", "2020051245": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:D-Link DIR-645 \u8eab\u4efd\u8ba4\u8bc1\u7ed5\u8fc7|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|result:success|o_msg:D-Link DIR-645 \u8eab\u4efd\u8ba4\u8bc1\u7ed5\u8fc7|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, d_link_645_auth_bypass;content:\"200\";http_stat_code;content:\"<postxml>\";http_server_body;content:\"<uid>USR-</uid>\";http_server_body;distance:0;sid:2020051245;rev:2;)", "2020050609": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:SaltStack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2020-11651,CVE-2020-11652)|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:SaltStack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2020-11651,CVE-2020-11652)\u3010\u4e0a\u4f20\u6587\u4ef6\u3011|severity:2|attacker:src\";flow:to_server, established;flowbits:set, cve_2020_11651_upload_file;content:\"enc|a5|clear|a4|load\";pcre:\"/cmd.wheel.fun.file_roots.write/R\";sid:2020050609;rev:2;)", "2019090245": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:radmin\u8fde\u63a5|direction:in|level:action|service_name:Radmin|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728Radmin|server:src\";flow:from_server,established;content:\"|01 00 00 00|\";depth:4;pcre:\"/^\\x01\\x00\\x00\\x00\\x09\\x00\\x00\\x10\\x4f\\x2f\\x10\\x00\\x00\\x04\\x00\\x00\\x00\\x1c/\";sid:2019090245;gid:0;)", "2020050725": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:discuz 3.x ssrf\u6f0f\u6d1e|tag:\u670d\u52a1\u7aef\u8bf7\u6c42\u4f2a\u9020|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:discuz 3.x ssrf\u6f0f\u6d1e|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"forum.php?\";http_uri;content:\"action=downremoteimg\";http_uri;distance:0;content:\"message=[img]\";http_uri;sid:2020050725;rev:2;)", "2018010094": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Redis\u672a\u6388\u6743\u6f0f\u6d1e\u5199webshell|tag:\u672a\u6388\u6743\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Redis\u56e0\u914d\u7f6e\u4e0d\u5f53\u53ef\u4ee5\u672a\u6388\u6743\u8bbf\u95ee\u3002\u653b\u51fb\u8005\u65e0\u9700\u8ba4\u8bc1\u76f4\u63a5\u5199SSH key|attacker:src\";content:\"set\";nocase;offset:0;pcre:\"/\\s+[\\w\\d_-]+\\s+\"<\\?php\\s+eval/iR\";flow:to_server,established;flowbits:set, redis_shell_req_1;gid:0;sid:2018010094;rev:1;)", "2020041017": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic XXE\uff08CVE-2019-2650\uff09|tag:xxe|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic XXE\uff08CVE-2019-2650\uff09|attacker:src\";flow:established, to_server;xbits:set, weblogic_xxe, track ip_dst, expire 20;content:\"|ac ed 00 05|\";content:\"weblogic.wsee.reliability.WsrmSequenceContext\";distance:0;content:\"<!DOCTYPE\";distance:0;content:\"SYSTEM \";distance:0;pcre:\"/(http|https):\\/\\//Ri\";sid:2020041017;rev:1;)", "2018060012": "alert TCP $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6267\u884cid\u547d\u4ee4|tag:\u6267\u884c\u547d\u4ee4|direction:in|dest:external_net|src:home_net|level:attack|severity:4|phase:control|type:shell|result:success|o_msg:linux id\u547d\u4ee4\u8fd4\u56de\u503c\";content:\"uid=\";pcre:\"/^\\d{1,3}\\x28(apache|www|nginx|http|nobody|web)\\x29/iR\";offset:0;dsize:<55;sid:2018060012;rev:1;)", "2020062206": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ABPTTS \u4ee3\u7406\u8fde\u63a5\u6210\u529f|tag:\u653b\u51fb\u4ee3\u7406|tool:ABPTTS|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u5185\u7f51\u6e17\u900f\u65f6\u7684\u5e38\u7528\u5de5\u5177ABPTTSwebshell|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;flowbits:set, http_abptts;content:\"POST\";http_method;content:\"|0d 0a|x-\";http_header;fast_pattern;pcre:\"/\\x0d\\x0ax-\\w+-\\w+-\\w+\\: ([a-zA-Z0-9\\/\\+]{4}){5,10}([a-zA-Z0-9\\/\\+]{4}|[a-zA-Z0-9\\/\\+]{2}==|[a-zA-Z0-9\\/\\+]{3}=)\\x0d\\x0a/H\";http_content_type;content:\"application/x-www-form-urlencoded\";pkt_data;content:\"|0d 0a|connection: close|0d 0a|\";http_header;nocase;http_header_names;content:\"|0d 0a|cookie|0d 0a|\";nocase;pkt_data;threshold:type both, track by_dst, count 20, seconds 5;sid:2020062206;rev:1;)", "2018010117": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|attacker:src\";content:\"information_schema.tables\";nocase;http_header;pcre:\"/from[(%20)| ]information_schema[(%2e)|\\.]tables/H\";flow:to_server,established;gid:0;sid:2018010117;rev:1;)", "2018060026": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:jsp webshell\u5217\u76ee\u5f55\u884c\u4e3a|tag:webshell\u8fde\u63a5|tool:\u83dc\u5200|direction:in|dest:home_net|src:external_net|level:attack|phase:control|type:shell|severity:4|result:success|o_msg:jsp webshell\u5217\u76ee\u5f55\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX\";content:\"200\";nocase;http_stat_code;http_content_type;content:\"text/html\";pkt_data;http_content_len;byte_test:0,<,1000,0,string,dec;pkt_data;content:\"|0d 0a 0d 0a 20 20 20 20 20 0d 0a 20 20 20 20 20 0d 0a|\";http_server_body;within:100;pcre:\"/(->|)([\\w\\d._/\\[\\]\\{\\}-]{1,255}(\\/)?\\x09\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\\x09\\d{1,5}\\x09[RWX ]{1,10}\\x0a)+(|<-)/iRQ\";flow:from_server,established;flowbits:isset,jsp_req;sid:2018060026;rev:1;)", "2026922": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"dy1PYmp\";fast_pattern;distance:0;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026922;rev:3;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "180827003": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Linux.Doflu|type:botnet|tag:Doflu|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u6728\u9a6c\u540e\u95e8Linux.Doflu\u4e0a\u7ebf\u5305\";dsize:1024;flow:to_server,established;content:\"VERSONEX:Linux-\";depth:15;nocase;sid:180827003;rev:1;)", "2019010039": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u5229\u7528fastjson\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:JAVA\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u901a\u8fc7http POST\u89e6\u53d1fastjson\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(JNDI\u6ce8\u5165)|attacker:src\";flow:to_server,established;content:\"@type\";http_client_body;content:\"com.sun.rowset.JdbcRowSetImpl\";distance:1;nocase;http_client_body;content:\"rmi|3A|//\";http_client_body;flowbits:set, fastjson_exp;xbits:set,is_exploit_fastjson,track ip_dst;gid:3;sid:2019010039;)", "2008097": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (IEMGR)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| IEMGR|0d 0a|\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008097;classtype:trojan-activity;sid:2008097;rev:8;)", "2020062816": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668\u6210\u529f(Stowaway-\u6b63\u5411\u4ee3\u7406)|tag:\u653b\u51fb\u4ee3\u7406|tool:Stowaway|direction:in|src:home_net|dest:external_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668\u6210\u529f(Stowaway-\u6b63\u5411\u4ee3\u7406)|attacker:dest\";flow:established, from_server;flowbits:isset, Stowaway_link_type_2_1;content:\"d41d8cd98f00b204\";depth:16;content:\"|30 30 30 30 30 30 30 30 30 31 00 00 00 00 00 00|\";offset:16;depth:16;content:\"COMMAND\";distance:2;within:7;content:\"INIT\";distance:4;within:4;sid:2020062816;rev:1;)", "2019010149": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:SQLMAP|tag:SQLMAP\u6ce8\u5165|tool:SQLMAP|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:\u5229\u7528SQLMAP\u5de5\u5177\u8fdb\u884c\u6ce8\u5165|attack_type:target|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\",((',\\\".).)\";nocase;http_client_body;flow:to_server,established;sid:2019010149;rev:1;)", "2015993": "alert tcp $HOME_NET 3306 -> $EXTERNAL_NET any (msg:\"name:MySQL\u7206\u7834|tag:MySQL\u7206\u7834|phase:exploit|src:home_net|level:attack|severity:1|result:unknown|o_msg:\u5bf9MySql\u8fdb\u884c\u5bc6\u7801\u7206\u7834\u5c1d\u8bd5|attacker:dest\";flow:from_server,established;content:\"|02|\";offset:3;depth:4;content:\"|15 04|Access denied for user\";fast_pattern:only;threshold:type both,track by_dst,count 10,seconds 1;sid:2015993;rev:2;)", "2020011302": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Nostromo Web\u670d\u52a1\u5668\u7684\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff08CVE-2019-16278\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Nostromo Web\u670d\u52a1\u5668\u7684\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff08CVE-2019-16278\uff09|attacker:src\";flow:to_server,established;content:\"POST\";http_method;pcre:\"/(\\/%0d..\\/)|(\\/.%0d.\\/)|(\\/..%0d\\/)/I\";sid:2020011302;rev:1;)", "2834761": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:mimikatz\u7684HTTP\u8f93\u51fa|tag:Metasploit|tool:Metasploit|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:true|result:unknown|o_msg:mimikatz\u7684HTTP\u8f93\u51fa|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"Hostname:\";http_client_body;content:\"|20 2f 20|S-1-5-21-\";http_client_body;distance:0;content:\"|20 20 2e 23 23 23 23 23 2e 20 20 20 6d 69 6d 69 6b 61 74 7a 20|\";http_client_body;distance:0;content:\"|20 62 75 69 6c 74 20 6f 6e 20|\";http_client_body;distance:0;metadata:former_category ATTACK_RESPONSE;reference:md5,59b88a26510be7d2a1760ee227900b11;classtype:trojan-activity;sid:2834761;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag mimikatz, signatrue_severity Major, created_at 2019_02_06, updated_at 2019_02_06;)", "2019010144": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"union\";nocase;http_client_body;pcre:\"/[(\\/\\*.*\\*\\/)| ]select/iPR\";content:\"CHR(\";nocase;http_client_body;pcre:\"/chr\\(\\d{1,3}\\)/iP\";flow:to_server,established;gid:0;sid:2019010144;rev:1;)", "2019010143": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;http_content_type;content:!\"boundary=\";pkt_data;content:\"information_schema.tables\";nocase;http_client_body;pcre:\"/from(%20| )information_schema(%2e|\\.)tables/P\";flow:to_server,established;gid:0;sid:2019010143;rev:1;)", "2020070318": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|tag:\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\".php\";http_uri;content:\"call_user_func\";http_client_body;fast_pattern;pcre:\"/\\$_(GET|POST)\\[\\S+\\]/PRi\";sid:2020070318;rev:1;)", "2019010077": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u8fc7phpmyadmin\u65e5\u5fd7getshell|tag:phpmyadmin|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:unknown|o_msg:\u901a\u8fc7phpmyadmin\u65e5\u5fd7getshell|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;content:\"/server_variables.php\";http_uri;nocase;content:\"varName=general_log_file\";http_client_body;content:\"phpMyAdmin=\";http_cookie;flowbits:set, phpmyadmin_edit_logname;flowbits:noalert;gid:4;sid:2019010077;)", "2019090161": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PGP Keyserver|direction:in|level:action|service_name:PGP Keyserver|service_class:auth|severity:1|result:unknown|o_msg:\u5b58\u5728PGP Keyserver|server:src\";flow:from_server,established;content:\"0|17 02 01 01|a\";depth:6;pcre:\"/^0\\x17\\x02\\x01\\x01a\\x12\\n\\x01\\0\\x04\\0\\x04\\x0bPGPError #0$/\";sid:2019090161;gid:0;)", "2019010047": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u83b7\u53d6phpinfo()|tag:\u53d1\u73b0phpinfo|direction:in|src:external_net|level:action|result:success|o_msg:\u83b7\u53d6phpinfo\u4fe1\u606f|dest:home_net|failed_by:http_status_3XX,http_status_4XX\";content:\"<!DOCTYPE html PUBLIC\";startswith;http_server_body;content:\"|0a|</style>|0a|<title>\";nocase;http_server_body;within:1200;content:\"phpinfo()</title>\";nocase;http_server_body;within:35;flow:from_server,established;gid:0;sid:2019010047;rev:1;)", "2020010011": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fc7bash\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4|tag:\u53cd\u5f39shell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:\u901a\u8fc7bash\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4\";flow:established,to_server;content:\"whoami|0a|\";content:\"mysql\";distance:0;flowbits:unset,bash_whoami;flowbits:isset,bash_whoami;sid:2020010011;)", "2009537": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (Loands) - \u53ef\u80fd\u662f\u6728\u9a6c\u4e0b\u8f7d\u7684GET\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent\\: Loands|0d 0a|\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/2009537;classtype:trojan-activity;sid:2009537;rev:7;)", "2017120111": "alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:\"name:\u5efa\u7acb\u901a\u4fe1\u96a7\u9053|type:tunneling|tag:DNS\u96a7\u9053|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:2|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5f02\u5e38\u7684NULL\u7c7b\u578b\u8bf7\u6c42\";content:!\"|00|\";offset:12;depth:1;byte_test:1, >, 30, 12, big;content:\"|00 0a 00 01|\";isdataat:!1, relative;threshold:type threshold, track by_src, count 50, seconds 300;sid:2017120111;rev:1;)", "2008707": "alert tcp $HOME_NET any -> $HOME_NET 139 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";flow:established,to_server;content:\"|1F 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"..|5C|..|5C|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008707;classtype:attempted-admin;sid:2008707;rev:6;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2018112612": "alert smb $HOME_NET any -> $HOME_NET 445 (msg:\"name:\u6c38\u6052\u6d6a\u6f2b\u6f0f\u6d1e\u653b\u51fb|tag:smb|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|gray:|result:success|o_msg:Trans Request\";content:\"|ff 53 4d 42 25|\";offset:4;depth:5;threshold:type threshold,track by_src,count 5,seconds 1;flowbits:set,TRANS_REQUEST;flowbits:noalert;sid:2018112612;)", "2018120300": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6ce2\u5c14\u540e\u95e8\u6728\u9a6c|type:rat|tag:Boer\u8fdc\u63a7|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6c\u6ce2\u5c14\u8fdc\u63a7\u51fa\u7ad9\u6d41\u91cf\";flow:established;content:\"EMSG00\";depth:6;nocase;content:\"<Msg00\";distance:0;content:\"</Msg00\";distance:0;sid:2018120300;rev:1;)", "2826143": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Cobalt Strike\u8fde\u63a5|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:\u5b58\u5728Cobalt Strike \u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"OK\";http_stat_msg;content:\"|58 35 4f 21 50 25 40 41 50 5b 34 5c 50 5a 58 35 34 28 50 5e 29 37 43 43 29 37 7d 24 45 49 43 41 52 2d 53 54 41 4e 44 41 52 44 2d 41 4e 54 49 56 49 52 55 53 2d 54 45 53 54 2d 46 49 4c 45 21 24 48 2b 48 2a|\";http_header;metadata:former_category TROJAN;reference:url,blog.cobaltstrike.com/2015/10/14/the-cobalt-strike-trials-evil-bit;classtype:trojan-activity;sid:2826143;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2017_04_27, performance_impact Moderate, updated_at 2017_04_27;)", "2020061809": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-2883)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-2883)|attacker:src\";flow:established, to_server;content:\"|ac ed 00 05|\";content:\"java.util.PriorityQueue\";distance:2;content:\"com.tangosol.util.extractor.ChainedExtractor\";distance:0;content:\"com.tangosol.util.extractor.AbstractExtractore\";sid:2020061809;rev:1;)", "2020010014": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fc7bash\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4|tag:\u53cd\u5f39shell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:\u901a\u8fc7bash\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4\";flow:established,to_server;content:\"whoami|0a|\";content:\"root\";distance:0;flowbits:unset,bash_whoami;flowbits:isset,bash_whoami;sid:2020010014;)", "2020032601": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Discuz!X \u22643.4 \u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e|tag:\u4efb\u610f\u6587\u4ef6\u5220\u9664|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Discuz!X \u22643.4 \u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, discuz_3_4_afd;content:\"POST\";http_method;content:\"/home.php\";http_uri;content:\"op=base\";http_uri;distance:1;content:\"birthprovince\";http_client_body;content:\"../\";http_client_body;distance:1;content:\"formhash\";http_client_body;sid:2020032601;rev:1;)", "2019060013": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"PHPSESSID=\";http_cookie;pcre:\"/[a-fA-F0-9]{32}/CR\";noalert;flowbits:isset, bingxie_webshell;flowbits:set, bingxie_webshell_step2;content:\"c\";nocase;http_server_body;within:16;pcre:\"/^([a-f0-9A-F]{16})$/Q\";isdataat:!1,relative;sid:2019060013;gid:0;rev:1;)", "2020072202": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Cobalt Strike\u8fde\u63a5|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:3|o_msg:\u5b58\u5728Cobalt Strike \u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"application/octet-stream\";depth:24;isdataat:!1,relative;pkt_data;http_header_names;content:\"|0d 0a|Date\";depth:6;content:\"|0d 0a|Content-Type|0d 0a|Content-Length|0d 0a 0d 0a|\";distance:0;within:34;pkt_data;content:\"%COMSPEC%\";http_server_body;depth:48;content:\"AAAA\";distance:0;sid:2020072202;rev:1;)", "2028588": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike\u5229\u7528O365\u8fdb\u884cC2\u8bf7\u6c42|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike\u5229\u7528O365\u8fdb\u884cC2\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"/owa/?wa=\";http_uri;depth:9;content:\"&path=/calendar\";http_uri;distance:0;isdataat:!1,relative;fast_pattern;content:\"MicrosoftApplicationsTelemetryDeviceId=\";http_cookie;depth:39;content:\"|3b|ClientId=\";http_cookie;distance:0;content:\"|3b|MSPAuth=\";http_cookie;distance:0;content:\"|3b|xid=\";http_cookie;distance:0;content:\"|3b|wla42=\";http_cookie;distance:0;http_header_names;content:!\"Referer\";content:\"Cookie\";metadata:former_category MALWARE;reference:md5,a26722fc7e5882b5a273239cddfe755f;reference:url,attack.mitre.org/groups/G0080/;classtype:trojan-activity;sid:2028588;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2019_09_17, malware_family Cobalt_Strike, updated_at 2019_09_17;)", "2019090122": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(imap)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"* OK \";depth:5;pcre:\"/^\\* OK Dovecot DA ready\\.\\r\\n/\";sid:2019090122;gid:0;)", "2020041025": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(JRMP)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(JRMP)|attacker:dest\";flow:established, to_server;xbits:isset, weblogic_link_jrmp, track ip_src;dsize:7;content:\"JRMI\";startswith;sid:2020041025;rev:1;)", "2024208": "alert smb $HOME_NET any -> $HOME_NET any (msg:\"name:\u5229\u7528MS17-010\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u7591\u4f3c\u5b58\u5728\u6c38\u6052\u4e4b\u84dd\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a - MS17-010\";flow:from_server,established;content:\"|FF|SMB|25 05 00 00 80|\";offset:4;depth:9;content:\"LSbfLScnLSepLSlfLSmf\";distance:0;fast_pattern;content:\"LSrfLSsrLSscLSblLSss\";within:20;content:\"LSshLStrLStcLSopLScd\";within:20;flowbits:set,TB.ETERNALROMANCE;metadata:former_category EXPLOIT;classtype:trojan-activity;sid:2024208;rev:1;metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_04_17;)", "2018010075": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"' UNION ALL SELECT\";nocase;http_uri;within:300;content:\"NULL,NULL,NULL,NULL,NULL\";nocase;http_uri;within:152;flow:to_server,established;gid:0;sid:2018010075;rev:1;)", "2018020001": "alert tcp $HOME_NET 23 -> $EXTERNAL_NET any (msg:\"name:\u767b\u5f55telnet|tag:\u767b\u5f55|direction:in|service_name:TELNET|service_class:rlogin|src:home_net|dest:external_net|level:action|o_msg:TELNET \u670d\u52a1\u767b\u5f55\u6210\u529f|server:src\";flow:from_server,established;content:\"welcome to\";nocase;content:\"@\";gid:3;sid:2018020001;rev:1;)", "2020071301": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Citrix Netscaler/ADC \u8ba4\u8bc1\u7ed5\u8fc7(CVE-2020-7473)|tag:\u6743\u9650\u7ed5\u8fc7|dest:home_net|level:attack|severity:3|result:unknown|phase:exploit|o_msg:Citrix Netscaler/ADC \u8ba4\u8bc1\u7ed5\u8fc7(CVE-2020-7473)\u3010step_1\u3011|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2020_7473_step_1;content:\"POST\";http_method;http_content_type;content:\"application/xml\";pkt_data;content:\"/pcidss/report\";http_uri;depth:20;content:\"sid=\";http_uri;distance:0;content:\"loginchallengeresponse\";http_uri;distance:0;content:\"requestbody\";http_uri;sid:2020071301;)", "2018020011": "alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:\"name:FTP\u767b\u5f55\u6210\u529f|tag:\u767b\u5f55|direction:in|service_name:FTP|service_class:file|src:external_net|dest:home_net|level:action|result:success|o_msg:ftp\u670d\u52a1\u767b\u5f55\u6210\u529f[2]|server:dest\";dsize:<40;flow:to_server,established;content:\"230 \";depth:4;sid:2018020011;rev:1;)", "2020070341": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:rConfig v3.9.2\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c(CVE-2019-16662)|tag:\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:rConfig v3.9.2\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c(CVE-2019-16662)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"setup.cgi\";http_uri;depth:20;content:\"currentsetting.htm=1\";http_uri;distance:0;content:\"todo=syscmd\";http_uri;sid:2020070341;rev:1;)", "2019121801": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Tomcat\u4e0a\u4f20war\u5305|tag:Tomcat|dest:home_net|force_save:true|level:action|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Tomcat\u4e0a\u4f20war\u5305|attacker:src\";flow:to_server,established;noalert;flowbits:set, tomcat_upload;content:\"POST\";http_method;content:\"/manager/html/upload\";http_uri;http_content_type:content: \"multipart/form-data\";pkt_data;content:\"name=\\\"deployWar\\\"\";http_client_body;content:\"filename=\\\"\";http_client_body;sid:2019121801;rev:1;)", "2020051211": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Jenkins \u811a\u672c\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:success|o_msg:Jenkins \u811a\u672c\u6267\u884c\u6f0f\u6d1e|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, jenkins_script_rce;content:\"200\";http_stat_code;content:\"<title>Jenkins</title>\";http_server_body;content:\"<h2>Result</h2>\";http_server_body;distance:200;sid:2020051211;rev:2;)", "2025813": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT php script double base64 encoded Remote Code Execution 4|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"OHFQRDl3YUhBZ\";metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025813;rev:2;metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2020060233": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:cobaltstrike \u4e3b\u673a\u4e0a\u7ebf(http)|tag:cobaltstrike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|result:unknown|o_msg:cobaltstrike \u4e3b\u673a\u4e0a\u7ebf(http)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;http_accept;content:\"*/*\";pkt_data;content:!\"imapi.5211game.com\";http_host;content:\"c\";nocase;http_cookie;pcre:\"/^([A-Za-z0-9+\\/]){171}=$/C\";sid:2020060233;rev:1;)", "2020062209": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4e0a\u4f20 ABPTTS \u4ee3\u7406\u6587\u4ef6|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u653b\u51fb\u8005\u4e0a\u4f20 ABPTTS \u4ee3\u7406\u6587\u4ef6, \u5c1d\u8bd5\u8fde\u63a5\u5185\u7f51webshell|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"boundary=\";pkt_data;content:\"filename=\";http_client_body;content:\".asp\";http_client_body;distance:0;within:100;content:\"<%@ Page Language=\\\"C#\\\" %>\";http_client_body;distance:0;content:\"This file is part of A Black Path Toward The Sun (\\\"ABPTTS\\\")\";http_client_body;distance:0;sid:2020062209;rev:1;)", "2018030017": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u89e3\u6790\u6f0f\u6d1e\u626b\u63cf|tag:\u968f\u673a\u626b\u63cf|dest:home_net|level:attack|phase:recon|severity:1|result:unknown|o_msg:asp\u89e3\u6790\u6f0f\u6d1e\u626b\u63cf|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\".asp\";nocase;http_uri;pcre:\"/\\.(asp|aspx)\\;\\.(jpg|gif|png|jpgn)$/iU\";flow:to_server,established;flowbits:set,req;flowbits:noalert;gid:0;sid:2018030017;rev:1;)", "2018030010": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6b63\u5e38PHP\u8bf7\u6c42|tag:php|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:2|result:unknown|o_msg:\u6b63\u5e38PHP\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";content:\"POST\";nocase;http_method;content:\".php\";nocase;http_uri;pcre:\"/\\.php$/iU\";flow:to_server,established;flowbits:set,req;flowbits:noalert;gid:0;sid:2018030010;rev:1;)", "2020051909": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring SpEL\u8868\u8fbe\u5f0f\u4ee3\u7801\u6ce8\u5165|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Spring SpEL\u8868\u8fbe\u5f0f\u4ee3\u7801\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"_(new\";http_client_body;content:\"java.lang.\";http_client_body;distance:1;pcre:\"/Runtime|ProcessBuilder/PRi\";sid:2020051909;rev:1;)", "2018010087": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6587\u4ef6\u5305\u542b\u6cc4\u9732/etc/passwd|tag:\u6587\u4ef6\u5305\u542b|level:attack|phase:exploit|severity:3|result:success|o_msg:\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff0c\u5305\u542b/etc/passwd|dest:home_net|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"root:x:0:0:root:/root:/bin/bash\";http_server_body;content:\"bin:x:1:1:bin:/bin:/sbin/nologin\";http_server_body;flow:from_server,established;flowbits:isset, is_etc_pass_vuln;gid:0;sid:2018010087;rev:1;)", "2100495": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u6267\u884c\u547d\u4ee4|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:success|o_msg:webshell\u8fde\u63a5\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"Bad command or filename\";nocase;http_server_body;sid:2100495;)", "2019010133": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"' UNION ALL SELECT\";nocase;http_client_body;content:\"NULL,NULL,NULL,NULL,NULL\";nocase;http_client_body;within:152;flow:to_server,established;gid:0;sid:2019010133;rev:1;)", "2020052006": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u8fde\u63a5webshell|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5c1d\u8bd5\u8fde\u63a5jsp\u7684webshell|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, jsp_webshell_20200520_1;noalert;content:\".jsp\";http_uri;sid:2020052006;rev:1;)", "2018040031": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:\u626b\u63cf\u9ed1\u5ba2\u540e\u95e8|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|phase:exploit|failed_by:http_status_3XX,http_status_4XX|severity:2|result:unknown|o_msg:\u68c0\u6d4b\u5230\u626b\u63cf\u83dc\u5200\u540e\u95e8\u884c\u4e3a(\u9ed1\u5403\u9ed1\u884c\u4e3a)\uff0c\u9ed1\u5ba2\u4ee5\u7206\u7834\u65b9\u5f0f\u5927\u8303\u56f4\u626b\u63cf\u522b\u7684\u9ed1\u5ba2\u7559\u4e0b\u7684\u540e\u95e8\";content:\"POST\";nocase;http_method;content:\"=Response.Write(\\\"------>\";nocase;http_client_body;flowbits:set, caidao_request;flowbits:set,webshell.scan;flow:to_server,established;gid:0;sid:2018040031;rev:1;)", "2020071503": "alert dns $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5185\u7f51\u5458\u5de5\u4f7f\u7528Burpsuite\u5de5\u5177|tag:dnslog|src:home_net|level:attack|phase:exploit|severity:1|result:success|o_msg:\u5728\u5185\u7f51\u4f7f\u7528burpsuite\uff0c\u9700\u8981\u5173\u6ce8|attacker:dest\";flow:established, to_server;dns_query;content:\"polling.burpcollaborator.net\";pkt_data;sid:2020071503;rev:1;)", "2020072913": "alert tcp $HOME_NET any -> $EXTERNAL_NET 5938 (msg:\"name:\u4f7f\u7528Teamviewer|level:attack|tool:Teamviewer|severity:1|src:home_net|phase:exploit|type:rat|result:unknown|o_msg:\u4f7f\u7528Teamviewer\u8fde\u63a5|attacker:dest\";dsize:83;flow:to_server,established;content:\"|11 30 3c 00 3b 00 00 00|\";depth:8;content:\"|1b 00 00 00 18 00 00 00|\";distance:8;within:8;gid:2;sid:2020072913;rev:1;)", "2019030006": "alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528ngrok\u8fdb\u884c\u5185\u7f51\u7a7f\u900f|tag:tunnel|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|tool:ngrok|result:unknown|o_msg:\u5c1d\u8bd5\u4e0e\u516c\u7f51ngrok\u670d\u52a1\u5668\u5efa\u7acb\u63a7\u5236\u8fde\u63a5\uff0c\u53ef\u7528\u6765\u8fdb\u884c\u5185\u7f51\u7a7f\u900f\";flow:established,to_server;tls_sni;content:\"tunnel.sa.ngrok.com\";flowbits:set,ngrok_state_findsni;flowbits:noalert;sid:2019030006;)", "2019010056": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:\u626b\u63cf|dest:home_net|level:attack|phase:exploit|severity:1|result:unknown|o_msg:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"\\;print(md5(\";nocase;http_client_body;within:80;flow:to_server,established;gid:0;sid:2019010056;)", "20198002": "alert tcp $HOME_NET any -> $EXTERNAL_NET !3389 (msg:\"name:lcx\u7aef\u53e3\u6620\u5c04|tag:\u7aef\u53e3\u6620\u5c04|direction:lateral|type:infil|src:home_net|dest:external_net|level:attack|phase:post_exploit|severity:3|gray:|result:success|o_msg:\u53d1\u73b0\u9ed1\u5ba2\u5de5\u5177lcx.exe\u5c06\u5185\u7f51\u4e3b\u673a\u7aef\u53e3\u6620\u5c04\u5230\u5916\u7f51\";dsize:19;flow:established,to_server;flowbits:isset, lcx_syn;content:\"|03 00 00 09 02 f0 80|\";offset:0;sid:20198002;rev:1;)", "2020070308": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;flowbits:set, tp_5_23_rce;content:\"%5f%6d%65%74%68%6f%64%3d%5f%5f%63%6f%6e%73%74%72%75%63%74\";http_client_body;content:\"%66%69%6c%74%65%72%3d\";http_client_body;sid:2020070308;rev:1;)", "2015995": "alert tcp $EXTERNAL_NET any -> $HOME_NET 3306 (msg:\"name:MySQL\u6f0f\u6d1e\u5229\u7528|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:1|gray:true|result:unknown|o_msg:\u9707\u7f51|attacker:src\";flow:to_server,established;content:\"|03|\";offset:3;depth:4;content:\"SELECT data FROM\";nocase;distance:0;content:\"INTO DUMPFILE\";nocase;distance:0;content:\"c|3a|/windows/system32/\";nocase;fast_pattern;content:\".exe\";nocase;distance:0;pcre:\"/SELECT data FROM [^\\x20]+?\\x20INTO DUMPFILE [\\x27\\x22]c\\x3a\\/windows\\/system32\\/[a-z0-9_-]+?\\.exe[\\x27\\x22]/i\";reference:url,seclists.org/fulldisclosure/2012/Dec/att-13/;classtype:attempted-user;sid:2015995;rev:4;metadata:created_at 2012_12_05, updated_at 2012_12_05;)", "2020082002": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874eWebshell\u901a\u8baf|tag:webshell|tool:\u51b0\u874e|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u51b0\u874eWebshell\u901a\u8baf|gray:true|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;flowbits:set, bingxie_3_0_4_jsp;noalert;content:\"POST\";http_method;content:\".jsp\";http_uri;fast_pattern;http_content_type;content:\"application/octet-stream\";pkt_data;http_content_len;byte_test:0,>=,8000,0,string,dec;pkt_data;pcre:\"/^[A-Za-z0-9+\\/]{8000,}[A-Za-z0-9+\\/=]{2}$/P\";sid:2020082002;gid:0;rev:1;)", "2019090100": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Pure-FTPd\u8fde\u63a5|direction:in|level:action|service_name:PureFTPd|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728PureFTPd|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220---------- .* Pure-FTPd ----------\\r\\n/\";sid:2019090100;gid:0;)", "2012307": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"name:NightDragon\u540e\u95e8\u6728\u9a6c|type:rat|tag:NightDragon|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230Night Dragon\u7684CMD Shell\";flow:established,to_server;content:\"|68 57 24 13 00 33|Microsoft\";offset:12;depth:15;reference:url,www.mcafee.com/us/resources/white-papers/wp-global-energy-cyberattacks-Night-dragon.pdf;classtype:trojan-activity;sid:2012307;rev:1;)", "2020061001": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Drupal Drupalgeddon 2 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2018-7600\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Drupal Drupalgeddon 2 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2018-7600\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2018_7600_1;content:\"POST\";http_method;content:\"/user/register\";http_uri;content:\"form_id=user_register_form\";http_client_body;pcre:\"/(%23|#)(access_callback|pre_render|post_render|lazy_builder)/Pi\";sid:2020061001;rev:1;)", "2020081902": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Nginx \u540e\u95e8\u63a2\u6d4b|tag:\u540e\u95e8\u63a2\u6d4b|dest:home_net|level:attack|phase:exploit|severity:1|result:unknown|o_msg:Nginx \u540e\u95e8\u63a2\u6d4b|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"lkfakjf\";http_cookie;fast_pattern;pcre:\"/^\\w+(((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(\\.((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3})((\\:\\d{1,5})?)/CR\";sid:2020081902;rev:1;)", "2020052509": "alert dns $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528sslip.io\u8fdb\u884c\u53cd\u5f39|tag:dnslog|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u5229\u7528dnslog\u8fdb\u884c\u53cd\u5f39|attacker:dest\";flow:established, to_server;dns_query;content:\".sslip.io\";pkt_data;sid:2020052509;rev:1;)", "2019010136": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"select(sleep(5))\";nocase;http_client_body;flow:to_server,established;gid:0;sid:2019010136;rev:1;)", "2018010118": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|attacker:src\";content:\"union\";nocase;http_header;pcre:\"/[(\\/\\*.*\\*\\/)| ]select/iHR\";content:\"CHR(\";nocase;http_header;pcre:\"/chr\\(\\d{1,3}\\)/iH\";flow:to_server,established;gid:0;sid:2018010118;rev:1;)", "2018062803": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:\u83dc\u5200\u8fde\u63a5\u8bf7\u6c42|tag:\u83dc\u5200|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u83dc\u5200\u8fde\u63a5jsp webshell\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;pcre:\"/=.?1.{0,3}action.?=.{0,5}z\\d.?=.{0,300}code.?=/iP\";sid:2018062803;rev:1;)", "2019010123": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Solr\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2019-0193)|tag:\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Apache Solr\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2019-0193)|attacker:src\";flow:to_server,established;flowbits:set, cve_2019_0193;content:\"/solr/\";http_uri;startswith;content:\"/dataimport\";http_uri;distance:0;content:\"debug=true\";http_uri;content:\"<dataConfig>\";http_uri;content:\"<script>\";http_uri;distance:0;pcre:\"/(java\\.lang\\.ProcessBuilder)|(java\\.lang\\.Runtime\\.getRuntime)/UR\";content:\"</script>\";http_uri;distance:0;content:\"script\\:\";http_uri;distance:0;content:\"</dataConfig>\";http_uri;distance:0;sid:2019010123;rev:1;)", "2020052511": "alert dns $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528tu4.org\u8fdb\u884c\u53cd\u5f39|tag:dnslog|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u5229\u7528dnslog\u8fdb\u884c\u53cd\u5f39|attacker:dest\";flow:established, to_server;dns_query;content:\".tu4.org\";pkt_data;sid:2020052511;rev:1;)", "2020081722": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528AWVS\u626b\u63cf|tag:\u626b\u63cf\u5668|dest:home_net|level:attack|phase:recon|severity:2|result:unknown|o_msg:\u4f7f\u7528AWVS\u8fdb\u884c\u626b\u63cf|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;http_header_names;content:\"|0d 0a|Acunetix-Aspect\";pkt_data;sid:2020081722;rev:1;)", "2018020034": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:wget\u5411\u5916\u8bf7\u6c42|tag:wget\u8bf7\u6c42|tool:wget|direction:out|src:home_net|dest:external_net|level:action|result:unknown|o_msg:\u68c0\u6d4b\u5230linux\u670d\u52a1\u5668\u5185\u90e8\u4f7f\u7528wget\u5411\u5916\u4e0b\u8f7d\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"wget\";http_user_agent;nocase;gid:3;sid:2018020034;rev:1;)", "2020070831": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6587\u4ef6\u5305\u542b\u8bfb\u53d6|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u6587\u4ef6\u8bfb\u53d6(\u6210\u529f)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, file_read_general;content:\"200\";http_stat_code;content:\"[pid\";http_server_body;fast_pattern;pcre:\"/\\[(Sun|Mon|Tue|Wed|Thu|Fri|Sat)\\ (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sept|Oct|Nov|Dec)\\ \\d{2} \\d{2}\\:\\d{2}\\:\\d{2}\\.\\d{6}\\ \\d{4}\\] \\[\\w+\\:\\w+\\] \\[pid \\d+\\] /Q\";sid:2020070831;rev:1;)", "2018030020": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JSP\u654f\u611f\u6587\u4ef6\u626b\u63cf|tag:\u626b\u63cf|tool:\u5317\u6781\u718a\u626b\u63cf\u5668|phase:recon|dest:home_net|level:attack|severity:2|result:unknown|o_msg:\u4f7f\u7528\u5317\u6781\u718a\u626b\u63cf\u5668\u8fdb\u884c\u626b\u63cfasp\u654f\u611f\u6587\u4ef6\uff0c\u5305\u62ec\u540e\u53f0\u6216\u6f0f\u6d1e\u7a0b\u5e8f\u7684\u6838\u5fc3\u6587\u4ef6\uff0c\u5317\u6781\u718a\u626b\u63cf\u5668\u662f\u5e7f\u5dde\u767d\u72d0\u516c\u53f8\u5f00\u53d1\u7684\u5355\u673a\u626b\u63cf\u5668|attacker:src\";content:\"GET\";nocase;content:\".jsp\";pcre:\"/\\.jsp$/iU\";content:\"Accept: */*|0d 0a|User-Agent: Mozilla/4.0 (compatible\\;Win32\\;WinHttp.WinHttpRequest.5)|0d 0a|Host:\";nocase;http_raw_header;offset:0;pcre:\"/[\\d\\w._-]+(\\x0d\\x0a)Connection: (Keep-Alive\\x0d\\x0a)$/iDR\";flow:to_server,established;threshold:type both, track by_src, count 40, seconds 1;sid:2018030020;rev:1;)", "2020010604": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:mongo express \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c(CVE-2019-10758)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:mongo express \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c(CVE-2019-10758)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2019_10758;content:\"X-Powered-By: Express\";http_header;content:\"Valid\";http_server_body;startswith;sid:2020010604;rev:1;)", "2020032606": "alert tcp $EXTERNAL_NET any -> $HOME_NET 11211 (msg:\"name:discuz-\u5c1d\u8bd5\u901a\u8fc7Memcached\u672a\u6388\u6743\u6267\u884c\u547d\u4ee4|tag:\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5c1d\u8bd5\u901a\u8fc7Memcached\u672a\u6388\u6743\u6267\u884c\u547d\u4ee4|attacker:src\";flow:established, to_server;content:\"a:2:{s:6:\\\"output\\\"\\;\";content:\"a:1:{s:4:\\\"preg\\\"\\;\";distance:0;content:\"a:2:{s:6:\\\"search\\\"\\;\";distance:0;sid:2020032606;rev:1;)", "2020051902": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:vBulletin \u524d\u53f0sql\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2020-12720\uff09|tag:SQL\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:vBulletin \u524d\u53f0sql\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2020-12720\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2020_12720;content:\"200\";http_stat_code;http_content_type;content:\"application/json\";pkt_data;content:\"\\\"title\\\":\";http_server_body;depth:10;content:\"\\\"rawtext\\\"\";http_server_body;distance:2;within:40;sid:2020051902;rev:1;)", "2025797": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT Generic system shell command to php base64 encoded Remote Code Execution 3|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"zeXN0ZW0oIiBwaH\";metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025797;rev:2;metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2019060020": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"ASPSESSIONID\";http_cookie;pcre:\"/[a-zA-Z]+=[a-zA-Z0-9]{24}/CR\";http_content_len;byte_test:0,=,16,0,string,dec;pkt_data;content:\"f\";nocase;http_server_body;within:16;pcre:\"/^([a-f0-9A-F]{16})$/Q\";isdataat:!1,relative;noalert;flowbits:isset, bingxie_webshell_asp;flowbits:set, bingxie_webshell_step2_asp;sid:2019060020;gid:0;rev:1;)", "2018010106": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165\u5199\u5165\u6587\u4ef6|tag:\u6ce8\u5165\u5199\u6587\u4ef6|dest:home_net|level:attack|phase:exploit|severity:2|success_by:sql_inject_success|o_msg:\u5c1d\u8bd5\u5229\u7528MySQL\u6ce8\u5165\u5199\u5165\u6587\u4ef6|attacker:src\";content:\"select\";nocase;http_header;pcre:\"/[\\s\\w/\\\\.*\\d()\"'=,:\\;+<>_-]+/iHR\";content:\"into outfile \";nocase;http_header;distance:1;within:100;pcre:\"/['\"][0-9A-Za-z/\\\\._:-]+['\"]/iHR\";flow:to_server,established;gid:0;sid:2018010106;rev:1;)", "2020041028": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2018-2893)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2018-2893)|attacker:src\";flow:established, to_server;flowbits:set, cve_2018_2893;xbits:set, weblogic_link_jrmp, track ip_dst, expire 60;content:\"|ac ed 00 05|\";content:\"weblogic.jms.common.StreamMessageImpl\";distance:0;content:\"weblogic.jms.common.MessageImpl\";distance:0;content:\"java.rmi.registry.Registry\";distance:0;content:\"java.rmi.server.RemoteObjectInvocationHandler\";distance:0;sid:2020041028;rev:1;)", "2019000050": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:weblogic\u6f0f\u6d1e\u5229\u7528|tag:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:weblogic\u6f0f\u6d1e\u5229\u7528|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"500\";http_stat_code;http_content_type;content:\"text/xml\";pkt_data;content:\"java.io.IOException: Cannot run program \\\"\";http_server_body;pcre:\"/(ifconfig|dir|ipconfig|)\\\": CreateProcess /RQ\";sid:2019000050;)", "2019090313": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Oracle\u8fde\u63a5|direction:in|level:action|service_name:Oracle|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728Oracle|server:src\";flow:from_server,established;content:\"|00 20 00 00 03 00 00 00 02|6|00 00 08 00 7f ff 01 00 00 00 00 20|\";offset:0;sid:2019090313;gid:0;)", "2020010000": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache ShardingSphere \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-1947)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Apache ShardingSphere \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-1947)|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/api/schema\";http_uri;content:\"dataSourceConfiguration\";http_client_body;content:\"!!\";http_client_body;distance:0;content:\"JdbcRowSetImpl\";http_client_body;distance:0;pcre:\"/(ldap|rmi):\\/\\//PRi\";sid:2020010000;rev:1;)", "2019090002": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MySQL\u8fde\u63a5|direction:in|level:action|service_name:MySQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728MySQL|server:src\";flow:from_server,established;content:\"|00 00 00|\";offset:1;depth:3;pcre:\"/^.\\0\\0\\0\\xffj\\x04'[\\d.]+' .* MySQL/\";sid:2019090002;gid:0;)", "2020041018": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic XXE\uff08CVE-2019-2888\uff09|tag:xxe|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic XXE\uff08CVE-2019-2888\uff09|attacker:src\";flow:established, to_server;xbits:set, weblogic_xxe, track ip_dst, expire 20;content:\"|ac ed 00 05|\";content:\"weblogic.servlet.ejb2jsp.dd.EJBTaglibDescriptor\";distance:0;content:\"<!DOCTYPE\";distance:0;content:\"SYSTEM \";distance:0;pcre:\"/(http|https):\\/\\//Ri\";sid:2020041018;rev:1;)", "2018010119": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|attacker:src\";content:\"union\";nocase;http_header;pcre:\"/[\\\\/*! ]+/select[\\\\/*! ]+/iHR\";flow:to_server,established;gid:0;sid:2018010119;rev:1;)", "2019000044": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:weblogic\u6f0f\u6d1e\u5229\u7528|tag:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:CVE-2017-10271 Payload\u653b\u51fb\u7cfb\u7edf[1]|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"class=\\\"java.io.PrintWriter\\\">\";http_client_body;content:\"<string>servers/\";http_client_body;pcre:\"/<string>servers\\/([a-zA-Z0-9_-]+\\/)+_WL_internal\\/bea_wls_internal\\/([a-zA-Z0-9_-]+\\/)+[0-9a-z]+\\.jsp<\\/string>/P\";flowbits:set, weblogic_write_file;gid:0;sid:2019000044;rev:1;)", "2020062312": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Dubbo \u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(ROME\u94fe-dubbo\u534f\u8bae)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Apache Dubbo \u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(ROME\u94fe-dubbo\u534f\u8bae)|attacker:src\";flow:established, to_server;xbits:set, dubbo_link_jrmp, track ip_dst, expire 20;content:\"|da bb|\";depth:2;fast_pattern;content:\"com.rometools.rome.feed.impl.ToStringBean\";distance:0;content:\"com.sun.rowset.JdbcRowSetImpl\";distance:0;pcre:\"/(ldap|rmi)\\:\\/\\//Ri\";sid:2020062312;rev:1;)", "2020060213": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(CommonsCollections1-HTTP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"application/\";pcre:\"/(x-www-form-urlencoded)|(x-java-serialized-object)/R\";pkt_data;content:\"|ac ed 00 05|\";http_client_body;fast_pattern;content:\"sun.reflect.annotation.AnnotationInvocationHandler\";http_client_body;content:\"org.apache.commons.collections.map.LazyMap\";http_client_body;content:\"org.apache.commons.collections.functors.InvokerTransformer\";http_client_body;sid:2020060213;rev:1;)", "2018030019": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHP\u654f\u611f\u6587\u4ef6\u626b\u63cf|tag:\u626b\u63cf|tool:\u5317\u6781\u718a\u626b\u63cf\u5668|phase:recon|dest:home_net|level:attack|severity:2|result:unknown|o_msg:\u4f7f\u7528\u5317\u6781\u718a\u626b\u63cf\u5668\u8fdb\u884c\u626b\u63cfasp\u654f\u611f\u6587\u4ef6\uff0c\u5305\u62ec\u540e\u53f0\u6216\u6f0f\u6d1e\u7a0b\u5e8f\u7684\u6838\u5fc3\u6587\u4ef6\uff0c\u5317\u6781\u718a\u626b\u63cf\u5668\u662f\u5e7f\u5dde\u767d\u72d0\u516c\u53f8\u5f00\u53d1\u7684\u5355\u673a\u626b\u63cf\u5668|attacker:src\";content:\"GET\";nocase;content:\".php\";pcre:\"/\\.php$/iU\";content:\"Accept: */*|0d 0a|User-Agent: Mozilla/4.0 (compatible\\;Win32\\;WinHttp.WinHttpRequest.5)|0d 0a|Host:\";nocase;http_raw_header;offset:0;pcre:\"/[\\d\\w._-]+(\\x0d\\x0a)Connection: (Keep-Alive\\x0d\\x0a)$/iDR\";flow:to_server,established;threshold:type both, track by_src, count 40, seconds 1;sid:2018030019;rev:1;)", "2019010114": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:XML\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165|tag:XML\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:XML\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:!\"boundary=\";pkt_data;content:\"<!DOCTYPE\";http_client_body;distance:0;content:\"<!ENTITY\";http_client_body;distance:0;content:\"SYSTEM |22|data://\";http_client_body;distance:0;content:\"base64\";http_client_body;distance:0;pcre:\"/ZmlsZTovL|aHR0cDovL|ZXhjZXB0Oi8v|cGhwOi8v|aHR0cHM6Ly/PR\";sid:2019010114;rev:1;)", "2020030022": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528\u5de5\u5177Mimikatz|tag:mimikatz|tool:mimikatz|dest:home_net|level:attack|phase:exploit|result:success|severity:3|o_msg:mimikatz|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"|0d 0a|  .#####.   \";http_server_body;content:\" .## ^ ##.  \";http_server_body;distance:8;content:\" ## / \\\\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\";http_server_body;content:\" ## \\\\ / ##       > http://blog.gentilkiwi.com/mimikatz\";distance:1;content:\" '## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\";distance:1;content:\"  '#####'        > http://pingcastle.com / http://mysmartlogon.com   ***/\";distance:1;sid:2020030022;rev:1;)", "2020060408": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:CVE-2019-2725|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:weblogic CVE-2019-2725|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve-2019-2725;content:\"202\";http_stat_code;sid:2020060408;rev:1;)", "2020070211": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u653b\u51fb\u8005\u83b7\u5f97\u670d\u52a1\u5668Shell|tag:getshell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u653b\u51fb\u8005\u83b7\u5f97\u670d\u52a1\u5668shell|attacker:dest\";flow:established;content:\"W|00|i|00|n|00|d|00|o|00|w|00|s|00 20 00|P|00|o|00|w|00|e|00|r|00|S|00|h|00|e|00|l|00|l|00|\";depth:40;content:\"M|00|i|00|c|00|r|00|o|00|s|00|o|00|f|00|t|00 20 00|C|00|o|00|r|00|p|00|o|00|r|00|a|00|t|00|i|00|o|00|n|00|\";distance:0;within:200;sid:2020070211;rev:1;)", "2008719": "alert tcp $HOME_NET any -> $HOME_NET 139 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";flow:established,to_server;content:\"|20 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"|00 2E 00 2E 00 2F 00 2E 00 2E 00 2F|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008719;classtype:attempted-admin;sid:2008719;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2020052004": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u8fde\u63a5webshell|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u5c1d\u8bd5\u8fde\u63a5jsp\u7684webshell|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, jsp_webshell_20200520;content:\"POST\";http_method;content:\".jsp\";http_uri;content:\"pass=\";http_client_body;fast_pattern;content:\"cmd=\";http_client_body;pcre:\"/^([a-zA-Z0-9\\/\\+]{4})*([a-zA-Z0-9\\/\\+]{4}|[a-zA-Z0-9\\/\\+]{3}=|[a-zA-Z0-9\\/\\+]{2}==)/PR\";sid:2020052004;rev:1;)", "2020061306": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4e0a\u4f20Behinder webshell|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u4e0a\u4f20Behinder webshell|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"boundary=\";pkt_data;content:\"<?php\";http_client_body;distance:0;content:\"session_start()\\;\";http_client_body;distance:0;content:\"file_get_contents\";http_client_body;distance:0;content:\"extension_loaded('openssl')\";http_client_body;distance:0;content:\"openssl_decrypt\";http_client_body;distance:0;content:\"__construct\";http_client_body;distance:0;sid:2020061306;rev:1;)", "2020051932": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee(metrics)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, spring_actuator_metrics;content:\"200\";http_stat_code;http_content_type;content:\"application\";content:\"spring-boot.actuator\";distance:0;content:\"json\";distance:0;pkt_data;content:\"{\\\"names\\\":\";http_server_body;startswith;content:\"jvm.\";distance:0;http_server_body;sid:2020051932;rev:1;)", "2018010041": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"extractvalue(\";nocase;http_uri;pcre:\"/\\d, *concat\\(0x\\w\\w,/iU\";flow:to_server,established;gid:0;sid:2018010041;rev:1;)", "2020051242": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:D-Link DIR-645\\DIR-815 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:success|o_msg:D-Link DIR-645 \u548c DIR-815 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, d_link_645_815_rce;content:\"200\";http_stat_code;content:\"<diagnostic>\";http_server_body;content:\"<report>OK</report>\";http_server_body;sid:2020051242;rev:2;)", "2025816": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT php script double base64 encoded Remote Code Execution 7|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"dktqdy9jR2h3S\";metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025816;rev:2;metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2020010005": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fc7bash\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4|tag:\u53cd\u5f39shell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:\u67e5\u8be2\u7f51\u7edc\u76f8\u5173\";flow:established,to_server;content:\"lo|3a|\";content:\"inet 127.0.0.1\";content:\"inet6 |3a||3a|1\";content:\"LOOPBACK\";flowbits:unset,ip_send;flowbits:isset,ip_send;sid:2020010005;)", "2019010132": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165\u8bfb\u53d6\u6587\u4ef6|tag:\u6ce8\u5165\u8bfb\u6587\u4ef6|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:\u5c1d\u8bd5\u5229\u7528MySQL\u6ce8\u5165\u8bfb\u53d6\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"union\";nocase;http_client_body;pcre:\"/[(\\/\\*.*\\*\\/)| ]select/iPR\";content:\"load_file(\";nocase;http_client_body;distance:1;within:40;flow:to_server,established;gid:0;sid:2019010132;rev:1;)", "2019090238": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:radmin\u8fde\u63a5|direction:in|level:action|service_name:Radmin|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728Radmin|server:src\";flow:from_server,established;content:\"|01 00 00 00|\";depth:4;pcre:\"/^\\x01\\x00\\x00\\x00\\x25\\x0a\\x00\\x01\\x10\\x08\\x01\\x00\\x0a\\x08/\";sid:2019090238;gid:0;)", "2020070604": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHPCMS \u6ce8\u518c\u9875\u9762\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e|tag:\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:PHPCMS \u6ce8\u518c\u9875\u9762\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, phpcms_9_6_upload;content:\"POST\";http_method;content:\"a=register\";http_uri;content:\"info%5Bcontent%5D=\";http_client_body;content:\"%3Cimg+src%3D\";http_client_body;distance:0;pcre:\"/%23\\.(gif|jpg|jpeg|bmp|png)/PRi\";sid:2020070604;rev:1;)", "2019090312": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Oracle-tns\u8fde\u63a5|direction:in|level:action|service_name:Oracle-tns|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728Oracle-tns|server:src\";flow:from_server,established;content:\"|00|\";pcre:\"/^..\\0\\0\\x04\\0\\0\\0\\\"\\0..\\(DESCRIPTION=\\(TMP=\\)\\(VSNNUM=\\d+\\)\\(ERR=1189\\)\\(ERROR_STACK=\\(ERROR=\\(CODE=1189\\)\\(EMFI=4\\)\\)/\";sid:2019090312;gid:0;)", "2826154": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike\u8fde\u63a5\u8bf7\u6c42(\u5229\u7528webbug)|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike \u5229\u7528webbug\u7684\u8d44\u6599\u9875\u8fdb\u884c\u53cd\u5f39\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\"_utm.gif?utmac=\";fast_pattern;http_uri;content:\"&utmcn=\";distance:0;http_uri;content:\"&utmcs=\";distance:0;http_uri;content:\"&utmsr=\";distance:0;http_uri;content:\"&utmsc=\";distance:0;http_uri;content:\"&utmul=\";distance:0;http_uri;content:!\"www.google-analytics.com\";http_host;http_header_names;content:!\"Referer|0d 0a|\";metadata:former_category MALWARE;reference:md5,dc65cbf12622eb55f0fd382e0fe250c5;classtype:trojan-activity;sid:2826154;rev:4;metadata:created_at 2017_04_27, updated_at 2020_03_05;)", "2020010903": "alert tcp $EXTERNAL_NET any -> $HOME_NET 27017 (msg:\"name:MongoDB\u6570\u636e\u5e93\u679a\u4e3e|tag:\u672a\u6388\u6743\u6f0f\u6d1e|direction:in|src:external_net|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:MongoDB\u6570\u636e\u5e93\u679a\u4e3e\";flow:to_server,established;flowbits:set, mongodb_link;content:\"|d4 07 00 00|\";offset:12;depth:4;fast_pattern;content:\"admin.$cmd|00|\";distance:0;content:\"admin.system.namespaces|00|\";distance:0;sid:2020010903;rev:1;)", "2834370": "alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike\u8bf7\u6c42SSL\u8fde\u63a5|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike\u8fde\u63a5\u8bf7\u6c42\";flow:to_server,established;tls_sni;content:\"secure-adn.appspot.com\";isdataat:!1,relative;metadata:former_category TROJAN;classtype:trojan-activity;sid:2834370;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag SSL_TLS_SNI, signatrue_severity Major, created_at 2019_01_14, malware_family CobaltStrike, performance_impact Low, updated_at 2019_09_28;)", "2019090087": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:FileZilla\u8fde\u63a5|direction:in|level:action|service_name:FileZilla|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728FileZilla|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220-FileZilla Server\\r\\n/\";sid:2019090087;gid:0;)", "2019090197": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([\\w_.-]+) ESMTP ispCP (.*) OMEGA Managed\\r\\n/\";sid:2019090197;gid:0;)", "2019010124": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Apache Solr\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e \uff08CVE-2019-12409\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Apache Solr\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e \uff08CVE-2019-12409\uff09|attacker:dest\";flow:established, from_server;flowbits:isset, cve_2019_12409;flowbits:unset, cve_2019_12409;content:\"Q|ac ed 00 05|w\";startswith;content:\"javax.management.ObjectName\";distance:16;sid:2019010124;rev:1;)", "2018010079": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"select count\";nocase;http_client_body;within:1000;content:\"NULL,NULL,NULL,NULL,NULL\";nocase;http_client_body;within:152;flow:to_server,established;gid:0;sid:2018010079;rev:1;)", "2806217": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:Linksys E1500/E2500\u7684\u6f0f\u6d1e\u5229\u7528|tag:webshell|src:home_net|dest:home_net|level:attack|phase:exploit|severity:2|gray:true|result:unknown|o_msg:Struts\u7684\u6f0f\u6d1e\u5229\u7528|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\"/apply.cgi\";fast_pattern:only;http_uri;nocase;content:\"ping_size=&\";nocase;http_uri;pcre:\"/ping_size=&[a-z]/Ui\";reference:bugtraq,5776;reference:url,homesupport.cisco.com/de-eu/support/routers/E1500;reference:url,s3cur1ty.de/m1adv2013-004;classtype:attempted-recon;sid:2806217;rev:2;metadata:created_at 2013_04_05, updated_at 2013_04_05;)", "2020072703": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Weblogic\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6(CVE-2019-2615)|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:Weblogic\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6(CVE-2019-2615)|severity:2|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2019_2615;content:\"/bea_wls_management_internal2/wl_management\";http_uri;http_header_names;content:\"|0d 0a|wl_request_type|0d 0a|\";nocase;content:\"|0d 0a|adminPath|0d 0a|\";nocase;pkt_data;content:\"wl_request_type\";http_header;content:\"wl_jsp_refresh_request\";http_header;distance:0;within:40;sid:2020072703;rev:1;)", "2018041800": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:DarkstRat2008\u540e\u95e8\u6728\u9a6c|type:rat|tag:DarkstRat2008|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cDarkstRat\u4e0a\u7ebf\u5305\";dsize:12<>18;flow:from_server,established;content:\"MAININFO\";pcre:\"/^MAININFO\\|\\d{2,5}\\x0d\\x0a$/\";flowbits:set,TB_DarkstRat2008;flowbits:noalert;sid:2018041800;rev:1;)", "2019090081": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:FileZilla\u8fde\u63a5|direction:in|level:action|service_name:FileZilla|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728FileZilla|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220[- ]FileZilla Server version (\\d[-.\\w ]+)\\r\\n/\";sid:2019090081;gid:0;)", "2020070319": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|tag:\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\".php\";http_uri;content:\"die\";http_uri;fast_pattern;distance:0;pcre:\"/die\\(\\@?md5\\(\\S+\\)\\)/Ui\";sid:2020070319;rev:1;)", "180827004": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Linux.Doflu|type:botnet|tag:Doflu|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u6728\u9a6c\u540e\u95e8Linux.Doflu\u5fc3\u8df3\u5305\";dsize:13<>36;content:\"INFO:\";depth:5;nocase;content:\"%|7C|\";distance:0;threshold:type both, track by_src, count 8, seconds 60;sid:180827004;rev:1;)", "2020062812": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Stowaway-\u53cd\u5411\u4ee3\u7406)|tag:\u653b\u51fb\u4ee3\u7406|tool:Stowaway|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Stowaway-\u53cd\u5411\u4ee3\u7406)\";flow:established, from_server;flowbits:isset, Stowaway_link_type_1_1;content:\"d41d8cd98f00b204\";depth:16;content:\"|30 30 30 30 30 30 30 30 30 31 00 00 00 00 00 00|\";distance:0;within:16;content:\"COMMAND\";distance:2;within:7;content:\"CONFIRM\";distance:4;within:7;sid:2020062812;rev:1;)", "20198001": "alert tcp $HOME_NET any -> $EXTERNAL_NET !3389 (msg:\"name:lcx\u7aef\u53e3\u6620\u5c04|tag:\u7aef\u53e3\u6620\u5c04|direction:lateral|type:infil|src:home_net|dest:external_net|level:attack|phase:post_exploit|severity:3|gray:|result:success|o_msg:\u53d1\u73b0\u9ed1\u5ba2\u5de5\u5177lcx.exe\u5c06\u5185\u7f51\u4e3b\u673a\u7aef\u53e3\u6620\u5c04\u5230\u5916\u7f51\";dsize:19;flow:established,to_server;flowbits:isset, lcx_syn;content:\"|03 00 00 13 0e d0 00 00 12|4|00 02 01 08 00 02 00 00 00|\";offset:0;sid:20198001;rev:1;)", "2019070008": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:weblogic\u6f0f\u6d1e\u5229\u7528|tag:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|direction:out|dest:external_net|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:attack_out|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Weblogic wls-wsat XMLDecoder\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1eCVE-2017-10271 Payload\u653b\u51fb\u7cfb\u7edf[1]\";flow:to_server,established;content:\"POST\";http_method;content:\"wls-wsat/CoordinatorPortType\";http_uri;content:\"java.lang.ProcessBuilder\";content:\"java.lang.String\";gid:3;sid:2019070008;rev:1;)", "2018010082": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"select(sleep(5))\";nocase;http_uri;within:1000;flow:to_server,established;gid:0;sid:2018010082;rev:1;)", "2020081729": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528Zgrab\u626b\u63cf|tag:\u626b\u63cf\u5668|tool:Zgrab|dest:home_net|level:attack|phase:recon|severity:2|result:unknown|o_msg:\u4f7f\u7528Zgrab\u8fdb\u884c\u626b\u63cf|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"Zgrab/\";http_user_agent;sid:2020081729;rev:1;)", "2019090190": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([\\w._-]+) [\\w._-]+ ESMTP Postfix \\(Debian/GNU\\)/\";sid:2019090190;gid:0;)", "2020072004": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5b58\u5728 Tomcat \u6837\u4f8b\u76ee\u5f55\u6210\u529f\u83b7\u53d6|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:recon|severity:1|result:unknown|o_msg:\u8bbf\u95ee Tomcat \u6837\u4f8b\u76ee\u5f55|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, tomcat_examples;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"<title>\";http_server_body;fast_pattern;content:\"example\";distance:0;within:80;http_server_body;nocase;sid:2020072004;rev:1;)", "2019010116": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Apache Solr\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2019-0192)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:Apache Solr\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2019-0192)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2019_0193;content:\"500\";http_stat_code;content:\"undeclared checked exception\\; nested exception is\";http_server_body;sid:2019010116;rev:1;)", "2019010011": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:/etc/passwd\u5c1d\u8bd5|tag:\u76ee\u5f55\u904d\u5386\u5c1d\u8bd5|dest:home_net|level:attack|phase:exploit|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u5305\u542b/etc/passwd|severity:1|attacker:src\";content:\"GET\";nocase;http_method;content:\"/etc/passwd\";nocase;http_client_body;flow:to_server,established;flowbits:set,etc.passwd;gid:0;sid:2019010011;rev:1;)", "2020021704": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u53cd\u5411\u4ee3\u7406\u8fde\u63a5|tag:\u53cd\u5411\u4ee3\u7406|dest:external_net|src:home_net|level:action|severity:2|result:unknown|o_msg:\u53cd\u5411\u4ee3\u7406\u8fde\u63a5\";flow:established, to_server;dsize:2;content:\"|05 00|\";offset:0;depth:2;sid:2020021704;rev:1;)", "2008704": "alert tcp $HOME_NET any -> $HOME_NET 445 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";flow:established,to_server;content:\"|1F 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"|00 2E 00 2E 00 2F 00 2E 00 2E 00 2F|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008704;classtype:attempted-admin;sid:2008704;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2020070201": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Fastjson \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Fastjson \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, fastjson_jndi;xbits:set, jdni_link_jrmp, track ip_dst, expire 20;content:\"POST\";http_method;http_content_type;content:\"application/json\";pkt_data;content:\"\\\\u0040\\\\u0074\\\\u0079\\\\u0070\\\\u0065\";http_client_body;fast_pattern;pcre:\"/(ldap|rmi):\\/\\//PRi\";sid:2020070201;rev:1;)", "2013338": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Bifrose\u540e\u95e8\u6728\u9a6c|type:rat|tag:Bifrose|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230Bifrose\u5ba2\u6237\u7aef\u4e0a\u7ebf\";flow:established,to_server;content:\"|00 00 99 4F B9 74 E2 75 94 0A 5A|\";offset:2;depth:11;classtype:trojan-activity;sid:2013338;rev:2;)", "2020052521": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:AWVS\u626b\u63cf\u5668|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tool:AWVS\u626b\u63cf\u5668|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u4f7f\u7528AWVS\u626b\u63cf\u5668\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"GET\";http_method;content:\".autoverify.cn\";http_uri;fast_pattern;sid:2020052521;rev:1;)", "2020070325": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u8bf7\u6c42Linux\u4e0b\u654f\u611f\u6587\u4ef6|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5c1d\u8bd5\u8bf7\u6c42Linux\u4e0b\u654f\u611f\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"/etc\";http_uri;fast_pattern;pcre:\"/^(\\/httpd\\/conf\\/httpd\\.conf)|(\\/rc\\.local)|(\\/apache\\/httpd\\.conf)|(\\/hosts\\.deny)|(\\/bashrc)|(\\/group)|(\\/httpd\\/httpd\\.conf)|(\\/issue)|(\\/issue\\/net)|(\\/ssh\\/ssh_config)|(\\/termcap)|(\\/xinetd\\.d)|(\\/mtab)|(\\/vsftpd\\/vsftpd\\.conf)|(\\/xinetd\\.conf)|(\\/protocols)|(\\/logrotate\\.conf)|(\\/ld\\.so\\.conf)|(\\/wgetrc)|(\\/passwd)|(\\/shadow)|(\\/inputrc)|(\\/resolv\\.conf)|(\\/sysconfig\\/network)|(\\/sendmail\\.cf)|(\\/sendmail\\.cw)/URi\";sid:2020070325;rev:1;)", "2020070602": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHPCMS v9.6.0 wap\u6a21\u5757 SQL\u6ce8\u5165(noalert)|tag:sql\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:PHPCMS v9.6.0 wap\u6a21\u5757 SQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, phpcms_9_6_sqlinject;noalert;content:\"c=down\";http_uri;content:\"a_k=\";http_uri;sid:2020070602;rev:1;)", "2027032": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"aXMgcHJvZ3JhbS\";distance:0;fast_pattern;metadata:former_category ATTACK_RESPONSE;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027032;rev:2;metadata:created_at 2019_03_05, updated_at 2019_03_05;)", "2018010042": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"updatexml(\";nocase;http_uri;pcre:\"/\\d, *concat\\(0x\\w\\w,/iU\";flow:to_server,established;gid:0;sid:2018010042;rev:1;)", "2018030001": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:AWVS\u626b\u63cf|tag:\u626b\u63cf|tool:AWVS|phase:recon|dest:home_net|level:attack|severity:2|result:unknown|o_msg:\u4f7f\u7528AWVS\u8fdb\u884cweb\u6f0f\u6d1e\u626b\u63cf|attack_type:target|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"connect\";nocase;http_method;content:\"www.acunetix.wvs:443\";nocase;http_uri;flow:to_server,established;sid:2018030001;rev:1;)", "2024207": "alert smb $HOME_NET any -> $HOME_NET any (msg:\"name:\u5229\u7528MS17-010\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u7591\u4f3c\u5b58\u5728\u6c38\u6052\u6d6a\u6f2b\u6f0f\u6d1e\u6210\u529f\u5229\u7528\u7684\u884c\u4e3a - MS17-010\";flow:to_server,established;flowbits:isset,TB.ETERNALROMANCE;content:\"|FF|SMB|26 00 00 00 00|\";offset:4;depth:9;content:\"|4d 5a|\";distance:0;content:\"This program cannot be run\";nocase;distance:0;fast_pattern:6,20;metadata:former_category EXPLOIT;classtype:trojan-activity;sid:2024207;rev:2;metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_04_17;)", "2020050607": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:SaltStack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2020-11651,CVE-2020-11652)|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:SaltStack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2020-11651,CVE-2020-11652)\u3010\u8bfb\u53d6\u6587\u4ef6\u3011|severity:2|attacker:src\";flow:to_server, established;flowbits:set, cve_2020_11651_read_file;content:\"enc|a5|clear|a4|load\";pcre:\"/cmd.wheel.fun.file_roots.read/R\";sid:2020050607;rev:2;)", "2008721": "alert tcp $HOME_NET any -> $HOME_NET 445 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";flow:established,to_server;content:\"|00 2e 00 2e 00 2f 00 2e 00 2e 00 2f 00 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 87|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008721;classtype:attempted-admin;sid:2008721;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2020030301": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:FasterXML/jackson-databind \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-9546\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:FasterXML/jackson-databind \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-9546\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"org.apache.hadoop.shaded.com.zaxxer.hikari.HikariConfig\";pcre:\"/(metricRegistry|healthCheckRegistry)/R\";pcre:\"/(ldap|rmi):\\/\\//Ri\";sid:2020030301;rev:1;)", "2018010039": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165\u5199\u5165\u6587\u4ef6|tag:\u6ce8\u5165\u5199\u6587\u4ef6|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:\u5c1d\u8bd5\u5229\u7528MySQL\u6ce8\u5165\u5199\u5165\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"select\";nocase;http_uri;pcre:\"/[\\s\\w/\\\\.*\\d()\"'=,:\\;+<>_-]+into[(\\/\\*.*\\*\\/)| ]dumpfile[(\\/\\*.*\\*\\/)| ]['\"][0-9A-Za-z/\\\\._:-]+['\"]/iUR\";flow:to_server,established;gid:0;sid:2018010039;rev:1;)", "2018010068": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6d4b\u8bd5\u662f\u5426\u5b58\u5728Discuz converter\u63d2\u4ef6\u6f0f\u6d1e|tag:Discuz\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:recon|severity:1|result:unknown|failed_by:http_status_3XX,http_status_4XX|o_msg:\u68c0\u6d4b\u5230\u5bf9Discuz converter\u63d2\u4ef6\u6f0f\u6d1e\u8fdb\u884c\u63a2\u6d4b|attacker:src\";content:\"convert/index.php?a=config&source=d7.2_x2.0\";nocase;http_uri;within:1000;flow:to_server,established;gid:0;sid:2018010068;rev:1;)", "2019010104": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:vBulletin 5.x \u524d\u53f0\u4ee3\u7801\u6267\u884c(CVE-2019-16759)|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:vBulletin 5.x \u524d\u53f0\u4ee3\u7801\u6267\u884c(CVE-2019-16759)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"routestring=\";http_client_body;pcre:\"/ajax(\\/|(%2f))render(\\/|(%2f))widget_php/Pi\";pcre:\"/widgetConfig(\\[|(%5b))code(\\]|(%5d))/Pi\";sid:2019010104;rev:1;)", "2020081008": "alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Powershell\u53cd\u5f39shell|tag:\u53cd\u5f39shell|type:shell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:powershell\u53cd\u5f39shell\";content:\"Windows PowerShell running as user\";depth:50;content:\"Microsoft Corporation\";distance:2;within:200;sid:2020081008;)", "2018030029": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528Netsparker\u626b\u63cf\u5668|tag:\u6f0f\u6d1e\u626b\u63cf|tool:Netsparker|phase:recon|dest:home_net|level:attack|severity:2|result:unknown|o_msg:\u4f7f\u7528burp\u8fdb\u884c\u5404\u79cdweb\u6f0f\u6d1e\u653b\u51fb\u5c1d\u8bd5|attack_type:target|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"|0d 0a|X-Scanner:|20|Netsparker|0d 0a|\";nocase;http_raw_header;within:1000;flow:to_server,established;sid:2018030029;rev:1;)", "2019090268": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"E|00 00 00|\";depth:4;pcre:\"/^E\\0\\0\\0\\xb1S\\xec\\xb9\\x98/\";sid:2019090268;gid:0;)", "2020061805": "alert tcp $HOME_NET 3389 -> $EXTERNAL_NET any (msg:\"name:\u7206\u7834 windows \u8fdc\u7a0b\u684c\u9762\u670d\u52a1|tag:\u7206\u7834\u7834\u89e3|src:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u653b\u51fb\u8005\u7206\u7834 windows \u8fdc\u7a0b\u684c\u9762\u670d\u52a1\uff0c\u5c1d\u8bd5\u767b\u9646\u8fdc\u7a0b\u684c\u9762|attacker:dest\";flow:established, from_server;flowbits:isset, rdp_blasting;threshold:type both,track by_dst,count 30, seconds 5;dsize:19;content:\"|03 00 00 13 0e d0 00 00 12 34 00 02 0f 08 00 08 00 00 00|\";depth:19;sid:2020061805;rev:1;)", "28341961": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ETPRO POLICY External IP Address Lookup via api .ip138 .com|tag:TEST|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:dest\";flow:to_server,established;content:\"GET\";http_method;content:\"ip138.com\";http_host;depth:13;isdataat:!1,relative;fast_pattern;http_header_names;content:!\"Referer\";metadata:former_category POLICY;classtype:trojan-activity;sid:28341961;rev:1;metadata:affected_product Any, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Audit, created_at 2019_01_03, performance_impact Low, updated_at 2019_01_03;)", "2019090224": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:qmail\u8fde\u63a5|direction:in|level:action|service_name:Qmail(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728qmail pop3|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK <[\\d.]+@([-\\w_.]+)>\\r\\n/\";sid:2019090224;gid:0;)", "2019090171": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Hmail\u8fde\u63a5|direction:in|level:action|service_name:Hmail(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Hmail|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 HMailServer ESMTP\\r\\n/\";sid:2019090171;gid:0;)", "2018010093": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Redis\u672a\u6388\u6743\u6f0f\u6d1e\u5199SSH Key|tag:\u672a\u6388\u6743\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Redis\u56e0\u914d\u7f6e\u4e0d\u5f53\u53ef\u4ee5\u672a\u6388\u6743\u8bbf\u95ee\u3002\u653b\u51fb\u8005\u65e0\u9700\u8ba4\u8bc1\u76f4\u63a5\u5199SSH key|attacker:src\";content:\"config set\";nocase;offset:0;pcre:\"/\\s+[\\w\\d_-]+authorized_keys/iR\";flow:to_server,established;flowbits:isset, redis_shell_req_2;gid:0;sid:2018010093;rev:1;)", "20114970": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528Hydra\u8fdb\u884c\u7206\u7834|tag:\u7206\u7834|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|result:unknown|o_msg:\u53d1\u73b0\u4f7f\u7528Hydra\u8fdb\u884cHTTP\u5bc6\u7801\u7206\u7834|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3A| Mozilla/4.0 (Hydra)\";nocase;http_header;fast_pattern:23,8;threshold:type limit, track by_src,count 2, seconds 60;reference:url,freeworld.thc.org/thc-hydra;classtype:attempted-recon;sid:20114970;rev:4;)", "2020010060": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6|tag:\u6587\u4ef6\u5305\u542b|level:attack|phase:exploit|severity:3|result:success|o_msg:\u5229\u7528\u6f0f\u6d1e\u5bfc\u81f4/etc/passwd|dest:home_net|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"root:!:0:0::/:/usr/bin/ksh\";http_server_body;within:100;content:\"bin:!:2:2::/bin:\";http_server_body;flow:from_server,established;gid:0;sid:2020010060;rev:1;)", "2019010030": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5c1d\u8bd5\u81f4\u8fdcOA\u6f0f\u6d1e|tag:CMS\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:3|phase:exploit|result:success|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u5c1d\u8bd5\u81f4\u8fdcOA\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"200\";http_stat_code;content:\"JSESSIONID=\";http_cookie;content:\"DBSTEP\";http_server_body;content:\"V3.0\";content:\"<%@ page\";content:\"import=\\\"java.util.*\";content:\"Runtime.getRuntime().exec(\";flow:from_server,established;flowbits:isset, zhiyuan.exp;gid:0;sid:2019010030;rev:1;)", "2020051112": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:UEditor .net\u7248\u672c getshell|tag:getshell|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:UEditor .net\u7248\u672c getshell|attacker:src\";flow:to_server,established;flowbits:set, ueditor_net_getshell;content:\"POST\";http_method;content:\"/ueditor/\";http_uri;fast_pattern;nocase;content:\"net/controller.ashx\";http_uri;nocase;distance:0;content:\"action=catchimage\";http_uri;distance:1;nocase;sid:2020051112;rev:1;)", "2019090293": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(IMAP)|direction:in|level:action|service_name:Microsoft Exchange(IMAP)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange|server:src\";flow:from_server,established;content:\"*OK Microsoft Exchange\";depth:23;pcre:\"/^\\* OK Microsoft Exchange Server ([\\d]+) IMAP4rev1 server version (\\d[-.\\w]+) \\(([-.\\w]+)\\) ready\\.\\r\\n/\";sid:2019090293;gid:0;)", "2019010034": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:WCM\u5185\u5bb9\u534f\u4f5c\u5e73\u53f0\u914d\u7f6e\u6f0f\u6d1e\u5229\u7528\u6210\u529f|tag:CMS\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:3|phase:exploit|result:success|o_msg:WCM\u5185\u5bb9\u534f\u4f5c\u5e73\u53f0\u914d\u7f6e\u6f0f\u6d1e\u5229\u7528\u6210\u529f|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset,wcm_exp;content:\"200\";http_stat_code;http_content_type;content:\"text/xml\";pkt_data;content:\"</ISDELETED><PASSWORD><\";http_server_body;content:\"></PASSWORD><APPLYTIME/>\";http_server_body;within:60;gid:0;sid:2019010034;rev:1;)", "2018489": "alert udp $HOME_NET 10000: -> $HOME_NET 10000: (msg:\"name:Nmap \u64cd\u4f5c\u7cfb\u7edf\u626b\u63cf|tag:\u626b\u63cf|tool:Nmap|type:infil|direction:in|phase:post_exploit|src:home_net|dest:home_net|level:attack|severity:1|result:unknown|o_msg:NMAP\u64cd\u4f5c\u7cfb\u7edf\u626b\u63cf\";dsize:300;content:\"CCCCCCCCCCCCCCCCCCCC\";fast_pattern;content:\"CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC\";depth:255;content:\"CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC\";within:45;classtype:attempted-recon;sid:2018489;rev:4;metadata:created_at 2014_05_20, updated_at 2019_10_07;)", "2826385": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike\u8fde\u63a5|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:\u5b58\u5728Cobalt Strike \u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\"/oscp/\";http_uri;fast_pattern;depth:6;pcre:\"/^\\/oscp\\/[a-z]+$/U\";content:\"Host|3a 20|ocsp.verisign.com|0d 0a|Accept\";http_header;depth:31;content:\"Microsoft-CryptoAPI/6.1\";http_header;content:!\"Referer|3a|\";http_header;metadata:former_category MALWARE;reference:md5,2ba2e7af1246da08e4fd7345c7207b59;reference:url,github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/oscp.profile;classtype:trojan-activity;sid:2826385;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2017_05_15, performance_impact Moderate, updated_at 2017_05_15;)", "2020071414": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5e94\u7528\u7a0b\u5e8f\u5f00\u542f Xdebug \u6269\u5c55,\u653b\u51fb\u8005\u5f00\u59cb\u6267\u884c\u547d\u4ee4|tag:\u5371\u9669\u914d\u7f6e|src:home_net|level:attack|severity:3|result:success|phase:exploit|o_msg:\u5e94\u7528\u7a0b\u5e8f\u5f00\u542f Xdebug \u6269\u5c55\uff0c\u653b\u51fb\u8005\u5f00\u59cb\u6267\u884c\u547d\u4ee4|attacker:dest\";flow:to_server, established;flowbits:isset, xdebud_rce_success;content:\"<?xml\";fast_pattern;content:\"xmlns:xdebug=\";distance:0;content:\"command=\\\"eval\\\"\";distance:0;sid:2020071414;)", "2020070209": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Shiro \u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e(CVE-2020-11989)|tag:\u6743\u9650\u7ed5\u8fc7|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Apache Shiro \u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e(CVE-2020-11989)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"/\\;/\";http_raw_uri;depth:3;sid:2020070209;rev:1;)", "2020061018": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u8fc7\u4f2a\u534f\u8bae\u6267\u884c\u547d\u4ee4|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u901a\u8fc7\u4e3a\u534f\u8bae\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, pseudo_rce;content:\"POST\";http_method;content:\"allow_url_include=\";http_uri;content:\"auto_prepend_file=php://input\";http_uri;content:\"<?php\";http_client_body;sid:2020061018;rev:1;)", "2018041704": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Gh0st\u540e\u95e8\u6728\u9a6c|type:rat|tag:Gh0st|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cGh0st\u4e0a\u7ebf\u5305\";dsize:80<>300;flow:to_server,established;content:\"Gh0st\";depth:5;content:\"|00 00|\";distance:2;within:2;content:\"|00 00 78 9c|\";distance:2;within:4;flowbits:noalert;flowbits:set,TB_Gh0st3.6;sid:2018041704;rev:1;)", "2019090024": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:RDP\u8fde\u63a5|direction:in|level:action|service_name:RDP|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728RDP|server:src\";flow:from_server,established;content:\"|03 00 00|\";depth:3;pcre:\"/^\\x03\\0\\0\\x0b\\x06\\xd0\\0\\0\\x12.\\0$/\";sid:2019090024;gid:0;)", "2020060901": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Shiro \u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e(CVE-2020-1957)|tag:\u6587\u4ef6\u64cd\u4f5c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Apache Shiro \u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e(CVE-2020-1957)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"\\;/../\";http_uri;depth:80;sid:2020060901;rev:1;)", "2020052520": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7d2b\u971e\u4ed9\u5b50\u6f0f\u6d1e\u626b\u63cf|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tool:\u7d2b\u971e\u4ed9\u5b50\u626b\u63cf\u5668|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u7d2b\u971e\u4ed9\u5b50\u6f0f\u6d1e\u626b\u63cf|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"GET\";http_method;content:\".wyzxxz.cn\";http_uri;fast_pattern;sid:2020052520;rev:1;)", "2019060021": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"ASPSESSIONID\";http_cookie;pcre:\"/[a-zA-Z]+=[a-zA-Z0-9]{24}/CR\";http_content_len;byte_test:0,=,16,0,string,dec;pkt_data;content:\"e\";nocase;http_server_body;within:16;pcre:\"/^([a-f0-9A-F]{16})$/Q\";isdataat:!1,relative;noalert;flowbits:isset, bingxie_webshell_asp;flowbits:set, bingxie_webshell_step2_asp;sid:2019060021;gid:0;rev:1;)", "2020022601": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:joomla\u901a\u8fc7\u6a21\u677f\u4e0a\u4f20getshell|tag:\u4e0a\u4f20shell|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg::joomla\u901a\u8fc7\u6a21\u677f\u4e0a\u4f20shell|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, joomla_temp_getshell;content:\"POST\";http_method;content:\"/administrator/index.php\";http_uri;content:\"option=com_templates\";http_uri;content:\"view=template\";http_uri;pcre:\"/jform(%5B|[)source(%5D|])/Pi\";pcre:\"/(eval|system|exec|shell_exec|popen|assert|create_function|passthru)/PRi\";content:\"task=template.save\";http_client_body;sid:2020022601;rev:1;)", "2020061811": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528goby\u626b\u63cf\u5668\u626b\u63cf|tag:\u626b\u63cf\u5668|dest:home_net|level:attack|phase:recon|severity:3|result:unknown|tool:goby|o_msg:\u4f7f\u7528goby\u626b\u63cf\u5668\u8fdb\u884c\u626b\u63cf\uff0c\u5904\u4e8e\u6f0f\u6d1e\u626b\u63cf\u9636\u6bb5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"/never_could_exists\";http_uri;depth:20;content:\"rememberMe=+2ewny/4XWAbAc9751f01TtmSLcxlwGmpMy2PSdrBq0=\";http_cookie;sid:2020061811;rev:1;)", "2020000080": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5947\u5b89\u4fe1\u6f0f\u6d1e\u626b\u63cf\u5668|tag:\u6f0f\u6d1e\u5229\u7528|tool:\u5947\u5b89\u4fe1\u6f0f\u6d1e\u626b\u63cf\u5668|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5947\u5b89\u4fe1\u6f0f\u6d1e\u626b\u63cf\u5668|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"jiance.qianxin.com\";http_client_body;fast_pattern;sid:2020000080;rev:1;)", "2020072205": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u811a\u672c\u4ee3\u7801\u4e0b\u8f7d\u6cc4\u9732|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:1|result:success|o_msg:\u811a\u672c\u4ee3\u7801\u4e0b\u8f7d\u6cc4\u9732\uff0c\u9ed1\u5ba2\u901a\u8fc7\u731c\u6d4b\u6216\u8005\u5176\u4ed6\u65b9\u5f0f\u5f97\u5230\u8fd0\u7ef4\u6216\u8005\u7814\u53d1\u7684\u811a\u672c\uff0c\u9700\u8981\u68c0\u67e5\u662f\u5426\u5305\u542b\u654f\u611f\u4fe1\u606f|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;content:\"#\";http_server_body;depth:6;fast_pattern;pcre:\"/^((\\s+)?(\\!)?(\\s+)?((\\/bin\\/)|(\\/usr\\/bin\\/)|(-\\*-(\\s)+coding\\:)|(\\/usr\\/local\\/bin\\/)|(coding(\\s+)?\\:)|(\\.env)))/QRi\";sid:2020072205;rev:1;)", "2019060016": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"PHPSESSID=\";http_cookie;pcre:\"/[a-fA-F0-9]{32}/CR\";noalert;flowbits:isset, bingxie_webshell;flowbits:set, bingxie_webshell_step2;content:\"f\";nocase;http_server_body;within:16;pcre:\"/^([a-f0-9A-F]{16})$/Q\";isdataat:!1,relative;sid:2019060016;gid:0;rev:1;)", "2020070306": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u4f7f\u7528\u4e2d\u56fd\u83dc\u5200\u8fde\u63a5\u540e\u95e8|tag:webshell|tool:\u4e2d\u56fd\u83dc\u5200|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u5c1d\u8bd5\u4f7f\u7528\u4e2d\u56fd\u83dc\u5200\u8fde\u63a5\u540e\u95e8|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;flowbits:isset, bingxie_webshell_4;content:\"POST\";http_method;content:\"eval\";http_client_body;content:\"base64_decode(\";http_client_body;distance:0;within:30;sid:2020070306;gid:0;rev:1;)", "2019010151": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6d4b\u8bd5SQL\u6ce8\u5165\u6f0f\u6d1e|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"and substr(\";nocase;http_client_body;pcre:\"/^\\w+,\\d,\\d\\)='\\w/iPR\";flow:to_server,established;gid:0;sid:2019010151;rev:1;)", "2019090262": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"E|00 00 00|\";depth:4;pcre:\"/^E\\0\\0\\0.S[^\\0]+\\0C0A000\\0M.*?65363\\.19778.*\\0F\\.\\\\src\\\\backend\\\\postmaster\\\\postmaster\\.c\\0L\\d{4}\\0RProcessStartupPacket\\0\\0$/\";sid:2019090262;gid:0;)", "2020061906": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Jupyter Notebook \u672a\u6388\u6743\u8bbf\u95ee|tag:\u672a\u6388\u6743\u8bbf\u95ee|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Jupyter Notebook \u672a\u6388\u6743\u8bbf\u95ee\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u8bbf\u95eenotebook\u6587\u4ef6\u751a\u81f3\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, jupyter_notebook_unauth;content:\"200\";http_stat_code;http_header_names;content:\"|0d 0a|Content-Security-Policy|0d 0a|\";pkt_data;content:\"username-\";http_cookie;content:\"<title>Home</title>\";http_server_body;depth:200;sid:2020061906;rev:1;)", "2020080308": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7 Metasploit \u8fde\u63a5\u670d\u52a1\u5668(tcp)|tag:\u53cd\u5f39shell|dest:home_net|level:attack|phase:exploit|severity:3|attack_type:target|result:unknown|o_msg:Metasploit \u8fde\u63a5(linux/x64/shell/bind_tcp)|attacker:src\";flags:P, A;flow:to_server, established;dsize:38;content:\"|6a 03 5e 48 ff|\";depth:5;content:\"/bin/sh|00|\";distance:14;within:8;sid:2020080308;)", "2018040010": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u68c0\u6d4bSSH\u6307\u7eb9|tag:\u626b\u63cf|tool:Nmap|type:\u6307\u7eb9\u63a2\u6d4b|direction:in|phase:recon|src:external_net|dest:home_net|level:attack|severity:1|result:unknown|o_msg:NMAP \u68c0\u6d4bSSH\u6307\u7eb9\";dsize:20;content:\"SSH\";nocase;offset:0;pcre:\"/-\\d\\.\\d-NmapNSE_\\d\\.\\d/iR\";flow:to_server,established;sid:2018040010;rev:1;)", "2010718": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230Gootkit\u4e0a\u7ebfUser-Agent (Gootkit HTTP Client)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"Gootkit HTTP Client\";http_header;nocase;reference:url,doc.emergingthreats.net/2010718;classtype:trojan-activity;sid:2010718;rev:6;)", "2020086": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:wmi\u7684\u5411\u5916\u53cd\u5f39|tag:\u53cd\u5f39shell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|result:success|o_msg:wmic\u53cd\u5f39\";flow:established;content:\"wmic|3a|root|5c|cli>\";classtype:successful-admin;sid:2020086;rev:1;metadata:created_at 2015_01_05, updated_at 2015_01_05;)", "202000809": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874eWebshell\u901a\u8baf|tag:webshell|tool:\u51b0\u874e|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u51b0\u874eWebshell\u901a\u8baf|gray:true|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, bingxie_3_0_php;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;http_header_names;content:!\"Cookie\";pkt_data;pcre:\"/^[A-Za-z0-9+\\/]{126}[A-Za-z0-9+\\/=]{2}$/Q\";sid:202000809;gid:0;rev:1;)", "2020051934": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee(scheduledtasks)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, spring_actuator_scheduledtasks;content:\"200\";http_stat_code;http_content_type;content:\"application\";content:\"spring-boot.actuator\";distance:0;content:\"json\";distance:0;pkt_data;content:\"{\\\"cron\\\":\";http_server_body;startswith;content:\"\\\"fixedDelay\\\":\";distance:0;http_server_body;content:\"\\\"custom\\\":\";distance:0;http_server_body;sid:2020051934;rev:1;)", "2019090135": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Coremail\u8fde\u63a5|direction:in|level:action|service_name:Coremail(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Coremail|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK Welcome to coremail Mail Pop3 Server \\(gzidcs\\[[0-9a-f]{32}s\\]\\)\\r\\n$/\";sid:2019090135;gid:0;)", "2019090019": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:RDP\u8fde\u63a5|direction:in|level:action|service_name:RDP|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728RDP|server:src\";flow:from_server,established;content:\"|03 00 00|\";depth:3;pcre:\"/^\\x03\\0\\0\\x0e\\t\\xd0\\0\\0\\0[\\x02\\xa1]\\0\\xc0\\x01\\n$/\";sid:2019090019;gid:0;)", "2020011409": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JBoss \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2017-7504\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JBOSS\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2017_7504;content:\"POST\";http_method;content:\"/jbossmq-httpil/HTTPServerILServlet\";http_uri;within:40;http_content_type;content:\"application/\";pcre:\"/(x-www-form-urlencoded)|(x-java-serialized-object)/R\";pkt_data;content:\"| ac ed 00 05 |sr\";http_client_body;startswith;sid:2020011409;rev:1;)", "2019011052": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:nosql\u6ce8\u5165(mongo)|tag:nosql\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u901a\u8fc7php\u548cmongodb\u7684\u7279\u6027\u6ce8\u5165\u6761\u4ef6\u8868\u8fbe\u5f0f\u7ed5\u8fc7\u9a8c\u8bc1\uff0c\u6216\u76f2\u6ce8\u51fa\u654f\u611f\u6570\u636e|attacker:src\";flow:to_server,established;content:\"?\";http_uri;pcre:\"/\\w\\[\\$(:?eq|gt|gte|in|lt|lte|ne|nin|and|not|nor|or|exists|type|expr|jsonSchema|mod|regex|text|where|geoIntersects|geoWithin|near|nearSphere|all|elemMatch|size|bitsAllClear|bitsAllSet|bitsAnyClear|bitsAnySet|comment|elemMatch|meta|slice|)\\]/UR\";gid:3;sid:2019011052;)", "2020051911": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring SpEL\u8868\u8fbe\u5f0f\u4ee3\u7801\u6ce8\u5165|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Spring SpEL\u8868\u8fbe\u5f0f\u4ee3\u7801\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"T(Thread).sleep(\";http_client_body;sid:2020051911;rev:1;)", "2019060038": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u7591\u4f3cWebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|type:shell|result:unknown|o_msg:\u68c0\u6d4b\u5230webshell\u7684\u4f20\u8f93\u5185\u5bb9|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;http_content_len;byte_test:0,<,200,0,string,dec;pkt_data;content:\".x86_64 #1 SMP \";within:90;http_server_body;content:\"UTC \";within:34;http_server_body;pcre:\"/UTC 20[1,2]\\d x86_64/iQ\";sid:2019060038;)", "2020052104": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Socks5\u670d\u52a1|tag:\u4ee3\u7406|direction:in|src:home_net|dest:external_net|level:action|service_name:Socks5|severity:2|service_class:auth|result:success|o_msg:\u653b\u51fb\u8005\u8fdb\u5165\u5185\u7f51\u7684\u5e38\u7528\u624b\u6bb5\uff0c\u9700\u8981\u4e00\u53f0\u88ab\u63a7\u5236\u7684\u5916\u7f51\u53ef\u8bbf\u95ee\u4e3b\u673a|gray:true|server:src\";flow:established, from_server;flowbits:isset, s5_step_3;content:\"|05 00 00 01|\";depth:4;sid:2020052104;rev:1;)", "2019060014": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"PHPSESSID=\";http_cookie;pcre:\"/[a-fA-F0-9]{32}/CR\";noalert;flowbits:isset, bingxie_webshell;flowbits:set, bingxie_webshell_step2;content:\"d\";nocase;http_server_body;within:16;pcre:\"/^([a-f0-9A-F]{16})$/Q\";isdataat:!1,relative;sid:2019060014;gid:0;rev:1;)", "2837001": "alert dns $HOME_NET any -> any any (msg:\"name:\u7591\u4f3cCobalt Strike DNS\u96a7\u9053|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|dest:home_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:\u7591\u4f3cCobalt Strike DNS\u96a7\u9053\";dns_query;content:\"post.4\";depth:6;fast_pattern;isdataat:200;content:\".\";distance:41;within:1;content:\".\";distance:56;within:1;content:\".\";distance:56;within:1;content:\".\";distance:56;within:1;content:\".\";distance:9;within:2;pcre:\"/^post\\.4[a-f0-9]{40}\\.(?:[a-f0-9]{56}\\.){3}/\";metadata:former_category TROJAN;classtype:trojan-activity;sid:2837001;rev:1;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2019_06_24, updated_at 2019_06_24;)", "2019010096": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Discuz!ML V3.X \u4ee3\u7801\u6ce8\u5165|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:Discuz!ML V3.X \u4ee3\u7801\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, from_server;flowbits:isset, discuz_code_injection;content:\"LANG = \";pcre:\"/LANG =\\s'.*('|%27)(\\.|%2e)\\w+(\\(|%28).*(\\)|%29)(\\.|%2e)('|%27)'/Q\";sid:2019010096;rev:1;)", "2020080503": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7 Metasploit \u8fde\u63a5\u670d\u52a1\u5668|tag:\u53cd\u5f39shell|dest:home_net|level:attack|phase:exploit|severity:3|attack_type:target|result:unknown|o_msg:metasploit \u8fde\u63a5|attacker:src\";flags:P, A;flow:to_server, established;flowbits:set, msf_bind_response;noalert;dsize:4;sid:2020080503;)", "2008692": "alert udp $HOME_NET any -> $HOME_NET 139 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";content:\"|1F 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"../../\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008692;classtype:attempted-admin;sid:2008692;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2020070301": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;flowbits:set, bingxie_webshell_1;noalert;content:\".\";http_uri;pcre:\"/\\.(php|jsp|asp|aspx|jspx)\\?[\\w.$@!%_-]+=\\d{2,3}/Ui\";content:\"|0d 0a|Connection: keep-alive|0d 0a|\";http_header;http_header_names;content:\"|0d 0a|Connection|0d 0a 0d 0a|\";pkt_data;sid:2020070301;gid:0;rev:1;)", "2011484": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:IMDDOS|type:botnet|tag:IMDDoS|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u50f5\u5c38\u7f51\u7edcIMDDOS\u5bb6\u65cf\u7684User-Agent i am ddos\";flow:established,to_server;content:\"User-Agent|3A| i am ddos\";nocase;depth:300;reference:url,www.damballa.com/downloads/r_pubs/Damballa_Report_IMDDOS.pdf;classtype:trojan-activity;sid:2011484;rev:4;)", "2020060811": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u8fc7PUT\u65b9\u6cd5\u4e0a\u4f20\u811a\u672c\u6587\u4ef6|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u901a\u8fc7PUT\u65b9\u6cd5\u4e0a\u4f20\u811a\u672c\u6587\u4ef6\uff0c\u5982\u679c\u60a8\u7684\u4f01\u4e1a\u4f7f\u7528put\u65b9\u6cd5\u90e8\u7f72\u4f01\u4e1a\u5e94\u7528\uff0c\u8fd9\u5c5e\u4e8e\u4e0d\u89c4\u8303\u7684\u5b89\u5168\u884c\u4e3a\uff0c\u5efa\u8bae\u4fee\u6539\u3002\u9ed1\u5ba2\u53ef\u4ee5\u5229\u7528\u540c\u6837\u7684\u65b9\u6cd5\u4e0a\u4f20webshell|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, put_update;content:\"PUT\";http_method;content:\"/\";http_uri;pcre:\"/\\.(asp|jsp|aspx|jspx|php|phtml)/URi\";content:\"<\";http_client_body;depth:30;pcre:\"/^(%|\\?)/PR\";sid:2020060811;rev:1;)", "2001330": "alert tcp $HOME_NET 3389 -> $EXTERNAL_NET any (msg:\"name:RDP(3389)\u767b\u5f55\u6210\u529f|tag:\u767b\u5f55|force_save:true|src:home_net|phase:exploit|level:action|result:success|o_msg:\u68c0\u6d4b\u5230\u5916\u7f51\u901a\u8fc73389\u767b\u9646\u6210\u529f|attacker:dest\";flow:from_server,established;content:\"|03|\";offset:0;depth:1;content:\"|D0|\";offset:5;depth:1;reference:url,doc.emergingthreats.net/2001330;classtype:misc-activity;sid:2001330;rev:8;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2019090195": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"421 \";depth:4;pcre:\"/^421 Unexpected log failure, please try later\\r\\n/\";sid:2019090195;gid:0;)", "2008427": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (AdiseExplorer)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| AdiseExplorer\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008427;classtype:trojan-activity;sid:2008427;rev:8;)", "2018041803": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:DarkstRat2008\u540e\u95e8\u6728\u9a6c|type:rat|tag:DarkstRat2008|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cDarkstRat\u5378\u8f7d\u81ea\u8eab\";dsize:23;flow:from_server,established;content:\"|53 45 52 56 49 44 4f 52 7c 44 45 53 49 4e 53 54 41 4c 41 52 7c 0d 0a|\";flowbits:isset,TB_DarkstRat2008;sid:2018041803;rev:1;)", "2020062221": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u653b\u51fb\u8005\u5c1d\u8bd5\u901a\u8fc7webshell\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, mem_webshell_interaction_1;content:\"POST\";http_method;content:\"pass_the_world=\";http_client_body;content:!\"model=\";http_client_body;sid:2020062221;rev:1;)", "2020070305": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell\u901a\u8baf|tag:webshell|tool:\u51b0\u874e|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:success|o_msg:\u51b0\u874ewebshell\u901a\u8baf|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;flowbits:isset, bingxie_webshell_4;content:\"POST\";http_method;content:\".\";http_uri;pcre:\"/\\.(php|jsp|asp|aspx|jspx)$/Ui\";http_header_names;content:\"|0d 0a|Cookie|0d 0a|\";pkt_data;http_content_len;byte_test:0,>=,1000,0,string,dec;pkt_data;pcre:\"/^([A-Za-z0-9+\\/]{4})+([A-Za-z0-9+\\/]{4}|[A-Za-z0-9+\\/]{3}=|[A-Za-z0-9+\\/]{2}==)$/P\";sid:2020070305;gid:0;rev:1;)", "2020041031": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2018-3191)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2018-3191)|attacker:src\";flow:established, to_server;xbits:set, weblogic_link_jrmp, track ip_dst, expire 60;content:\"|ac ed 00 05|\";content:\"java.rmi.server.RemoteObject\";distance:0;content:\"weblogic.jms.common.MessageImpl\";distance:0;sid:2020041031;rev:1;)", "2020081728": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528ZmEu\u626b\u63cf|tag:\u626b\u63cf\u5668|dest:home_net|level:attack|phase:recon|severity:2|result:unknown|o_msg:\u4f7f\u7528ZmEu\u8fdb\u884c\u626b\u63cf|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"ZmEu\";http_user_agent;depth:10;sid:2020081728;rev:1;)", "2019090004": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MySQL\u8fde\u63a5|direction:in|level:action|service_name:MySQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728MySQL|server:src\";flow:from_server,established;content:\"|00 00 00|\";offset:1;depth:3;pcre:\"/^.\\0\\0\\0\\x0a(5\\.[-_~.+\\w]+)\\0/\";sid:2019090004;gid:0;)", "2020051114": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-2551)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-2551)|attacker:src\";flow:established, to_server;xbits:set, weblogic_link_jrmp, track ip_dst, expire 20;flowbits:set, cve_2020_2551;content:\"GIOP\";depth:4;content:\"weblogic.iiop.ProxyDesc\";distance:0;content:\"JtaTransactionManager\";distance:0;pcre:\"/(ldap|rmi):\\/\\//Ri\";sid:2020051114;rev:1;)", "2019000026": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u8fc7nc\u6267\u884c\u547d\u4ee4|tag:\u53cd\u5f39shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|attack_type:target|result:unknown|o_msg:\u901a\u8fc7nc\u6267\u884c\u547d\u4ee4\";flags:P,A;dsize:9;flow:established;content:\"ifconfig\";pcre:\"/^ifconfig\\n$/\";flowbits:set,ip_send;sid:2019000026;)", "2018010063": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:SQLMAP|tag:SQLMAP\u6ce8\u5165|tool:SQLMAP|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:\u5229\u7528SQLMAP\u5de5\u5177\u8fdb\u884c\u6ce8\u5165|attack_type:target|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\",((',\\\".).)\";nocase;http_client_body;within:200;flow:to_server,established;sid:2018010063;rev:1;)", "2008215": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (up2dash updater)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| up2dash\";nocase;http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008215;classtype:trojan-activity;sid:2008215;rev:9;)", "2018010085": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:SSRF\u6f0f\u6d1e\u5c1d\u8bd5gopher\u6267\u884c\u547d\u4ee4|tag:SSRF\u653b\u51fb|dest:home_net|level:attack|severity:3|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528SSRF\u5c1d\u8bd5\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"GET\";http_method;content:\".php?s=gopher&\";http_uri;within:1000;pcre:\"/(i|ip)=((^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$)|(\\b([a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,}\\b))&(port|p)=\\d{2,5}/iUR\";gid:0;sid:2018010085;rev:1;)", "2020061204": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u81f4\u8fdcOA Session\u6cc4\u6f0f|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u81f4\u8fdcOA Session\u6cc4\u6f0f|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, from_server;flowbits:isset, seeyou_session_disclosure;pcre:\"/\\w+ [A-Z0-9]{32}/Q\";sid:2020061204;rev:1;)", "2806275": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:DLink DIR-645 / DIR-815\u7684\u6f0f\u6d1e\u5229\u7528|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:2|gray:true|result:unknown|o_msg:DLink DIR-645 / DIR-815\u7684\u6f0f\u6d1e\u5229\u7528|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/diagnostic.php\";http_uri;nocase;content:\"usr\";nocase;http_client_body;content:\"bin\";http_client_body;pcre:\"/(\\x60|%60)(\\s|%20)*?(\\x2f|\\x252f)usr(\\x2f|\\x252f)bin(\\x2f|\\x252f)/Pi\";reference:bugtraq,58938;reference:url,s3cur1ty.de/m1adv2013-017;classtype:attempted-recon;sid:2806275;rev:2;metadata:created_at 2013_04_18, updated_at 2013_04_18;)", "2018030006": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:webshell\u5c1d\u8bd5\u8fde\u63a5|tool:\u83dc\u5200|failed_by:http_status_3XX,http_status_4XX|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u83dc\u5200\u901a\u7528\u8bf7\u6c42php|attacker:src\";content:\"POST\";nocase;http_method;content:\".php\";nocase;http_uri;pcre:\"/\\.(php|php\\;\\.(jpg|gif|png|jpgn))$/iU\";content:\"=@\";nocase;http_client_body;within:24;pcre:\"/[\\s]*eval[\\s]*\\(/iPR\";flowbits:set, caidao_request;flow:to_server,established;gid:0;sid:2018030006;rev:1;)", "2832804": "alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Cobalt Strike\u6728\u9a6cSSL\u8bc1\u4e66\u4f20\u8f93\u884c\u4e3a|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|dest:home_net|src:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike\u6728\u9a6cSSL\u8bc1\u4e66\u4f20\u8f93\u884c\u4e3a\";flow:established,from_server;tls_cert_subject;content:\"CN=kkkjjjaaa.com\";nocase;isdataat:!1,relative;metadata:former_category TROJAN;reference:md5,a05f1d66b633a598348fe4c37eb0f5ac;classtype:trojan-activity;sid:2832804;rev:1;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2018_09_26, malware_family Cobalt_Strike, performance_impact Moderate, updated_at 2019_09_28;)", "2019090007": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MySQL\u8fde\u63a5|direction:in|level:action|service_name:MySQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728MySQL|server:src\";flow:from_server,established;content:\"|00 00 00|\";offset:1;depth:3;pcre:\"/^.\\0\\0\\0.(3\\.[-_~.+\\w]+)\\0.*\\x08\\x02\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0$/\";sid:2019090007;gid:0;)", "2020060216": "alert TCP $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(CommonsCollections2-TCP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|attacker:src\";flow:established, to_server;content:\"|ac ed 00 05|\";fast_pattern;content:\"java.util.PriorityQueue\";content:\"org.apache.commons.collections4.functors.InvokerTransformer\";content:\"getRuntime()\";sid:2020060216;rev:1;)", "2018030016": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:webshell\u8fde\u63a5|tag:webshell\u4e0a\u4f20EXE\u6587\u4ef6|tool:\u83dc\u5200|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:unknown|o_msg:\u83dc\u5200\u4e0a\u4f20exe\u7684\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX\";content:\"POST\";nocase;http_method;content:\".asp\";nocase;http_uri;pcre:\"/\\.(asp|aspx)$/iU\";content:\"&\";nocase;http_client_body;within:1000;pcre:\"/[\\d\\w-_]{1,12}=4D5A900003[a-fA-F0-9]{600,}/iPR\";flowbits:isset, req_webshell;flow:to_server,established;sid:2018030016;rev:1;)", "2008181": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (MS Internet Explorer)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| MS Internet Explorer|0d 0a|\";http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008181;classtype:trojan-activity;sid:2008181;rev:9;)", "2020060000": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:APT-C-06/Darkhotel|tag:\u4e0a\u4f20\u6076\u610f\u6587\u4ef6|severity:3|direction:out|src:home_net|dest:external_net|level:attack|phase:control|result:success|o_msg:\u653b\u51fb\u8005\u5229\u7528\u6df1\u4fe1\u670d\u8bbe\u5907\u4e0b\u53d1\u66f4\u65b0\uff0c\u611f\u67d3\u4f7f\u7528vpn agent\u767b\u5f55\u7684\u7535\u8111\uff0c\u5e76\u56de\u4f20\u4fe1\u606f\u7684\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX\";content:\"POST\";http_method;http_content_type;content:\"multipart/form-data\\; boundary=----974767299852498929531610575\";pkt_data;content:\"Content-Disposition: form-data\\; name=\\\"_ga\\\"\\; filename=\\\"\";http_client_body;flow:to_server,established;gid:0;sid:2020060000;rev:1;)", "2019090147": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:OpenLDAP\u8fde\u63a5|direction:in|level:action|service_name:OpenLDAP|service_class:auth|severity:1|result:unknown|o_msg:\u5b58\u5728OpenLDAP|server:src\";flow:from_server,established;content:\"unable to set certificate file|0a|6292:error:02001002:system library:fopen:No such file or directory:bss_file.c:\";depth:109;sid:2019090147;gid:0;)", "2020072203": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZeroShell \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:ZeroShell \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"/cgi-bin/kerbynet\";http_uri;depth:20;content:\"Section=NoAuthREQ\";http_uri;distance:0;content:\"type=*%22\\;\";http_raw_uri;sid:2020072203;rev:1;)", "2019090086": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:FileZilla\u8fde\u63a5|direction:in|level:action|service_name:FileZilla|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728FileZilla|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220-.*\\r\\n220-\\r\\n220 using FileZilla FileZilla Server version ([^\\r\\n]+)\\r\\n/\";sid:2019090086;gid:0;)", "2020010301": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Nagios XI \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Nagios XI \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|attacker:src\";flow:to_server,established;flowbits:set, cve_2019_20197;content:\"POST\";http_method;content:\"/nagiosxi/includes/components/scheduledreporting/schedulereport.php\";http_uri;content:\"id=\";http_client_body;pcre:\"/(\\|\\|)|(%7c%7c)|(%7c)|(%3b)|(%26)|([\\|\\;])/PRi\";pcre:\"/ls|cd|pwd|wget|curl|adduser|cat|passwd|chmod|echo|netstat|uname|sysctl|mysql|history|bash|useradd|ps|ifconfig|find|id|grep|awk|last|lsof|iptables|find|whoami|touch|ping/PRi\";sid:2020010301;)", "2841453": "alert smb $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:SMBv3 CVE-2020-0796 POC\u6f0f\u6d1e\u5c1d\u8bd5|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u9488\u5bf9CVE-2020-0796\u505a\u68c0\u6d4b|attacker:src\";flow:established,to_server;content:\"SMB|ff ff ff ff|\";offset:5;depth:7;content:\"|03 03 03 03 03 03 00 00 00 00 00 00 00 00 ff ff ff fe|\";distance:0;content:\"|ff ff ff 7f 41 07 00 0f ff 00 00 fc 0f 02 00|\";distance:0;fast_pattern;isdataat:!1,relative;threshold:type limit, count 1, seconds 30, track by_src;metadata:former_category EXPLOIT;reference:cve,2020-0796;classtype:attempted-admin;sid:2841453;rev:2;metadata:affected_product SMBv3, deployment Perimeter, deployment Internal, signature_severity Major, created_at 2020_03_10, performance_impact Low, updated_at 2020_03_10;)", "2018010047": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"union\";nocase;http_uri;pcre:\"/[\\\\/*! ]+all[\\\\/*! ]+/select[\\\\/*! ]+/iUR\";flow:to_server,established;gid:0;sid:2018010047;rev:1;)", "2020041029": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2018-2893)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2018-2893)|attacker:dest\";flow:established, to_client;flowbits:isset, cve_2018_2893;content:\"|ac ed 00 05|\";content:\"weblogic.jms.common.StreamMessageImpl\";distance:0;sid:2020041029;rev:1;)", "2020032409": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7phpmyadmin\u4fee\u6539\u6162\u67e5\u8be2\u8def\u5f84|tag:\u5371\u9669\u914d\u7f6e|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5c1d\u8bd5\u901a\u8fc7phpmyadmin\u4fee\u6539\u6162\u67e5\u8be2\u8def\u5f84|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, phpmyadmin_exec_sql_success;content:\"POST\";http_method;content:\"/import.php\";http_uri;content:\"sql_query=\";http_client_body;content:\"set+global+slow_query_log_file\";http_client_body;distance:0;nocase;content:\".php\";http_client_body;distance:0;nocase;sid:2020032409;rev:1;)", "2024215": "alert smb $HOME_NET any -> $HOME_NET any (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u7591\u4f3c\u5b58\u5728ECLIPSEDWING\u6f0f\u6d1e\u63a2\u6d4b - MS08-067\";flow:to_server,established;content:\"|ff|SMB|2f 00 00 00 00|\";offset:4;depth:9;content:\"|00 00 00 00 ff ff ff ff 08 00|\";distance:30;within:10;content:\"|2e 00 00 00 00 00 00 00 2e 00 00 00|\";distance:0;content:\"|2f 00 41 00 2f 00 2e 00 2e 00 2f 00|\";within:12;fast_pattern;content:\"|2e 00 00 00 00 00 00 00 2e 00 00 00|\";distance:0;content:\"|2f 00 41 00 2f 00 2e 00 2e 00 2f 00|\";within:12;content:\"|2f 00 41 00 2f 00 2e 00 2e 00 2f 00|\";distance:0;content:\"|2f 00 41 00 2f 00 2e 00 2e 00 2f 00|\";distance:0;isdataat:800,relative;metadata:former_category EXPLOIT;classtype:trojan-activity;sid:2024215;rev:1;metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_04_17;)", "20258011": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:\u626b\u63cf|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:recon|result:unknown|o_msg:\u626b\u63cf\u53ef\u80fd\u5b58\u5728\u7684\u9ed1\u5ba2\u540e\u95e8\";flow:to_server,established;flowbits:set,webshell.scan;content:\"ZmlsZV9wdXRfY29udGVudH\";http_client_body;metadata:former_category EXPLOIT;classtype:attempted-user;sid:20258011;rev:2;flowbits:set, caidao_request;flowbits:set,webshell.scan;metadata:affected_product Web_Server_Applications, affected_product PHP, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2019090010": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MySQL\u8fde\u63a5|direction:in|level:action|service_name:MySQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728MySQL|server:src\";flow:from_server,established;content:\"|00 00 00|\";offset:1;depth:3;pcre:\"/^.\\0\\0\\0\\xff..Host .* is not allowed to connect to this MariaDB server$/\";sid:2019090010;gid:0;)", "2019060026": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:success|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;content:\".aspx\";http_uri;content:\"ASP.NET_SessionId=\";http_cookie;pcre:\"/[a-zA-Z0-9]{24}/CR\";http_content_len;byte_test:0,>=,7000,0,string,dec;pkt_data;http_accept;content:\"text/html, image/gif, image/jpeg, *\\; q=.2, */*\\; q=.2\";pkt_data;flowbits:isset, bingxie_webshell_step2_aspx;sid:2019060026;gid:0;rev:1;)", "2020032603": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Discuz!X \u22643.4 \u540e\u53f0sql\u6ce8\u5165|tag:sql\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Discuz!X \u22643.4 \u540e\u53f0sql\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, discuz_3_4_sqli;content:\"POST\";http_method;content:\"/admin.php\";http_uri;content:\"action=setting\";http_uri;distance:0;content:\"settingnew[uc][appid]\";http_client_body;content:\"'\";http_client_body;distance:0;within:20;pcre:\"/select|union|order|convert|concat|group_concat|sleep|waitfor|substr|updatexml|outfile/PRi\";sid:2020032603;rev:1;)", "2020081005": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:nishang \u83b7\u53d6session\u4fe1\u606f|tag:webshell|type:shell|tool:nishang|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:nishang \u83b7\u53d6session\u4fe1\u606f(Invoke-SessionGopher),\u901a\u8fc7web\u754c\u9762\u8fd4\u56de\u7ed3\u679c|failed_by:http_status_3XX,http_status_4XX\";content:\"200\";http_stat_code;flow:from_server,established;http_content_type;content:\"text/html\";pkt_data;content:\"SessionGopher\";http_server_body;content:\"..+     )      Brandon Arvanaghi\";http_server_body;distance:0;content:\"m..m       @arvanaghi |7c| arvanaghi.com\";http_server_body;distance:0;sid:2020081005;)", "2020062806": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4ee3\u7406\u8fde\u63a5\u6210\u529f(Neo-reGeorg)|tag:\u653b\u51fb\u4ee3\u7406|tool:Neo-reGeorg|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u4ee3\u7406\u8fde\u63a5\u6210\u529f(Neo-reGeorg)|attacker:dest|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, access_script_file_post;content:\"200\";http_stat_code;content:\"|0d 0a|Connection: Keep-Alive, Keep-Alive|0d 0a|Content-Length: 0|0d 0a|\";http_header;pcre:\"/\\x0d\\x0a[A-Z]{1}[a-z]{1,17}\\: [A-Za-z0-9_]{2,66}\\x0d\\x0a/H\";threshold:type both, track by_dst, count 10, seconds 30;sid:2020062806;rev:1;)", "2019060040": "alert udp $HOME_NET any -> any 53 (msg:\"name:\u5229\u7528ceye.io\u8fdb\u884cdnslog\u53cd\u5f39|tag:dns\u53cd\u5f39|direction:out|level:attack|phase:control|severity:3|result:success|o_msg:\u68c0\u6d4bceye.io\u7684dns\u8bf7\u6c42\";content:\"|01 00|\";offset:2;content:\"|04|ceye|02|io|00|\";nocase;sid:2019060040;)", "2019060005": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:reGeorg\u8fde\u63a5\u6210\u529f|tag:\u653b\u51fb\u4ee3\u7406|tool:reGeorg|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u5185\u7f51\u6e17\u900f\u65f6\u7684\u5e38\u7528\u5de5\u5177reGeorg|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;http_content_len;byte_test:0,=,28,0,string,dec;pkt_data;content:\"Georg says, 'All seems fine'\";sid:2019060005;rev:7;)", "2020071412": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5e94\u7528\u7a0b\u5e8f\u5f00\u542f Xdebug \u6269\u5c55|tag:\u5371\u9669\u914d\u7f6e|src:home_net|level:attack|severity:3|result:success|phase:exploit|o_msg:\u5e94\u7528\u7a0b\u5e8f\u5f00\u542f Xdebug \u6269\u5c55\uff0c\u653b\u51fb\u8005\u53ef\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4|attacker:dest\";flow:to_server, established;xbits:isset, xdebug_server_discover, track ip_src, expire 30;xbits:unset, xdebug_server_discover, track ip_src;flowbits:set, xdebud_rce;content:\"<?xml\";fast_pattern;offset:3;depth:10;content:\"xmlns:xdebug=\";distance:0;content:\"xdebug:language_version=\";distance:0;sid:2020071412;)", "2020072009": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u6f0f\u6d1e\u653b\u51fb\uff08\u673a\u5668\u5b66\u4e60\uff09|tag:exploit|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u8bf7\u6c42\u4f53\u5305\u542b dnslog|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\".cn\";http_client_body;fast_pattern;pcre:\"/(wyzxxz\\.cn)|(awvsscan119\\.autoverify\\.cn)|(cloudeye\\.cn)|(nslog\\.0kee\\.360\\.cn)/Pi\";sid:2020072009;rev:1;)", "2019090292": "alert tcp $EXTERNAL_NET 5938 -> $HOME_NET any (msg:\"name:\u4f7f\u7528Teamviewer|direction:in|src:external_net|dest:home_net|level:action|service_name:Teamviewer|severity:1|service_class:rlogin|result:unknown|o_msg:\u4f7f\u7528teamviewer\u8fde\u63a5|server:dest\";dsize:438;flow:to_client,established;content:\"|11 30 3c 00 9e 01 00 00|\";depth:8;content:\"|1b 00 00 00 18 00 00 00|\";distance:8;within:8;content:\"|00 80 00 07 80 00 00 1a 00 40 00 80 00|\";distance:17;within:13;gid:2;sid:2019090292;rev:1;)", "2805861": "alert tcp $EXTERNAL_NET any -> $HOME_NET 1433 (msg:\"name:ETPRO EXPLOIT Microsoft SQL Server Database Link Crawling Command Execution (Metasploit Module Method for shellcode payload via powershell thread injection)|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"|00|E|00|X|00|E|00|C|00| |00|m|00|a|00|s|00|t|00|e|00|r|00|.|00|.|00|x|00|p|00|_|00|c|00|m|00|d|00|s|00|h|00|e|00|l|00|l|00| |00 27 00|p|00|o|00|w|00|e|00|r|00|s|00|h|00|e|00|l|00|l|00| |00|-|00|\";reference:url,msdn.microsoft.com/en-us/library/ms188279.aspx;reference:url,dev.metasploit.com/redmine/projects/framework/repository/entry/modules/exploits/windows/mssql/mssql_linkcrawler.rb;classtype:attempted-user;sid:2805861;rev:2;metadata:affected_product Any, attack_target Client_and_Server, deployment Perimeter, deployment Internet, deployment Internal, deployment Datacenter, tag Metasploit, signatrue_severity Critical, created_at 2013_01_04, updated_at 2016_07_01;)", "2020051503": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:D-Link \u76ee\u5f55\u904d\u5386\u6f0f\u6d1e\uff08CVE-2018-10822\uff09|tag:\u76ee\u5f55\u904d\u5386|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:D-Link \u76ee\u5f55\u904d\u5386\u6f0f\u6d1e\uff08CVE-2018-10822\uff09|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server, established;content:\"/uir/\";http_raw_uri;depth:6;pcre:\"/^(..\\/)|(\\/(etc|var|log|bin|lib|mnt|opt|usr|media|proc))/IR\";sid:2020051503;rev:2;)", "2019010085": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"select\";nocase;http_uri;within:2000;pcre:\"/\\s+count\\(\\*\\)\\s*,\\s*concat\\(/iUR\";flow:to_server,established;gid:0;sid:2019010085;rev:1;)", "2018010077": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5ThinkPHP\u6f0f\u6d1e|tag:ThinkPHP\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728ThinkPHP\u6f0f\u6d1e|attacker:src\";content:\"GET\";nocase;http_method;content:\"?s=\";http_uri;within:1000;pcre:\"/(\\/[\\w\\d]+){3}\\/$({|%7b)@?(system|eval|phpinfo|print)\\(?/iU\";flow:to_server,established;gid:0;sid:2018010077;rev:1;)", "2806218": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:Linksys E1500\u7684\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e|tag:webshell|src:home_net|dest:home_net|level:attack|phase:exploit|severity:2|gray:true|result:unknown|o_msg:Struts\u7684\u6f0f\u6d1e\u5229\u7528|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;content:\"/apply.cgi\";fast_pattern:only;http_uri;nocase;content:\"|2e 2e 2f|\";http_client_body;reference:bugtraq,57760;reference:url,homekb.cisco.com/Cisco2/ukp.aspx?pid=80&app=vw&vw=1&login=1&json=1&docid=d7d0a87be9864e20bc347a73f194411f_KB_EN_v1.xml;reference:url,s3cur1ty.de/m1adv2013-004;reference:url,community.rapid7.com/community/metasploit/blog/2013/04/05/compromising-embedded-linux-routers-with-metasploit;classtype:attempted-recon;sid:2806218;rev:2;metadata:created_at 2013_04_05, updated_at 2013_04_05;)", "2020051409": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Confluence \u672a\u6388\u6743 RCE (CVE-2019-3396)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:success|o_msg:Confluence \u672a\u6388\u6743 RCE (CVE-2019-3396)|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2019_3396;content:\"200\";http_stat_code;http_content_type;content:\"text/plain\";pkt_data;content:\"<title>Preview Macro</title>\";http_server_body;depth:200;content:\"<div class=\\\"wiki-content\\\"\";http_server_body;distance:200;sid:2020051409;rev:2;)", "2019090095": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:bftp\u8fde\u63a5|direction:in|level:action|service_name:bftp|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728bftp|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 Server 47 FTP service\\. Welcome\\.\\r\\n/\";sid:2019090095;gid:0;)", "2020021012": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Magento\u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u5199\u6587\u4ef6)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Magento\u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Zend_Memory_Manager\";content:\"Zend_Memory_Manager_backend\";distance:1;content:\"Varien_Cache_Backend_Eaccelerator\";distance:1;content:\"*_directives\";distance:1;content:\"*_writers\";distance:1;content:\"Zend_CodeGenerator_Php_File\";distance:1;content:\"*_sourceContent\";distance:1;sid:2020021012;rev:1;)", "2020061210": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u81f4\u8fdcOA A8 \u672a\u6388\u6743\u8bbf\u95ee|tag:\u672a\u6388\u6743\u8bbf\u95ee|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u81f4\u8fdcOA A8 \u672a\u6388\u6743\u8bbf\u95ee|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"/seeyon/main.do\";http_uri;depth:40;content:\"method=officeDown\";http_uri;distance:0;content:\"filename=\";http_uri;sid:2020061210;rev:1;)", "2019070013": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:weblogic\u6f0f\u6d1e\u5229\u7528|tag:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|direction:out|src:home_net|dest:external_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:attack_out|result:unknown|o_msg:CVE-2017-10271 Payload\u653b\u51fb\u7cfb\u7edf[1]\";flow:to_server,established;content:\"POST\";http_method;content:\"<void class=\\\"weblogic.utils.Hex\\\"\";http_client_body;content:\"method=\\\"fromHexString\\\"\";http_client_body;content:\"<string>0xcafebabe\";http_client_body;flowbits:set, cmd_reponse_echo;gid:0;sid:2019070013;rev:1;)", "2019090286": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DNS\u8fde\u63a5|direction:in|level:action|service_name:Microsoft DNS|service_class:other|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft DNS|server:src\";flow:from_server,established;content:\"|07|version|04|bind\";within:27;pcre:\"/\\x07version\\x04bind\\0\\0\\x10\\0\\x03\\xc0\\x0c\\0\\x10\\0\\x01.{7}Microsoft DNS (6\\.3)$/\";sid:2019090286;gid:0;)", "2019090290": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DNS\u8fde\u63a5|direction:in|level:action|service_name:Microsoft DNS|service_class:other|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft DNS|server:src\";flow:from_server,established;content:\"|07|version|04|bind\";within:27;pcre:\"/\\x07version\\x04bind\\0\\0\\x10\\0\\x03\\xc0\\x0c\\0\\x10\\0[\\x01\\x03].{7}Microsoft DNS (.+)/\";sid:2019090290;gid:0;)", "2019090302": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:RDP\u8fde\u63a5|direction:in|level:action|service_name:RDP|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728RDP|server:src\";flow:from_server,established;content:\"|03 00 00|\";depth:3;pcre:\"/\\x03\\0\\0\\x13\\x0e\\xd0\\0\\0\\x124\\0\\x02\\x01\\x08\\0\\x02\\0\\0\\0/\";sid:2019090302;gid:0;)", "2019070002": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ThinkPHP\u6f0f\u6d1e|tag:ThinkPHP\u6f0f\u6d1e\u5229\u7528|direction:out|src:home_net|dest:external_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:attack_out|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728ThinkPHP\u6f0f\u6d1e\";content:\"GET\";nocase;http_method;content:\"/index.php\";nocase;http_uri;within:100;pcre:\"/(\\/)?\\?s=(\\/)?index\\/\\\\think\\\\app\\/invokefunction&function=/iUR\";flow:to_server,established;gid:0;sid:2019070002;rev:1;)", "2019090068": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Redis\u8fde\u63a5|direction:in|level:action|service_name:Redis|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728Redis|server:src\";flow:from_server,established;content:\"redis_version:\";pcre:\"/^\\$\\d+\\r\\n(?:#[^\\r\\n]*\\r\\n)*redis_version:([.\\d]+)\\r\\n/\";sid:2019090068;gid:0;)", "2834166": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ETPRO EXPLOIT DSL-2770L Credential Disclosure Attempt|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:to_server,established;content:\"GET\";http_method;content:\"/atbox.htm\";http_uri;urilen:10;fast_pattern;metadata:former_category EXPLOIT;reference:url,cxsecurity.com/ascii/WLB-2018120204;classtype:attempted-admin;sid:2834166;rev:2;metadata:affected_product Linux, attack_target Networking_Equipment, deployment Internal, signatrue_severity Minor, created_at 2019_01_02, updated_at 2019_01_02;)", "2020021006": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Guzzle \u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u6267\u884c\u547d\u4ee4)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Guzzle \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"GuzzleHttp\";content:\"Psr7\";distance:1;content:\"FnStream\";distance:1;content:\"_fn_close\";distance:1;sid:2020021006;rev:1;)", "2018111909": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DistWrite\u540e\u95e8\u6728\u9a6c|type:rat|tag:DistWrite|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cDistWrite\u4e0a\u7ebf\";flow:to_server,established;content:\"|A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3 A3|\";depth:32;offset:96;dsize:496;sid:2018111909;rev:1;)", "2018010008": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Struts2\u6f0f\u6d1e\u5229\u7528|tag:Struts\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|success_by:execmd|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Struts2 Jakarta Plugin\u63d2\u4ef6\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u7684payload\u653b\u51fb\u7cfb\u7edf|attacker:src\";flow:established,to_server;content:\"com.opensymphony.xwork2.ActionContext.container\";http_header;content:\"com.opensymphony.xwork2.ognl.OgnlUtil@class\";http_header;gid:3;sid:2018010008;rev:1;)", "2020082303": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5b9d\u5854Linux\u6743\u9650\u7ed5\u8fc7|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u5b9d\u5854Linux\u6743\u9650\u7ed5\u8fc7|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, baota_auth_bypass;content:\"200\";http_stat_code;content:\"phpmyadmin\";http_server_body;nocase;depth:2000;sid:2020082303;rev:1;)", "2010782": "alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:\"name:\u4f7f\u7528psexec\u5de5\u5177\u8fdc\u7a0b\u64cd\u4f5c|tag:PsExec|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|attacker:src|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u53d1\u73b0\u5f53\u524d\u4e3b\u673a\u4f7f\u7528psexec\u5de5\u5177\u5bf9\u76ee\u6807Windows\u7cfb\u7edf\u6210\u529f\u8fdb\u884c\u8fdc\u7a0b\u64cd\u4f5c\";flow:to_server,established;dsize:<360;content:\"|50 00 53 00 45 00 58 00 45 00 53 00 56 00 43 00 2e 00 65 00 78 00 65|\";reference:url,threatbook.cn;reference:url,doc.emergingthreats.net/2010781;classtype:suspicious-filename-detect;threshold:type limit,track by_src,count 1,seconds 60;sid:2010782;rev:3;)", "2019090204": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([-\\w_.]+)\\r\\n502 [\\d.]+ Error: command not recognized\\r\\n/\";sid:2019090204;gid:0;)", "2018020056": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:HTTP\u8fd4\u56de401\u8ba4\u8bc1\u9519\u8bef|tag:\u8ba4\u8bc1\u5931\u8d25|direction:in|dest:home_net|src:external_net|level:action|o_msg:HTTP\u8fd4\u56de401\u8ba4\u8bc1\u9519\u8bef|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"401\";http_stat_code;gid:0;sid:2018020056;rev:1;)", "2019010020": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:weblogic\u8865\u4e01\u7ed5\u8fc7\u6f0f\u6d1e|tag:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Weblogic  \u62a4\u7f51\u671f\u95f4\u4f7f\u7528\u76840day\u8865\u4e01\u7ed5\u8fc7\u6f0f\u6d1e|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"wls-wsat/CoordinatorPortType\";http_uri;content:\"\\;/\";http_uri;pcre:\"/(\\.\\.\\/\\w)$/RU\";content:\"oracle.toplink.internal.sessions.UnitOfWorkChangeSet\";content:\"<void index=\\\"\";gid:3;sid:2019010020;rev:1;)", "2020070102": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Nexus \u4f7f\u7528\u9ed8\u8ba4\u5bc6\u7801|tag:\u5f31\u53e3\u4ee4|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Nexus \u4f7f\u7528\u9ed8\u8ba4\u5bc6\u7801|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, nexus_weak_passwd_2;content:\"204\";http_stat_code;content:\"|0d 0a|Server: Nexus/3\";http_header;content:\"NXSESSIONID=\";http_cookie;sid:2020070102;rev:1;)", "2019090233": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Courier\u8fde\u63a5|direction:in|level:action|service_name:Courier(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Courier smtp|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([-\\w_.]+) ESMTP\\r\\n535 Authentication required\\.\\r\\n/\";sid:2019090233;gid:0;)", "2020082009": "alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08udp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884cnetsh firewall show config\u547d\u4ee4|gray:true\";flow:established;content:\":|0d 0a|-------------------------------------------------------------------|0d 0a|\";content:\"\\\"netsh firewall\\\" \";distance:0;content:\"\\\"netsh advfirewall firewall\\\" \";distance:0;sid:2020082009;)", "2020041024": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2017-3248)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2017-3248)|attacker:dest\";flow:established, to_client;flowbits:isset, cve_2017_3248_or_2018_2628;content:\"|ac ed 00 05|\";pcre:\"/\\$Proxy[0-9]+/R\";sid:2020041024;rev:1;)", "2018040021": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHPCMS\u4efb\u610f\u4e0a\u4f20\u6f0f\u6d1e\u7684\u5c1d\u8bd5|tag:\u6f0f\u6d1e\u626b\u63cf|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|phase:recon|failed_by:http_status_3XX,http_status_4XX|severity:1|result:unknown|o_msg:PHPCMS\u4efb\u610f\u4e0a\u4f20\u6f0f\u6d1e\u7684\u626b\u63cf\";content:\"POST\";nocase;http_method;content:\"/index.php?m=member&c=index&a=register&siteid=1\";nocase;http_uri;within:300;content:\"&info\";http_client_body;within:200;pcre:\"/(%5B|\\[)content(%5D|\\])=(%3C|<)img(\\+|%2B|%20|\\s+)src(=|%3D)/iPR\";flow:to_server,established;gid:0;sid:2018040021;rev:1;)", "2020081903": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u8fbeOA\u4efb\u610f\u6587\u4ef6\u5220\u9664|tag:\u6743\u9650\u7ed5\u8fc7|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u901a\u8fbeOA\u4efb\u610f\u6587\u4ef6\u5220\u9664|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, tongda_oa_afd;content:\"/module/appbuilder/assets/print.php\";http_uri;depth:100;content:\"guid=\";http_uri;distance:0;content:\"../\";http_uri;distance:0;sid:2020081903;rev:1;)", "2019060019": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\".asp?\";http_uri;pcre:\"/[\\w.$@!%_-]+=\\d{3}/iUR\";http_accept;content:\"text/html, image/gif, image/jpeg, *\\; q=.2, */*\\; q=.2\";pkt_data;noalert;flowbits:set, bingxie_webshell_asp;sid:2019060019;gid:0;rev:1;)", "2018010011": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Jboss\u6f0f\u6d1e\u5229\u7528|tag:Jboss\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|severity:2|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Jboss\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1eCVE-2017-12149 Payload\u653b\u51fb\u7cfb\u7edf[2]|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"invoker/readonly\";http_uri;content:\"org.apache.commons.collections.functors.ChainedTransformer\";content:\"org.apache.commons.collections.functors.ConstantTransformer\";content:\"org.apache.commons.collections.functors.InvokerTransformer\";content:\"org.apache.commons.collections.functors.InvokerTransformer\";content:\"java.lang.Override\";gid:3;sid:2018010011;rev:1;)", "2020060015": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528\u6f0f\u6d1e\u6267\u884c\u547d\u4ee4|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|type:shell|result:unknown|o_msg:\u68c0\u6d4b\u5230\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;http_content_len;byte_test:0,<,200,0,string,dec;pkt_data;content:\".x86_64 #1 SMP \";within:90;http_server_body;content:\"UTC \";within:34;http_server_body;pcre:\"/UTC 20[1,2]\\d x86_64/iQ\";flowbits:isset,cmd_reponse_echo;sid:2020060015;)", "2010270": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Asprox\u540e\u95e8\u6728\u9a6c|type:rat|tag:Asprox|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230Asprox\u53d1\u9001\u6570\u636e\u5230C&C|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";nocase;http_method;content:\"name=|22|sid|22 0d 0a 0d 0a|\";http_client_body;nocase;content:\"name=|22|upt|22 0d 0a 0d 0a|\";http_client_body;nocase;content:\"name=|22|hcc|22 0d 0a 0d 0a|\";http_client_body;nocase;reference:url,www.secureworks.com/research/threats/danmecasprox/;reference:url,www.toorcon.org/tcx/18_Brown.pdf;reference:url,doc.emergingthreats.net/2010270;classtype:trojan-activity;sid:2010270;rev:6;)", "2020061019": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fc7\u4f2a\u534f\u8bae\u6267\u884c\u547d\u4ee4|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u901a\u8fc7\u4e3a\u534f\u8bae\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, pseudo_rce;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"ChangeLog\";http_server_body;content:\"db_create.php\";http_server_body;content:\"db_sql_format.php\";http_server_body;content:\"server_sql.php\";http_server_body;content:\"robots.txt\";http_server_body;sid:2020061019;rev:1;)", "2809644": "alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:\"name:\u5229\u7528SMB\u4f20\u8f93mimikatz|tag:smb|direction:lateral|type:infil|src:home_net|dest:home_net|attacker:src|level:attack|phase:post_exploit|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5728\u5185\u7f51\u901a\u8fc7SMB\u534f\u8bae\u4f20\u8f93\u9ed1\u5ba2\u5de5\u5177Mimikatz\u7684mimikatz.exe\u6587\u4ef6\uff08Unicode\uff09\";flow:established,to_server;content:\"|FF|SMB|a2|\";offset:4;depth:5;byte_test:1,&,0x80,6,relative;content:\"m|00|i|00|m|00|i|00|k|00|a|00|t|00|z|00|.|00|e|00|x|00|e\";distance:0;reference:url,github.com/gentilkiwi/mimikatz;classtype:trojan-activity;sid:2809644;rev:1;metadata:created_at 2015_01_30, updated_at 2015_01_30;)", "2027038": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"aABpAHMAIABwAHIAbwBnAHIAYQBtAC\";distance:0;fast_pattern;metadata:former_category ATTACK_RESPONSE;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027038;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_03_05, malware_family CoinMiner, updated_at 2019_03_05;)", "2020051927": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee(health)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, spring_actuator_health;content:\"/actuator/health\";http_uri;sid:2020051927;rev:1;)", "2018010059": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MSSQL\u6ce8\u5165|tag:\u5ef6\u8fdf\u6ce8\u5165|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MSSQL\u6ce8\u5165 -  \u5ef6\u8fdf\u6ce8\u5165|dest:home_net|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"\\;WAITFOR DELAY\";nocase;http_uri;pcre:\"/[ +]'[\\d:]+'/iUR\";flow:to_server,established;gid:0;sid:2018010059;rev:1;)", "2019090186": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220([\\s-]\\S+) ESMTP Postfix/\";sid:2019090186;gid:0;)", "2018041702": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Gh0st2011\u540e\u95e8\u6728\u9a6c|type:rat|tag:Gh0st2011|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cGh0st2011\u4e0a\u7ebf\u5305\uff083\uff09\";dsize:80<>400;flow:to_server,established;content:\"|00 00|\";offset:2;depth:2;content:\"|00 00 78 9c|\";distance:2;within:4;flowbits:isset,TB_Gh0st2011_2;sid:2018041702;rev:1;)", "2019090187": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^(?:220-.*\\r\\n)?220 ([\\w._-]+) ESMTP Postfix/\";sid:2019090187;gid:0;)", "2019090231": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Courier\u8fde\u63a5|direction:in|level:action|service_name:Courier(imap)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Courier imap|server:src\";flow:from_server,established;content:\"* OK \";depth:5;pcre:\"/^\\* OK \\[CAPABILITY IMAP4rev1 [^]]*\\]\\r\\nGET NO Error in IMAP command received by server\\.\\r\\n\\* NO Error in IMAP command received by server\\.\\r\\n/\";sid:2019090231;gid:0;)", "2020062819": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(iox-\u53cd\u5411\u4ee3\u7406)|tag:\u653b\u51fb\u4ee3\u7406|tool:iox|direction:in|src:home_net|dest:external_net|level:attack|phase:control|type:control|severity:4|result:unknown|o_msg:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(iox-\u53cd\u5411\u4ee3\u7406)\";flow:established, to_server;flowbits:set, iox_link_type_1_1;noalert;content:\"|00 c0 ee ff|\";depth:4;dsize:4;sid:2020062819;rev:1;)", "2018011706": "alert udp $HOME_NET any -> $EXTERNAL_NET 123 (msg:\"name:\u50f5\u5c38\u7f51\u7edc\u884c\u4e3a|type:botnet|tag:ntp flood|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5bf9\u5916\u7684NTP Flood\u653b\u51fb\";dsize:64<>500;content:\"|17 00 03 2a|\";depth:4;content:\"|00 00 00 00 00 00|\";distance:20;threshold:type both, track by_src, count 2000, seconds 1;sid:2018011706;rev:1;)", "2020050913": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|dest:home_net|level:attack|phase:exploit|type:shell|severity:3|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, bingxie_webshell;noalert;content:\"GET\";http_method;content:\".aspx?\";http_uri;pcre:\"/[\\w.$@!%_-]+=\\d{3}$/iUR\";isdataat:!1,relative;content:\"Connection: keep-alive\";http_header;sid:2020050913;gid:0;rev:1;)", "2020081004": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Windows\u7528\u6237\u51ed\u636e\u6cc4\u9732|tag:\u4fe1\u606f\u6cc4\u9732|type:shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:Windows\u7528\u6237\u51ed\u636e\u6cc4\u9732|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"Administrator\";http_server_body;nocase;pcre:\"/^(\\s*):(\\s*)500(\\s*):(\\s*)[a-z0-9]{32}(\\s*)\\:(\\s*)[a-z0-9]{32}(\\s*)\\:(\\s*)(\\s*)\\:(\\s*)\\:/QRi\";content:\"Guest\";http_server_body;nocase;pcre:\"/^(\\s*):(\\s*)501(\\s*):(\\s*)[a-z0-9]{32}(\\s*)\\:(\\s*)[a-z0-9]{32}(\\s*)\\:(\\s*)(\\s*)\\:(\\s*)\\:/QRi\";sid:2020081004;)", "2019090225": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Courier\u8fde\u63a5|direction:in|level:action|service_name:Courier(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Courier pop3|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK Hello there\\.\\r\\n$/\";sid:2019090225;gid:0;)", "2019060034": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u83b7\u53d6\u5185\u7f51\u6e17\u900f\u811a\u672c|tag:\u4e0b\u8f7d\u6076\u610f\u6587\u4ef6|direction:out|src:home_net|dest:external_net|level:attack|phase:control|type:unknown_url|severity:3|result:success|o_msg:\u7591\u4f3c\u4e0b\u8f7dpowershell\u811a\u672c|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;http_content_type;content:\"text/plain\";pkt_data;content:\"(New-Object\";nocase;http_server_body;pcre:\"/\\s+Net.WebClient\\)\\.DownloadString\\('/QR\";content:\"https://raw.githubusercontent.com/mattifestation/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1')\\;\";gid:0;sid:2019060034;rev:1;)", "2008749": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (checkonline)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| checkonline|0d 0a|\";http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008749;classtype:trojan-activity;sid:2008749;rev:7;)", "2026926": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"FydC1Qcm9\";distance:0;fast_pattern;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026926;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2019090274": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"E|00 00 00|\";depth:4;pcre:\"/^E\\0\\0\\0.S[^\\0]+\\0VFATAL\\0C0A000\\0M.*?65363\\.19778.*?1\\.0.*?3\\.0.*?\\0F\\.\\\\src\\\\backend\\\\postmaster\\\\postmaster\\.c\\0/\";sid:2019090274;gid:0;)", "2014018": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Jboss\u6f0f\u6d1e\u5229\u7528|tag:Jboss\u6f0f\u6d1e|dest:home_net|level:attack|severity:2|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Jboss jmx-console\u8bbf\u95ee\u7ed5\u8fc7|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"HEAD\";http_method;content:\"/jmx-console/HtmlAdaptor?\";http_uri;nocase;content:\"Runtime.getRuntime().exec(\";http_uri;sid:2014018;)", "2020022704": "alert tcp $HOME_NET 21 -> $EXTERNAL_NET any (msg:\"name:Proftpd mod_copy\u6a21\u5757\u547d\u4ee4\u672a\u6388\u6743\u8c03\u7528\uff08CVE-2015-3306\uff09|tag:\u672a\u6388\u6743\u8c03\u7528|src:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:Proftpd mod_copy\u6a21\u5757\u547d\u4ee4\u672a\u6388\u6743\u8c03\u7528\uff08CVE-2015-3306\uff09|attacker:dest\";flow:established, from_server;flowbits:isset, cve_2015_3306_cpto;content:\"250 Copy successful\";sid:2020022704;rev:1;)", "2019000055": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Jenkins \u767b\u5f55\u884c\u4e3a|tag:\u767b\u5f55\u884c\u4e3a|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Jenkins \u767b\u5f55\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, jboss_login;content:\"302\";http_stat_code;content:\"Location: \";http_header;content:\"/admin-console/secure/summary.seam?conversationId=\";distance:12;sid:2019000055;rev:1;)", "2020022607": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u8bfb\u53d6/etc/issue|tag:\u6267\u884c\u547d\u4ee4|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u8bfb\u53d6/etc/issue|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"|20|Debian|20|\";http_server_body;content:\"GNU/Linux|20|\";distance:0;http_server_body;content:\"|5c 6e 20 5c 6c 0a 0a|\";distance:2;http_server_body;sid:2020022607;rev:1;)", "2020032102": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Fastjson <=1.2.62 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Fastjson <=1.2.62 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, fastjson_jndi;content:\"@type\";http_client_body;fast_pattern;content:\"org.apache.cocoon.components.slide.impl.JMSContentInterceptor\";http_client_body;distance:0;content:\"parameters\";http_client_body;nocase;content:\"topic-factory\";http_client_body;nocase;distance:20;pcre:\"/(ldap|rmi):\\/\\//PRi\";sid:2020032102;rev:1;)", "2020071502": "alert dns $EXTERNAL_NET any -> $HOME_NET 53 (msg:\"name:Windows DNS Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-1350)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Windows DNS Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-1350)|attacker:src\";flow:to_server, established;byte_test:2,>=,65280,0;content:\"|00 01|\";offset:10;depth:2;content:\"|00 18|\";distance:4;isdataat:7000;sid:2020071502;rev:1;)", "2020021022": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Symfony\u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u547d\u4ee4\u6267\u884c)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Symfony\u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Symfony\";content:\"Component\";distance:1;content:\"Cache\";distance:1;content:\"Adapter\";distance:1;content:\"ApcuAdapter\";distance:1;content:\"AbstractAdaptermergeByLifetime\";distance:1;content:\"AbstractAdapternamespace\";distance:1;content:\"AbstractAdapterdeferred\";distance:1;sid:2020021022;rev:1;)", "2018041706": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Gh0st\u540e\u95e8\u6728\u9a6c|type:rat|tag:Gh0st|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cGh0st\u5378\u8f7d\u81ea\u8eab\";dsize:22;flow:from_server,established;content:\"|47 68 30 73 74 16 00 00 00 01 00 00 00 78 9c d3 02 00 00 2b 00 2b|\";flowbits:isset,TB_Gh0st3.6.1;sid:2018041706;rev:1;)", "2020051016": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Struts2\u6f0f\u6d1e\u5229\u7528|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:struts\u6f0f\u6d1e\u5229\u7528\u6210\u529f|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"struts2_security_check\";depth:22;http_server_body;flow:from_server,established;sid:2020051016;gid:0;rev:1;)", "2019060039": "alert udp $HOME_NET any -> any 53 (msg:\"name:\u5229\u7528dnslog.link\u8fdb\u884cdnslog\u53cd\u5f39|tag:dns\u53cd\u5f39|direction:out|level:attack|phase:control|severity:3|result:success|o_msg:\u68c0\u6d4bdnslog.link\u7684dns\u8bf7\u6c42\";content:\"|01 00|\";offset:2;content:\"|06|dnslog|04|link|00|\";nocase;sid:2019060039;)", "2020072702": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Apache Shiro \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:success|o_msg:Apache Shiro \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|severity:4|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, shiro_exp_by_tools;content:\"200\";http_stat_code;http_header_names;content:\"|0d 0a|Testecho|0d 0a|\";pkt_data;sid:2020072702;rev:1;)", "2835199": "alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Cobalt Strike\u6728\u9a6cSSL\u8bc1\u4e66\u4f20\u8f93|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|dest:home_net|src:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike\u6728\u9a6cSSL\u8bc1\u4e66\u4f20\u8f93\";flow:established,from_server;tls_cert_subject;content:\"CN=files.office-help.site\";nocase;isdataat:!1,relative;metadata:former_category TROJAN;reference:md5,7d9cea58ea0885a0bfb7084b27755a69;classtype:trojan-activity;sid:2835199;rev:1;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2019_03_06, malware_family Cobalt_Strike, performance_impact Low, updated_at 2019_09_28;)", "2018111000": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Lucky\u52d2\u7d22|type:trojan|tag:Lucky\u52d2\u7d22|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230Lucky\u52d2\u7d22\u7684HTTP\u6d41\u91cf\u7279\u5f81|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\"/l_version\";http_uri;fast_pattern;flowbits:set,TB_ftxx;sid:2018111000;rev:1;)", "2019090165": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Hmail\u8fde\u63a5|direction:in|level:action|service_name:Hmail(imap)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Hmail|server:src\";flow:from_server,established;content:\"* OK \";depth:5;pcre:\"/^\\* OK IMAPrev1 Service Ready - hMailServer ([\\w.-]+)\\r\\n/\";sid:2019090165;gid:0;)", "2835687": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ETPRO POLICY External IP Lookup - jsonip.com|tag:TEST|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:dest\";flow:established,to_server;content:\"jsonip.com\";http_host;depth:10;isdataat:!1,relative;content:!\"Referer|3a|\";http_header;metadata:former_category POLICY;classtype:policy-violation;sid:2835687;rev:2;metadata:attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Audit, created_at 2019_04_02, updated_at 2019_04_02;)", "2020070804": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6587\u4ef6\u5305\u542b\u8bfb\u53d6|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u6587\u4ef6\u8bfb\u53d6\u5c1d\u8bd5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, file_read_general;content:\"/opt\";http_uri;fast_pattern;pcre:\"/(lampp\\/logs\\/access_log)|(\\/lampp\\/logs\\/access\\.log)|(\\/xampp\\/logs\\/access\\.log)|(\\/xampp\\/logs\\/access_log)/U\";sid:2020070804;rev:1;)", "2026936": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"nZva2UtV21pTWV0aG\";distance:0;fast_pattern;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026936;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2019010009": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4e0a\u4f20\u6076\u610f\u884c\u4e3a|tag:\u4e0a\u4f20\u6076\u610f\u6587\u4ef6|level:attack|phase:exploit|result:unknown|o_msg:\u4e0a\u4f20\u6076\u610f\u884c\u4e3a|severity:1|dest:home_net|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;http_content_type;content:\"multipart/form-data\\;\";nocase;pcre:\"/[ ]+boundary=/iHR\";pkt_data;content:\"Content-Disposition:\";nocase;http_client_body;content:\"<?php \";http_client_body;flowbits:set,upload_script_file;flow:to_server,established;gid:0;sid:2019010009;rev:1;)", "2019090281": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DNS\u8fde\u63a5|direction:in|level:action|service_name:Microsoft DNS|service_class:other|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft DNS|server:src\";flow:from_server,established;content:\"|07|version|04|bind\";within:27;pcre:\"/\\x07version\\x04bind\\0\\0\\x10\\0\\x03\\xc0\\x0c\\0\\x10\\0\\x01.{7}Microsoft DNS (6\\.1\\.7600.+)/\";sid:2019090281;gid:0;)", "2020052516": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:AWVS\u626b\u63cf\u5668|tag:\u6f0f\u6d1e\u5229\u7528|tool:AWVS\u626b\u63cf\u5668|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:AWVS\u626b\u63cf\u5668|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\".autoverify.cn\";http_client_body;fast_pattern;sid:2020052516;rev:1;)", "2833643": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike\u62e6\u622a\u8bf7\u6c42(\u5229\u7528JQuery\u7ad9\u70b9)|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike\u62e6\u622a\u8bf7\u6c42(\u5229\u7528JQuery\u7ad9\u70b9)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\"/jquery-\";http_uri;depth:8;content:\"Host|3a 20|code.jquery.com|0d 0a|Accept|3a|\";http_header;depth:30;fast_pattern;content:\"Referer|3a 20|http|3a|//code.jquery.com/|0d 0a|Accept-\";http_header;distance:0;content:\"__cfduid=\";http_cookie;metadata:former_category MALWARE;reference:md5,8c9903db02a29847d04d0fd81dd67046;classtype:trojan-activity;sid:2833643;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2018_11_26, malware_family CobaltStrike, malware_family Cobalt_Strike, updated_at 2018_11_26;)", "2018010073": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5ThinkPHP\u6f0f\u6d1e|tag:ThinkPHP\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728ThinkPHP\u6f0f\u6d1e|attacker:src\";content:\"GET\";nocase;http_method;content:\"/module/aciton/param1/\";http_uri;within:1000;pcre:\"/$({|%7b)@?(system|eval|phpinfo|print)\\(($_GET|$_POST)?/iU\";flow:to_server,established;gid:0;sid:2018010073;rev:1;)", "2020051506": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7591\u4f3c\u65b0\u578bwebshell\u8fde\u63a5|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:\u7591\u4f3c\u65b0\u578bwebshell\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"Proxy-Client-Server-IP\";http_header;sid:2020051506;rev:1;)", "2019000061": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Jenkins\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2018-1000861\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Jenkins\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2018-1000861\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2018_1000861;content:\"descriptorByName\";http_uri;distance:0;content:\"sandbox.groovy\";http_uri;distance:0;content:\"checkScript\";http_uri;distance:0;content:\"value=\";http_uri;distance:1;pcre:\"/public|class|@ASTTest|@GrabConfig/URi\";sid:2019000061;rev:1;)", "2002664": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Nessus\u626b\u63cf|tag:\u626b\u63cf|tool:Nessus|phase:recon|dest:home_net|level:attack|severity:1|result:unknown|o_msg:\u4f7f\u7528Nessus\u8fdb\u884cweb\u6f0f\u6d1e\u626b\u63cf|attack_type:target|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"Nessus\";nocase;depth:6;http_user_agent;threshold:type limit, track by_src,count 1, seconds 60;sid:2002664;rev:10;)", "180805102": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:XorDDoS|type:botnet|tag:XorDDoS|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u6728\u9a6c\u6837\u672cWin32/Linux.Xor.DDos\u5fc3\u8df3\u5305\";flow:from_server,established;content:\"|53 43 f0 96 00 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|\";dsize:28;depth:28;classtype:trojan-activity;sid:180805102;rev:1;)", "2020021007": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Laravel \u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u6267\u884c\u547d\u4ee4)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Laravel \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Illuminate\";content:\"Broadcasting\";distance:1;content:\"PendingBroadcast\";distance:1;content:\"*events\";distance:1;content:\"Faker\";distance:1;content:\"Generator\";distance:1;content:\"*formatters\";distance:1;content:\"dispatch\";distance:1;content:\"*event\";distance:1;sid:2020021007;rev:1;)", "2008643": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent(Downloader1.2)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| Downloader\";http_header;pcre:\"/User-Agent\\: Downloader\\d+\\.\\d/H\";threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008643;classtype:trojan-activity;sid:2008643;rev:7;)", "2020041010": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, weblogic_xmldecode_1;flowbits:isset,weblogic_xmldecode_2;content:\"200\";http_stat_code;content:\"X-Powered-By: Servlet\";http_header;sid:2020041010;)", "2020070304": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, bingxie_webshell_3;noalert;flowbits:unset, bingxie_webshell_3;flowbits:set, bingxie_webshell_4;content:\"200\";http_stat_code;http_header_names;content:\"|0d 0a|Set-Cookie|0d 0a|\";pkt_data;http_content_len;content:\"16\";pkt_data;pcre:\"/^[a-fA-F0-9]{16}$/Q\";sid:2020070304;gid:0;rev:1;)", "2020051213": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Couchdb \u5782\u76f4\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\uff08CVE-2017-12635\uff09|tag:\u6743\u9650\u7ed5\u8fc7|dest:home_net|level:attack|phase:exploit|result:success|o_msg:Couchdb \u5782\u76f4\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\uff08CVE-2017-12635\uff09|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2017_12635;content:\"201\";http_stat_code;http_content_type;content:\"application/json\";pkt_data;content:\"{\\\"ok\\\":true\";http_server_body;startswith;sid:2020051213;rev:2;)", "2020010026": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528\u6f0f\u6d1e\u6267\u884c\u547d\u4ee4|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u68c0\u6d4b\u5230\u8fdc\u7a0b\u547d\u4ee4\u6267\u884cwhoami|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;http_content_len;byte_test:0,<,7,0,string,dec;pkt_data;content:\"oracle\";http_server_body;flowbits:isset,cmd_reponse_echo;sid:2020010026;)", "2019090078": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Serv-U\u8fde\u63a5|direction:in|level:action|service_name:Serv-U|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728Serv-U|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 .*\\r\\n214- The following commands are recognized \\(\\* => unimplemented\\)\\.\\r\\n[ ]{3}USER[ ]{4}PORT[ ]{4}RETR[ ]{4}ALLO[ ]{4}DELE[ ]{4}SITE[ ]{4}XMKD[ ]{4}CDUP[ ]{4}FEAT\\r\\n[ ]{3}PASS[ ]{4}PASV[ ]{4}STOR[ ]{4}REST[ ]{4}CWD[ ]{3,4}STAT[ ]{4}RMD[ ]{3,5}XCUP[ ]{4}OPTS\\r\\n[ ]{3}ACCT[ ]{4}TYPE[ ]{4}APPE[ ]{4}RNFR[ ]{4}XCWD[ ]{4}HELP[ ]{4}XRMD[ ]{4}STOU[ ]{4}AUTH\\r\\n[ ]{3}REIN[ ]{4}STRU[ ]{4}SMNT[ ]{4}RNTO[ ]{4}LIST[ ]{4}NOOP[ ]{4}PWD[ ]{4,5}SIZE[ ]{4}PBSZ\\r\\n/\";sid:2019090078;gid:0;)", "2020051202": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PHP-FPM Fastcgi \u672a\u6388\u6743\u8bbf\u95ee\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|src:home_net|level:attack|phase:exploit|result:success|o_msg:PHP-FPM Fastcgi \u672a\u6388\u6743\u8bbf\u95ee\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:dest\";flow:to_server, established;flowbits:isset, fastcgi_unauth;content:\"X-Powered-By: PHP\";content:\"Content-type: text/html\";distance:0;content:\"_cg\";isdataat:!1,relative;sid:2020051202;rev:2;)", "2020040803": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Nexus Repository Manager 3 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Repository Manager 3 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2020_10199;content:\"POST\";http_method;content:\"/service/rest/beta/repositories/go/group\";http_uri;http_content_type;content:\"application/json\";pkt_data;content:\"\\\"group\\\"\";http_client_body;content:\"\\\"memberNames\\\"\";http_client_body;distance:0;pcre:\"/\\$(\\\\\\\\.)?\\{/PR\";sid:2020040803;rev:1;)", "2020062216": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:success|o_msg:\u653b\u51fb\u8005\u5c1d\u8bd5\u901a\u8fc7webshell\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, mem_webshell_interaction;content:\"200\";http_stat_code;content:\"Received fatal alert: protocol_versionReceived fatal alert: protocol_version<html>\";http_server_body;sid:2020062216;rev:1;)", "2020032410": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:phpmyadmin\u547d\u4ee4\u6267\u884c\u6210\u529f|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:phpmyadmin\u547d\u4ee4\u6267\u884c\u6210\u529f|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, phpmyadmin_exec_sql_success;content:\"200\";http_stat_code;http_content_type;content:\"application/json\";pkt_data;content:\"<div class=\\\\\\\"success\\\\\\\">\";http_server_body;sid:2020032410;rev:1;)", "2018030015": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:webshell\u8fde\u63a5|tag:webshell\u4e0a\u4f20EXE\u6587\u4ef6|tool:\u83dc\u5200|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:unknown|o_msg:\u83dc\u5200\u4e0a\u4f20exe\u7684\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX\";content:\"POST\";nocase;http_method;content:\".php\";nocase;http_uri;pcre:\"/\\.php$/iU\";content:\"\\;&\";nocase;http_client_body;within:1000;flowbits:isset, req_webshell;pcre:\"/[\\d\\w-_]{1,12}=4D5A900003[a-fA-F0-9]{100,}/iPR\";flow:to_server,established;sid:2018030015;rev:1;)", "2019090213": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:qmail\u8fde\u63a5|direction:in|level:action|service_name:Qmail|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728qmail|server:src\";flow:from_server,established;content:\"421 \";depth:4;pcre:\"/^421 unable to read controls \\(#4\\.3\\.0\\)\\r\\n/\";sid:2019090213;gid:0;)", "2018020035": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u83b7\u53d6phpinfo()|tag:\u53d1\u73b0phpinfo|direction:in|src:external_net|level:action|result:success|o_msg:\u83b7\u53d6phpinfo\u4fe1\u606f|dest:home_net|failed_by:http_status_3XX,http_status_4XX\";content:\"<!DOCTYPE html PUBLIC\";nocase;http_server_body;within:28;content:\"|0a|</style>|0a|<title>phpinfo()</title>\";nocase;http_server_body;within:1200;flow:from_server,established;gid:0;sid:2018020035;rev:1;)", "2019020008": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Tomcat\u7ba1\u7406\u754c\u9762\u767b\u9646\u6210\u529f|tag:Tomcat|force_save:true|direction:in|src:external_net|dest:home_net|level:action|severity:2|result:success|o_msg:Tomcat\u7ba1\u7406\u754c\u9762\u767b\u5f55\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, tomcat_wake_password;content:\"200\";http_stat_code;content:\"tomcat\";http_server_body;http_response_line;content:\"<html>|0a|<head>|0a|<style>|0a|H1 {font-family:\";sid:2019020008;rev:1;)", "2008663": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent(aguarovex-loader v3.221)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| aguarovex-loader v\";http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008663;classtype:trojan-activity;sid:2008663;rev:8;)", "2020071407": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:qdPM <9.1 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-7246)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|severity:3|result:unknown|phase:exploit|o_msg:qdPM <9.1 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-7246)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2020_7246;content:\"POST\";http_method;content:\"/index.php/myAccount/update\";http_uri;content:\"qdPM8=\";http_cookie;http_content_type;content:\"boundary=\";pkt_data;content:\"name=\\\"users[photo]\\\"\";http_client_body;content:\"filename=\";http_client_body;distance:0;within:40;content:\".php\";http_client_body;distance:0;content:\"<?php\";http_client_body;distance:0;sid:2020071407;)", "2809643": "alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:\"name:\u5229\u7528SMB\u4f20\u8f93mimikatz|tag:smb|direction:lateral|type:infil|src:home_net|dest:home_net|attacker:src|level:attack|phase:post_exploit|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5728\u5185\u7f51\u901a\u8fc7SMB\u534f\u8bae\u4f20\u8f93\u9ed1\u5ba2\u5de5\u5177Mimikatz\u7684mimidrv.sys\u6587\u4ef6\uff08Unicode\uff09\";flow:established,to_server;content:\"|FF|SMB|a2|\";offset:4;depth:5;byte_test:1,&,0x80,6,relative;content:\"m|00|i|00|m|00|i|00|d|00|r|00|v|00|.|00|s|00|y\";distance:0;reference:url,github.com/gentilkiwi/mimikatz;classtype:trojan-activity;sid:2809643;rev:1;metadata:created_at 2015_01_30, updated_at 2015_01_30;)", "2018081305": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u83b7\u53d6\u8ba1\u7b97\u673a\u8be6\u7ec6\u4fe1\u606f\";dsize:9;flow:from_server,established;content:\"sysinfo|0D 0A|\";depth:9;nocase;flowbits:isset,TB_ZxShell;sid:2018081305;rev:1;)", "180608000": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Ganiw_DDoS|type:rat|tag:Ganiw|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u6728\u9a6c\u540e\u95e8Linux.DDos.Ganiw\u4e0a\u7ebf\u5305(1)\";dsize:20;flow:from_server,established;content:\"|08 00 00 00 0c 00 00 00 00 00 00 00 00 00 00 00 e8 fd 00 00|\";sid:180608000;rev:1;)", "2020061202": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6cdb\u5faeOA \u4fe1\u606f\u6cc4\u9732|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:\u6cdb\u5faeOA \u4fe1\u606f\u6cc4\u9732|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, ecology_info_disclosure_612;content:\"200\";http_stat_code;content:\"\\\\WEAVER\\\\ecology\\\\\";http_server_body;sid:2020061202;rev:1;)", "180608001": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Ganiw_DDoS|type:rat|tag:Ganiw|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u6728\u9a6c\u540e\u95e8Linux.DDos.Ganiw\u4e0a\u7ebf\u5305(2)\";dsize:40;flow:from_client,established;content:\"|02 00 00 00 20 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 02 01 00 00 00 00 00 00 00 00 00 00 00 00|\";sid:180608001;rev:1;)", "2020071440": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|severity:3|result:unknown|phase:exploit|o_msg:\u547d\u4ee4\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"GET\";http_method;content:\"cd\";fast_pattern;pcre:\"/cd\\s+[a-zA-Z0-9\\:\\/\\;\\s\\-\\*\\.]+(curl|wget)\\s+[a-zA-Z0-9\\:\\/\\;\\s\\-\\*\\.]+(chmod\\s[a-zA-Z0-9\\:\\/\\;\\s\\-\\*\\.]+)?(sh|\\.\\/)/U\";sid:2020071440;)", "2020060231": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:cobaltstrike \u4e3b\u673a\u4e0a\u7ebf(http)|tag:cobaltstrike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|result:unknown|o_msg:cobaltstrike \u4e3b\u673a\u4e0a\u7ebf(http)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;http_accept;content:\"*/*\";pkt_data;content:!\"imapi.5211game.com\";http_host;content:\"b\";nocase;http_cookie;pcre:\"/^([A-Za-z0-9+\\/]){171}=$/C\";sid:2020060231;rev:1;)", "2020080324": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7 Metasploit \u8fde\u63a5\u670d\u52a1\u5668(tcp)|tag:\u53cd\u5f39shell|dest:home_net|level:attack|phase:exploit|severity:3|attack_type:target|result:unknown|o_msg:Metasploit \u8fde\u63a5(windows/x64/shell/bind_tcp)|attacker:src\";flags:P, A;flow:to_server, established;flowbits:set, windows_x64_shell_bind_tcp;noalert;dsize:4;content:\"|50 01 00 00|\";depth:4;sid:2020080324;)", "2019000073": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Intellian Satellian Aptus Web\u63a7\u5236\u53f0\u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-7989\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Intellian Satellian Aptus Web\u63a7\u5236\u53f0\u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-7989\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2020\u2014_7980;content:\"POST\";http_method;content:\"/cgi-bin/libagent.cgi\";http_uri;startswith;http_content_type;content:\"application/json\";pkt_data;content:\"\\\"EXEC_CMD\\\"\";http_client_body;sid:2019000073;rev:1;)", "2019090173": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Hmail\u8fde\u63a5|direction:in|level:action|service_name:Hmail(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Hmail|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([-\\w_.]+) .*\\r\\n211 DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY\\r\\n\\r\\n/\";sid:2019090173;gid:0;)", "2834374": "alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike\u8bf7\u6c42SSL\u8fde\u63a5|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike\u8bf7\u6c42SSL\u8fde\u63a5\";flow:to_server,established;tls_sni;content:\"flex-msn.appspot.com\";isdataat:!1,relative;metadata:former_category TROJAN;classtype:trojan-activity;sid:2834374;rev:1;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag SSL_TLS_SNI, signatrue_severity Major, created_at 2019_01_14, malware_family CobaltStrike, performance_impact Low, updated_at 2019_09_28;)", "2019090128": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK Dovecot ready -/\";sid:2019090128;gid:0;)", "20170251": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:1|result:unknown|o_msg:\u6267\u884c\u547d\u4ee4net user|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"GET\";http_method;content:\"=net\";http_uri;pcre:\"/=net(%20| )user\\b/iU\";flowbits:set,net_user;sid:20170251;)", "2019010048": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:nosql\u6ce8\u5165(mongo)|tag:nosql\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u901a\u8fc7php\u548cmongodb\u7684\u7279\u6027\u6ce8\u5165\u6761\u4ef6\u8868\u8fbe\u5f0f\u7ed5\u8fc7\u9a8c\u8bc1\uff0c\u6216\u76f2\u6ce8\u51fa\u654f\u611f\u6570\u636e|attacker:src\";flow:established,from_server;content:\"X-Powered-By: PHP\";nocase;http_header;flowbits:isset,nosqli;gid:3;sid:2019010048;)", "2020060801": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Kylin \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-1956\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Apache Kylin \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-1956\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/kylin/api/cubes/\";http_uri;within:30;pcre:\"/(\\|)|(\\&)|(\\;)|(`)/UR\";content:\"migrate\";http_uri;offset:16;sid:2020060801;rev:1;)", "2016959": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Struts2\u6f0f\u6d1e\u5229\u7528|tag:Struts\u6f0f\u6d1e|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|success_by:execmd|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Struts2 OGNL Java Exec\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u7684payload\u653b\u51fb\u7cfb\u7edf|attacker:src\";flow:to_server,established;content:\"java.io.FileOutputStream\";http_uri;nocase;content:\".write\";distance:0;nocase;http_uri;content:\"sun.misc.BASE64Decoder\";nocase;http_uri;flowbits:set,cmd_reponse_echo;sid:2016959;)", "2020052107": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fc7webshell\u5217\u76ee\u5f55|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u901a\u8fc7webshell\u5217\u76ee\u5f55\uff0c\u8bbf\u95ee\u6587\u4ef6\u5185\u5bb9|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"<script> \";http_server_body;content:\"function get(\";http_server_body;distance:0;content:\"function saveFile(\";http_server_body;distance:0;content:\"<h1>Directory Listing For \";http_server_body;distance:0;content:\"<table\";http_server_body;distance:10;content:\"<td align=\\\"left\\\"><font size=\\\"+1\\\"><strong>\";http_server_body;distance:0;sid:2020052107;rev:1;)", "2834375": "alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike\u8bf7\u6c42SSL\u8fde\u63a5|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike\u8bf7\u6c42SSL\u8fde\u63a5\";flow:to_server,established;tls_sni;content:\"msftncsi.appspot.com\";isdataat:!1,relative;metadata:former_category TROJAN;classtype:trojan-activity;sid:2834375;rev:1;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag SSL_TLS_SNI, signatrue_severity Major, created_at 2019_01_14, malware_family CobaltStrike, performance_impact Low, updated_at 2019_09_28;)", "2018020062": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u670d\u52a1\u5668\u51fa\u73b0PHP fatal error|direction:in|dest:home_net|src:external_net|level:action|o_msg:\u670d\u52a1\u5668\u8fd4\u56de\u9875\u9762\u51fa\u73b0php fatal error|failed_by:http_status_3XX,http_status_4XX\";http_content_type;content:\"text/html\";pkt_data;content:\"Fatal error</b>:\";nocase;within:3000;http_server_body;content:\"in\";within:300;http_server_body;pcre:\"/in (<b>)?(\\/[\\d\\w_.-]+)+\\.php(<\\/b>)? on line /Q\";flow:from_server,established;sid:2018020062;rev:1;)", "2018060001": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6267\u884c\u547d\u4ee4ifconfig|tag:\u547d\u4ee4\u6267\u884c|direction:in|src:external_net|level:attack|phase:control|type:shell|result:success|o_msg:\u547d\u4ee4\u6267\u884cifconfig|severity:1|dest:home_net|failed_by:http_status_3XX,http_status_4XX\";content:\"GET\";nocase;http_method;content:\"=ifconfig\";nocase;http_uri;within:1500;noalert;flowbits:set,cmd;flow:to_server,established;gid:0;sid:2018060001;rev:1;)", "2025812": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT php script double base64 encoded Remote Code Execution 3|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"MeW84UDNCb2ND\";metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025812;rev:2;metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2018010098": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5ThinkPHP\u6f0f\u6d1e|tag:ThinkPHP\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u9ed1\u5403\u9ed1\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728ThinkPHP\u6f0f\u6d1e|attacker:src\";content:\"GET\";nocase;http_method;content:\"/index.php\";http_uri;within:1000;pcre:\"/(\\/[\\w\\d]+){3}\\/$({|%7b)@?(system|eval|phpinfo|print)\\(?/iU\";flow:to_server,established;gid:0;sid:2018010098;rev:1;)", "2020062813": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Stowaway-\u53cd\u5411\u4ee3\u7406)|tag:\u653b\u51fb\u4ee3\u7406|tool:Stowaway|direction:in|src:home_net|dest:external_net|level:attack|phase:control|type:control|severity:4|result:unknown|o_msg:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Stowaway-\u53cd\u5411\u4ee3\u7406)\";flow:established, to_server;flowbits:set, Stowaway_link_type_1_2;content:\"|30 30 30 30 30 30 30 30 30 30 00 00 00 00 00 00|\";offset:16;depth:16;content:\"|00 00 00 30 30 30 30 30 30 30 30 30 30 |\";distance:64;within:13;sid:2020062813;rev:1;)", "2019090222": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:qmail\u8fde\u63a5|direction:in|level:action|service_name:Qmail|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728qmail|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([-\\w_.]+) ESMTP .*\\r\\n214-qmail home page: http://pobox\\.com/~djb/qmail\\.html\\r\\n214 qmail-ldap patch home page: http://www\\.nrg4u\\.com\\r\\n/\";sid:2019090222;gid:0;)", "2019090159": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:LDAP\u8fde\u63a5|direction:in|level:action|service_name:LDAP|service_class:auth|severity:1|result:unknown|o_msg:\u5b58\u5728LDAP|server:src\";flow:from_server,established;content:\"0|84 00 00 00|\";depth:5;pcre:\"/0\\x84\\x00\\x00\\x00-\\x02\\x01\\x01c\\x84\\x00\\x00\\x00$\\x04\\x00\\n\\x01\\x00\\n\\x01\\x00\\x02\\x01\\x00\\x02\\x01\\x00\\x01\\x01\\x00\\x87\\x0bobjectclass0\\x84\\x00\\x00\\x00\\x00\\x00\\n$/\";sid:2019090159;gid:0;)", "2834372": "alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike\u8bf7\u6c42SSL\u8fde\u63a5|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike\u8bf7\u6c42\u8fde\u63a5\";flow:to_server,established;tls_sni;content:\"trendmicro.appspot.com\";isdataat:!1,relative;metadata:former_category TROJAN;classtype:trojan-activity;sid:2834372;rev:1;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag SSL_TLS_SNI, signatrue_severity Major, created_at 2019_01_14, malware_family CobaltStrike, performance_impact Low, updated_at 2019_09_28;)", "2020032404": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7phpmyadmin\u67e5\u8be2\u65e5\u5fd7\u72b6\u6001|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5c1d\u8bd5\u901a\u8fc7phpmyadmin\u67e5\u8be2\u65e5\u5fd7\u72b6\u6001|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, phpmyadmin_exec_sql_success;content:\"POST\";http_method;content:\"/import.php\";http_uri;content:\"sql_query=\";http_client_body;content:\"show+variables+like+\";http_client_body;distance:0;nocase;content:\"%25general%25\";http_client_body;distance:0;within:15;nocase;sid:2020032404;rev:1;)", "2019060036": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u83b7\u53d6\u5185\u7f51\u6e17\u900f\u811a\u672c|tag:\u4e0b\u8f7d\u6076\u610f\u6587\u4ef6|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|type:unknown_url|result:success|o_msg:\u7591\u4f3c\u4e0b\u8f7dpowershell\u811a\u672c|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;http_content_type;content:\"application/octet-stream\";pkt_data;content:\"(New-Object\";nocase;http_server_body;pcre:\"/\\s+Net.WebClient\\)\\.DownloadString\\('/QR\";content:\"https://raw.githubusercontent.com/mattifestation/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1')\\;\";gid:0;sid:2019060036;rev:1;)", "2008046": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230Rf-cheats.ru\u6728\u9a6c\u76f8\u5173User-Agent (RFRudokop v.1.1 account verification)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"RFRudokop\";http_user_agent;depth:9;reference:url,doc.emergingthreats.net/2008046;classtype:trojan-activity;sid:2008046;rev:7;)", "2018120503": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:KonniX\u540e\u95e8\u6728\u9a6c|type:rat|tag:KonniX|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cKonniX\u51fa\u7ad9\u6d41\u91cf|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\"down.php?file=\";http_uri;content:\"_drop.jpg\";distance:8;within:9;http_uri;isdataat:!1,relative;content:\"HTTP\";http_user_agent;depth:4;isdataat:!1,relative;sid:2018120503;rev:1;)", "2020061021": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u4f7f\u7528Jboss\u4e0a\u4f20war\u5305\u90e8\u7f72\u5e94\u7528|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5c1d\u8bd5\u4f7f\u7528Jboss\u4e0a\u4f20war\u5305\u90e8\u7f72\u5e94\u7528|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/admin-console/secure/resourceContentCreate.seam\";http_uri;http_content_type;content:\"boundary=\";pkt_data;content:\"name=\\\"createContentForm:file\\\"\";http_client_body;sid:2020061021;rev:1;)", "2018081313": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u8fdb\u884c\u6d4f\u89c8G\u76d8\";dsize:9;flow:from_server,established;content:\"LIST G:|0d 0a|\";depth:9;nocase;flowbits:isset,TB_ZxShell_2;sid:2018081313;rev:1;)", "2020041098": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u6267\u884c\u547d\u4ee4|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|type:shell|phase:control|severity:3|result:success|o_msg:webshell\u6267\u884cnet user|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"-------------------------------------------------------------------------------\";http_server_body;content:\"Administrator\";http_server_body;distance:0;content:\"Guest\";http_server_body;distance:0;flowbits:isset,net_user;sid:2020041098;)", "2020072001": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u653b\u51fb\u8005\u5e38\u7528${IFS}\u4ee3\u66ff\u95f4\u9694\u7b26\uff0c\u7ed5\u8fc7\u9650\u5236|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"GET\";http_method;content:\"${IFS}\";http_uri;nocase;fast_pattern;pcre:\"/(ls|cd|pwd|wget|curl|adduser|cat|passwd|chmod|echo|netstat|uname|sysctl|mysql|history|bash|useradd|ps|ifconfig|find|id|grep|awk|last|lsof|iptables|find|whoami|touch|ping)/Ui\";sid:2020072001;rev:1;)", "2020010023": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08cve-2019-2725\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08cve-2019-2725\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/_async/AsyncResponseService\";http_uri;http_content_type;content:\"text/xml\";pkt_data;content:\"<soapenv:Envelope\";http_client_body;content:\"class\";http_client_body;distance:0;pcre:\"/(oracle\\.toplink\\.internal\\.sessions\\.UnitOfWorkChangeSet)|(com\\.sun.rowset\\.JdbcRowSetImpl)|(org\\.slf4j\\.ext\\.EventData)/PR\";flowbits:set, cve-2019-2725;sid:2020010023;rev:1;)", "20277621": "alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528AnyDesk|tag:\u8fdc\u7a0b\u63a7\u5236|tool:anydesk|dest:home_net|level:attack|severity:1|phase:exploit|type:shell|result:unknown|o_msg:\u4f7f\u7528AnyDesk\u8fde\u63a5\uff0c\u90e8\u5206\u9ed1\u5ba2\u4f1a\u4f7f\u7528Anydesk\u8fde\u63a5\u4e0d\u4f1a\u88ab\u6740\u6bd2\u8f6f\u4ef6\u6740\u6389\u53c8\u5f88\u7a33\u5b9a\u3002\u4f46\u66f4\u591a\u60c5\u51b5\u662f\u8fd0\u7ef4\u5728\u4f7f\u7528\uff0c\u6240\u4ee5\u9700\u8981\u6392\u67e5\u60c5\u51b5\u3002|attacker:src\";flow:established, to_client;tls_cert_subject;content:\"C=DE, O=philandro Software GmbH, CN=AnyNet Relay\";isdataat:!1,relative;fast_pattern;threshold:type limit, track by_dst, count 1, seconds 600;sid:20277621;rev:2;)", "2018062903": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528etherworm\u5efa\u7acb\u901a\u4fe1\u96a7\u9053|type:infil|tag:\u7aef\u53e3\u6620\u5c04|direction:lateral|src:home_net|dest:external_net|level:attack|phase:post_exploit|severity:4|result:unknown|o_msg:\u9ed1\u5ba2\u5de5\u5177etherworm\u7684lcx\u6a21\u5757\u5c06\u5185\u7f51\u4e3b\u673a\u7aef\u53e3\u6620\u5c04\u5230\u5916\u7f51(set)\";dsize:6;flow:established,to_server;content:\"|01 04 00 00 00 00|\";flowbits:set, TB_tool_exe_02packet;flowbits:noalert;sid:2018062903;rev:1;)", "2020051903": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:spring-cloud-config\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\uff08CVE-2019-3799\uff09|tag:\u76ee\u5f55\u7a7f\u8d8a|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:spring-cloud-config\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\uff08CVE-2019-3799\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"..%252F\";http_raw_uri;sid:2020051903;rev:1;)", "2020051208": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Adobe ColdFusion \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e (CVE-2018-15961)|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:Adobe ColdFusion \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e (CVE-2018-15961)|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2018_15961;content:\"POST\";http_method;content:\"/cf_scripts/scripts/ajax/ckeditor/plugins/filemanager/upload.cfm\";http_uri;nocase;http_content_type;content:\"multipart/form-data\";pkt_data;sid:2020051208;rev:2;)", "2020070208": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Shiro \u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e(CVE-2020-11989)|tag:\u6743\u9650\u7ed5\u8fc7|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Apache Shiro \u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e(CVE-2020-11989)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"%25%32%66\";http_raw_uri;depth:100;sid:2020070208;rev:1;)", "2020081718": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528\u7eff\u76df\u626b\u63cf\u5668\u626b\u63cf|tag:\u626b\u63cf\u5668|dest:home_net|level:attack|phase:recon|severity:2|result:unknown|o_msg:\u4f7f\u7528\u7eff\u76df\u626b\u63cf\u5668\u8fdb\u884c\u626b\u63cf|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;http_content_type;content:\"boundary=--nsfocus\";pkt_data;sid:2020081718;rev:1;)", "2019060041": "alert udp $HOME_NET any -> any 53 (msg:\"name:\u5229\u7528dnslog.cn\u8fdb\u884cdnslog\u53cd\u5f39|tag:dns\u53cd\u5f39|direction:out|level:attack|phase:control|severity:3|result:success|o_msg:\u68c0\u6d4bdnslog.cn\u7684dns\u8bf7\u6c42\";content:\"|01 00|\";offset:2;content:\"|06|dnslog|02|cn|00|\";nocase;sid:2019060041;)", "2025814": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT php script double base64 encoded Remote Code Execution 5|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"hxUEQ5d2FIQW\";metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025814;rev:2;metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2019030013": "alert udp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u8fde\u63a5\u5230\u516c\u7f51frp\u670d\u52a1\u5668(via kcp)|tag:tunnel|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|tool:frp|result:success|o_msg:frp\u96a7\u9053\u5efa\u7acb\u6210\u529f\uff0c\u53ef\u7528\u6765\u8fdb\u884c\u5185\u7f51\u7a7f\u900f\";dsize:<500;content:\"|00 01 00 02 00 00 00 01 00 00 00 00|\";content:\"O{\\\"version\\\"\\:\\\"\";distance:0;content:\"\\\",\\\"run_id\\\"\\:\\\"\";distance:0;content:\"\\\",\\\"server_udp_port\\\"\\:\";distance:0;content:\",\\\"error\\\"\\:\\\"\";distance:0;content:\"\\\"}\";distance:0;flowbits:isset,frp_state_kcp;sid:2019030013;)", "2019060029": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"ASP.NET_SessionId=\";http_cookie;pcre:\"/[a-zA-Z0-9]{24}/CR\";http_content_len;byte_test:0,=,16,0,string,dec;pkt_data;content:\"d\";nocase;http_server_body;within:16;pcre:\"/^([a-f0-9A-F]{16})$/Q\";isdataat:!1,relative;noalert;flowbits:isset, bingxie_webshell_aspx;flowbits:set, bingxie_webshell_step2_aspx;sid:2019060029;gid:0;rev:1;)", "2020071445": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Citrix \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e(CVE-2020-8195)|tag:\u672a\u6388\u6743\u8bbf\u95ee|dest:home_net|level:attack|severity:3|result:unknown|phase:exploit|o_msg:Citrix \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6b64\u6f0f\u6d1e\u83b7\u53d6\u654f\u611f\u4fe1\u606f|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2020_8195;content:\"/pcidss/report\";http_uri;fast_pattern;content:\"type=all_signatures\";http_uri;distance:0;content:\"sid=\";http_uri;content:\"username=\";http_uri;content:\"set=\";http_uri;content:\"sig_name=_default_signature_\";http_uri;sid:2020071445;)", "2020021018": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:SwiftMailer\u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u5220\u6587\u4ef6)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:SwiftMailer\u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Swift_ByteStream_TemporaryFileByteStream\";content:\"Swift_ByteStream_FileByteStreampathonse\";distance:1;sid:2020021018;rev:1;)", "2824408": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528Empire\u5efa\u7acbSession\u521d\u59cb\u6d3b\u52a8|tag:\u6728\u9a6c|direction:out|src:home_net|dest:external_net|level:attack|type:c2|phase:control|severity:3|result:success|o_msg:\u4f7f\u7528Empire\u5efa\u7acbSession|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;urilen:10;http_start;content:\"GET /index.asp|20|HTTP/1.1|0d 0a|User-Agent|3a 20|Mozilla/5.0 (Windows NT 6.1|3b 20|WOW64|3b 20|Trident/7.0|3b 20|rv|3a|11.0) like Gecko|0d 0a|Host|3a|\";fast_pattern;http_header_names;content:!\"Accept\";content:!\"Referer|0d 0a|\";content:!\"Cache-Control|0d 0a|\";http_connection;content:\"Keep-Alive\";depth:10;isdataat:!1,relative;classtype:trojan-activity;sid:2824408;rev:4;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag PowerShell_Empire, signature_severity Major, created_at 2017_01_13, performance_impact Low, updated_at 2020_03_02;)", "2020070706": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Maccms8.x \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Maccms8.x \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, Maccms_8_x_rce;content:\"POST\";http_method;content:\"m=vod-search\";http_uri;fast_pattern;content:\"wd=\";http_client_body;pcre:\"/({|%7B)if-([\\s\\S]*?):([\\s\\S]+?)}([\\s\\S]*?){endif-([\\s\\S]*?)(}|%7D)/PRi\";sid:2020070706;rev:1;)", "2805170": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ETPRO EXPLOIT  Metasploit Java Applet Field Bytecode Verifier Cache Remote Code Execution|tag:TEST|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:dest\";flow:established,from_server;content:\"archive=\";content:\".jar\";within:13;content:\"code=|22|cve1723.Attacker|22|\";distance:0;reference:cve,2012-1723;reference:bugtraq,52161;reference:url,oracle.com/technetwork/topics/security/javacpujun2012-1515912.html;classtype:attempted-user;sid:2805170;rev:3;metadata:affected_product Any, attack_target Client_and_Server, deployment Perimeter, deployment Internet, deployment Internal, deployment Datacenter, tag Metasploit, signatrue_severity Critical, created_at 2012_07_12, updated_at 2016_07_01;)", "2018062805": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:weevely\u8fde\u63a5\u8bf7\u6c42|tag:\u83dc\u5200|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230weevely\u8fde\u63a5php webshell\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;pcre:\"/^ID=we\\;/C\";sid:2018062805;rev:1;)", "2020011404": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JBoss \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2013-4810\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JBOSS\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/invoker/JMXInvokerServlet\";http_uri;within:40;content:\"application/x-java-serialized-object\";http_header;content:\"invocation.MarshalledInvocation\";http_header;distance:0;content:\"| ac ed 00 05 |sr\";http_client_body;startswith;sid:2020011404;rev:1;)", "2020060210": "alert TCP $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(Clojure-TCP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|attacker:src\";flow:established, to_server;content:\"|ac ed 00 05|\";fast_pattern;content:\"java.util.HashMap\";content:\"javax.swing.table.AbstractTableModel$ff19274a\";content:\"clojure.core$comp$fn__4727\";content:\"clojure.main$eval_opt\";content:\"clojure.core$constantly$fn__4614\";sid:2020060210;rev:1;)", "2832155": "alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Cobalt Strike\u6728\u9a6cSSL\u8bc1\u4e66\u4f20\u8f93(APT32\u4f7f\u7528)|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|dest:home_net|src:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:\u5b58\u5728Cobalt Strike\u6728\u9a6c\u7684SSL\u8bc1\u4e66\uff0c\u8be5\u8bc1\u4e66ATP32\u7ec4\u7ec7\u66fe\u7ecf\u4f7f\u7528\u8fc7\u3002\";flow:established,from_server;tls_cert_subject;content:\"CN=cortanasyn.com\";nocase;isdataat:!1,relative;metadata:former_category MALWARE;reference:md5,38755ef6e9c6fa0d8f3f74869310ce29;classtype:trojan-activity;sid:2832155;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, deployment Perimeter, tag APT32, signatrue_severity Major, created_at 2018_08_13, malware_family Cobalt_Strike, performance_impact Moderate, updated_at 2019_09_28;)", "2019010035": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WCM\u5185\u5bb9\u534f\u4f5c\u5e73\u53f0\u914d\u7f6e\u6f0f\u6d1e|tag:CMS\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:exploit|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:WCM\u5185\u5bb9\u534f\u4f5c\u5e73\u53f0\u914d\u7f6e\u6f0f\u6d1e|attacker:src\";flow:to_server,established;content:\"GET\";http_method;content:\" /wcm/infoview.do?serviceid=wcm6_user&MethodName=getUsersByNames&UserNames=\";http_uri;flowbits:set,wcm_exp;sid:2019010035;gid:0;)", "2019090243": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:radmin\u8fde\u63a5|direction:in|level:action|service_name:Radmin|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728Radmin|server:src\";flow:from_server,established;content:\"|01 00 00 00|\";depth:4;pcre:\"/^\\x01\\x00\\x00\\x00\\x25\\x59\\x00\\x02\\x12\\x08\\x02\\x00\\x59\\x0a/\";sid:2019090243;gid:0;)", "2020010041": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4e0a\u4f20\u6076\u610f\u6587\u4ef6|tag:\u4e0a\u4f20\u6076\u610f\u6587\u4ef6|level:attack|phase:exploit|result:unknown|o_msg:\u4e0a\u4f20\u6076\u610f\u884c\u4e3a|severity:1|dest:home_net|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;http_content_type;content:\"multipart/form-data|3B|\";nocase;pcre:\"/[ ]+boundary=/iR\";pkt_data;content:\"Content-Disposition:\";nocase;http_client_body;content:\"<%@ Page\";nocase;http_client_body;flowbits:set,upload_script_file;flow:to_server,established;gid:0;sid:2020010041;rev:1;)", "2020070213": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Hadoop Yarn REST API\u672a\u6388\u6743\u8bbf\u95ee\u653b\u51fb|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Hadoop Yarn REST API\u672a\u6388\u6743\u8bbf\u95ee\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, hadoop_yarn_unauth;content:\"202\";http_stat_code;http_content_type;content:\"application/json\";pkt_data;http_content_len;content:\"0\";sid:2020070213;rev:1;)", "2835929": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ETPRO POLICY External IP Address Lookup via api.ip .sb|tag:TEST|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:dest\";flow:to_server,established;content:\"GET\";http_method;content:\"/geoip\";http_uri;depth:6;isdataat:!1,relative;content:\"api.ip.sb\";http_host;depth:9;fast_pattern;isdataat:!1,relative;metadata:former_category POLICY;classtype:policy-violation;sid:2835929;rev:1;metadata:attack_target Client_Endpoint, deployment Perimeter, tag IP_address_lookup_website, signatrue_severity Audit, created_at 2019_04_17, performance_impact Low, updated_at 2019_04_17;)", "2019090181": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Hmail\u8fde\u63a5|direction:in|level:action|service_name:Hmail(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Hmail|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK .*\\r\\n-ERR Invalid command in current state\\.\\r\\n-ERR Invalid command in current state\\.\\r\\n/\";sid:2019090181;gid:0;)", "2018041910": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6697\u591c\u7cbe\u7075\u540e\u95e8\u6728\u9a6c|type:rat|tag:NightElf|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6c\u6697\u591c\u7cbe\u7075\u4e0a\u7ebf\";dsize:8;content:\"faggotry\";flow:from_server;flowbits:isset,TB_NightElf;sid:2018041910;rev:1;)", "2019010006": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5KindEditor\u6f0f\u6d1e|tag:CMS\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728KindEditor\u4e0a\u4f20\u6f0f\u6d1e|attacker:src\";content:\"POST\";nocase;http_method;content:\"/upload_json.\";http_uri;nocase;content:\"?dir=file\";http_uri;distance:3;within:40;content:\"multipart/form-data\\;\";nocase;http_content_type;pcre:\"/[ ]+boundary=/iHR\";pkt_data;content:\"Content-Disposition:\";nocase;http_client_body;pcre:\"/filename=\\\"[^.]+\\.(ashx|asp|aspx|php|jsp|asa|html|htm|txt|phtml|md)/PRi\";flowbits:set,kindedior;flow:to_server,established;gid:0;sid:2019010006;rev:1;)", "2009994": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (STEROID\u4e0b\u8f7d)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| STEROID Download|0D 0A|\";nocase;http_header;reference:url,anubis.iseclab.org/?action=result&task_id=17b118a86edba30f4f588db66eaf55d10;reference:url,security.thejoshmeister.com/2009/09/new-malware-ddos-botexe-etc-and.html;reference:url,doc.emergingthreats.net/2009994;classtype:trojan-activity;sid:2009994;rev:7;)", "2013337": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PoisonIvy\u540e\u95e8\u6728\u9a6c|type:rat|tag:PoisonIvy|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230PoisonIvy.X\u5fc3\u8df3\u5305\";flow:established,to_server;dsize:>30;content:\"|90 48 5c d5 ec 70 a3 8b 41 72 28 50 ec f6 d5 2a|\";offset:16;depth:16;reference:url,www.threatexpert.com/report.aspx?md5=fc414168a5b4ca074ea6e03f770659ef;classtype:trojan-activity;sid:2013337;rev:5;)", "2026920": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"V3LU9\";fast_pattern;distance:0;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026920;rev:3;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2020020505": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528\u5de5\u5177QuarksPwDump|tag:QuarksPwDump|tool:QuarksPwDump|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:QuarksPwDump|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"________\";http_server_body;content:\"                          __            __________          ________                            |0d 0d 0a|\";http_server_body;distance:0;within:100;content:\"|5c|_____  |5c|   __ __ _____  _______ |7c|  |7c|\";http_server_body;distance:0;content:\" __  ______|5c|\";http_server_body;distance:0;content:\" -<(QuarksLab)>-|0d 0d 0a|\";distance:300;sid:2020020505;rev:1;)", "2019010019": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Coremail \u914d\u7f6e\u8bfb\u53d6\u6f0f\u6d1e|tag:\u914d\u7f6e\u6f0f\u6d1e|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:Coremail\u7206\u51fa0day\u6f0f\u6d1e\u53ef\u4ee5\u76f4\u63a5\u8bfb\u53d6\u914d\u7f6e|attacker:src\";flow:to_server,established;flowbits:set,coremail.exp;content:\"/mailsms/s?func=admin:appstate&dumpconfig=/\";http_uri;nocase;gid:0;sid:2019010019;rev:1;)", "2019070014": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u7591\u4f3cwebshell|tag:webshell|direction:out|src:home_net|dest:external_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:attack_out|result:unknown|o_msg:CVE-2017-10271 Payload\u653b\u51fb\u7cfb\u7edf[1]\";flow:to_server,established;content:\"POST\";http_method;content:\"/bea_wls_internal/\";http_uri;pcre:\"/[0-9a-zA-Z]+\\.(jsp)$/iUR\";flowbits:set, weblogic_write_file3;gid:0;sid:2019070014;rev:1;)", "2019090058": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(POP3)|direction:in|level:action|service_name:Microsoft Exchange(POP3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange|server:src\";flow:from_server,established;content:\"*OK Microsoft Exchange\";depth:23;pcre:\"/^\\+OK Microsoft Exchange Server 2007 POP3 HIROC service ready\\r\\n/\";sid:2019090058;gid:0;)", "2018111900": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:tRAT\u540e\u95e8\u6728\u9a6c|type:rat|tag:tRAT|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6ctRAT\u4e0a\u7ebf\";flow:to_server,established;content:\"D9BD68ABF53C3914A248EC603E9CD96F\";depth:32;dsize:32<>300;sid:2018111900;rev:1;)", "2019090049": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(IMAP)|direction:in|level:action|service_name:Microsoft Exchange(IMAP)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Rsync|server:src\";flow:from_server,established;content:\"*OK Microsoft Exchange\";depth:23;pcre:\"/^\\* OK Microsoft Exchange IMAP4rev1 server version ([-.\\w]+) /\";sid:2019090049;gid:0;)", "2026932": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"Zva2UtV21pTWV\";distance:0;fast_pattern;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026932;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2020050702": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:HTTP\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2015-1635)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:recon|result:success|o_msg:\u626b\u63cfHTTP\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2015-1635)\uff0c\u51fa\u73b0\u8be5\u6761\u544a\u8b66\uff0c\u8bf4\u660e\u6f0f\u6d1e\u5b58\u5728|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2015_1635;content:\"416\";http_stat_code;content:\"|0d 0a|Server: Microsoft-IIS\";http_header;content:\"The requested range is not satisfiable.</p>\";http_server_body;sid:2020050702;rev:2;)", "2809506": "alert tcp $EXTERNAL_NET any -> $HOME_NET 27017 (msg:\"name:\u8bf7\u6c42MongoDB\u7248\u672c\u4fe1\u606f|tag:MongoDB|direction:lateral|type:infil|src:external_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5bf9MongoDB\u7684\u7248\u672c\u4fe1\u606f\u8bf7\u6c42\";flow:to_server,established;content:\"|d4 07 00 00|\";offset:12;depth:4;fast_pattern;content:\"admin.$cmd|00|\";distance:0;content:\"buildinfo|00|\";distance:0;reference:url,github.com/tcstool/NoSQLMap/blob/0.5/README.md;classtype:successful-admin;sid:2809506;rev:1;metadata:created_at 2015_01_13, updated_at 2015_01_13;)", "2020081723": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528AWVS\u626b\u63cf|tag:\u626b\u63cf\u5668|dest:home_net|level:attack|phase:recon|severity:2|result:unknown|o_msg:\u4f7f\u7528AWVS\u8fdb\u884c\u626b\u63cf|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"acunetix_wvs_security_test\";http_client_body;sid:2020081723;rev:1;)", "2019090167": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Hmail\u8fde\u63a5|direction:in|level:action|service_name:Hmail(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Hmail|server:src\";flow:from_server,established;content:\"* OK \";depth:5;pcre:\"/^\\* OK .*\\r\\nGET BAD Unknown or NULL command\\r\\n BAD NULL COMMAND\\r\\n/\";sid:2019090167;gid:0;)", "2018020059": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528DELETE\u8bf7\u6c42|direction:in|src:external_net|dest:home_net|level:action|o_msg:HTTP\u7684DELETE\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"DELETE\";nocase;http_method;gid:0;sid:2018020059;rev:1;)", "2020082004": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874eWebshell\u901a\u8baf|tag:webshell|tool:\u51b0\u874e|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u51b0\u874eWebshell\u901a\u8baf|gray:true|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;flowbits:set, bingxie_3_0_4_asp;noalert;content:\"POST\";http_method;content:\".asp\";http_uri;fast_pattern;http_content_type;content:\"application/octet-stream\";pkt_data;http_content_len;byte_test:0,>=,6000,0,string,dec;pkt_data;pcre:\"/^[[:print:]]{0,3}[^[:print:]]/P\";sid:2020082004;gid:0;rev:1;)", "2834376": "alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike\u8bf7\u6c42SSL\u8fde\u63a5|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike\u8bf7\u6c42SSL\u8fde\u63a5\";flow:to_server,established;tls_sni;content:\"choice-microsoft.appspot.com\";isdataat:!1,relative;metadata:former_category TROJAN;classtype:trojan-activity;sid:2834376;rev:1;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag SSL_TLS_SNI, signatrue_severity Major, created_at 2019_01_14, malware_family CobaltStrike, performance_impact Low, updated_at 2019_09_28;)", "2019090311": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Oracle-tns\u8fde\u63a5|direction:in|level:action|service_name:Oracle-tns|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728Oracle-tns|server:src\";flow:from_server,established;content:\"|00|\";pcre:\"/^..\\0\\0\\x04\\0\\0\\0\\\"\\0..\\(DESCRIPTION=\\(TMP=\\)\\(VSNNUM=\\d+\\)\\(ERR=1194\\)\\(ERROR_STACK=\\(ERROR=\\(CODE=1194\\)\\(EMFI=4\\)\\)\\)\\)/\";sid:2019090311;gid:0;)", "2020080307": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7 Metasploit \u8fde\u63a5\u670d\u52a1\u5668(tcp)|tag:\u53cd\u5f39shell|dest:home_net|level:attack|phase:exploit|severity:3|attack_type:target|result:unknown|o_msg:Metasploit \u8fde\u63a5(linux/x86/meterpreter/bind_tcp)|attacker:src\";flow:to_server, established;content:\"mbedtls_platform_entropy_poll|00|\";fast_pattern;content:\"execve|00|\";distance:0;within:7;content:\"mbedtls_ctr_drbg_random|00|\";distance:0;within:24;content:\"__c_locale|00|\";distance:0;within:11;content:\"webcam_stop|00|\";distance:0;within:12;sid:2020080307;)", "2020060221": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(CommonsCollections5-HTTP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"application/\";pcre:\"/(x-www-form-urlencoded)|(x-java-serialized-object)/R\";pkt_data;content:\"|ac ed 00 05|\";http_client_body;fast_pattern;content:\"ValueExpException\";http_client_body;content:\"org.apache.commons.collections.keyvalue.TiedMapEntry\";http_client_body;content:\"org.apache.commons.collections.map.LazyMap\";http_client_body;content:\"org.apache.commons.collections.functors.ConstantTransformer\";http_client_body;content:\"org.apache.commons.collections.functors.InvokerTransformer\";http_client_body;sid:2020060221;rev:1;)", "2019000067": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:LDIF\u6587\u4ef6\u4e0b\u8f7d|tag:\u4e0b\u8f7d|src:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:ldif\u6587\u4ef6\u4e0b\u8f7d|attacker:dest\";flow:established, from_server;content:\"dn: \";fast_pattern;content:\"|0a|objectClass: \";distance:5;content:\"|0a 0a|dn: \";distance:5;sid:2019000067;rev:1;)", "2020040804": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Nexus Repository Manager 3 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Repository Manager 3 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2020_10199;content:\"400\";http_stat_code;http_content_type;content:\"application/vnd.siesta-validation-errors-v1+json\";pkt_data;content:\"FIELD memberNames\";http_server_body;sid:2020040804;rev:1;)", "2020070317": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|tag:\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\".php\";http_uri;content:\"assert\";http_client_body;fast_pattern;pcre:\"/\\$_(GET|POST)\\[\\S+\\]/PRi\";sid:2020070317;rev:1;)", "2019090232": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Courier\u8fde\u63a5|direction:in|level:action|service_name:Courier(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Courier smtp|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([-.\\w]+) ESMTP\\r\\n502 ESMTP command error\\r\\n$/\";sid:2019090232;gid:0;)", "2019010088": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Joomla 3.4.6\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Joomla 3.4.6 \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a|attacker:src\";flow:to_server,established;flowbits:set, joomla_rce_by_username;flowbits:set, Joomla_3_4_6_rce_1;content:\"POST\";http_method;pcre:\"/username=\\w*(%5C0%5C0%5C0)+\\w*/P\";content:\"password=\";http_client_body;content:\"JDatabaseDriverMysqli\";distance:0;http_client_body;content:\"JSimplepieFactory\";distance:0;http_client_body;content:\"disconnectHandlers\";distance:0;http_client_body;content:\"SimplePie\";distance:0;http_client_body;content:\"JDatabaseDriverMysql\";distance:0;http_client_body;content:\"cache_name_function\";distance:0;http_client_body;content:\"feed_url\";distance:0;http_client_body;pcre:\"/(http|https|ftp)| 3A 2F 2F |/P\";content:\"task=user.login\";http_client_body;sid:2019010088;rev:1;)", "2020010006": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u8fc7bash\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4|tag:\u53cd\u5f39shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|attack_type:target|result:unknown|o_msg:ip a\";flow:established,to_client;dsize:5;flags:P,A;content:\"ip a|0a|\";offset:0;depth:5;flowbits:isset,linux_bash_reverse_shell;flowbits:set,ip_send;flowbits:noalert;sid:2020010006;)", "2020042602": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Apache Axis2 \u767b\u5f55\u884c\u4e3a|tag:\u767b\u5f55\u884c\u4e3a|dest:home_net|level:attack|severity:3|phase:exploit|result:success|o_msg:Apache Axis2 \u767b\u5f55\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, axis2_login;content:\"302\";http_stat_code;content:\"Location: index|3B|jsessionid=\";http_header;sid:2020042602;rev:1;)", "2019010002": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5ThinkPHP\u6f0f\u6d1e|tag:ThinkPHP\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728ThinkPHP\u6f0f\u6d1e|attacker:src\";content:\"GET\";nocase;http_method;content:\"/index.php\";nocase;http_uri;within:100;pcre:\"/(\\/)?\\?s=(\\/)?index\\/(\\\\)?think\\\\Request/input&filter=/iUR\";flow:to_server,established;gid:0;sid:2019010002;rev:1;)", "2020021024": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Symfony\u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u547d\u4ee4\u6267\u884c)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Symfony\u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Symfony\";content:\"Component\";distance:1;content:\"Process\";distance:1;content:\"Pipes\";distance:1;content:\"WindowsPipes\";distance:1;content:\"WindowsPipesfiles\";distance:1;content:\"Expression\";distance:1;content:\"Expressionvalue\";distance:1;content:\"StringStorage\";distance:1;content:\"*template\";distance:1;sid:2020021024;rev:1;)", "2008702": "alert tcp $HOME_NET any -> $HOME_NET 445 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";flow:established,to_server;content:\"|1F 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"|5C|..|5C|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008702;classtype:attempted-admin;sid:2008702;rev:6;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2020062207": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ABPTTS \u4ee3\u7406\u8fde\u63a5\u6210\u529f|tag:\u653b\u51fb\u4ee3\u7406|tool:ABPTTS|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u5185\u7f51\u6e17\u900f\u65f6\u7684\u5e38\u7528\u5de5\u5177ABPTTSwebshell|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, http_abptts;content:\"200\";http_stat_code;content:\"<html>|0d 0a 09|<head>|0d 0a 09 09|<title>System Status API</title>|0d 0a 09|</head>\";http_server_body;startswith;threshold:type both, track by_src, count 20, seconds 5;sid:2020062207;rev:1;)", "2019090288": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DNS\u8fde\u63a5|direction:in|level:action|service_name:Microsoft DNS|service_class:other|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft DNS|server:src\";flow:from_server,established;content:\"|07|version|04|bind\";within:27;pcre:\"/\\x07version\\x04bind\\0\\0\\x10\\0\\x03\\xc0\\x0c\\0\\x10\\0\\x01.{7}Microsoft DNS (6\\.1)$/\";sid:2019090288;gid:0;)", "2018040008": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u68c0\u6d4bSMTP\u6307\u7eb9|tag:\u626b\u63cf|tool:Nmap|type:\u6307\u7eb9\u63a2\u6d4b|direction:in|phase:recon|src:external_net|dest:home_net|level:attack|severity:1|result:unknown|o_msg:NMAP\u626b\u63cf\u68c0\u6d4bSMTP\u6307\u7eb9\";dsize:22;content:\"EHLO nmap.scanme.org|0d 0a|\";flow:to_server,established;sid:2018040008;rev:1;)", "2020081447": "alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08udp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u8bfb\u53d6\u6587\u4ef6/etc/shadow\";content:\"bin\";fast_pattern;pcre:\"/^\\:\\*\\:\\d{5}\\:0\\:99999\\:7\\:\\:\\:\\x0a/R\";content:\"mail\";distance:0;pcre:\"/^\\:\\*\\:\\d{5}\\:0\\:99999\\:7\\:\\:\\:\\x0a/R\";content:\"nobody\";distance:0;pcre:\"/^\\:\\*\\:\\d{5}\\:0\\:99999\\:7\\:\\:\\:\\x0a/R\";sid:2020081447;)", "2020021002": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Doctrine \u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u5199\u6587\u4ef6)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Doctrine \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Doctrine\";content:\"ResultSetMappingBuilder\";distance:0;content:\"EntityManager\";distance:0;content:\"AnnotationDriver\";distance:0;content:\"CachedReader\";distance:0;sid:2020021002;rev:1;)", "2020072002": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u653b\u51fb\u8005\u5e38\u7528${IFS}\u4ee3\u66ff\u95f4\u9694\u7b26\uff0c\u7ed5\u8fc7\u9650\u5236|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"${IFS}\";http_client_body;nocase;fast_pattern;pcre:\"/(ls|cd|pwd|wget|curl|adduser|cat|passwd|chmod|echo|netstat|uname|sysctl|mysql|history|bash|useradd|ps|ifconfig|find|id|grep|awk|last|lsof|iptables|find|whoami|touch|ping)/Pi\";sid:2020072002;rev:1;)", "2019090235": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Courier\u8fde\u63a5|direction:in|level:action|service_name:Courier(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Courier smtp|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 \\[[-\\w_.]+\\] Courier Mail Server ([-\\w_.]+) ESMTP service ready\\r\\n/\";sid:2019090235;gid:0;)", "2019090203": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 smtpd\\r\\n502 [\\d.]+ Error: command not recognized\\r\\n/\";sid:2019090203;gid:0;)", "2018010032": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u89e3\u6790\u6f0f\u6d1e\u5229\u7528|tag:IIS\u6f0f\u6d1e|phase:exploit|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:IIS6.0\u89e3\u6790\u6f0f\u6d1e\u5229\u7528|attacker:src\";content:\"POST\";nocase;http_method;http_content_type;content:\"multipart/form-data\\;\";nocase;pcre:\"/[ ]+boundary=/iHR\";pkt_data;content:\"Content-Disposition:\";nocase;http_client_body;within:250;pcre:\"/[ ]*form-data\\;\\s*name=\\s*\"file\"\\;\\s*filename=\"[\\w\\d_-]+\\.(php|asp|jsp|aspx|asa|cer|jspf|jspx|php3|php4)\\;\\.[\\w\\d_-]+\"/iPR\";flow:to_server,established;gid:0;sid:2018010032;rev:1;)", "2020021019": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:SwiftMailer\u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u5199\u6587\u4ef6)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:SwiftMailer\u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Swift_Message\";content:\"Swift_MessageheaderSigners\";distance:1;content:\"Swift_Signers_DomainKeySigner\";distance:1;content:\"*_privateKey\";distance:1;content:\"-----BEGIN RSA PRIVATE KEY-----\";distance:1;sid:2020021019;rev:1;)", "2020051501": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Joomla \u672a\u6388\u6743\u521b\u5efa\u7528\u6237\u6f0f\u6d1e(CVE-2016-8870)|tag:\u6743\u9650\u7ed5\u8fc7|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:Joomla \u672a\u6388\u6743\u521b\u5efa\u7528\u6237\u6f0f\u6d1e(CVE-2016-8870)|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;flowbits:set, cve_2016_8870;content:\"/index.php/component/users/\";http_uri;content:\"task=user.register\";http_uri;distance:0;within:22;content:\"com_users\";http_client_body;sid:2020051501;rev:2;)", "2018010114": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|attacker:src\";content:\"extractvalue(\";nocase;http_header;pcre:\"/\\d, *concat\\(0x\\w\\w,/iH\";flow:to_server,established;gid:0;sid:2018010114;rev:1;)", "2020072806": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u89e3\u6790\u6f0f\u6d1e\u5229\u7528|tag:IIS\u6f0f\u6d1e|phase:exploit|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|success_by:resp_body_upload_success_str|o_msg:IIS 7.0/IIS 7.5/Nginx <=0.8.37 \u89e3\u6790\u6f0f\u6d1e\u63a2\u6d4b|attacker:src\";content:\"POST\";http_method;flow:to_server,established;http_content_type;content:\"multipart/form-data\\;\";content:\"boundary=\";pkt_data;content:\"Content-Disposition:\";nocase;http_client_body;pcre:\"/filename=\\\"[^.]+\\.[a-z]+\\/([^.\\/]+)?\\.php/PRi\";gid:0;sid:2020072806;rev:1;)", "2020050802": "alert tcp $HOME_NET 21 -> $EXTERNAL_NET any (msg:\"name:\u5c1d\u8bd5FTP\u533f\u540d\u767b\u5f55|tag:\u533f\u540d\u767b\u5f55|src:home_net|level:attack|phase:exploit|result:success|o_msg:\u5c1d\u8bd5FTP\u533f\u540d\u767b\u5f55|severity:1|attacker:dest\";flow:to_client, established;flowbits:isset, ftp_login_any;flags:P, A;content:\"230 \";depth:4;sid:2020050802;rev:2;)", "2018010003": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf|tag:SYN\u626b\u63cf|type:\u6307\u7eb9\u63a2\u6d4b|direction:in|phase:recon|src:external_net|dest:home_net|level:attack|severity:1|result:unknown|o_msg:syn\u626b\u63cf\";flow:to_server;flags:S,CE;threshold:type both, track by_src, count 2000, seconds 1;sid:2018010003;rev:1;)", "2020060802": "alert TCP $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ActiveMQ \u4fe1\u606f\u6cc4\u6f0f\u6f0f\u6d1e\uff08CVE-2017-15709\uff09|tag:\u4fe1\u606f\u6cc4\u9732|src:home_net|level:attack|phase:exploit|severity:1|result:success|o_msg:ActiveMQ \u4fe1\u606f\u6cc4\u6f0f\u6f0f\u6d1e\uff08CVE-2017-15709\uff09,\u6cc4\u9732\u5e94\u7528\u540d\u79f0\uff0cJVM\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4ee5\u53ca\u5185\u6838\u7248\u672c\u7b49\u4fe1\u606f|attacker:dest\";flow:established, from_server;content:\"ActiveMQ\";depth:100;content:\"JVM: \";distance:40;content:\"OS: \";distance:40;content:\"ProviderVersion\";distance:40;sid:2020060802;rev:1;)", "2020021009": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Laravel \u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u6267\u884c\u547d\u4ee4)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Laravel \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Illuminate\";content:\"Broadcasting\";distance:1;content:\"PendingBroadcast\";distance:1;content:\"*events\";distance:1;content:\"Illuminate\";distance:1;content:\"Notifications\";distance:1;content:\"ChannelManager\";distance:1;content:\"*app\";distance:1;content:\"*defaultChannel\";distance:1;content:\"*customCreators\";distance:1;sid:2020021009;rev:1;)", "2026930": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"GFydC1Qcm9jZX\";distance:0;fast_pattern;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026930;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2018010056": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MSSQL\u6ce8\u5165|tag:\u6ce8\u5165\u53d6\u6570\u636e\u5e93\u7528\u6237\u540d|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MSSQL\u6ce8\u5165 -  \u83b7\u53d6\u6570\u636e\u5e93\u7528\u6237\u540d|dest:home_net|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"and\";nocase;http_uri;pcre:\"/[ +]+\\d[=><][ +]*(quotename\\()?user\\)?/iUR\";flow:to_server,established;gid:0;sid:2018010056;rev:1;)", "2018010120": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|attacker:src\";content:\"union\";nocase;http_header;pcre:\"/[\\\\/*! ]+all[\\\\/*! ]+/select[\\\\/*! ]+/iHR\";flow:to_server,established;gid:0;sid:2018010120;rev:1;)", "2019090221": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:qmail\u8fde\u63a5|direction:in|level:action|service_name:Qmail|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728qmail|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 .* ESMTP\\r\\n214-Gentoo Linux qmail-([-\\w.]+)\\r\\n214 qmail home page: http://pobox\\.com/~djb/qmail\\.html\\r\\n/\";sid:2019090221;gid:0;)", "2019090071": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MSSQL\u8fde\u63a5|direction:in|level:action|service_name:MSSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728MSSQL|server:src\";flow:from_server,established;content:\"|04 01 00 25 00 00 01 00 00 00 15 00 06 01 00 1b 00 01 02 00 1c 00 01 03 00 1d 00 00 ff|\";depth:29;pcre:\"/^\\x04\\x01\\x00\\x25\\x00\\x00\\x01\\x00\\x00\\x00\\x15\\x00\\x06\\x01\\x00\\x1b\\x00\\x01\\x02\\x00\\x1c\\x00\\x01\\x03\\x00\\x1d\\x00\\x00\\xff(\\x08\\x00\\x00\\xc2|\\x08\\x00\\x01\\x37|\\x08\\x00\\x01\\x7e|\\x08\\x00\\x01\\x80|\\x08\\x00\\x02\\x14|\\x08\\x00\\x02\\x16|\\x08\\x00\\x02\\xf8|\\x08\\x00\\x02\\xfe|\\x08\\x00\\x03\\x32|\\x08\\x00\\x07\\xf7|\\x08\\x00\\x08\\x02|\\x08\\x00\\x08\\x07|\\x09\\x00\\x05\\x77|\\x09\\x00\\x05\\x7e|\\x09\\x00\\x07\\xff|\\x09\\x00\\x08\\x7a|\\x09\\x00\\x0b\\xe2|\\x09\\x00\\x0b\\xee|\\x09\\x00\\x0b\\xfc|\\x09\\x00\\x0c\\x01|\\x09\\x00\\x0c\\x05|\\x09\\x00\\x0c\\x08|\\x09\\x00\\x0f\\xc3|\\x09\\x00\\x0f\\xd5|\\x09\\x00\\x10\\x73|\\x09\\x00\\x13\\x88|\\x09\\x00\\x13\\xcd|\\x09\\x00\\x14\\xcc|\\x09\\x00(..)|\\x0a\\x00\\x04\\x33|\\x0a\\x00\\x06\\x40|\\x0a\\x00\\x06\\xfb|\\x0a\\x00\\x09\\xe3|\\x0a\\x00\\x0a\\xba|\\x0a\\x00\\x0f\\xa0|\\x0a\\x00\\x0f\\xe0|\\x0a\\x00\\x15\\x7c|\\x0a\\x00\\x15\\x88|\\x0a\\x00\\x15\\xa2|\\x0a\\x00\\x17\\x70|\\x0a\\x00\\x18\\x61|\\x0a\\x00(..)|\\x0a\\x32\\x06\\x40|\\x0a\\x32\\x06\\x51|\\x0a\\x32\\x09\\xc4|\\x0a\\x32\\x09\\xf6|\\x0a\\x32\\x0f\\xa0|\\x0a\\x32\\x10\\xb4|\\x0a\\x32\\x17\\x70|\\x0a\\x32(..)|\\x0b\\x00\\x08\\x34|\\x0b\\x00\\x0b\\xb8|\\x0b\\x00\\x0c\\x38|\\x0b\\x00\\x13\\xc2|\\x0b\\x00\\x17\\x84|\\x0b\\x00(..)|\\x0c\\x00\\x07\\xd0|\\x0c\\x00\\x10\\x04|\\x0c\\x00\\x10\\x75|\\x0c\\x00\\x13\\x88|\\x0c\\x00(..)|\\x0d\\x00\\x06\\x41|\\x0d\\x00\\x0f\\xa1|\\x0d\\x00(..)|\\x0e\\x00(..))/\";sid:2019090071;gid:0;)", "2020032107": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Apache axis2 \u4e0a\u4f20\u884c\u4e3a|tag:\u654f\u611f\u884c\u4e3a|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Apache axis2 \u4e0a\u4f20\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, axis2_upload;content:\"302\";http_stat_code;content:\"Location: upload?status=\";sid:2020032107;rev:1;)", "2018080191": "alert tcp $HOME_NET any -> $HOME_NET any (msg:\"name:\u6e17\u900f\u653b\u51fb|tag:ftp|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|gray:|result:unknown|o_msg:ftp\u670d\u52a1\u5668\u51c6\u5907\u5c31\u7eea\";dsize:10<>100;flow:to_client,established;content:\"220 \";depth:4;content:\"FTP\";distance:0;nocase;flowbits:set,TB_FTPBrute0;flowbits:noalert;sid:2018080191;rev:2;)", "2020060804": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Adobe ColdFusion \u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e(CVE-2010-2861)|tag:\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Adobe ColdFusion \u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e(CVE-2010-2861)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2010_2861;content:\"/CFIDE/administrator/enter.cfm\";http_uri;depth:40;content:\"locale=\";distance:0;within:20;http_uri;content:\"../\";distance:0;within:10;http_uri;content:\"%00\";distance:0;http_raw_uri;sid:2020060804;rev:1;)", "2020081410": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08tcp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u8bfb\u53d6\u6587\u4ef6/etc/passwd\";flow:established;content:\"root:x:0:0:root:/root:/bin/\";sid:2020081410;)", "20198000": "alert tcp $HOME_NET any -> $EXTERNAL_NET !3389 (msg:\"name:lcx\u7aef\u53e3\u6620\u5c04|tag:\u7aef\u53e3\u6620\u5c04|direction:lateral|type:infil|src:home_net|dest:external_net|level:attack|phase:post_exploit|severity:3|gray:|result:success|o_msg:\u53d1\u73b0\u9ed1\u5ba2\u5de5\u5177lcx.exe\u5c06\u5185\u7f51\u4e3b\u673a\u7aef\u53e3\u6620\u5c04\u5230\u5916\u7f51\";dsize:19;flow:established,to_server;flowbits:isset, lcx_syn;content:\"|03|\";depth:1;content:\"|E0|\";distance:4;within:1;sid:20198000;rev:1;)", "2019090172": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Hmail\u8fde\u63a5|direction:in|level:action|service_name:Hmail(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Hmail|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([-\\w_.]+) ESMTP[^\\r\\n]*\\r\\n211 DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY\\r\\n\\r\\n/\";sid:2019090172;gid:0;)", "2805946": "alert tcp $HOME_NET any -> $EXTERNAL_NET 3306 (msg:\"name:MySQL\u6587\u4ef6\u548c\u76ee\u5f55\u904d\u5386|tag:\u6ce8\u5165|src:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u904d\u5386MySQL\u6587\u4ef6\u548c\u76ee\u5f55|attacker:dest\";flow:to_server,established;content:\"|03|LOAD DATA INFILE |27|\";depth:19;pcre:\"/^[^\\x27]+?\\x27\\s*INTO TABLE/Ri\";sid:2805946;rev:1;)", "2019010060": "alert tcp $EXTERNAL_NET any -> $HOME_NET 7077 (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7spark submission gateway\u90e8\u7f72\u4ee3\u7801(Java)|tag:\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u672a\u6388\u6743\u7684\u653b\u51fb\u8005\u53ef\u80fd\u901a\u8fc7\u66b4\u9732\u5728\u516c\u7f51\u7684spark 7077\u7aef\u53e3\u6267\u884c\u4efb\u610f\u4ee3\u7801|attacker:src\";flow:established,to_server;content:\"|01 00 0a|\";depth:3;content:\"org.apache.spark.deploy.DeployMessages$HeartbeatF\";distance:10;content:\"Lorg/apache/spark/rpc/RpcEndpointRef\\;\";distance:0;content:\"spark\\://\";distance:50;gid:3;sid:2019010060;)", "2027096": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:RoR \u8def\u5f84\u7a7f\u8d8a\u4e0e\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6(CVE-2019-5418)|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:Ruby on Rails \u8def\u5f84\u7a7f\u8d8a\u4e0e\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff08CVE-2019-5418\uff09|attacker:src\";flow:established,to_server;http_accept;content:\"../\";metadata:former_category WEB_SPECIFIC_APPS;reference:url,github.com/mpgn/CVE-2019-5418;classtype:web-application-attack;sid:2027096;rev:2;metadata:attack_target Web_Server, deployment Datacenter, cve 2019_5418, signature_severity Audit, created_at 2019_03_18, updated_at 2019_03_19;)", "2020060810": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ActiveMQ\u7269\u7406\u8def\u5f84\u6cc4\u6f0f\u6f0f\u6d1e|tag:\u4fe1\u606f\u6cc4\u9732|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:ActiveMQ\u7269\u7406\u8def\u5f84\u6cc4\u6f0f\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:dest\";flow:from_server,established;flowbits:isset, activemq_pwd;content:\"500\";http_stat_code;http_response_line;content:\"(No such file or directory)\";pkt_data;sid:2020060810;rev:1;)", "2020052518": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528burpsuite\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|tool:burp|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u4f7f\u7528burp\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"burpcollaborator.net\";http_client_body;fast_pattern;sid:2020052518;rev:1;)", "2019090038": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:VNC\u8fde\u63a5|direction:in|level:action|service_name:VNC|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728VNC|server:src\";flow:from_server,established;content:\"RFB\";depth:3;pcre:\"/^RFB 000\\.000\\n$/\";sid:2019090038;gid:0;)", "2020061802": "alert tcp $HOME_NET 3389 -> $EXTERNAL_NET any (msg:\"name:\u7206\u7834 windows \u8fdc\u7a0b\u684c\u9762\u670d\u52a1|tag:\u7206\u7834\u7834\u89e3|src:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u653b\u51fb\u8005\u7206\u7834 windows \u8fdc\u7a0b\u684c\u9762\u670d\u52a1\uff0c\u5c1d\u8bd5\u767b\u9646\u8fdc\u7a0b\u684c\u9762|attacker:dest\";flow:established, from_server;flowbits:isset, rdp_blasting;flags:AR, 12;threshold:type both,track by_dst,count 30, seconds 5;sid:2020061802;rev:1;)", "2835222": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ETPRO EXPLOIT Huawei Remote Command Execution - Outbound (CVE-2017-17215)|tag:TEST|direction:in|dest:external_net|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:attack_out|result:success|gray:true|o_msg:BBBBB\";flow:to_server,established;content:\"POST\";http_method;content:\"/ctrlt/DeviceUpgrade_1\";http_uri;fast_pattern;content:\"|3c|NewStatusURL|3e|\";http_client_body;content:\"|24 28|\";http_client_body;within:3;content:\"NewStatusURL|3e|\";http_client_body;distance:0;content:\"|3c|NewDownloadURL|3e|\";http_client_body;distance:0;content:\"|24 28|\";http_client_body;within:3;content:\"NewDownloadURL|3e|\";http_client_body;distance:0;metadata:former_category EXPLOIT;reference:cve,2017-17215;classtype:trojan-activity;sid:2835222;rev:1;metadata:deployment Perimeter, cve 2017_17215, signatrue_severity Major, created_at 2019_03_06, performance_impact Low, updated_at 2019_03_06;)", "2020081905": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u8fbeOA\u6743\u9650\u63a7\u5236\u6587\u4ef6\u63a2\u6d4b|tag:\u6587\u4ef6\u63a2\u6d4b|dest:home_net|level:attack|phase:exploit|severity:1|result:unknown|o_msg:\u901a\u8fbeOA\u6743\u9650\u63a7\u5236\u6587\u4ef6\u63a2\u6d4b|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"GET\";http_method;content:\"/inc/auth.inc.php\";http_uri;depth:30;sid:2020081905;rev:1;)", "2020051907": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring SpEL\u8868\u8fbe\u5f0f\u4ee3\u7801\u6ce8\u5165|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Spring SpEL\u8868\u8fbe\u5f0f\u4ee3\u7801\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"#this.getClass().forName(\";http_client_body;content:\"java.lang.\";http_client_body;distance:0;pcre:\"/Runtime|ProcessBuilder/PRi\";sid:2020051907;rev:1;)", "2020081906": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u8fbeOA\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u901a\u8fbeOA\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, tongda_oa_afd_upload;content:\"POST\";http_method;content:\"/general/data_center/utils/upload.php\";http_uri;depth:60;content:\"action=upload\";http_uri;distance:0;content:\"repkid=\";http_uri;offset:38;pcre:\"/(<.*>)|(\\.\\.\\/)/URi\";http_content_type;content:\"boundary=\";sid:2020081906;rev:1;)", "2019000006": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u8681\u5251\u8fde\u63a5webshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:unknown|o_msg:\u8681\u5251\u8fde\u63a5webshell|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"%40vav_frg(%22qvfcynl_reebef%22%2C%20%220%22)%3B%40frg_gvzr_yvzvg(0)%3B\";http_client_body;content:\"%40eval(%40str_rot13\";nocase;http_client_body;flowbits:set, first_packet_send;flowbits:noalert;sid:2019000006;)", "2008424": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (CFS_DOWNLOAD)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| CFS_DOWNLOAD\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008424;classtype:trojan-activity;sid:2008424;rev:9;)", "2019010023": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Bluehero\u7684\u6f0f\u6d1e\u540e\u5c1d\u8bd5\u5229\u7528\u884c\u4e3a|tag:\u8815\u866b\u653b\u51fb|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:Bluehero\u611f\u67d3\u673a\u5668\u7684\u968f\u673a\u653b\u51fb\u884c\u4e3a|attacker:src\";flow:to_server,established;content:\"/hydra.php?\";http_uri;nocase;content:\"xcmd=cmd.exe\";http_uri;nocase;gid:3;sid:2019010023;rev:1;)", "2020010020": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:XML\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165|tag:XML\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:XML\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:!\"boundary=\";pkt_data;content:\"encoding=|22|UTF-7|22|\";http_client_body;distance:0;content:\"+ADwAIQ-DOCTYPE\";http_client_body;distance:0;content:\"+ADwAIQ-ENTITY\";http_client_body;distance:0;content:\"SYSTEM +ACI-\";http_client_body;distance:0;pcre:\"/(file|http|https|php|expect)\\:\\/\\//PRi\";sid:2020010020;rev:1;)", "2801679": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Jboss\u6f0f\u6d1e\u5229\u7528|tag:Jboss\u6f0f\u6d1e|dest:home_net|level:attack|severity:2|phase:exploit|result:unknown|o_msg:\u672c\u8d28\u4e0a\u662fPostgres Plus Advanced Server\u7684\u6f0f\u6d1e,\u4f46\u662f\u901a\u8fc7Jboss\u6765\u505a\u5229\u7528|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"/jmx-console/\";http_uri;content:\"String&arg0=\";http_uri;pcre:\"/String&arg0=(%20|\\s*)import java.io/iU\";sid:2801679;)", "2020062818": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668\u6210\u529f(Stowaway-\u6b63\u5411\u4ee3\u7406)|tag:\u653b\u51fb\u4ee3\u7406|tool:Stowaway|direction:in|src:home_net|dest:external_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668\u6210\u529f(Stowaway-\u6b63\u5411\u4ee3\u7406)|attacker:dest\";flow:established, from_server;flowbits:isset, Stowaway_link_type_2_2;content:\"|30 30 30 30 30 30 30 30 30 31 00 00 00 00 00 00|\";offset:16;depth:16;content:\"|00 00 00 30 30 30 30 30 30 30 30 30 30 |\";distance:64;within:13;sid:2020062818;rev:1;)", "2020060812": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fc7PUT\u65b9\u6cd5\u4e0a\u4f20webshell|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u901a\u8fc7PUT\u65b9\u6cd5\u4e0a\u4f20webshell|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, put_update;content:\"204\";http_stat_code;sid:2020060812;rev:1;)", "2019030012": "alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u8fde\u63a5\u5230\u516c\u7f51frp\u670d\u52a1\u5668(via kcp)|tag:tunnel|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|tool:frp|result:unknown|o_msg:\u5c1d\u8bd5\u4e0e\u516c\u7f51frp\u670d\u52a1\u5668\u5efa\u7acbfrp\u96a7\u9053\uff0c\u53ef\u7528\u6765\u8fdb\u884c\u5185\u7f51\u7a7f\u900f\";dsize:<500;content:\"|00 01 00 01 00 00 00 01 00 00 00 00|\";content:\"{\\\"version\\\"\\:\\\"\";distance:0;content:\"\\\",\\\"hostname\\\"\\:\\\"\";distance:0;content:\"\\\",\\\"os\\\"\\:\\\"\";distance:0;content:\"\\\",\\\"arch\\\"\\:\\\"\";distance:0;content:\"\\\",\\\"user\\\"\\:\\\"\";distance:0;content:\"\\\",\\\"privilege_key\\\"\\:\\\"\";distance:0;content:\"\\\",\\\"timestamp\\\"\\:\";distance:0;content:\",\\\"run_id\\\"\\:\\\"\";distance:0;content:\"\\\",\\\"pool_count\\\"\\:\";distance:0;content:\"}\";distance:0;isdataat:!1,relative;flowbits:set,frp_state_kcp;flowbits:noalert;sid:2019030012;)", "2019070015": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:weblogic\u6f0f\u6d1e\u5229\u7528|tag:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|direction:out|src:home_net|dest:external_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:attack_out|result:unknown|o_msg:CVE-2017-10271 Payload\u653b\u51fb\u7cfb\u7edf[1]\";flow:to_server,established;content:\"POST\";http_method;content:\"class=\\\"java.io.PrintWriter\\\">\";http_client_body;content:\"<string>servers/\";http_client_body;pcre:\"/<string>servers\\/([a-zA-Z0-9_-]+\\/)+_WL_internal\\/bea_wls_internal\\/([a-zA-Z0-9_-]+\\/)+[0-9a-z]+\\.jsp<\\/string>/P\";flowbits:set, weblogic_write_file;gid:0;sid:2019070015;rev:1;)", "2832206": "alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Cobalt Strike\u6728\u9a6cSSL\u8bc1\u4e66\u4f20\u8f93\u884c\u4e3a|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|dest:home_net|src:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike\u6728\u9a6cSSL\u8bc1\u4e66\u4f20\u8f93\u884c\u4e3a\";flow:established,from_server;tls_cert_subject;content:\"CN=lidorubs.com\";nocase;isdataat:!1,relative;metadata:former_category TROJAN;reference:md5,429e1533c6a96a27cdf1e3bed7bb0259;classtype:trojan-activity;sid:2832206;rev:1;metadata:attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2018_08_16, malware_family Cobalt_Strike, performance_impact Moderate, updated_at 2019_09_28;)", "2018030012": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6b63\u5e38jsp\u8bf7\u6c42|tag:jsp|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:2|result:unknown|o_msg:\u6b63\u5e38JSP\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";content:\"POST\";nocase;http_method;content:\".jsp\";nocase;http_uri;pcre:\"/\\.jsp$/iU\";flow:to_server,established;flowbits:set,jsp_req;flowbits:noalert;gid:0;sid:2018030012;rev:1;)", "2020032608": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Discuz <= 3.4 \u540e\u53f0uc_center\u4ee3\u7801\u6267\u884c|tag:\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Discuz <= 3.4 \u540e\u53f0uc_center\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, discuz_3_4_sqli;content:\"POST\";http_method;content:\"/upload/admin.php\";http_uri;content:\"action=setting\";http_uri;distance:1;content:\"name=\\\"settingnew[uc][api]\\\"\";http_client_body;content:\"')\\;\";http_client_body;distance:0;within:120;sid:2020032608;rev:1;)", "2020052601": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:FreeMarker\u6a21\u677f\u6ce8\u5165|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|type:exploit|severity:3|result:unknown|o_msg:\u653b\u51fb\u8005\u5229\u7528FreeMarker\u6a21\u677f\u5f15\u64ce\uff0c\u5b9e\u73b0\u4ee3\u7801\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"<\";http_client_body;content:\"#\";http_client_body;distance:0;within:10;content:\"freemarker.template.utility.Execute\";http_client_body;distance:0;sid:2020052601;rev:1;)", "2019090310": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Oracle-tns\u8fde\u63a5|direction:in|level:action|service_name:Oracle-tns|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728Oracle-tns|server:src\";flow:from_server,established;content:\"|00|\";depth:1;pcre:\"/^\\0.\\0\\0[\\x02\\x04]\\0\\0\\0.*TNSLSNR for ([-.+/ \\w]{2,24}): Version ([-\\d.]+) - Production/\";sid:2019090310;gid:0;)", "2020000081": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u8c6a\u6a2a!cmd\u540d\u5b57\u7684\u6728\u9a6c|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:URI\u5185\u5bb9\u4e3acmd|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, http_uri_cmd;content:\"GET\";http_method;content:\"/cmd.\";http_uri;nocase;pcre:\"/cmd\\.(asp|aspx|jsp|jspx|php)\\?cmd=/iRU\";noalert;sid:2020000081;rev:2;)", "2018030007": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:webshell\u5c1d\u8bd5\u8fde\u63a5|tool:\u83dc\u5200|failed_by:http_status_3XX,http_status_4XX|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u83dc\u5200\u901a\u7528\u8bf7\u6c42asp|attacker:src\";content:\"POST\";nocase;http_method;content:\".asp\";nocase;http_uri;pcre:\"/\\.(asp|aspx|asp\\;\\.(jpg|gif|png|jpgn))$/iU\";content:\"%u0045%xec%ute\";nocase;http_client_body;within:24;flowbits:set, caidao_request;flow:to_server,established;gid:0;sid:2018030007;rev:1;)", "2019010063": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7spark REST api\u90e8\u7f72\u4ee3\u7801(Python)|tag:\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u672a\u6388\u6743\u7684\u653b\u51fb\u8005\u53ef\u80fd\u901a\u8fc7\u672a\u6b63\u786e\u914d\u7f6eACL\u7684spark REST API\u8fdc\u7a0b\u6267\u884c\u4efb\u610f\u4ee3\u7801|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/v1/submissions/create\";isdataat:!1,relative;http_uri;content:\"\\\"action\\\"\";http_client_body;content:\"\\\"CreateSubmissionRequest\\\"\";within:30;http_client_body;content:\"\\\"spark.submit.pyFiles\\\"\";http_client_body;flowbits:set,spark_state_access;gid:3;sid:2019010063;)", "2008361": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (Accessing)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| Accessing|0d 0a|\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008361;classtype:trojan-activity;sid:2008361;rev:7;)", "2020080317": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Metasploit \u8fde\u63a5(http)|tag:\u53cd\u5f39shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:Metasploit \u8fde\u63a5(windows/x64/meterpreter/reverse_http)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;flowbits:set, win_linux_x64_meterpreter_reverse_http;noalert;content:\"GET\";http_method;content:\"/\";http_uri;pcre:\"/^[a-zA-Z0-9_\\-]+\\/$/UR\";http_header_names;content:\"|0d 0a|Cache-Control\";depth:15;content:\"|0d 0a|Connection|0d 0a|Pragma|0d 0a|User-Agent|0d 0a|Host|0d 0a 0d 0a|\";distance:0;within:42;pkt_data;sid:2020080317;)", "2020070310": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Thinkphp \u914d\u7f6e\u4fe1\u606f\u6cc4\u9732|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Thinkphp \u914d\u7f6e\u4fe1\u606f\u6cc4\u9732|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"s=.|7c|think\\\\config/get\";http_uri;depth:200;content:\"name=\";http_uri;depth:200;sid:2020070310;rev:1;)", "2019060010": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"PHPSESSID=\";http_cookie;pcre:\"/[a-fA-F0-9]{32}/CR\";noalert;flowbits:isset, bingxie_webshell;flowbits:set, bingxie_webshell_step2;content:\"a\";nocase;http_server_body;within:16;pcre:\"/^([a-f0-9A-F]{16})$/Q\";isdataat:!1,relative;sid:2019060010;gid:0;rev:1;)", "2020062201": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:tomcat\u5185\u5b58webshell|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:tomcat\u5185\u5b58\u9a6c\u6d4b\u8bd5webshell|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;noalert;flowbits:set, webshell_nofile_webshell;content:\"=\";http_uri;pcre:\"/^(ls|cd|pwd|wget|curl|adduser|cat|passwd|chmod|echo|netstat|uname|sysctl|mysql|history|bash|useradd|ps|ifconfig|find|id|grep|awk|last|lsof|iptables|find|whoami|touch|ping)/URi\";sid:2020062201;rev:1;)", "2020071441": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell\u901a\u8baf|tag:webshell|tool:\u51b0\u874e|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u7591\u4f3c\u51b0\u874ewebshell\u901a\u8baf|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;flowbits:set, bingxie_send_message_1;content:\"POST\";http_method;content:\".\";http_uri;pcre:\"/^(asp|jsp|jspx|aspx|php)/URi\";pcre:\"/(ASP\\.NET_SessionId=)|(PHPSESSID=)|(JSESSIONID=)/C\";http_content_len;byte_test:0,>=,1000,0,string,dec;pkt_data;http_accept;content:\"text/html, image/gif, image/jpeg, *\\; q=.2, */*\\; q=.2\";pkt_data;http_content_type;content:\"application/x-www-form-urlencoded\";pkt_data;pcre:\"/^([A-Za-z0-9+\\/]{4}){200,}([A-Za-z0-9+\\/]{4}|[A-Za-z0-9+\\/]{3}=|[A-Za-z0-9+\\/]{2}==)$/P\";sid:2020071441;gid:0;rev:1;)", "2019090179": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Hmail\u8fde\u63a5|direction:in|level:action|service_name:Hmail(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Hmail|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK XXX Private Mail server\\r\\n-ERR Invalid command in current state\\.\\r\\n/\";sid:2019090179;gid:0;)", "2020072912": "alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528\u5411\u65e5\u8475\u8fdc\u63a7|tag:\u5411\u65e5\u8475\u8fdc\u63a7|level:attack|tool:\u5411\u65e5\u8475\u8fdc\u63a7|severity:1|src:home_net|phase:exploit|type:rat|result:unknown|o_msg:\u4f7f\u7528\u5411\u65e5\u8475\u8fdc\u63a7|attacker:dest\";dsize:30;flow:to_server;flowbits:set, sunlogin_1;noalert;content:\"|6f 72 61 79|\";depth:4;content:\"|03 04 00 18 04 00|\";distance:0;within:6;sid:2020072912;rev:2;)", "2020070214": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;flowbits:set, tp_5_23_rce;content:\"_method=__construct\";http_client_body;content:\"filter[]=\";http_client_body;sid:2020070214;rev:1;)", "2018010070": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6d4b\u8bd5\u662f\u5426\u5b58\u5728PUT\u6f0f\u6d1e|tag:\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:1|phase:recon|result:unknown|failed_by:http_status_3XX,http_status_4XX|o_msg:\u68c0\u6d4b\u5230\u6d4b\u8bd5\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728PUT\u6f0f\u6d1e|attacker:src\";content:\"PUT\";nocase;http_method;content:\".\";http_uri;within:1000;pcre:\"/[\\w\\d]+\\.(txt|jpg|docx|exe|tmp|gif|swf|log|)$/iU\";flow:to_server,established;gid:0;sid:2018010070;rev:1;)", "2826659": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike \u53cd\u8fde\u8bf7\u6c42(APT19\u66fe\u7528\u8fc7\u76f8\u540c\u7684\u653b\u51fb\u65b9\u6cd5)|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike \u53cd\u8fde\u8bf7\u6c42(APT19\u66fe\u7528\u8fc7\u76f8\u540c\u7684\u653b\u51fb\u65b9\u6cd5)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;urilen:22;content:\"/IE9CompatViewList.xml\";http_uri;content:\"User-Agent|3a 20|Mozilla/5.0 (compatible|3b| MSIE 9.0|3b| Windows NT 6.1|3b| Trident/5.0|3b| FunWebProducts|3b| IE0006_ver1|3b|EN_GB)|0d 0a|Host\";http_header;depth:116;fast_pattern;http_header_names;content:!\"Referer|0d 0a|\";content:!\"Accept-\";metadata:former_category MALWARE;reference:md5,3a1dca21bfe72368f2dd46eb4d9b48c4;reference:url,www.fireeye.com/blog/threat-research/2017/06/phished-at-the-request-of-counsel.html;classtype:trojan-activity;sid:2826659;rev:3;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2017_06_07, performance_impact Moderate, updated_at 2020_03_11;)", "2019080030": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:abptts\u96a7\u9053\u521d\u59cb\u5316\u6210\u529f|tag:tunnel|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|tool:abptts|type:infil|result:success|o_msg:\u901a\u8fc7abptts\u7684webshell\u8f6c\u53d1tcp\u6d41\u91cf|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;file_data;content:!\"<!doctype html>\";nocase;content:\"<html>\";depth:6;content:\"<html>|0d 0a 09|<head>|0d 0a 09 09|<title>System Status API</title>|0d 0a 09|</head>|0d 0a 09|<body>|0d 0a|<pre>\";content:\"</pre>|0d 0a 09|</body>|0d 0a|</html>\";pcre:\"/<pre>\\r\\n[a-f0-9]+[^\\w][a-fA-F0-9]+\\r\\n<\\/pre>/\";flowbits:isset,state_abptts_init;sid:2019080030;)", "2019030011": "alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528ngrok\u8fdb\u884c\u5185\u7f51\u7a7f\u900f|tag:tunnel|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|tool:ngrok|result:unknown|o_msg:\u5c1d\u8bd5\u4e0e\u516c\u7f51ngrok\u670d\u52a1\u5668\u5efa\u7acb\u63a7\u5236\u8fde\u63a5\uff0c\u53ef\u7528\u6765\u8fdb\u884c\u5185\u7f51\u7a7f\u900f\";flow:established,to_server;tls_sni;content:\"tunnel.us.ngrok.com\";flowbits:set,ngrok_state_findsni;flowbits:noalert;sid:2019030011;)", "2019060015": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"PHPSESSID=\";http_cookie;pcre:\"/[a-fA-F0-9]{32}/CR\";noalert;flowbits:isset, bingxie_webshell;flowbits:set, bingxie_webshell_step2;content:\"e\";nocase;http_server_body;within:16;pcre:\"/^([a-f0-9A-F]{16})$/Q\";isdataat:!1,relative;sid:2019060015;gid:0;rev:1;)", "2018120502": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:KonniX\u540e\u95e8\u6728\u9a6c|type:rat|tag:KonniX|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cKonniX\u4e0a\u7ebf\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;content:\"upload.php\";http_uri;isdataat:!1,relative;content:\"id=\";http_client_body;depth:3;content:\"&title=\";http_client_body;distance:8;within:7;content:\"&passwd=\";http_client_body;distance:0;content:\" OS is :\";http_client_body;distance:0;sid:2018120502;rev:1;)", "2020070323": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cfWebshell\u540e\u95e8|tag:\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:\u626b\u63cfWebshell\u540e\u95e8|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\".php\";http_uri;fast_pattern;http_content_type;content:!\"boundary=\";pkt_data;content:!\"<?xml\";http_client_body;content:\"<?\";http_client_body;pcre:\"/echo|eval|system|phpinfo|md5|die|assert|call_user_func|print|file_put_contents/PRi\";sid:2020070323;rev:1;)", "2020032402": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7phpmyadmin\u67e5\u8be2mysql\u5b89\u5168\u914d\u7f6e|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5c1d\u8bd5\u901a\u8fc7phpmyadmin\u67e5\u8be2mysql\u5b89\u5168\u914d\u7f6e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, phpmyadmin_exec_sql_success;content:\"POST\";http_method;content:\"/import.php\";http_uri;content:\"sql_query=\";http_client_body;content:\"show+global+variables+like+\";http_client_body;distance:0;nocase;content:\"'%25secure%25\";http_client_body;distance:0;within:15;nocase;sid:2020032402;rev:1;)", "2020050704": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u63a2\u6d4b\u670d\u52a1\u5668\u652f\u6301\u7684HTTP\u8bf7\u6c42\u65b9\u6cd5|tag:\u4fe1\u606f\u6cc4\u9732|direction:in|src:external_net|dest:home_net|level:action|result:success|o_msg:\u63a2\u6d4b\u670d\u52a1\u5668\u652f\u6301\u7684HTTP\u8bf7\u6c42\u65b9\u6cd5|severity:2|failed_by:http_status_3XX,http_status_4XX\";flow:to_client, established;flowbits:isset, get_methods;content:\"Public\";http_header;content:\"Allow\";http_header;sid:2020050704;rev:2;)", "2019090160": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:LDAP\u8fde\u63a5|direction:in|level:action|service_name:LDAP|service_class:auth|severity:1|result:unknown|o_msg:\u5b58\u5728LDAP|server:src\";flow:from_server,established;content:\"02|02 01 00|\";depth:5;pcre:\"/02\\x02\\x01\\x00x-\\n\\x01\\x02\\x04\\x00\\x04\\x0edecoding error\\x8a\\x16[\\d.]+/\";sid:2019090160;gid:0;)", "2019030008": "alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528ngrok\u8fdb\u884c\u5185\u7f51\u7a7f\u900f|tag:tunnel|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|tool:ngrok|result:unknown|o_msg:\u5c1d\u8bd5\u4e0e\u516c\u7f51ngrok\u670d\u52a1\u5668\u5efa\u7acb\u63a7\u5236\u8fde\u63a5\uff0c\u53ef\u7528\u6765\u8fdb\u884c\u5185\u7f51\u7a7f\u900f\";flow:established,to_server;tls_sni;content:\"tunnel.ap.ngrok.com\";flowbits:set,ngrok_state_findsni;flowbits:noalert;sid:2019030008;)", "2020080504": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Metasploit \u8fde\u63a5(tcp)|tag:\u53cd\u5f39shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:Metasploit \u8fde\u63a5(windows/meterpreter/bind_tcp)\";flow:to_server, established;flowbits:isset, msf_bind_response;content:\"MZ\";depth:2;content:\"This program cannot be run in DOS mode.\";distance:0;within:200;sid:2020080504;)", "2019010089": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7591\u4f3c\u5305\u542bJSP\u6728\u9a6c|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u7591\u4f3c\u5305\u542bJSP\u6728\u9a6c|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"n\";http_client_body;pcre:\"/UnVudGltZS5nZXRSdW50aW1lKCkuZXhlYw|dW50aW1lLmdldFJ1bnRpbWUoKS5leGVj|bnRpbWUuZ2V0UnVudGltZSgpLmV4ZWM/P\";distance:0;sid:2019010089;rev:1;)", "2025795": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT Generic system shell command to php base64 encoded Remote Code Execution 1|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"c3lzdGVtKCIgcGhw\";metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025795;rev:2;metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2020022603": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:joomscan\u626b\u63cf|tag:scan|dest:home_net|level:attack|phase:recon|severity:3|result:unknown|o_msg:joomscan\u626b\u63cf|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"HEAD\";http_method;content:\"/joomla.\";http_uri;nocase;threshold:type both,track by_src,count 10,seconds 10;sid:2020022603;)", "2019000027": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7591\u4f3c\u5229\u7528Spring\u6f0f\u6d1e(CVE-2018-1273)|tag:spring|dest:home_net|level:suspicious|phase:exploit|severity:2|gray:true|result:unknown|failed_by:http_status_3XX,http_status_4XX|o_msg:\u5c06\u6076\u610f\u7684SpEL\u8868\u8fbe\u5f0f\u4f5c\u4e3akey\u7684\u4e00\u90e8\u5206\u53d1\u9001\u5bfc\u81f4RCE|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/users?\";http_uri;content:\"[\";http_client_body;pcre:\"/.+java\\.lang\\.Runtime\\]/PR\";sid:2019000027;)", "2019090155": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Nortel CallPilot LDAP\u8fde\u63a5|direction:in|level:action|service_name:Nortel CallPilot LDAP|service_class:auth|severity:1|result:unknown|o_msg:\u5b58\u5728Nortel CallPilot LDAP|server:src\";flow:from_server,established;content:\"0|1a 02 01 01|a\";depth:6;pcre:\"/^0\\x1a\\x02\\x01\\x01a\\x15\\n\\x01\\0\\x04\\0\\x04\\x0eanonymous bind/\";sid:2019090155;gid:0;)", "2020070303": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;flowbits:isset, bingxie_webshell_2;noalert;flowbits:unset, bingxie_webshell_2;flowbits:set, bingxie_webshell_3;content:\".\";http_uri;pcre:\"/\\.(php|jsp|asp|aspx|jspx)\\?[\\w.$@!%_-]+=\\d{2,3}/Ui\";content:\"|0d 0a|Connection: keep-alive|0d 0a|\";http_header;http_header_names;content:\"|0d 0a|Connection|0d 0a 0d 0a|\";pkt_data;sid:2020070303;gid:0;rev:1;)", "2008208": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (TestAgent)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| TestAgent|0d 0a|\";http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008208;classtype:trojan-activity;sid:2008208;rev:9;)", "2019090131": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK Dovecot at ([-\\w_.]+) ready\\.\\r\\n/\";sid:2019090131;gid:0;)", "2020062314": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Dubbo \u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(resin\u94fe-dubbo\u534f\u8bae)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Apache Dubbo \u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(resin\u94fe-dubbo\u534f\u8bae)|attacker:src\";flow:established, to_server;content:\"|da bb|\";depth:2;fast_pattern;content:\"com.caucho.naming.QName\";distance:0;content:\"javax.naming.spi.ContinuationDirContext\";distance:0;content:\"javax.naming.CannotProceedException\";distance:0;sid:2020062314;rev:1;)", "2020051502": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Joomla \u672a\u6388\u6743\u521b\u5efa\u7528\u6237\u6f0f\u6d1e(CVE-2016-8870)|tag:\u6743\u9650\u7ed5\u8fc7|dest:home_net|level:attack|phase:exploit|result:success|o_msg:Joomla \u672a\u6388\u6743\u521b\u5efa\u7528\u6237\u6f0f\u6d1e(CVE-2016-8870)|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2016_8870;content:\"303\";http_stat_code;content:\"Location: \";http_header;content:\"option=com_users&view=registration\";http_header;distance:0;sid:2020051502;rev:2;)", "2019002": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u7591\u4f3cwebshell\u8bbf\u95ee|tag:webshell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:2|result:success|type:shell|o_msg:webshell\u8fde\u63a5\";flow:established,to_server;content:\"Host Name|3a|\";content:\"OS Name|3a|\";content:\"OS Version|3a|\";content:\"OS Manufacturer|3a|\";content:\"Microsoft Corporation\";distance:0;content:\"OS Configuration|3a|\";content:\"OS Build Type|3a|\";content:\"Registered Owner|3a|\";content:\"Registered Organization|3a|\";content:\"Product ID|3a|\";content:\"Original Install Date|3a|\";content:\"System Up Time|3a|\";content:\"System Manufacturer|3a|\";content:\"System Model|3a|\";content:\"System type|3a|\";content:\"Processor|28|s|29 3a|\";reference:md5,a22af4fc7fe011069704a15296634ca6;classtype:trojan-activity;sid:2019002;rev:1;metadata:created_at 2014_08_25, updated_at 2014_08_25;)", "2025802": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:\u626b\u63cf|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:recon|result:unknown|o_msg:\u626b\u63cf\u53ef\u80fd\u5b58\u5728\u7684\u9ed1\u5ba2\u540e\u95e8\";flow:established,to_server;content:\"ZpbGVfcHV0X2NvbnRlbnRz\";http_header;metadata:former_category EXPLOIT;classtype:attempted-user;flowbits:set,webshell.scan;sid:2025802;rev:2;metadata:affected_product Web_Server_Applications, affected_product PHP, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2026761": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ET POLICY External IP Address Lookup via vtransmit .com|tag:TEST|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:dest\";flow:to_server,established;content:\"GET\";http_method;content:\"/getip.php\";http_uri;depth:10;isdataat:!1,relative;content:\"vtransmit.com\";http_host;depth:13;fast_pattern;isdataat:!1,relative;metadata:former_category POLICY;classtype:policy-violation;sid:2026761;rev:2;metadata:attack_target Client_and_Server, deployment Perimeter, tag IP_address_lookup_website, signatrue_severity Minor, created_at 2019_01_07, performance_impact Low, updated_at 2019_01_07;)", "2834442": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ETPRO POLICY External IP Address Lookup via api .sypexgeo .net|tag:TEST|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:dest\";flow:to_server,established;content:\"GET\";http_method;content:\"api.sypexgeo.net\";http_host;depth:16;isdataat:!1,relative;fast_pattern;http_header_names;content:!\"Referer\";metadata:former_category POLICY;classtype:policy-violation;sid:2834442;rev:2;metadata:affected_product Any, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Audit, created_at 2019_01_16, performance_impact Low, updated_at 2019_01_16;)", "2020022606": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u8bfb\u53d6/etc/issue|tag:\u6267\u884c\u547d\u4ee4|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u8bfb\u53d6/etc/issue|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"|20|Ubuntu|20|\";http_server_body;pcre:\"/\\d{1,2}\\.\\d{1,2}\\.\\d{1,2} /QR\";content:\"LTS|20|\";distance:0;http_server_body;content:\"|5c 6e 20 5c 6c 0a 0a|\";distance:0;http_server_body;sid:2020022606;rev:1;)", "2020021020": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Symfony\u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u5199\u6587\u4ef6)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Symfony\u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Symfony\";content:\"Component\";distance:1;content:\"HttpKernel\";distance:1;content:\"Profiler\";distance:1;content:\"Profile\";distance:1;content:\"Profiletoken\";distance:1;content:\"TableStylehorizontalBorderChar\";distance:1;content:\"TableStyleverticalBorderChar\";distance:1;sid:2020021020;rev:1;)", "2018010055": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MSSQL\u6ce8\u5165|tag:\u6ce8\u5165\u6dfb\u52a0\u7528\u6237|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MSSQL\u6ce8\u5165 -  \u6dfb\u52a0\u767b\u5f55\u7528\u6237|dest:home_net|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"\\;exec\";nocase;http_uri;pcre:\"/[ +]+master.(dbo)?.sp_addlogin[ +]*/iUR\";flow:to_server,established;gid:0;sid:2018010055;rev:1;)", "2018081319": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u6267\u884c\u6216\u8005\u6253\u5f00\u6587\u4ef6\";flow:from_server,established;content:\"EXEC \";depth:5;nocase;content:\"|3A 5C|\";distance:1;within:2;flowbits:isset,TB_ZxShell_2;sid:2018081319;rev:1;)", "2020052412": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:reGeorg\u8fde\u63a5\u6210\u529f|tag:\u653b\u51fb\u4ee3\u7406|tool:reGeorg|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u5185\u7f51\u6e17\u900f\u65f6\u7684\u5e38\u7528\u5de5\u5177reGeorg|failed_by:http_status_3XX,http_status_4XX\";flowbits:isset, regeory_froward;flow:from_server,established;content:\"200\";http_stat_code;content:\"X-STATUS: FAIL\";http_header;content:\"X-ERROR: No more running, close now\";http_header;sid:2020052412;rev:1;)", "2020021303": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6d4f\u89c8Web\u76ee\u5f55|tag:\u76ee\u5f55\u904d\u5386|direction:in|dest:home_net|src:external_net|level:action|severity:0|result:success|o_msg:\u68c0\u6d4b\u5230\u76ee\u5f55\u904d\u5386\u884c\u4e3a(other)|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"<html>|0a|<head>|0a|<title>Directory Listing For\";http_server_body;nocase;offset:0;depth:100;gid:0;sid:2020021303;)", "2020062808": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668\u6210\u529f(Venom-\u53cd\u5411\u4ee3\u7406)|tag:\u653b\u51fb\u4ee3\u7406|tool:Venom|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668\u6210\u529f(Venom-\u53cd\u5411\u4ee3\u7406)\";flow:established, from_server;flowbits:isset, Venom_link_type_1;content:\"ABCDEFGH\";depth:8;content:\"VCMD\";distance:0;within:4;content:\"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|\";distance:0;within:16;sid:2020062808;rev:1;)", "2020010208": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(Jdk7u21)|tag:\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(Jdk7u21)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"Gadgets.java\";http_client_body;distance:0;content:\"javax.xml.transform.Templatesxrjava.lang.reflect.Proxy\";http_client_body;distance:0;content:\"sun.reflect.annotation.AnnotationInvocationHandler\";http_client_body;distance:0;sid:2020010208;rev:1;)", "2020071447": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Citrix \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e(CVE-2020-8194)|tag:\u672a\u6388\u6743\u8bbf\u95ee|dest:home_net|level:attack|severity:3|result:unknown|phase:exploit|o_msg:Citrix \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u5b83\u6765\u521b\u5efa\u6076\u610f\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2020_8194;content:\"/menu/guiw\";http_uri;content:\"nsbrand=\";http_uri;distance:0;content:\"&protocol=\";http_uri;content:\"id=\";http_uri;content:\"nsvpx=\";http_uri;sid:2020071447;)", "2020062302": "alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5efa\u7acb ICMP \u901a\u9053\u4f20\u8f93\u6570\u636e|tag:\u653b\u51fb\u4ee3\u7406|tool:pingtunnel|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:3|result:success|o_msg:\u5c1d\u8bd5\u5efa\u7acb ICMP \u901a\u9053\uff0c\u4f20\u8f93\u6570\u636e|attacker:src\";flow:established, from_server;itype:0;icode:0;content:\"|10 01 22 0f 01 00 00 00 0e d6|\";depth:10;threshold:type both, track by_dst, count 30, seconds 30;sid:2020062302;rev:1;)", "2018041804": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:DRAT2009\u540e\u95e8\u6728\u9a6c|type:rat|tag:DRAT2009|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cDRat2009\u4e0a\u7ebf\u5305\";dsize:12<>80;flow:from_server,established;content:\"000\";pcre:\"/^000\\|\\d{2,5}\\|[[:print:]]+?\\|\\x0d\\x0a$/\";flowbits:set,TB_DRAT2009_A;sid:2018041804;rev:1;)", "2018081320": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u6253\u5f00\u8fdc\u7a0b\u684c\u9762\";dsize:8;flow:from_server,established;content:\"winvnc|0D 0A|\";depth:8;nocase;flowbits:isset,TB_ZxShell;sid:2018081320;rev:1;)", "2020081901": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Struts2 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2017-5638)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Struts2 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2017-5638)|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;http_content_type;content:\"multipart/form-data\";fast_pattern;content:\"%{\";content:\"}\";distance:0;pkt_data;sid:2020081901;rev:1;)", "2020052507": "alert dns $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528xip.name\u8fdb\u884c\u53cd\u5f39|tag:dnslog|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u5229\u7528dnslog\u8fdb\u884c\u53cd\u5f39|attacker:dest\";flow:established, to_server;dns_query;content:\".xip.name\";pkt_data;sid:2020052507;rev:1;)", "2018010029": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u89e3\u6790\u6f0f\u6d1e\u63a2\u6d4b|tag:\u89e3\u6790\u6f0f\u6d1e\u8bd5\u63a2|phase:exploit|dest:home_net|level:attack|severity:1|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:IIS6.0\u89e3\u6790\u6f0f\u6d1e\u63a2\u6d4b|attacker:src\";content:\"GET\";nocase;http_method;content:\".cer\";nocase;http_uri;within:200;pcre:\"/\\/[\\d\\w_-]\\.(jpg|gif|png)/iUR\";flow:to_server,established;gid:0;sid:2018010029;rev:1;)", "2020051216": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Couchdb \u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2017-12636\uff09\u3010step_2\u3011|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:Couchdb \u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2017-12636\uff09\u3010step_2\u3011|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;xbits:isset, cve_2017_12636_xbit, track ip_dst;content:\"POST\";http_method;content:\"/_temp_view\";http_uri;http_content_type;content:\"application/json\";pkt_data;content:\"language\";http_client_body;content:\"cmd\";http_client_body;distance:1;sid:2020051216;rev:2;)", "2020052505": "alert dns $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528send.jiance.qianxin.com\u8fdb\u884c\u53cd\u5f39|tag:dnslog|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u5229\u7528dnslog\u8fdb\u884c\u53cd\u5f39|attacker:dest\";flow:established, to_server;dns_query;content:\".send.jiance.qianxin.com\";pkt_data;sid:2020052505;rev:1;)", "2018041802": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DarkstRat2008\u540e\u95e8\u6728\u9a6c|type:rat|tag:DarkstRat2008|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cDarkstRat\u4e0a\u7ebf\u5305\";dsize:5<>10;flow:to_server,established;content:\"SH\";pcre:\"/^SH\\|\\d{2,5}\\x0a$/i\";flowbits:isset,TB_DarkstRat2008;sid:2018041802;rev:1;)", "2020052007": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u76ee\u6807\u673a\u5668\u5b58\u5728 webshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:success|o_msg:\u76ee\u6807\u673a\u5668\u5b58\u5728 webshell|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, jsp_webshell_20200520_1;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"|0d 0a 0d 0a 0d 0a|\";http_server_body;depth:6;content:\"<pre>\";distance:0;within:5;http_server_body;content:\"Wrong password\";distance:0;within:14;http_server_body;content:\"</pre>\";distance:0;http_server_body;within:6;sid:2020052007;rev:1;)", "2831654": "alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike \u53cd\u8fde|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:\u5b58\u5728Cobalt Strike C2\u57df\u540d\u8fde\u63a5\";flow:established,to_server;tls_sni;content:\"worldmailtracker.azureedge.net\";isdataat:!1,relative;metadata:former_category TROJAN;reference:md5,b40c1cb8d98907ba037dfb7e13770b11;classtype:trojan-activity;sid:2831654;rev:1;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2018_07_10, malware_family Cobalt_Strike, performance_impact Moderate, updated_at 2019_09_28;)", "2008413": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (PcPcUpdater)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| PcPcUpdater\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008413;classtype:trojan-activity;sid:2008413;rev:9;)", "2020051922": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee(info)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, spring_actuator_3_info;content:\"200\";http_stat_code;http_content_type;content:\"application\";content:\"spring-boot.actuator\";distance:0;content:\"json\";distance:0;pkt_data;content:\"{\\\"project-groupId\\\":\";http_server_body;startswith;sid:2020051922;rev:1;)", "2020051002": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, bingxie_webshell;flowbits:set, bingxie_webshell_step2;noalert;content:\"200\";http_stat_code;content:\"ASP.NET_SessionId=\";http_cookie;http_content_len;content:\"16\";pkt_data;pcre:\"/^([a-z0-9]{16})$/Q\";isdataat:!1,relative;sid:2020051002;gid:0;rev:1;)", "2020060407": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Dark Nexus \u7269\u8054\u7f51\u50f5\u5c38\u7f51\u7edc\u653b\u51fb|tag:\u50f5\u5c38\u7f51\u7edc|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Dark Nexus \u7269\u8054\u7f51\u50f5\u5c38\u7f51\u7edc\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"dark_NeXus_Qbot/\";http_user_agent;nocase;sid:2020060407;rev:1;)", "2020063002": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Nexus 2 yum\u63d2\u4ef6\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Nexus 2 yum\u63d2\u4ef6\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2019_5475;content:\"PUT\";http_method;content:\"/service/siesta/capabilities/\";http_uri;depth:50;http_content_type;content:\"application/xml\";pkt_data;content:\"<value>\";http_client_body;pcre:\"/(\\:\\\\{1,2}Windows\\\\{1,2}System32\\\\{1,2})|(bash (-i|-c))|(\\/bin\\/)/PR\";sid:2020063002;rev:1;)", "2020062222": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u653b\u51fb\u8005\u5c1d\u8bd5\u901a\u8fc7webshell\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, mem_webshell_interaction_1;content:\"pass_the_world=\";http_uri;content:!\"model=\";http_uri;sid:2020062222;rev:1;)", "2019090170": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Hmail\u8fde\u63a5|direction:in|level:action|service_name:Hmail(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Hmail|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([-\\w_.]+) ESMTP hMailServer ([\\w.-]+)\\r\\n/\";sid:2019090170;gid:0;)", "2019080031": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u8bd5\u56fe\u521d\u59cb\u5316abptts\u96a7\u9053|tag:tunnel|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|tool:abptts|type:infil|result:unknown|o_msg:\u901a\u8fc7abptts\u7684webshell\u8f6c\u53d1tcp\u6d41\u91cf|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;http_header_names;content:\"user-agent|0d 0a|\";content:\"content-type|0d 0a|\";content:\"accept-encoding|0d 0a|\";content:\"Content-Length|0d 0a|\";content:\"Host|0d 0a|\";content:!\"accept|0d 0a|\";nocase;content:!\"accept-language|0d 0a|\";nocase;http_connection;content:\"close\";pkt_data;pcre:\"/\\.(aspx|jsp)$/U\";flowbits:set,state_abptts_init;flowbits:noalert;xbits:set,state_abptts_init,track ip_pair;sid:2019080031;)", "2020050921": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell\u4ea4\u4e92|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:webshell\u4ea4\u4e92|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, jsp_replace_shell_1;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"<pre>|0a|\";http_server_body;within:6;content:\"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|\";http_server_body;distance:0;sid:2020050921;gid:0;rev:1;)", "2020052512": "alert dns $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528nip.io\u8fdb\u884c\u53cd\u5f39|tag:dnslog|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u5229\u7528dnslog\u8fdb\u884c\u53cd\u5f39|attacker:dest\";flow:established, to_server;dns_query;content:\".nip.io\";pkt_data;sid:2020052512;rev:1;)", "2019010045": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4e0b\u8f7d\u6587\u4ef6\u5305\u542b\u6570\u636e\u5e93\u5bc6\u7801|tag:\u654f\u611f\u4fe1\u606f|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u4e0b\u8f7d\u7684\u6587\u4ef6\u5305\u542b\u6570\u636e\u7684\u5bc6\u7801|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;http_content_type;content:\"application/octet-stream\";pkt_data;content:\"UPDATE mysql.user SET password=PASSWORD(\";http_server_body;gid:0;sid:2019010045;rev:1;)", "2019090083": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:FileZilla\u8fde\u63a5|direction:in|level:action|service_name:FileZilla|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728FileZilla|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 FTP Server - FileZilla\\r\\n/\";sid:2019090083;gid:0;)", "2020062807": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Venom-\u53cd\u5411\u4ee3\u7406)|tag:\u653b\u51fb\u4ee3\u7406|tool:Venom|direction:in|src:home_net|dest:external_net|level:attack|phase:control|type:control|severity:4|result:unknown|o_msg:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Venom-\u53cd\u5411\u4ee3\u7406)\";flow:established, to_server;flowbits:set, Venom_link_type_1;content:\"ABCDEFGH\";depth:8;content:\"VCMD\";distance:0;within:4;content:\"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|\";distance:0;within:16;content:\"|00 00 00 00 00 00 00 26|\";distance:50;within:8;content:\"|00 00 00 02|\";distance:0;within:4;sid:2020062807;rev:1;)", "2020061010": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ThinkPHP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:ThinkPHP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, tp_5_rce_1;content:\"s=index/\\\\think\\\";http_uri;depth:100;nocase;sid:2020061010;rev:1;)", "2019090166": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Hmail\u8fde\u63a5|direction:in|level:action|service_name:Hmail(imap)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Hmail|server:src\";flow:from_server,established;content:\"* OK \";depth:5;pcre:\"/^\\* OK ([-\\w_.]+) IMAP server ready\\r\\n/\";sid:2019090166;gid:0;)", "2020011411": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Citrix ADC \u76ee\u5f55\u7a7f\u8d8a\uff08CVE-2019-19781\uff09|tag:\u76ee\u5f55\u7a7f\u8d8a|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Citrix ADC|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established,to_server;content:\"/vpn/../vpns/\";http_raw_uri;startswith;sid:2020011411;rev:1;)", "2020010904": "alert tcp $HOME_NET 27017 -> $EXTERNAL_NET any (msg:\"name:MongoDB\u6570\u636e\u5e93\u679a\u4e3e|tag:\u672a\u6388\u6743\u6f0f\u6d1e|direction:in|dest:external_net|src:home_net|level:attack|phase:exploit|severity:4|result:success|o_msg:MongoDB\u6570\u636e\u5e93\u679a\u4e3e\";flow:to_client, established;flowbits:isset, mongodb_link;flowbits:unset, mongodb_link;content:\"|dd 07 00 00|\";offset:12;depth:4;fast_pattern;content:\"|00 08|ismaster|00 01|\";distance:0;content:\"|00 f0 3f 00|\";distance:0;sid:2020010904;rev:1;)", "2019090220": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:qmail\u8fde\u63a5|direction:in|level:action|service_name:Qmail|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728qmail|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([-\\w_.]+) ESMTP\\r\\n214-Gentoo Linux qmail-([-\\w.]+)\\r\\n214 qmail home page: http://pobox\\.com/~djb/qmail\\.html\\r\\n/\";sid:2019090220;gid:0;)", "2020070814": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6587\u4ef6\u5305\u542b\u8bfb\u53d6|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u6587\u4ef6\u8bfb\u53d6\u5c1d\u8bd5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, file_read_general;content:\"tomcat\";http_client_body;fast_pattern;pcre:\"/log(\\/|%2f|%2F)localhost_access_log/P\";sid:2020070814;rev:1;)", "2020020701": "alert tcp $EXTERNAL_NET any -> $HOME_NET 6379 (msg:\"name:redis\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:redis\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff08\u57fa\u4e8e\u4e3b\u4ece\u590d\u5236\uff09|attacker:src\";flow:established, to_server;noalert;flowbits:set, SLAVEOF;content:\"|24 37 0d 0a|SLAVEOF\";nocase;sid:2020020701;rev:1;)", "2018011704": "alert tcp $HOME_NET any -> $EXTERNAL_NET 25 (msg:\"name:Grum_spam|type:trojan|tag:Grum|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u7591\u4f3cGrum\u6728\u9a6c\u53d1\u9001\u5783\u573e\u90ae\u4ef6(Empty EHLO argument)\";dsize:7;flow:to_server,established;content:\"ehlo |0D 0A|\";nocase;depth:7;threshold:type both, track by_src, count 30, seconds 60;sid:2018011704;rev:1;)", "2018020041": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6d4f\u89c8Web\u76ee\u5f55|tag:\u76ee\u5f55\u904d\u5386|direction:in|dest:home_net|src:external_net|level:attack|phase:exploit|severity:1|result:success|o_msg:\u68c0\u6d4b\u5230\u6d4f\u89c8\u76ee\u5f55\u7684\u884c\u4e3a\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u7279\u6027\u83b7\u53d6web\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|gray:true\";flow:from_server,established;content:\"<html><head><title>\";nocase;http_server_body;offset:0;pcre:\"/(^([a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,} - \\/([\\d\\w_-]+\\/)*)</title></head><body><H1>\\1</H1><hr>\\x0d\\x0a\\x0d\\x0a<pre><A HREF/iQR\";content:\"[\u8f6c\u5230\u7236\u76ee\u5f55]</A><br><br>\";nocase;http_server_body;within:60;gid:0;sid:2018020041;)", "2026927": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"RhcnQtUHJ\";distance:0;fast_pattern;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026927;rev:2;metadata:attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2019070012": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:weblogic\u6f0f\u6d1e\u5229\u7528|tag:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|direction:out|src:home_net|dest:external_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:attack_out|result:unknown|o_msg:CVE-2017-10271 Payload\u653b\u51fb\u7cfb\u7edf[1]\";flow:to_server,established;content:\"POST\";http_method;content:\"<void class=\\\"sun.misc.BASE64Decoder\\\">\";http_client_body;content:\"<void method=\\\"decodeBuffer\\\"\";http_client_body;content:\"<string>yv66vgAAA\";http_client_body;flowbits:set, cmd_reponse_echo;gid:0;sid:2019070012;rev:1;)", "2020011502": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:phpmyadmin SQL\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2020-5504\uff09|tag:SQL\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:success|o_msg:phpmyadmin sql\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2020-5504\uff09|attacker:src\";flow:from_server,established;flowbits:isset, cve_2020_5504;content:\"200\";http_stat_code;content:\"\\\"error\\\":\\\"<div class=\\\\\\\"error\\\\\\\"><h1>\";http_server_body;sid:2020011502;rev:1;)", "2018020038": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6d4f\u89c8Web\u76ee\u5f55|tag:\u76ee\u5f55\u904d\u5386|direction:in|dest:home_net|src:external_net|level:attack|phase:exploit|severity:1|result:success|o_msg:\u68c0\u6d4b\u5230\u6d4f\u89c8\u76ee\u5f55\u7684\u884c\u4e3a\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u7279\u6027\u83b7\u53d6web\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|gray:true\";flow:from_server,established;content:\"<html>|0d 0a|<head><title>Index of /\";http_server_body;offset:0;gid:0;sid:2018020038;)", "2019090043": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(SMTP)|direction:in|level:action|service_name:Microsoft Exchange(SMTP)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange Server|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 ([\\w._-]+) Microsoft ESMTP MAIL Service Version: ([\\w._-]+)\\r\\n/\";sid:2019090043;gid:0;)", "2027027": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"hpcyBwcm9\";distance:0;fast_pattern;metadata:former_category ATTACK_RESPONSE;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027027;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_03_05, malware_family DNSlivery, updated_at 2019_03_05;)", "2026939": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"dm9rZS1Db21\";distance:0;fast_pattern;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026939;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2020032411": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:phpmyadmin 4.8.1 \u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e(CVE-2018-12613)|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:phpmyadmin 4.8.1 \u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e(CVE-2018-12613)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2018_12613;content:\"/index.php?target=\";http_uri;pcre:\"/db_datadict\\.php|db_sql\\.php|db_events\\.php|db_export\\.php|db_importdocsql\\.php|db_multi_table_query\\.php|db_structure\\.php|db_import\\.php|db_operations\\.php|db_search\\.php|db_routines\\.php|export\\.php|import\\.php|index\\.php|pdf_pages\\.php|pdf_schema\\.php|server_binlog\\.php|server_collations\\.php|server_databases\\.php|server_engines\\.php|server_export\\.php|server_import\\.php|server_privileges\\.php|server_sql\\.php|server_status\\.php|server_status_advisor\\.php|server_status_monitor\\.php|server_status_queries\\.php|server_status_variables\\.php|server_variables\\.php|sql\\.php|tbl_addfield\\.php|tbl_change\\.php|tbl_create\\.php|tbl_import\\.php|tbl_indexes\\.php|tbl_sql\\.php|tbl_export\\.php|tbl_operations\\.php|tbl_structure\\.php|tbl_relation\\.php|tbl_replace\\.php|tbl_row_action\\.php|tbl_select\\.php|tbl_zoom_select\\.php|transformation_overview\\.php|transformation_wrapper\\.php|user_password\\.php/URi\";content:\"../\";http_uri;distance:0;sid:2020032411;rev:1;)", "2017120102": "alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:\"name:\u5efa\u7acb\u901a\u4fe1\u96a7\u9053|type:tunneling|tag:DNS\u96a7\u9053|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:2|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u7578\u5f62\u7684DNS\u8bf7\u6c42\uff08NS\u7c7b\u578b\uff09\";content:!\"|00|\";offset:12;depth:1;byte_test:1, >, 63, 12, big;content:\"|00 02 00 01|\";isdataat:!1, relative;sid:2017120102;rev:1;)", "2020010018": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u7591\u4f3c\u9875\u9762\u8fd4\u56de\u5305\u542bSQL\u8bed\u53e5|tag:\u5f02\u5e38\u8bb0\u5f55|dest:home_net|level:attack|phase:exploit|severity:1|result:unknown|o_msg:\u90e8\u5206\u903b\u8f91\u6f0f\u6d1e\u7684\u9875\u9762\u4e2d\u4f1a\u5b58\u5728\u6570\u636e\u5e93\u64cd\u4f5c\u8bed\u53e5\uff0c\u5efa\u8bae\u5173\u6ce8\u3002\u5c06\u4e25\u91cd\u7ea7\u522b\u5b9a\u4f4d\u6700\u4f4e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"application/json\";pkt_data;content:\"select * from\";http_server_body;sid:2020010018;rev:1;)", "2003930": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (Snatch-System)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| Snatch-System\";nocase;http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2003930;classtype:trojan-activity;sid:2003930;rev:11;)", "2019010001": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5ThinkPHP\u6f0f\u6d1e|tag:ThinkPHP\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728ThinkPHP\u6f0f\u6d1e|attacker:src\";content:\"GET\";nocase;http_method;content:\"/index.php\";nocase;http_uri;within:100;pcre:\"/(\\/)?\\?s=(\\/)?index\\/(\\\\)?think\\\\Container/invokefunction&function=/iUR\";flow:to_server,established;gid:0;sid:2019010001;rev:1;)", "2020041032": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2018-3245)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2018-3245)|attacker:src\";flow:established, to_server;flowbits:set, cve_2018_3191;xbits:set, weblogic_link_jrmp, track ip_dst, expire 60;content:\"|ac ed 00 05|\";content:\"com.sun.jndi.rmi.registry.ReferenceWrapper_Stub\";distance:0;content:\"java.rmi.server.RemoteStub\";distance:0;content:\"java.rmi.server.RemoteObject\";distance:0;sid:2020041032;rev:1;)", "2020062309": "alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5efa\u7acb ICMP \u901a\u9053\u4f20\u8f93\u6570\u636e|tag:\u653b\u51fb\u4ee3\u7406|tool:icmpsh|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u653b\u51fb\u8005\u5efa\u7acbICMP\u96a7\u9053\uff0c\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4|attacker:src\";flow:established, from_server;itype:0;icode:0;content:\"net user\";depth:30;sid:2020062309;rev:1;)", "2019090308": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:CouchDB\u8fde\u63a5|direction:in|level:action|service_name:CouchDB|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728CouchDB|failed_by:http_status_3XX,http_status_4XX|server:dest\";flow:from_server,established;content:\"200\";http_stat_code;content:\"X-CouchDB-Body-Time|3a|\";http_raw_header;sid:2019090308;gid:0;)", "2020071442": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u7591\u4f3c\u51b0\u874ewebshell\u901a\u8baf|tag:webshell|tool:\u51b0\u874e|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:success|o_msg:\u7591\u4f3c\u51b0\u874ewebshell\u901a\u8baf|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, bingxie_send_message_1;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;pcre:\"/.{6000,}/Qs\";sid:2020071442;gid:0;rev:1;)", "2019090284": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DNS\u8fde\u63a5|direction:in|level:action|service_name:Microsoft DNS|service_class:other|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft DNS|server:src\";flow:from_server,established;content:\"|07|version|04|bind\";within:27;pcre:\"/\\x07version\\x04bind\\0\\0\\x10\\0\\x03\\xc0\\x0c\\0\\x10\\0[\\x01\\x03].{7}Microsoft DNS (5\\.2\\.3790.+)/\";sid:2019090284;gid:0;)", "2020070204": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:JNDI \u6ce8\u5165\u6210\u529f\uff0c\u5916\u8fdeldap/rmi\u670d\u52a1\u5668|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Apache Dubbo \u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u5229\u7528\u6210\u529f\uff0c\u5916\u8fdeldap/rmi\u670d\u52a1\u5668|attacker:dest\";flow:established, to_server;xbits:isset, jndi_link_jrmp, track ip_src;dsize:7;content:\"JRMI\";startswith;sid:2020070204;rev:1;)", "2018010080": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"=DBMS_PIPE.RECEIVE_MESSAGE(\";nocase;http_uri;within:1000;pcre:\"/(chr\\(\\d{2,3})+/iUR\";flow:to_server,established;gid:0;sid:2018010080;rev:1;)", "2020060215": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(CommonsCollections2-HTTP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"application/\";pcre:\"/(x-www-form-urlencoded)|(x-java-serialized-object)/R\";pkt_data;content:\"|ac ed 00 05|\";http_client_body;fast_pattern;content:\"java.util.PriorityQueue\";http_client_body;content:\"org.apache.commons.collections4.functors.InvokerTransformer\";http_client_body;content:\"getRuntime()\";http_client_body;sid:2020060215;rev:1;)", "2019010086": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5ThinkPHP\u6f0f\u6d1e|tag:ThinkPHP\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728ThinkPHP\u6f0f\u6d1e|attacker:src\";content:\"GET\";nocase;http_method;content:\"?s=\";nocase;http_uri;within:100;pcre:\"/index\\/(\\\\)?think\\\\app\\/invokefunction&function=/iUR\";flow:to_server,established;gid:0;sid:2019010086;rev:1;)", "2020062217": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:success|o_msg:\u653b\u51fb\u8005\u5c1d\u8bd5\u901a\u8fc7webshell\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, mem_webshell_interaction;content:\"200\";http_stat_code;content:\"|0d 0a|Content-Disposition: attachment\\; filename=\";http_header;sid:2020062217;rev:1;)", "2020011301": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Tomcat \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2019-0232)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Apache Tomcat \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2019-0232)|attacker:src\";flow:to_server,established;content:\"/cgi-bin/\";http_uri;startswith;pcre:\"/\\.(bat|cmd)\\?\\&/URi\";sid:2020011301;rev:1;)", "2019070010": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:weblogic\u8865\u4e01\u7ed5\u8fc7\u6f0f\u6d1e|tag:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|direction:out|src:home_net|dest:external_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:attack_out|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Weblogic  \u62a4\u7f51\u671f\u95f4\u4f7f\u7528\u76840day\u8865\u4e01\u7ed5\u8fc7\u6f0f\u6d1e\";flow:to_server,established;content:\"POST\";http_method;content:\"/_async/AsyncResponseService\";http_uri;content:\"java.lang.ProcessBuilder\";content:\"oracle.toplink.internal.sessions.UnitOfWorkChangeSet\";content:\"<void index=\\\"\";gid:3;sid:2019070010;rev:1;)", "2020061201": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6cdb\u5faeOA \u4fe1\u606f\u6cc4\u9732|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u6cdb\u5faeOA \u4fe1\u606f\u6cc4\u9732|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, ecology_info_disclosure_612;content:\"/hrm/kq/gethrmkq.jsp\";http_uri;depth:80;sid:2020061201;rev:1;)", "2019020005": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:tomcat\u767b\u5f55\u6210\u529f|tag:tomcat|direction:in|src:external_net|dest:home_net|level:action|phase:control|severity:1|result:success|o_msg:tomcat\u767b\u5f55\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"<title>/manager</title>\";http_server_body;content:\"<small>Apache Tomcat/\";http_server_body;flowbits:isset, tomcat_login;flowbits:unset, tomcat_login;gid:3;sid:2019020005;)", "2018041913": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6781\u5149\u540e\u95e8\u6728\u9a6c|type:rat|tag:jiguang2009|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6c\u6781\u51492009\u4e0a\u7ebf\u5305\";dsize:200<>400;flow:to_server,established;content:\"PEdSP\";offset:4;depth:5;content:\"PC9HUj48SU0+\";distance:0;within:50;content:\"PC9KQz48Q1I+\";distance:0;within:350;flowbits:set,TB_jiguang2009;sid:2018041913;rev:1;)", "2026933": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"52b2tlLVdtaU1\";distance:0;fast_pattern;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026933;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2020051904": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:spring-cloud-config\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\uff08CVE-2020-5405\uff09|tag:\u76ee\u5f55\u7a7f\u8d8a|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:spring-cloud-config\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\uff08CVE-2020-5405\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"..(_)\";http_uri;sid:2020051904;rev:1;)", "2020070313": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|tag:\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\".php\";http_uri;content:\"assert\";http_uri;fast_pattern;distance:0;pcre:\"/\\$_(GET|POST)\\[\\S+\\]/URi\";sid:2020070313;rev:1;)", "2019090109": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:vsFTPd\u8fde\u63a5|direction:in|level:action|service_name:vsFTPd|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728vsFTPd|server:src\";flow:from_server,established;content:\"500\";depth:3;pcre:\"/^500 OOPS: (could not bind listening IPv4 socket)\\r\\n$/\";sid:2019090109;gid:0;)", "2019090276": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DNS\u8fde\u63a5|direction:in|level:action|service_name:Microsoft DNS|service_class:other|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft DNS|server:src\";flow:from_server,established;content:\"|80 f0 80 12 00|\";depth:5;pcre:\"/^\\x80\\xf0\\x80\\x12\\0\\x01\\0\\0\\0\\0\\0\\0\\x20CKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\0\\0!\\0\\x01/\";sid:2019090276;gid:0;)", "2101886": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u6267\u884ccmd\u547d\u4ee4id|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:unknown|o_msg:webshell\u8fde\u63a5\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"uid=\";within:100;http_server_body;pcre:\"/uid=\\d+\\(apache\\) gid=\\d+\\(apache\\) groups=\\d+\\(/QR\";flowbits:isset,req;sid:2101886;rev:7;)", "2020061902": "alert tcp $HOME_NET 11211 -> $EXTERNAL_NET any (msg:\"name:Memcache \u4fe1\u606f\u6cc4\u9732|tag:\u4fe1\u606f\u6cc4\u9732|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Memcache \u5bf9\u5916\u7f51\u5f00\u653e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u8fde\u63a5Memcache\uff0c\u6267\u884cMemcache\u547d\u4ee4|failed_by:http_status_3XX, http_status_4XX|attacker:dest\";flow:established, from_server;content:\"STAT maxbytes \";depth:30;content:\"|0d 0a|STAT maxconns \";distance:0;content:\"|0d 0a|STAT tcpport \";distance:0;content:\"|0d 0a|STAT udpport \";distance:0;content:\"|0d 0a|STAT inter \";distance:0;content:\"|0d 0a|STAT verbosity \";distance:0;sid:2020061902;rev:1;)", "2809642": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:\u5229\u7528HTTP\u4f20\u8f93mimikatz|tag:smb|direction:lateral|type:infil|src:home_net|dest:home_net|attacker:src|level:attack|phase:post_exploit|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u901a\u8fc7http\u534f\u8bae\u4f20\u8f93mimikatz\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_client;content:\"SpLsaModeInitialize\";content:\"mimikatz|00|start\";fast_pattern;distance:23;within:17;classtype:policy-violation;sid:2809642;rev:2;metadata:created_at 2015_01_30, updated_at 2015_01_30;)", "2020081425": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08tcp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884c\u547d\u4ee4ifconfig\";flow:established;content:\" flags=\";fast_pattern;pcre:\"/^\\d+<[a-zA-Z,]+> {2}mtu \\d+\\x0a/Ri\";content:\"inet \";distance:8;content:\"netmask \";distance:7;within:35;content:\"broadcast \";distance:7;within:45;content:\"ether \";distance:7;sid:2020081425;)", "2019090000": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MySQL\u8fde\u63a5|direction:in|level:action|service_name:MySQL|service_class:database|phase:action|severity:1|result:unknown|o_msg:MySQL\u8fde\u63a5|server:src\";flow:from_server,established;content:\"|00 00 00 0a|\";offset:1;depth:4;pcre:\"/[4-9]\\.\\d{1,2}\\.\\d{1,2}/R\";content:\"|00 00 00 00 00 00 00 00 00 00|\";content:\"|00|mysql_native_password|00|\";isdataat:!1,relative;sid:2019090000;gid:0;)", "2025818": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT php script double base64 encoded Remote Code Execution 9|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"2S2p3L2NHaHdJ\";metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025818;rev:2;metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2020061806": "alert tcp $HOME_NET 3389 -> $EXTERNAL_NET any (msg:\"name:\u7206\u7834 windows \u8fdc\u7a0b\u684c\u9762\u670d\u52a1|tag:\u7206\u7834\u7834\u89e3|src:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u653b\u51fb\u8005\u7206\u7834 windows \u8fdc\u7a0b\u684c\u9762\u670d\u52a1\uff0c\u5c1d\u8bd5\u767b\u9646\u8fdc\u7a0b\u684c\u9762|attacker:dest\";flow:established, from_server;flowbits:isset, rdp_blasting;threshold:type both,track by_dst,count 30, seconds 5;dsize:19;content:\"|03 00 00 13 0e d0 00 00 12 34 00 02 09 08 00 02 00 00 00|\";depth:19;sid:2020061806;rev:1;)", "2018010050": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MSSQL\u6ce8\u5165|tag:\u6ce8\u5165\u5199\u6587\u4ef6|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MSSQL\u6ce8\u5165\u5c1d\u8bd5|dest:home_net|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"and\";nocase;http_uri;pcre:\"/[ !\\\\/*+]+'[\\d\\w]*'[ !\\\\/*+]*[=><][ !\\\\/*+]*'[\\d\\w]*/iUR\";flow:to_server,established;gid:0;sid:2018010050;rev:1;)", "2838832": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike \u540e\u95e8\u53cd\u8fde\u4fe1\u606f|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike \u8fdc\u7a0b\u63a7\u5236\u7684\u6d3b\u8dc3\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;content:\"/submit.php?id=\";http_uri;fast_pattern;pcre:\"/^[0-9]{3,6}$/RU\";content:\"Mozilla/5.0 (\";http_user_agent;depth:13;pcre:\"/^[\\x20-\\x7e\\r\\n]{0,20}[^\\x20-\\x7e\\r\\n]Psi/\";http_content_type;content:\"application/octet-stream\";depth:24;isdataat:!1,relative;http_header_names;content:!\"Referer\";metadata:former_category MALWARE;classtype:trojan-activity;sid:2838832;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2019_10_09, malware_family Cobalt_Strike, performance_impact Moderate, updated_at 2019_10_09;)", "2018041807": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:DRAT2008\u540e\u95e8\u6728\u9a6c|type:rat|tag:DRAT2008|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cDRat2008\u4e0a\u7ebf\u5305\";dsize:7<>12;flow:from_server,established;content:\"000\";pcre:\"/^000\\|\\d{2,5}\\x0d\\x0a$/\";flowbits:set,TB_DRAT2009_1;sid:2018041807;rev:1;)", "2020060222": "alert TCP $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(CommonsCollections5-TCP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|attacker:src\";flow:established, to_server;content:\"|ac ed 00 05|\";fast_pattern;content:\"ValueExpException\";content:\"org.apache.commons.collections.keyvalue.TiedMapEntry\";content:\"org.apache.commons.collections.map.LazyMap\";content:\"org.apache.commons.collections.functors.ConstantTransformer\";content:\"org.apache.commons.collections.functors.InvokerTransformer\";sid:2020060222;rev:1;)", "2020010025": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528\u6f0f\u6d1e\u6267\u884c\u547d\u4ee4|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u68c0\u6d4b\u5230\u8fdc\u7a0b\u547d\u4ee4\u6267\u884cwhoami|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;http_content_len;byte_test:0,<,7,0,string,dec;pkt_data;content:\"apache\";http_server_body;flowbits:isset,cmd_reponse_echo;sid:2020010025;)", "2019010094": "alert http $EXTERNAL_NET any -> $HOME_NET 9200 (msg:\"name:elasticsearch\u672a\u6388\u6743\u8bbf\u95ee|tag:elasticsearch|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:elasticsearch\u672a\u6388\u6743\u8bbf\u95ee|attacker:src\";flow:to_server,established;flowbits:set, established_unauthorization;noalert;content:\"_cat\";http_uri;content:!\"Authorization: Basic\";http_header;sid:2019010094;)", "2019010042": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u5229\u7528fastjson\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:JAVA\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u901a\u8fc7http POST\u89e6\u53d1fastjson\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(RowSetImpl\u5229\u7528\u94fe)|attacker:src\";flow:to_server,established;content:\"{\";http_client_body;pcre:\"/{\\s*\\\"@type\\\"\\s*:\\s*\\\"L*com.sun.rowset.RowSetImpl\\;*\\\"[^}]*}/Pi\";distance:-1;gid:3;sid:2019010042;)", "2020060905": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7\u4e0a\u4f20shtml\u6587\u4ef6\u6267\u884c\u547d\u4ee4|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u653b\u51fb\u8005\u5c1d\u8bd5\u4e0a\u4f20shtml\u6587\u4ef6\u6267\u884c\u7cfb\u7edf\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"boundary=\";pkt_data;content:\".shtml\";http_client_body;content:\"<!--#exec\";http_client_body;distance:0;sid:2020060905;rev:1;)", "202000805": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874eWebshell\u901a\u8baf|tag:webshell|tool:\u51b0\u874e|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u51b0\u874eWebshell\u901a\u8baf|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;flowbits:set, bingxie_3_0_php;noalert;content:\"POST\";http_method;http_content_len;content:\"1112\";pkt_data;content:\"PHPSESSID=\";http_cookie;pcre:\"/^[a-z0-9]{26}/CRi\";pcre:\"/^[A-Za-z0-9+\\/]{1110}[A-Za-z0-9+\\/=]{2}$/P\";sid:202000805;gid:0;rev:1;)", "2020050920": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell\u4ea4\u4e92|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:webshell\u4ea4\u4e92|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, jsp_replace_shell_1;content:\"POST\";http_method;content:\".jsp\";http_uri;nocase;content:\"help=\";http_client_body;nocase;content:\"other\";http_client_body;nocase;noalert;sid:2020050920;gid:0;rev:1;)", "2008714": "alert tcp $HOME_NET any -> $HOME_NET 445 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";flow:established,to_server;content:\"|20 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"|00 2E 00 2E 00 2F 00 2E 00 2E 00 2F|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008714;classtype:attempted-admin;sid:2008714;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2018081329": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u83b7\u53d6\u64cd\u4f5c\u7cfb\u7edf\u660e\u6587\u5bc6\u7801\";flow:from_server,established;content:\"logonPasswords\";depth:14;nocase;flowbits:isset,TB_ZxShell;sid:2018081329;rev:1;)", "2019000040": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6f0f\u6d1e\u5229\u7528\u6267\u884cnet user|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:4|gray:true|result:success|o_msg:webshell\u6267\u884cnet user|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"-------------------------------------------------------------------------------\";http_server_body;content:\"Administrator\";http_server_body;within:20;flowbits:isset,cmd_reponse_echo;flowbits:unset,cmd_reponse_echo;sid:2019000040;)", "2019090112": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:vsFTPd\u8fde\u63a5|direction:in|level:action|service_name:vsFTPd|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728vsFTPd|server:src\";flow:from_server,established;content:\"500\";depth:3;pcre:\"/^500 OOPS: cannot locate user entry:([-\\w_]+)\\r\\n/\";sid:2019090112;gid:0;)", "2018060028": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:jsp webshell\u5217\u76ee\u5f55\u884c\u4e3a|tag:webshell\u8fde\u63a5|tool:\u83dc\u5200|direction:in|dest:home_net|src:external_net|level:attack|phase:control|severity:4|result:success|type:shell|o_msg:jsp webshell\u5217\u76ee\u5f55\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX\";content:\"200\";nocase;http_stat_code;http_content_type;content:\"text/html\";pkt_data;http_content_len;byte_test:0,<,1000,0,string,dec;pkt_data;content:\"|0a 0a 20 20 20 20 20 0a 20 20 20 20 20 0a|\";http_server_body;within:600;pcre:\"/->\\|([\\w\\d._/\\[\\]\\{\\}-]{1,255}(\\/)?\\x09\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\\x09\\d{1,5}\\x09[RWX ]{1,10}\\x0a)+\\|<-/iRQ\";flow:from_server,established;flowbits:isset,jsp_req;sid:2018060028;rev:1;)", "2020081449": "alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08udp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884c\u547d\u4ee4netstat\";content:\"Active Internet connections (servers and established)\";content:\"|0a|Proto \";distance:0;within:8;sid:2020081449;)", "2020061301": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4e0a\u4f20Behinder webshell|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u4e0a\u4f20Behinder webshell|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"boundary=\";pkt_data;content:\"<%\";http_client_body;distance:0;content:\"javax.crypto.\";http_client_body;distance:0;content:\"Cipher.getInstance(\\\"AES/ECB/PKCS5Padding\\\")\\;\";http_client_body;distance:0;sid:2020061301;rev:1;)", "2018020064": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u670d\u52a1\u5668\u51fa\u73b0PHP fatal error|direction:in|dest:home_net|src:external_net|level:action|o_msg:\u670d\u52a1\u5668\u8fd4\u56de\u9875\u9762\u51fa\u73b0php fatal error|failed_by:http_status_3XX,http_status_4XX\";http_content_type;content:\"text/html\";pkt_data;content:\"Warning</b>:\";nocase;within:3000;http_server_body;content:\"in\";within:300;http_server_body;pcre:\"/in (<b>)?(\\/[\\d\\w_.-]+)+\\.php(<\\/b>)? on line /Q\";flow:from_server,established;sid:2018020064;rev:1;)", "2020061807": "alert tcp $HOME_NET 3389 -> $EXTERNAL_NET any (msg:\"name:\u7206\u7834 windows \u8fdc\u7a0b\u684c\u9762\u670d\u52a1|tag:\u7206\u7834\u7834\u89e3|src:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u653b\u51fb\u8005\u7206\u7834 windows \u8fdc\u7a0b\u684c\u9762\u670d\u52a1\uff0c\u5c1d\u8bd5\u767b\u9646\u8fdc\u7a0b\u684c\u9762|attacker:dest\";flow:established, from_server;flowbits:isset, rdp_blasting;threshold:type both,track by_dst,count 30, seconds 5;dsize:19;content:\"|03 00 00 13 0e d0 00 00 12 34 00 03 00 08 00 02 00 00 00|\";depth:19;sid:2020061807;rev:1;)", "2019090032": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:VNC\u8fde\u63a5|direction:in|level:action|service_name:VNC|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728VNC|server:src\";flow:from_server,established;content:\"RFB\";depth:3;pcre:\"/^RFB 004\\.000\\n/\";sid:2019090032;gid:0;)", "2019010058": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:\u626b\u63cf|dest:home_net|level:attack|phase:exploit|severity:1|result:unknown|o_msg:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"=print(md5(\";nocase;http_uri;flow:to_server,established;gid:0;sid:2019010058;)", "2017510": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT Metasploit CVE-2013-3205 Exploit Specific|tag:TEST|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:dest\";flow:established,from_server;file_data;content:\"function putPayload(\";nocase;fast_pattern:only;classtype:attempted-user;sid:2017510;rev:2;metadata:affected_product Any, attack_target Client_and_Server, deployment Perimeter, deployment Internet, deployment Internal, deployment Datacenter, tag Metasploit, signatrue_severity Critical, created_at 2013_09_23, updated_at 2016_07_01;)", "2020000082": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u8c6a\u6a2a!cmd\u540d\u5b57\u7684\u6728\u9a6c|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:unknown|o_msg:\u8c6a\u6a2a!cmd\u540d\u5b57\u7684\u6728\u9a6c|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;flowbits:isset,http_uri_cmd;sid:2020000082;rev:7;)", "2019060024": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"ASPSESSIONID\";http_cookie;pcre:\"/[a-zA-Z]+=[a-zA-Z0-9]{24}/CR\";http_content_len;byte_test:0,=,16,0,string,dec;pkt_data;content:\"b\";nocase;http_server_body;within:16;pcre:\"/^([a-f0-9A-F]{16})$/Q\";isdataat:!1,relative;noalert;flowbits:isset, bingxie_webshell_asp;flowbits:set, bingxie_webshell_step2_asp;sid:2019060024;gid:0;rev:1;)", "2010380": "alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"name:\u5c1d\u8bd5JBOSS/JMX \u8fdc\u7a0b\u6f0f\u6d1e|tag:\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:JBOSS\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"GET \";nocase;depth:4;uricontent:\"/jmx-console/HtmlAdaptor?action=invokeOpByName&name=jboss.deployment\";uricontent:\"DeploymentScanner\";nocase;uricontent:\"methodName=addURL\";nocase;uricontent:\"=http\";nocase;reference:url,www.notsosecure.com/folder2/2009/10/27/hacking-jboss-with-jmx-console/;reference:url,www.nruns.com/_downloads/Whitepaper-Hacking-jBoss-using-a-Browser.pdf;reference:url,doc.emergingthreats.net/2010380;classtype:web-application-attack;sid:2010380;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2018060030": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u663e\u793a\u7cfb\u7edf\u7248\u672c|tag:webshell\u8fde\u63a5|tool:\u83dc\u5200|direction:in|dest:home_net|src:external_net|level:attack|phase:control|severity:4|result:success|type:shell|o_msg:webshell\u663e\u793a\u7cfb\u7edf\u7248\u672c|failed_by:http_status_3XX,http_status_4XX\";content:\"200\";nocase;http_stat_code;http_content_type;content:\"text/html\";pkt_data;http_content_len;byte_test:0,<,1000,0,string,dec;pkt_data;content:\"->|7c|\";http_server_body;within:100;content:\"Linux \";http_server_body;content:\".x86_64 #1 SMP \";within:60;http_server_body;content:\"UTC \";within:34;http_server_body;pcre:\"/UTC 20[1,2]\\d x86_64/iQ\";content:\"|7c|<-\";isdataat:!3,relative;flow:from_server,established;sid:2018060030;rev:1;)", "2019090066": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Redis\u8fde\u63a5|direction:in|level:action|service_name:Redis|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728Redis|server:src\";flow:from_server,established;content:\"-ERR\";depth:4;pcre:\"/-ERR operation not permitted\\x0d\\x0a/\";sid:2019090066;gid:0;)", "2019090138": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Winmail\u8fde\u63a5|direction:in|level:action|service_name:Winmail(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Winmail|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK ([\\w._-]+) Winmail Mail Server POP3 ready\\r\\n/\";sid:2019090138;gid:0;)", "2839791": "alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Cobalt Strike\u53cd\u5f39\u8bf7\u6c42|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|dest:home_net|src:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike DNS\u53cd\u5f39\";flow:established,from_server;tls_cert_subject;content:\"CN=www.corpbonus.com\";nocase;isdataat:!1,relative;metadata:former_category MALWARE;classtype:trojan-activity;sid:2839791;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2019_12_09, malware_family Cobalt_Strike, updated_at 2019_12_09;)", "2020062205": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:weblogic\u5185\u5b58webshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:success|o_msg:weblogic\u5185\u5b58webshellwebshell|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"setStartupEnv.sh|0a|\";http_server_body;content:\"startManagedWebLogic.sh|0a|\";http_server_body;content:\"stopWebLogic.sh|0a|\";http_server_body;content:\"startWebLogic.sh|0a|\";http_server_body;content:\"stopManagedWebLogic.sh\";http_server_body;sid:2020062205;rev:1;)", "2019010142": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6d4b\u8bd5SQL\u6ce8\u5165\u6f0f\u6d1e|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"or\";nocase;http_client_body;pcre:\"/or(%20| )+\\d+(%3d|=)\\d+/iP\";flow:to_server,established;gid:0;sid:2019010142;rev:1;)", "2809649": "alert tcp $HOME_NET [139,445] -> $HOME_NET any (msg:\"name:\u5229\u7528SMB\u4f20\u8f93mimikatz|tag:smb|direction:lateral|type:infil|src:home_net|dest:home_net|attacker:dest|level:attack|phase:post_exploit|severity:3|gray:|result:success|o_msg:\u7591\u4f3c\u68c0\u6d4b\u5230\u5728\u5185\u7f51\u901a\u8fc7SMB\u534f\u8bae\u4f20\u8f93\u9ed1\u5ba2\u5de5\u5177Mimikatz\u7684mimilib.dll\u6587\u4ef6\";flow:established,from_server;content:\"SpLsaModeInitialize\";content:\"mimikatz|00|start\";fast_pattern;distance:23;within:17;reference:url,github.com/gentilkiwi/mimikatz;classtype:trojan-activity;sid:2809649;rev:1;metadata:created_at 2015_01_30, updated_at 2015_01_30;)", "2020072805": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u89e3\u6790\u6f0f\u6d1e\u5229\u7528|tag:IIS\u6f0f\u6d1e|phase:exploit|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|success_by:resp_body_upload_success_str|o_msg:IIS6.0\u89e3\u6790\u6f0f\u6d1e\u5229\u7528|attacker:src\";content:\"POST\";http_method;flow:to_server,established;http_content_type;content:\"multipart/form-data\\;\";content:\"boundary=\";pkt_data;content:\"Content-Disposition:\";nocase;http_client_body;pcre:\"/filename=\"[^.\\/]+\\.(asp|aspx|(php(\\d?))|asa|cer|cdx)((\\/)|(\\;)|(\\:))([^.\\/]+)?\\.[a-z0-9]+/PRi\";gid:0;sid:2020072805;rev:1;)", "2809646": "alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:\"name:\u5229\u7528SMB\u4f20\u8f93mimikatz|tag:smb|direction:lateral|type:infil|src:home_net|dest:home_net|attacker:src|level:attack|phase:post_exploit|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5728\u5185\u7f51\u901a\u8fc7SMB\u534f\u8bae\u4f20\u8f93\u9ed1\u5ba2\u5de5\u5177Mimikatz\u7684mimilib.dll\u6587\u4ef6\uff08Unicode\uff09\";flow:established,to_server;content:\"|FF|SMB|a2|\";offset:4;depth:5;byte_test:1,&,0x80,6,relative;content:\"m|00|i|00|m|00|i|00|l|00|i|00|b|00|.|00|d|00|l|00|l\";distance:0;reference:url,github.com/gentilkiwi/mimikatz;classtype:trojan-activity;sid:2809646;rev:2;metadata:created_at 2015_01_30, updated_at 2015_01_30;)", "2020061003": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Drupal Drupalgeddon 2 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2018-7600\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Drupal Drupalgeddon 2 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2018-7600\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"user/password\";http_uri;pcre:\"/#(access_callback|pre_render|post_render|lazy_builder)/Ui\";sid:2020061003;rev:1;)", "2020060219": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(CommonsCollections4-HTTP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"application/\";pcre:\"/(x-www-form-urlencoded)|(x-java-serialized-object)/R\";pkt_data;content:\"|ac ed 00 05|\";http_client_body;fast_pattern;content:\"java.util.PriorityQueue\";http_client_body;content:\"org.apache.commons.collections4.functors.InstantiateTransformer\";http_client_body;content:\"getRuntime()\";http_client_body;sid:2020060219;rev:1;)", "2020061011": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, tp_5_rce_1;content:\"200\";http_stat_code;http_content_len;content:\"32\";pkt_data;http_content_type;content:\"text/html\";pkt_data;pcre:\"/^[a-z0-9]{32}$/Q\";sid:2020061011;rev:1;)", "2825202": "alert tls $EXTERNAL_NET 443 -> $HOME_NET any (msg:\"name:Empire \u8fde\u63a5\u68c0\u6d4b|tag:\u6728\u9a6c|direction:out|src:external_net|dest:home_net|level:attack|type:c2|phase:control|severity:3|result:success|o_msg:\u4f7f\u7528Empire \u8fde\u63a5\u68c0\u6d4b\";flow:established,from_server;content:\"|55 04 03|\";content:\"|11|shop.npr-news.com\";distance:1;within:18;metadata:former_category TROJAN;reference:md5,9fc2ab4fdfd6d005d17e98b825234a37;classtype:trojan-activity;sid:2825202;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag SSL_Malicious_Cert, signature_severity Major, created_at 2017_03_02, updated_at 2017_03_02;)", "2835221": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:D-LINK\u8def\u7531\u5668\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|tag:\u8def\u7531\u5668\u653b\u51fb|direction:out|dest:external_net|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:attack_out|result:unknown|o_msg:\u5229\u7528D-Link\u8def\u7531\u5668\u6267\u884c\u6f0f\u6d1e\u63a7\u5236\u8def\u7531\u5668\";flow:to_server,established;content:\"/login.cgi?cli=\";http_uri;content:\"$\";http_uri;distance:0;metadata:former_category EXPLOIT;reference:url,www.quantumleap.it/d-link-router-dsl-2750b-firmware-1-01-1-03-rce-no-auth;reference:url,www.exploit-db.com/exploits/44760;classtype:attempted-admin;sid:2835221;rev:1;metadata:attack_target Networking_Equipment, deployment Perimeter, signature_severity Major, created_at 2019_03_06, performance_impact Low, updated_at 2019_03_06;)", "2020062805": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4ee5POST\u65b9\u5f0f\u8bbf\u95ee\u811a\u672c\u6587\u4ef6|tag:\u653b\u51fb\u4ee3\u7406|tool:Neo-reGeorg|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:4|result:unknown|o_msg:\u4ee5POST\u65b9\u5f0f\u8bbf\u95ee\u811a\u672c\u6587\u4ef6|attacker:src|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;flowbits:set, access_script_file_post;noalert;content:\"POST\";http_method;content:\"|0d 0a|Connection: keep-alive|0d 0a|Accept-Encoding: deflate|0d 0a|Accept: */*|0d 0a|User-Agent:|20|\";http_header;pcre:\"/\\x0d\\x0a[A-Z]{1}[a-z]{1,17}\\: [A-Za-z0-9_]{2,66}\\x0d\\x0a/HR\";http_content_len;content:\"0\";pkt_data;sid:2020062805;rev:1;)", "2020011410": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:JBoss \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2017-7504\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:JBOSS\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2017_7504;content:\"200\";http_stat_code;http_content_type;content:\"application/x-java-serialized-object\";pkt_data;content:\"| ac ed 00 05 |sr\";http_server_body;startswith;content:\"org.jboss.mq.il.http.HTTPILResponse\";distance:40;sid:2020011410;rev:1;)", "2020072914": "alert tcp $EXTERNAL_NET 5938 -> $HOME_NET any (msg:\"name:\u4f7f\u7528Teamviewer|level:attack|tool:Teamviewer|severity:1|dest:home_net|phase:exploit|type:rat|result:unknown|o_msg:\u4f7f\u7528teamviewer\u8fde\u63a5|attacker:src\";dsize:438;flow:to_client,established;content:\"|11 30 3c 00 9e 01 00 00|\";depth:8;content:\"|1b 00 00 00 18 00 00 00|\";distance:8;within:8;content:\"|00 80 00 07 80 00 00 1a 00 40 00 80 00|\";distance:17;within:13;gid:2;sid:2020072914;rev:1;)", "2020021705": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u53cd\u5411\u4ee3\u7406\u8fde\u63a5|tag:\u53cd\u5411\u4ee3\u7406|dest:external_net|src:home_net|level:action|severity:2|result:unknown|o_msg:\u53cd\u5411\u4ee3\u7406\u8fde\u63a5\";flow:established, to_server;dsize:4;content:\"|05 05 00 01|\";offset:0;depth:4;sid:2020021705;rev:1;)", "2101884": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u6267\u884ccmd\u547d\u4ee4id|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:unknown|o_msg:webshell\u8fde\u63a5\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;http_content_len;byte_test:0,>=,40,0,string,dec;pkt_data;content:\"uid=\";within:100;http_server_body;pcre:\"/uid=\\d+\\(nobody\\) gid=\\d+\\(nobody\\) groups=\\d+\\(/QR\";flowbits:isset,req;flowbits:isset,req;sid:2101884;rev:7;)", "2018010005": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Tomcat\u6f0f\u6d1e\u5229\u7528|tag:\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Tomcat PUT\u65b9\u6cd5\u4efb\u610f\u5199\u6587\u4ef6\u6f0f\u6d1e(CVE-2017-12615)\u653b\u51fb\u7cfb\u7edf[1]|attacker:src\";flow:to_server,established;content:\"PUT\";http_method;pcre:\"/\\/.*\\.jsp\\/$/I\";gid:3;flowbits:set,tomcat_put;sid:2018010005;rev:1;)", "2019010090": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6d4b\u8bd5SQL\u6ce8\u5165\u6f0f\u6d1e|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"or\";nocase;http_client_body;pcre:\"/or(%20|\\s+)\\d+(%3d|=)\\d+/iP\";within:500;flow:to_server,established;gid:0;sid:2019010090;rev:1;)", "2027034": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"BoAGkAcwAgAHAAcgBvAGcAcgB\";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027034;rev:2;metadata:created_at 2019_03_05, updated_at 2019_03_05;)", "2020051305": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7591\u4f3c\u9488\u5bf9\u6df1\u4fe1\u670dVPN\u7684\u653b\u51fb\u884c\u4e3a|tag:\u6df1\u4fe1\u670dVPN|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:unknown|o_msg:\u7591\u4f3c\u9488\u5bf9\u6df1\u4fe1\u670dVPN\u7684\u653b\u51fb\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;content:\"md=\";http_client_body;content:\"..%c0%af..%2F..%c0%af..%2F..%c0%af..%2F..%c0%af..%2F..%c0%af..%2F..%c0%af..%2F\";http_client_body;distance:0;sid:2020051305;gid:0;rev:1;)", "180621003": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PlugX\u540e\u95e8\u6728\u9a6c|type:rat|tag:PlugX|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8Backdoor.Win32.PlugX\u7684\u4e0a\u7ebf\u4fe1\u606f|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;content:\"X-Session|3a 20|\";http_header;content:\"X-Status|3a 20|\";http_header;content:\"X-Size|3a 20|\";http_header;content:\"X-Sn|3a 20|\";http_header;sid:180621003;rev:1;)", "2020081414": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08tcp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884c\u547d\u4ee4netstat\";flow:established;content:\"Active Internet connections (servers and established)\";content:\"|0a|Proto \";distance:0;within:8;sid:2020081414;)", "2020041033": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-2555)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-2555)|attacker:src\";flow:established, to_server;content:\"|ac ed 00 05|\";content:\"javax.management.BadAttributeValueExpException\";distance:2;content:\"com.tangosol.util.filter.LimitFilter\";distance:0;content:\"com.tangosol.util.extractor.ChainedExtractorC\";distance:0;content:\"com.tangosol.util.extractor.ReflectionExtractor\";distance:0;sid:2020041033;rev:1;)", "2008713": "alert tcp $HOME_NET any -> $HOME_NET 445 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";flow:established,to_server;content:\"|20 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"/../\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008713;classtype:attempted-admin;sid:2008713;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2020061207": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Apache Shiro \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Apache Shiro \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0c\u6682\u672a\u8fdb\u884c\u6f0f\u6d1e\u5229\u7528\uff0c\u4f46\u6f0f\u6d1e\u5b58\u5728|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, shiro_rce_test;content:\"500\";http_stat_code;content:\"rememberMe=\";http_cookie;content:\"<div>There was an unexpected error (Type=Internal Server Error, status=500).</div>\";http_server_body;pcre:\"/^<div>\\S+</div>/QR\";sid:2020061207;rev:1;)", "2019090154": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Active Directory\u8fde\u63a5|direction:in|level:action|service_name:Windows Active Directory|service_class:auth|severity:1|result:unknown|o_msg:\u5b58\u5728Active Directory|server:src\";flow:from_server,established;content:\"0|84 00 00|\";depth:4;pcre:\"/^0\\x84\\0\\0..\\x02\\x01.*dsServiceName1\\x84\\0\\0\\0.\\x04.CN=NTDS\\x20Settings,CN=([^,]+),CN=Servers,CN=([^,]+),CN=Sites,CN=Configuration,DC=([^,]+),DC=([^,]+),DC=([^,]+)0\\x84\\0/\";sid:2019090154;gid:0;)", "2019000062": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Jenkins\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2017-1000353\uff09|tag:\u5371\u9669\u884c\u4e3a|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Jenkins\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2017-1000353\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2017_1000353;content:\"200\";http_stat_code;content:\"X-Content-Type-Options: nosniff\";http_header;content:\"Hudson-Duplex: \";http_header;sid:2019000062;rev:1;)", "2019090280": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DNS\u8fde\u63a5|direction:in|level:action|service_name:Microsoft DNS|service_class:other|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft DNS|server:src\";flow:from_server,established;content:\"|07|version|04|bind\";within:27;pcre:\"/\\x07version\\x04bind\\0\\0\\x10\\0\\x03\\xc0\\x0c\\0\\x10\\0\\x01.{7}Microsoft DNS (6\\.1\\.7601.+)/\";sid:2019090280;gid:0;)", "2020062817": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Stowaway-\u6b63\u5411\u4ee3\u7406)|tag:\u653b\u51fb\u4ee3\u7406|tool:Stowaway|dest:home_net|level:attack|phase:exploit|type:exploit|severity:4|result:success|o_msg:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Stowaway-\u6b63\u5411\u4ee3\u7406)|attacker:src\";flow:established, to_server;flowbits:set, Stowaway_link_type_2_2;content:\"|30 30 30 30 30 30 30 30 30 31 00 00 00 00 00 00|\";offset:16;depth:16;content:\"|00 00 00 30 30 30 30 30 30 30 30 30 30 |\";distance:64;within:13;sid:2020062817;rev:1;)", "2020032607": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Discuz! X3.1 \u540e\u53f0\u4efb\u610f\u4ee3\u7801\u6267\u884c|tag:\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Discuz! X3.1 \u540e\u53f0\u4efb\u610f\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, discuz_3_4_sqli;content:\"POST\";http_method;content:\"/upload/admin.php\";http_uri;content:\"action=setting\";http_uri;distance:1;content:\"name=\\\"settingnew[statcode]\\\"\";http_client_body;content:\"<?php\";http_client_body;distance:0;within:80;sid:2020032607;rev:1;)", "2020051930": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee(loggers)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, spring_actuator_loggers;content:\"200\";http_stat_code;http_content_type;content:\"application\";content:\"spring-boot.actuator\";distance:0;content:\"json\";distance:0;pkt_data;content:\"{\\\"levels\\\":[\";http_server_body;startswith;content:\"\\\"loggers\\\":\";distance:0;http_server_body;content:\"configuredLevel\";distance:0;http_server_body;content:\"effectiveLevel\";distance:0;http_server_body;sid:2020051930;rev:1;)", "2026923": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"V3LU9iam\";fast_pattern;distance:0;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026923;rev:3;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2020041005": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:webshell\u6267\u884cnet user|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset,weblogic_xmldecode_1;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\". . . . . . . . :\";http_server_body;pcre:\"/[0-9a-f]{4}::[0-9a-f]{4}:[0-9a-f]{4}:[0-9a-f]{4}:[0-9a-f]{4}%[0-9a-f]{2}/RQ\";content:\". . . . . . . :\";http_server_body;pcre:\"/\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}/RQ\";sid:2020041005;)", "2019010004": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5ThinkPHP\u6f0f\u6d1e|tag:ThinkPHP\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728ThinkPHP\u6f0f\u6d1e|attacker:src\";content:\"GET\";nocase;http_method;content:\"/index.php\";nocase;http_uri;within:100;pcre:\"/(\\/)?\\?s=(\\/)?index\\/(\\\\)?think\\\\view\\\\driver\\\\Php/display&content=/iUR\";flow:to_server,established;gid:0;sid:2019010004;rev:1;)", "2024219": "alert smb $HOME_NET any -> $HOME_NET any (msg:\"name:\u5229\u7528MS17-010\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u7591\u4f3c\u5b58\u5728\u6c38\u6052\u6d6a\u6f2b\u6f0f\u6d1e\u5806\u55b7\u5c04\u884c\u4e3a - MS17-010\";flow:to_server,established;content:\"|ff|SMB|25 00 00 00 00 18|\";offset:4;depth:10;content:\"|07 c0 00 00 00 00 00 00 00 00 00 00 00 00 00 08|\";fast_pattern;within:16;content:\"|00 08|\";distance:2;within:2;content:\"|0e 00 00 40 00|\";distance:2;within:5;content:\"|00 00 00 00 00 00 01 00 00 00 00 00 00 00 00|\";distance:2;within:15;content:\"|00 00 00 00 00 00 00 00 00|\";isdataat:!1,relative;threshold:type threshold, track by_src, count 20, seconds 1;metadata:former_category EXPLOIT;classtype:trojan-activity;sid:2024219;rev:1;metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_04_17;)", "2008464": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (adsntD)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| adsntD\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008464;classtype:trojan-activity;sid:2008464;rev:8;)", "2020051923": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee(mappings)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, spring_actuator_4_mappings;content:\"/actuator/mappings\";http_uri;sid:2020051923;rev:1;)", "2019090111": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:vsFTPd\u8fde\u63a5|direction:in|level:action|service_name:vsFTPd|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728vsFTPd|server:src\";flow:from_server,established;content:\"500\";depth:3;pcre:\"/^500 OOPS: vsftpd: both local and anonymous access disabled!\\r\\n/\";sid:2019090111;gid:0;)", "160322301": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u9ed1\u5ba2\u5de5\u5177\u4e2d\u56fd\u83dc\u5200|type:rat|tag:ChinaChopper|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u4e2d\u56fd\u83dc\u5200\u8fdb\u884cPhP WebShell\u8fde\u63a5\u5c1d\u8bd5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";nocase;http_method;content:\"|3D 24|xx|25|3Dchr\";nocase;content:\"|26|z0|3D|\";nocase;content:\"|26|z1|3D|\";nocase;sid:160322301;rev:1;)", "2019010125": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5371\u9669\u914d\u7f6e\uff1a\u5141\u8bb8Apache Solr\u52a0\u8f7d\u6307\u5b9a\u6a21\u677f|tag:Apache Solr|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u5371\u9669\u914d\u7f6e\uff1a\u5141\u8bb8Apache Solr\u52a0\u8f7d\u6307\u5b9a\u6a21\u677f|attacker:src\";flowbits:set, solr_risk_config;flow:to_server,established;content:\"/solr/\";http_uri;startswith;content:\"/config\";http_uri;distance:2;content:\"\\\"params.resource.loader.enabled\\\": \\\"true\\\"\";http_client_body;sid:2019010125;rev:1;)", "2020050601": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5229\u7528SaltStack\u6f0f\u6d1e\u83b7\u53d6root_key(CVE-2020-11651,CVE-2020-11652)|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:SaltStack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2020-11651,CVE-2020-11652)\u3010\u83b7\u53d6root_key\u3011|severity:3|attacker:src\";flow:to_server, established;flowbits:set, cve_2020_11651_read_root_key;content:\"enc|a5|clear|a4|load\";content:\"cmd\";distance:2;within:3;content:\"_prep_auth_info\";distance:1;within:15;sid:2020050601;rev:2;)", "2020051920": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee(env)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, spring_actuator_env;content:\"200\";http_stat_code;http_content_type;content:\"application\";content:\"spring-boot.actuator\";distance:0;content:\"json\";distance:0;pkt_data;content:\"{\\\"activeProfiles\\\":[\\\"prod\\\"]\";http_server_body;startswith;sid:2020051920;rev:1;)", "2020022605": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u8bfb\u53d6/etc/issue|tag:\u6267\u884c\u547d\u4ee4|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u8bfb\u53d6/etc/issue|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"|20 5c 53 0a|\";http_server_body;content:\"Kernel|20|\";distance:0;within:7;http_server_body;content:\"|5c 72 20|\";distance:0;within:3;http_server_body;content:\"on|20|\";distance:0;within:3;http_server_body;content:\"an|20|\";distance:0;within:3;http_server_body;content:\"|5c 6d 0a 0a|\";distance:0;within:4;http_server_body;sid:2020022605;rev:1;)", "2019090202": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([-\\w_.]+) ESMTP\\r\\n402 Error: command not implemented\\r\\n$/\";sid:2019090202;gid:0;)", "2020041003": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, weblogic_xmldecode_1;http_content_type;content:\"text/xml\";pkt_data;content:\"<faultstring>\";http_server_body;pcre:\"/^((java.util.NoSuchElementException)|(sun\\.misc\\.BASE64Decoder)|(weblogic\\.utils\\.Hex)|(java\\.lang\\.ProcessBuilder)|(java\\.lang\\.Runtime)|(java\\.lang\\.String)|(java\\.io\\.PrintWriter)|(java\\.beans\\.XMLDecoder)|(0))/QRi\";content:!\"<faultstring>Invalid attribute for element \";http_server_body;sid:2020041003;rev:1;)", "2018060009": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:b374k Webshell\u8fde\u63a5\u6210\u529f|tag:Webshell\u8fde\u63a5|direction:in|dest:home_net|src:external_net|level:attack|severity:4|phase:control|type:shell|result:success|o_msg:b374k Webshell\u8fde\u63a5\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";content:\"200\";http_stat_code;content:\"cwd=\";offset:0;http_content_type;content:\"text/html\";pkt_data;content:\"<title>b374k\";http_server_body;within:50;flow:from_server,established;flowbits:isset,b374k_shell;gid:0;sid:2018060009;rev:1;)", "2020050701": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:HTTP\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2015-1635)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:recon|result:unknown|o_msg:\u626b\u63cfHTTP\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2015-1635)|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server, established;flowbits:set, cve_2015_1635;content:\"Range: bytes=0-18446744073709551615\";http_header;sid:2020050701;rev:2;)", "2020062822": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Apache Dubbo \u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Apache Dubbo \u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u5229\u7528\u6210\u529f\uff0c\u5916\u8fdeldap/rmi\u670d\u52a1\u5668|attacker:dest\";flow:established, to_server;xbits:isset, dubbo_link_jrmp, track ip_src;dsize:7;content:\"JRMI\";startswith;sid:2020062822;rev:1;)", "2018062804": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:\u83dc\u5200\u8fde\u63a5\u8bf7\u6c42|tag:\u83dc\u5200|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u83dc\u5200\u8fde\u63a5asp webshell\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;pcre:\"/=.{0,2}Execute.{0,1}\\(.{0,3}Execute.{0,1}\\(.{0,3}On.{0,3}Error.{0,3}Resume.{0,3}Next.{0,4}Function/iP\";sid:2018062804;rev:1;)", "2020070103": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Netflix Conductor \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Netflix Conductor \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/api/metadata/taskdefs\";http_uri;depth:30;http_content_type;content:\"application/json\";pkt_data;content:\"\\\"name\\\"\";http_client_body;content:\"${\";http_client_body;distance:2;within:40;sid:2020070103;rev:1;)", "2020060902": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:FreeMarker\u6a21\u677f\u6ce8\u5165|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|type:exploit|severity:3|result:unknown|o_msg:\u653b\u51fb\u8005\u5229\u7528FreeMarker\u6a21\u677f\u5f15\u64ce\uff0c\u5b9e\u73b0\u4ee3\u7801\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"$\";http_client_body;content:\"{\";http_client_body;distance:0;within:10;content:\"freemarker.template.utility.Execute\";http_client_body;distance:0;sid:2020060902;rev:1;)", "2019010074": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7591\u4f3c\u51b0\u874ewebshell|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u51b0\u874e\u7684\u8bf7\u6c42\u5305|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\".asp\";http_uri;content:\"=\";http_cookie;pcre:\"/[a-fA-F0-9]{32}/CR\";http_content_len;byte_test:0,>=,7000,0,string,dec;pkt_data;http_accept;content:\"text/html, image/gif, image/jpeg, *\\; q=.2, */*\\; q=.2\";pkt_data;content:!\"<?xml\";http_client_body;content:\"a\";nocase;http_client_body;pcre:\"/^([A-Za-z0-9+\\/]{4}){100,}([A-Za-z0-9+\\/]{4}|[A-Za-z0-9+\\/]{3}=|[A-Za-z0-9+\\/]{2}==)$/P\";sid:2019010074;gid:0;rev:1;)", "2008715": "alert tcp $HOME_NET any -> $HOME_NET 445 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";flow:established,to_server;content:\"|20 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"|00 2E 00 2E 00 5C 00 2E 00 2E 00 5C|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008715;classtype:attempted-admin;sid:2008715;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2019080032": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u8bd5\u56fe\u521d\u59cb\u5316abptts\u96a7\u9053|tag:tunnel|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|tool:abptts|type:infil|result:unknown|o_msg:\u901a\u8fc7abptts\u7684webshell\u8f6c\u53d1tcp\u6d41\u91cf|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;http_header_names;content:\"user-agent|0d 0a|\";content:\"content-type|0d 0a|\";content:\"accept-encoding|0d 0a|\";content:\"Content-Length|0d 0a|\";content:\"Host|0d 0a|\";content:!\"accept|0d 0a|\";nocase;content:!\"accept-language|0d 0a|\";nocase;http_connection;content:\"close\";pkt_data;content:\"abptts\";http_uri;pcre:\"/abptts\\.(aspx|jsp)$/U\";flowbits:set,state_abptts_init;flowbits:noalert;xbits:set,state_abptts_init,track ip_pair;sid:2019080032;)", "2018071202": "alert tcp $HOME_NET any -> $HOME_NET any (msg:\"name:meterpreter\u9ed1\u5ba2shell\u53cd\u5f39\u8bf7\u6c42|tag:meterpreter|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230windows metasploit\u7684meterpreter\u9ed1\u5ba2shell\u53cd\u5f39\u8bf7\u6c42\";flow:established,to_server;content:\"|16 03 01 00 51 01 00 00 4d 03 01 5b|\";content:\"|20 00 39 00 38 00 35 00 16 00 13 00 0a 00 33 00 32 00 2f 00 07 00 05 00 04 00 15 00 12 00 09 00 ff 01 00 00 04 00 23 00 00|\";sid:2018071202;rev:1;)", "2020070314": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|tag:\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\".php\";http_uri;distance:0;content:\"call_user_func\";http_uri;fast_pattern;pcre:\"/\\$_(GET|POST)\\[\\S+\\]/URi\";sid:2020070314;rev:1;)", "2019090129": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK (.*) Dovecot ready\\.\\r\\n$/\";sid:2019090129;gid:0;)", "2019090294": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:VNC\u8fde\u63a5|direction:in|level:action|service_name:VNC|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728VNC|server:src\";flow:from_server,established;content:\"RFB\";depth:3;pcre:\"/^RFB 103\\.006\\n/\";sid:2019090294;gid:0;)", "2019090030": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:VNC\u8fde\u63a5|direction:in|level:action|service_name:VNC|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728VNC|server:src\";flow:from_server,established;content:\"RFB\";depth:3;pcre:\"/^ISD 001\\.000\\n$/\";sid:2019090030;gid:0;)", "2019090064": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MongoDB\u8fde\u63a5|direction:in|level:action|service_name:MongoDB|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728MongoDB|server:src\";flow:from_server,established;content:\"|00 00 00|\";offset:1;depth:3;pcre:\"/^.\\0\\0\\0....:0\\0\\0\\x01\\0\\0\\0\\x08\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x01\\0\\0\\0\\+\\0\\0\\0\\x02errmsg\\0\\x0e\\0\\0\\0need to login\\0\\x01ok\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0/\";sid:2019090064;gid:0;)", "2019010026": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Bash\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e|tag:\u547d\u4ee4\u6ce8\u5165|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u5c1d\u8bd5\u8fdb\u884c\u547d\u4ee4\u6ce8\u5165|attacker:src\";flow:to_server,established;content:\"()\";http_user_agent;nocase;pcre:\"/(\\s{1,3})?\\{(\\s{1,3})?:\\;\\}\\;/VR\";gid:3;sid:2019010026;rev:1;)", "2008266": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (Zilla)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| Zilla|0d 0a|\";http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008266;classtype:trojan-activity;sid:2008266;rev:7;)", "2019060002": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6b63\u5e38ASP\u8bf7\u6c42|tag:php|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:1|result:unknown|o_msg:\u6b63\u5e38asp\u548caspx\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";content:\"POST\";nocase;http_method;content:\".asp\";nocase;http_uri;pcre:\"/\\.(asp|aspx)(\\?)?/iU\";flow:to_server,established;flowbits:set,post_req;flowbits:noalert;gid:0;sid:2019060002;rev:1;)", "2013090": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DarkRat\u540e\u95e8\u6728\u9a6c|type:rat|tag:DarkRat|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230Backdoor.Win32.Fynloski.A/DarkRat\u4e0a\u7ebf\u51fa\u7ad9\u6d41\u91cf\";flow:to_server,established;dsize:<16;content:\"KEEPALIVE\";depth:9;pcre:\"/^KEEPALIVE\\x7c?\\d/\";reference:url,www.microsoft.com/security/portal/Threat/Encyclopedia/Entry.aspx?Name=Backdoor%3aWin32%2fFynloski.A&ThreatID=-2147327112;reference:url,www.contextis.com/research/blog/darkcometrat/;reference:url,www.eff.org/deeplinks/2012/08/syrian-malware-post;reference:md5,a2f58a4215441276706f18519dae9102;classtype:trojan-activity;sid:2013090;rev:10;)", "2008697": "alert udp $HOME_NET any -> $HOME_NET 139 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";content:\"|20 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"../../\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008697;classtype:attempted-admin;sid:2008697;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2020021004": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Drupal7 \u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u547d\u4ee4\u6267\u884c)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Drupal7 \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"SchemaCache\";content:\"*keysToPersist\";distance:0;content:\"#form_id\";distance:0;content:\"*storage\";distance:0;sid:2020021004;rev:1;)", "2020021016": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Phalcon\u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u547d\u4ee4\u6267\u884c)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Phalcon\u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"GuzzleHttp\";content:\"Psr7\";distance:1;content:\"FnStream\";distance:1;content:\"FnStreammethods\";distance:1;content:\"Pydio\";distance:1;content:\"ShutdownScheduler\";distance:1;content:\"ShutdownSchedulercallbacks\";distance:1;sid:2020021016;rev:1;)", "2811476": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u77ff\u6c60\u5730\u5740|type:mining|tag:BitCoinMiner|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230CoinMiner\u6728\u9a6c\u7684stratum\u534f\u8bae\u8ba4\u8bc1\u4fe1\u606f2015-06-15\";flow:established,to_server;content:\"{|22|id|22 3A|\";depth:6;content:\"|22|method|22 3a 20 22|mining.authorize|22 2c|\";within:100;content:\"|22|params|22|\";within:50;content:\"|5b 22|\";distance:0;pcre:\"/^(?:(?:(?:4(?:f(?:9(?:d(?:b(?:80a|e00)|ac04)|f(?:1a06|fa04)|(?:2ee|6e8)00|18a13|36604)|(?:3(?:1(?:00|9a)|00e|b22)|2(?:2c6|5fa)|e(?:c1e|de0))00|4(?:(?:012|350)02|(?:7ae|918)01|5b206|6e004|84a00)|7(?:(?:c6|db)402|49001|bb40b|f2400)|b(?:4(?:5404|fa00)|72406)|8(?:(?:3a4|822)01|cd400)|a(?:0c802|56e00|90a09)|5d1804|cbc201)|e(?:(?:b(?:caa|ec2)|c17a|f8ee)00|8(?:35e01|bda00)|a6(?:1400|5c04)|9(?:2fe|ed0)01)|b(?:4(?:40800|f3c01)|1a7801|275800)|a(?:f(?:76800|91a04)|793a02)|8(?:d8da03|ffb400)|(?:791a|99d8)000|43b3601)|50(?:(?:0(?:08c|890)|508e)00|1c6a01|4b5c02)|(?:Mila432|rymont).1|kukaracho64|3ef4a802)\", \"|mildcyan.1\", \"x)x|fopen.mineiro\", \"passs)\\\"\\]/R\";reference:url,research.zscaler.com/2013/12/bitcoin-mining-operation-seen-across.html;reference:url,www.btcguild.com/new_protocol.php;reference:url,mining.bitcoin.cz/stratum-mining;reference:md5,f8d81ae49c7c8cd058ac36110204da8e;classtype:trojan-activity;sid:2811476;rev:1;)", "2019090091": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:FileZilla\u8fde\u63a5|direction:in|level:action|service_name:FileZilla|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728FileZilla|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220[ -].*\\r\\n214-The following commands are recognized:\\r\\n.*\\r\\n214 Have a nice day\\.\\r\\n/\";sid:2019090091;gid:0;)", "2020051933": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee(scheduledtasks)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, spring_actuator_scheduledtasks;content:\"/actuator/scheduledtasks\";http_uri;sid:2020051933;rev:1;)", "2012765": "alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:\"name:Cobalt_Strike\u901a\u8fc7DNS\u7aef\u53e3\u4f20\u8f93\u53ef\u6267\u884c\u6587\u4ef6|tag:\u8fdc\u63a7|tool:Cobalt_Strike|direction:out|level:attack|phase:control|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u5229\u7528DNS\u7aef\u53e3\u4f20\u8f93\u63a8\u9001\u53ef\u6267\u884c\u6587\u4ef6\u548c\u6728\u9a6c|severity:1\";flow:established,from_server;content:\"MZ\";within:8;isdataat:76,relative;content:\"This program cannot be run in DOS mode.\";distance:76;sid:2012765;rev:7;metadata:created_at 2011_05_03, updated_at 2011_05_03;)", "2019000056": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JBOSS \u767b\u5f55\u884c\u4e3a|tag:\u767b\u5f55\u884c\u4e3a|dest:home_net|level:attack|severity:3|phase:exploit|result:unknown|o_msg:JBOSS \u767b\u5f55\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, jboss_login;content:\"POST\";http_method;content:\"/admin-console/login.seam\";http_uri;content:\"\\;jsessionid=\";http_uri;distance:0;within:12;content:\"name=\";http_client_body;content:\"admin\";http_client_body;distance:0;content:\"password=\";http_client_body;content:\"vulhub\";http_client_body;distance:0;sid:2019000056;rev:1;)", "2019090301": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DNS\u8fde\u63a5|direction:in|level:action|service_name:Microsoft DNS|service_class:other|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft DNS|server:src\";flow:from_server,established;content:\"|00 1e 00 06 81 04 00 01 00 00 00 00 00 00 07|version|04|bind|00 00 10 00 03|\";offset:0;depth:32;sid:2019090301;gid:0;)", "2019090145": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Exim\u8fde\u63a5|direction:in|level:action|service_name:Exim(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Exim|server:src\";flow:from_server,established;content:\"554\";depth:3;pcre:\"/^554 SMTP synchronization error\\r\\n/\";sid:2019090145;gid:0;)", "2020060207": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(C3P0-HTTP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"application/\";pcre:\"/(x-www-form-urlencoded)|(x-java-serialized-object)/R\";pkt_data;content:\"|ac ed 00 05|\";http_client_body;fast_pattern;content:\"com.mchange.v2.c3p0.PoolBackedDataSource\";http_client_body;content:\"impl.PoolBackedDataSourceBasInumHelperThreadsLconnectionPoolDataSourcet\";http_client_body;content:\"com.mchange.v2.naming.ReferenceIndirector$ReferenceSerialized\";http_client_body;sid:2020060207;rev:1;)", "2019060007": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"=\";http_cookie;pcre:\"/[a-fA-F0-9]{32}/CR\";http_content_len;byte_test:0,=,16,0,string,dec;noalert;flowbits:isset, bingxie_webshell_jsp;flowbits:set, bingxie_webshell_step2_jsp;sid:2019060007;gid:0;rev:1;)", "2020081716": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:\u5c1d\u8bd5\u901a\u8fc7powershell\u6267\u884c\u547d\u4ee4\u4e0b\u8f7d\u6587\u4ef6|severity:2|gray:true|attacker:src\";flow:to_server, established;content:\"powershell\";fast_pattern;content:\"(new-object Net.WebClient).DownloadFile(\";distance:0;within:200;sid:2020081716;rev:1;)", "2826254": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike Beacon\u4f7f\u7528\u7684 User-Agent|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike Beacon  http\u8bf7\u6c42\u4f7f\u7528\u7684UA|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\"like VGVhbTEK|0d 0a|\";fast_pattern;http_header;http_header_names;content:!\"Accept|0d 0a|\";content:!\"Referer|0d 0a|\";content:\"Cookie|0d 0a|\";metadata:former_category TROJAN;reference:md5,d8ed3ebcae4ec7d56a76cd0e8d49b4f3;classtype:trojan-activity;sid:2826254;rev:4;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2017_05_04, performance_impact Moderate, updated_at 2020_03_09;)", "2020063001": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Nexus 2 yum\u63d2\u4ef6\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Nexus 2 yum\u63d2\u4ef6\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2019_5475;content:\"PUT\";http_method;content:\"/service/siesta/capabilities/\";http_uri;depth:50;http_content_type;content:\"application/json\";pkt_data;content:\"\\\"typeId\\\"\";http_client_body;content:\"\\\"yum\\\"\";http_client_body;distance:0;within:20;content:\"\\\"value\\\"\";http_client_body;distance:0;within:200;pcre:\"/(\\:\\\\{1,2}Windows\\\\{1,2}System32\\\\{1,2})|(bash (-i|-c))|(\\/bin\\/)/PR\";sid:2020063001;rev:1;)", "2020061311": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Draytek\u4f01\u4e1a\u7f51\u7edc\u8bbe\u5907\u547d\u4ee4\u6ce8\u5165\uff08CVE-2020-8515\uff09|tag:\u547d\u4ee4\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Draytek\u4f01\u4e1a\u7f51\u7edc\u8bbe\u5907\u547d\u4ee4\u6ce8\u5165\uff08CVE-2020-8515\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"/cgi-bin/mainfunction.cgi\";http_uri;depth:80;content:\"keyPath=\";http_client_body;pcre:\"/(%27%0A)|(\\|\\|)|(%7c%7c)|(%7c)|(%3b)|(%26)|([\\|\\;]).*(ls|cd|pwd|wget|curl|adduser|cat|passwd|chmod|echo|netstat|uname|sysctl|mysql|history|bash|useradd|ps|ifconfig|find|id|grep|awk|last|lsof|iptables|find|whoami|touch|ping)/PRi\";sid:2020061311;rev:1;)", "2020072908": "alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528\u5411\u65e5\u8475\u8fdc\u63a7|tag:\u5411\u65e5\u8475\u8fdc\u63a7|direction:in|level:action|service_name:\u5411\u65e5\u8475\u8fdc\u63a7|severity:1|service_class:rlogin|result:unknown|o_msg:\u4f7f\u7528\u5411\u65e5\u8475\u8fdc\u63a7|server:src\";flow:to_server;flowbits:isset, sunlogin_1;content:\"|6f 72 61 79|\";depth:4;content:\"SHA1:\";distance:52;within:6;sid:2020072908;rev:2;)", "2019010010": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5XSS\u6f0f\u6d1e|tag:XSS|dest:home_net|level:attack|severity:1|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728XSS|attacker:src\";content:\"<script>alert(\";http_client_body;nocase;pcre:\"/'?\\w+'?\\)<\\/script>/iPR\";flow:to_server,established;gid:0;sid:2019010010;rev:1;)", "2018082001": "alert tcp $HOME_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528net user\u547d\u4ee4|tag:netuser|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:dest|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51Net User\u547d\u4ee4\u7684\u56de\u5305\";flow:established;content:\"|b5 c4 d3 c3 bb a7 d5 ca bb a7|\";fast_pattern;content:\"-------------------------------------------------------------------------------\";distance:0;content:\"Administrator\";within:20;classtype:successful-user;sid:2018082001;rev:1;metadata:created_at 2018_08_20, updated_at 2018_08_20;)", "202000806": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874eWebshell\u901a\u8baf|tag:webshell|tool:\u51b0\u874e|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u51b0\u874eWebshell\u901a\u8baf|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, bingxie_3_0_php;content:\"200\";http_stat_code;http_content_len;content:\"129\";pkt_data;http_content_type;content:\"text/html\";pkt_data;http_header_names;content:!\"Cookie\";pkt_data;pcre:\"/^[A-Za-z0-9+\\/]{126}[A-Za-z0-9+\\/=]{2}\\x0a$/Q\";sid:202000806;gid:0;rev:1;)", "2020030202": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:FasterXML/jackson-databind \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-9548\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:FasterXML/jackson-databind \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-9548\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"br.com.anteros.dbcp.AnterosDBCPConfig\";content:\"healthCheckRegistry\";distance:0;pcre:\"/(ldap|rmi):\\/\\//Ri\";sid:2020030202;rev:1;)", "2019010108": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ThinkCMF \u4efb\u610f\u5185\u5bb9\u5305\u542b\u6f0f\u6d1e|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:ThinkCMF \u4efb\u610f\u5185\u5bb9\u5305\u542b\u6f0f\u6d1e|attacker:src\";flow:to_server,established;flowbits:set, thinkcmf_include_file;content:\"POST\";http_method;content:\"a=fetch\";http_client_body;content:\"content=\";http_client_body;content:\"php\";http_client_body;distance:0;content:\"file_put_contents\";http_client_body;distance:1;sid:2019010108;rev:1;)", "2020032106": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache axis2 \u4e0a\u4f20\u884c\u4e3a|tag:\u654f\u611f\u884c\u4e3a|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Apache axis2 \u4e0a\u4f20\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, axis2_upload;content:\"POST\";http_method;content:\"/axis2-admin/doUpload\";http_uri;nocase;http_content_type;content:\"multipart/form-data\";pkt_data;content:\"WebKitFormBoundary\";http_client_body;sid:2020032106;rev:1;)", "2019090106": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:vsFTPd\u8fde\u63a5|direction:in|level:action|service_name:vsFTPd|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728vsFTPd|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 ready, dude \\(vsFTPd (\\d[0-9.]+): beat me, break me\\)\\r\\n/\";sid:2019090106;gid:0;)", "2009582": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7aef\u53e3\u626b\u63cf|tag:\u626b\u63cf|tool:Nmap|type:\u6307\u7eb9\u63a2\u6d4b|direction:in|phase:recon|src:external_net|dest:home_net|level:attack|severity:1|result:unknown|o_msg:nmap -sS \u9ed8\u8ba4\u626b\u63cf\u7aef\u53e3\";fragbits:!D;dsize:0;flags:S,CE;ack:0;window:1024;threshold:type both, track by_src, count 20, seconds 1;gid:0;sid:2009582;rev:3;)", "2020060405": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ThinkPHP 5.x \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:ThinkPHP 5.x \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, tp_5_23_rce;content:\"POST\";http_method;content:\"s=captcha\";http_uri;within:60;content:\"_method=__construct\";http_client_body;content:\"filter\";http_client_body;content:\"method=\";http_client_body;sid:2020060405;rev:1;)", "2018081309": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u8fdb\u884c\u6d4f\u89c8C\u76d8\";dsize:9;flow:from_server,established;content:\"LIST C:|0d 0a|\";depth:9;nocase;flowbits:isset,TB_ZxShell_2;sid:2018081309;rev:1;)", "2026938": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"Zva2UtQ29\";distance:0;fast_pattern;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026938;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2019090105": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:vsFTPd\u8fde\u63a5|direction:in|level:action|service_name:vsFTPd|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728vsFTPd|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 vsFTPd (.*) ready\\.\\.\\. \\[charset=\\w+\\]\\r\\n/\";sid:2019090105;gid:0;)", "2838092": "alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Cobalt Strike\u6728\u9a6cSSL\u8bc1\u4e66\u4f20\u8f93|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|dest:home_net|src:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike\u6728\u9a6cSSL\u8bc1\u4e66\u4f20\u8f93\";flow:established,from_server;tls_cert_subject;content:\"CN=verybigbro.dns-cloud.net\";nocase;isdataat:!1,relative;metadata:former_category MALWARE;reference:md5,ef975f2e890316944997b781db600dce;classtype:trojan-activity;sid:2838092;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2019_08_20, malware_family Cobalt_Strike, performance_impact Low, updated_at 2019_09_28;)", "2020051206": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Jboss jmx\u2014console\u8fdc\u7a0b\u90e8\u7f72war\u5305|tag:\u5371\u9669\u884c\u4e3a|dest:home_net|level:attack|phase:exploit|force_save:true|result:success|o_msg:Jboss jmx\u2014console\u8fdc\u7a0b\u90e8\u7f72war\u5305,\u53ef\u80fd\u5b58\u5728\u8fd0\u7ef4\u6b63\u5e38\u4f7f\u7528\u7684\u60c5\u51b5\uff0c\u9700\u8981\u7504\u522b|severity:2|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, jboss_remote_war;content:\"200\";http_stat_code;content:\"<title>Operation Results</title>\";http_server_body;content:\"Operation completed successfully without a return value.\";http_server_body;distance:0;sid:2020051206;rev:2;)", "2018081301": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:DeSpy\u540e\u95e8\u6728\u9a6c|type:rat|tag:DeSpy|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u94f6\u884c\u7a83\u5bc6\u6728\u9a6cWin.Banker.DeSpy.a\u4e0a\u7ebf|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"TRUEFalse\";http_server_body;flowbits:isset,TB_DESPY;sid:2018081301;rev:1;)", "2019090248": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:OpenVPN\u8fde\u63a5|direction:in|level:action|service_name:OpenVPN|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728OpenVPN|server:src\";flow:from_server,established;content:\"|00|*@\";depth:3;pcre:\"/^\\0\\*@.*\\0\\0\\0\\0\\0/\";sid:2019090248;gid:0;)", "2008400": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (ReadFileURL)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| ReadFileURL|0d 0a|\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008400;classtype:trojan-activity;sid:2008400;rev:10;)", "2019090192": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([-\\w_.]+) SMTPD Server - Postfix\\r\\n/\";sid:2019090192;gid:0;)", "2018060027": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:JSP Webshell\u8fde\u63a5\u6210\u529f|tag:webshell\u8fde\u63a5\u6210\u529f|direction:in|dest:home_net|src:external_net|level:attack|severity:4|phase:control|type:shell|result:success|o_msg:\u68c0\u6d4b\u5230JSP webshell,\u6210\u529f\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;http_content_len;byte_test:0,<=,21,0,string,dec;pkt_data;content:\"|0a 0a 20 20 20 20 20 0a 20 20 20 20 20 0a 2d 3e 7c 7c 3c 2d|\";http_server_body;flow:from_server,established;flowbits:isset,jsp_req;gid:0;sid:2018060027;rev:1;)", "2027031": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"GlzIHByb2dyYW\";distance:0;fast_pattern;metadata:former_category ATTACK_RESPONSE;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027031;rev:2;metadata:attack_target DNS_Server, deployment Perimeter, signature_severity Major, created_at 2019_03_05, malware_family DNSlivery, updated_at 2019_03_05;)", "2835440": "alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u8fde\u63a5Cobalt Strike\u4f7f\u7528\u6076\u610f\u57df\u540d|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike DNS\u53cd\u5f39\";flow:established,to_server;tls_sni;content:\"omnibelts.appspot.com\";isdataat:!1,relative;metadata:former_category TROJAN;reference:md5,aba297a380c4e70d484f7ce9dc8ef59c;classtype:trojan-activity;sid:2835440;rev:1;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2019_03_19, malware_family Cobalt_Strike, performance_impact Low, updated_at 2019_09_28;)", "2028598": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike \u53cd\u8fde\u8bf7\u6c42|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike \u53cd\u8fde\u8bf7\u6c42\uff0c\u5e38\u7528\u6b63\u5e38\u7f51\u7ad9\u7684gif\u548ccss\u6587\u4ef6\uff0c\u5728\u5934\u90e8\u4f7f\u7528base64\u5bf9\u6307\u4ee4\u8fdb\u884c\u7f16\u7801|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"Mozilla/5.0 (compatible|3b 20|MSIE 9.0|3b 20|Windows NT 6.1|3b 20|WOW64|3b 20|Trident/5.0|3b 20|BOIE9|3b|ENGB)\";http_user_agent;depth:82;isdataat:!1,relative;metadata:former_category MALWARE;classtype:trojan-activity;sid:2028598;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2019_09_18, malware_family Cobalt_Strike, performance_impact Low, updated_at 2019_09_28;)", "2019010044": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u5229\u7528Jira\u670d\u52a1\u7aef\u6a21\u677f\u6ce8\u5165\u6f0f\u6d1e|tag:SSTI|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Jira\u670d\u52a1\u7aef\u6a21\u677f\u6ce8\u5165(CVE-2019-11581)|attacker:src\";flow:to_server,established;content:\"POST\";nocase;http_method;content:\"/secure/admin/SendBulkMail.jspa\";http_uri;content:\"subject=\";http_client_body;pcre:\"/\\$\\w+\\.\\w+\\([^\\)]*\\)/P\";distance:0;gid:3;sid:2019010044;)", "2020021015": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Phalcon\u53cd\u5e8f\u5217\u5316\u653b\u51fb(\u547d\u4ee4\u6267\u884c)|tag:PHP\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Phalcon\u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Phalcon\";content:\"File\";distance:1;content:\"*_transaction\";distance:1;content:\"php://input\";distance:1;sid:2020021015;rev:1;)", "2020052514": "alert dns $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528dnslog.bid\u8fdb\u884c\u53cd\u5f39|tag:dnslog|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u5229\u7528dnslog\u8fdb\u884c\u53cd\u5f39|attacker:dest\";flow:established, to_server;dns_query;content:\".dnslog.bid\";pkt_data;sid:2020052514;rev:1;)", "2017120104": "alert dns $HOME_NET any -> $EXTERNAL_NET 53 (msg:\"name:\u5efa\u7acb\u901a\u4fe1\u96a7\u9053|type:tunneling|tag:DNS\u96a7\u9053|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:2|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5f02\u5e38\u7684TXT\u7c7b\u578b\u8bf7\u6c42\";content:!\"|00|\";offset:12;depth:1;content:\"|00 10 00 01|\";offset:82;depth:61;isdataat:!1, relative;threshold:type threshold, track by_src, count 50, seconds 300;sid:2017120104;rev:2;)", "2018041908": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6697\u591c\u7cbe\u7075\u540e\u95e8\u6728\u9a6c|type:rat|tag:NightElf|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6c\u6697\u591c\u7cbe\u7075\u4e0a\u7ebf\u5305\uff08set\uff09\";dsize:10<>40;pcre:\"/^[[:print:]]+?-[[:print:]]+? - \\w+?\\x07[WL]AN\\x07Win/\";flow:to_server;flowbits:noalert;flowbits:set,TB_NightElf;sid:2018041908;rev:1;)", "2809481": "alert tcp $HOME_NET 28017 -> $EXTERNAL_NET any (msg:\"name:MongoDB\u516c\u7f51\u76f4\u63a5\u8bbf\u95ee-REST INFO\u54cd\u5e94|tag:\u672a\u6388\u6743\u6f0f\u6d1e|direction:in|src:home_net|dest:external_net|level:attack|phase:exploit|severity:4|result:success|o_msg:MongoDB\u516c\u7f51\u76f4\u63a5\u8bbf\u95ee-REST INFO\u54cd\u5e94\";flow:from_server,established;content:\"HTTP/1.0 200\";depth:12;fast_pattern;content:\"<title>mongod \";distance:0;content:\"/_commands\";distance:0;content:\"/_replset\";distance:0;sid:2809481;rev:1;)", "2020051243": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:D-Link Webproc \u76ee\u5f55\u7a7f\u8d8a|tag:\u76ee\u5f55\u7a7f\u8d8a|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:D-Link Webproc \u76ee\u5f55\u7a7f\u8d8a|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"/cgi-bin/webproc?\";http_uri;content:\"getpage=\";http_uri;distance:0;pcre:\"/^(\\/(var|etc|dev|bin|lib|opt|usr))|(\\.\\.)/URi\";sid:2020051243;rev:2;)", "2019090051": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(IMAP)|direction:in|level:action|service_name:Microsoft Exchange(IMAP)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange|server:src\";flow:from_server,established;content:\"* BYE Connection refused|0d 0a|\";depth:26;sid:2019090051;gid:0;)", "2018010072": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5ThinkPHP\u6f0f\u6d1e|tag:ThinkPHP\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728ThinkPHP\u6f0f\u6d1e|attacker:src\";content:\"POST\";nocase;http_method;content:\"/module/aciton/param1/\";http_uri;within:1000;pcre:\"/$({|%7b)@?(system|eval|phpinfo|print)\\(($_GET|$_POST)?/iU\";flow:to_server,established;gid:0;sid:2018010072;rev:1;)", "2020051104": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Zabbix SQL(jsrpc.php) \u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2016-10134\uff09|tag:SQL\u6ce8\u5165\u6f0f\u6d1e|dest:home_net|level:attack|phase:exploit|result:success|o_msg:Zabbix SQL(jsrpc.php) \u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2016-10134\uff09|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, CVE-2016-10134;content:\"200\";http_stat_code;content:\"Error in query [INSERT INTO profiles\";http_server_body;sid:2020051104;rev:2;)", "2020041019": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2016-0638)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2016-0638)|attacker:src\";flow:established, to_server;flowbits:set, cve_2016_0638;content:\"|ac ed 00 05|\";content:\"weblogic.rjvm.ClassTableEntry\";distance:0;content:\"weblogic.jms.common.StreamMessageImpl\";distance:0;sid:2020041019;rev:1;)", "2018010012": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Jboss\u6f0f\u6d1e\u5229\u7528|tag:Jboss\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|severity:2|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Jboss\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1eCVE-2017-12149 Payload\u653b\u51fb\u7cfb\u7edf[3]|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"invoker/readonly\";http_uri;content:\"ysoserial/Pwner\";content:\"ysoserial/payloads/util/Gadgets\";sid:2018010012;rev:1;)", "2020062810": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668\u6210\u529f(Venom-\u6b63\u5411\u4ee3\u7406)|tag:\u653b\u51fb\u4ee3\u7406|tool:Venom|direction:in|src:home_net|dest:external_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668\u6210\u529f(Venom-\u6b63\u5411\u4ee3\u7406)|attacker:dest\";flow:established, from_server;flowbits:isset, Venom_link_type_2;content:\"ABCDEFGH\";depth:8;content:\"VCMD\";distance:0;within:4;content:\"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|\";distance:0;within:16;sid:2020062810;rev:1;)", "2018010115": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|attacker:src\";content:\"updatexml(\";nocase;http_header;pcre:\"/\\d, *concat\\(0x\\w\\w,/iH\";flow:to_server,established;gid:0;sid:2018010115;rev:1;)", "2019000058": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Jenkins \u767b\u5f55\u884c\u4e3a|tag:\u767b\u5f55\u884c\u4e3a|dest:home_net|level:attack|severity:3|phase:exploit|result:unknown|o_msg:Jenkins \u767b\u5f55\u884c\u4e3a\uff0c\u7528\u6237\u540d\u5bc6\u7801\u90fd\u662fuser1|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, jenkins_login;content:\"POST\";http_method;content:\"/j_acegi_security_check\";http_uri;content:\"j_username=\";http_client_body;content:\"user1\";http_client_body;distance:0;content:\"j_password=\";http_client_body;content:\"user1\";http_client_body;distance:0;sid:2019000058;rev:1;)", "2020082003": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874eWebshell\u901a\u8baf|tag:webshell|tool:\u51b0\u874e|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u51b0\u874eWebshell\u901a\u8baf|gray:true|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, bingxie_3_0_4_jsp;content:\"200\";http_stat_code;http_content_type;content:\"text/\";pcre:\"/^(html|xml)/R\";pkt_data;pcre:\"/^[[:print:]]{0,3}[^[:print:]]/Q\";sid:2020082003;gid:0;rev:1;)", "2020040802": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Nexus Repository Manager 3 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Repository Manager 3 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/service/extdirect\";http_uri;http_content_type;content:\"application/json\";pkt_data;content:\"\\\"method\\\"\";http_client_body;pcre:\"/\"(create|update)\"/PR\";content:\"\\\"data\\\"\";http_client_body;content:\"\\\"privileges\\\"\";http_client_body;distance:0;pcre:\"/\\$(\\\\\\\\.)?\\{/PR\";sid:2020040802;rev:1;)", "2009356": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (runPatch.html)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| runPatch|2e|html\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/2009356;classtype:trojan-activity;sid:2009356;rev:8;)", "2020050606": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:SaltStack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2020-11651,CVE-2020-11652)|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|src:home_net|level:attack|phase:exploit|result:success|o_msg:SaltStack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2020-11651,CVE-2020-11652)\u3010\u6267\u884c\u547d\u4ee4\u3011|severity:3|attacker:dest\";flow:to_client, established;flowbits:isset, cve_2020_11651_rce_2;dsize:>0;sid:2020050606;rev:2;)", "2008209": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (SERVER2_03)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| SERVER\";http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008209;classtype:trojan-activity;sid:2008209;rev:8;)", "2020060229": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(BeanShell1-HTTP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"application/\";pcre:\"/(x-www-form-urlencoded)|(x-java-serialized-object)/R\";pkt_data;content:\"|ac ed 00 05|\";http_client_body;fast_pattern;content:\"java.util.PriorityQueue\";http_client_body;content:\"bsh.BSHAllocationExpression\";http_client_body;content:\"bsh.BSHAmbiguousName\";http_client_body;content:\"bsh.BSHArrayDimensions\";http_client_body;content:\"bsh.BSHLiteral\";http_client_body;sid:2020060229;rev:1;)", "2018041808": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DRAT2008\u540e\u95e8\u6728\u9a6c|type:rat|tag:DRAT2008|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cDRat2008\u4e0a\u7ebf\u5305\";dsize:80<>300;flow:to_server,established;content:\"000\";pcre:\"/^000\\|\\w+\\|Windows.+\\|.+CPU\\s+@\\s+.+?GHz\\|.+\\|\\x0a$/i\";flowbits:isset,TB_DRAT2009_1;flowbits:set,TB_DRAT2009_2;sid:2018041808;rev:1;)", "2019090029": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:VNC\u8fde\u63a5|direction:in|level:action|service_name:VNC|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728VNC|server:src\";flow:from_server,established;content:\"RFB\";depth:3;pcre:\"/^.{27}\\x16\\x20\\xe4\\xb0\\x95\\x63\\x29\\x78\\xdb\\x6e\\x35\\x92$/\";sid:2019090029;gid:0;)", "2020052515": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7d2b\u971e\u4ed9\u5b50\u626b\u63cf\u5668|tag:\u6f0f\u6d1e\u5229\u7528|tool:\u7d2b\u971e\u4ed9\u5b50\u626b\u63cf\u5668|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u7d2b\u971e\u4ed9\u5b50\u626b\u63cf\u5668|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\".wyzxxz.cn\";http_client_body;fast_pattern;sid:2020052515;rev:1;)", "2020071501": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(T3)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|attacker:src\";flow:established, to_server;flowbits:set, cve_2016_0638;flowbits:set, cve_2017_3248;flowbits:set, cve_2016_3510;flowbits:set, cve_2018_3191;flowbits:set, cve_2018_2893;flowbits:set, cve_2017_3248_or_2018_2628;xbits:set, weblogic_link_jrmp, track ip_dst, expire 60;content:\"t3\";depth:2;content:\"|ac ed 00 05|\";distance:0;pcre:\"/(org\\.apache\\.commons\\.collections\\.functors)|(com\\.sun\\.org\\.apache\\.xalan\\.internal\\.xsltc\\.trax)|(javassist)|(java\\.rmi\\.activation)|(sun\\.rmi\\.server)|(org\\.jboss\\.interceptor\\.builder)|(org\\.jboss\\.interceptor\\.reader)|(org\\.jboss\\.interceptor\\.proxy)|(org\\.jboss\\.interceptor\\.spi\\.metadata)|(org\\.jboss\\.interceptor\\.spi\\.model)|(com\\.bea\\.core\\.repackaged\\.springframework\\.aop\\.aspectj)|(com\\.bea\\.core\\.repackaged\\.springframework\\.aop\\.aspectj\\.annotation)|(com\\.bea\\.core\\.repackaged\\.springframework\\.aop\\.aspectj\\.autoproxy)|(com\\.bea\\.core\\.repackaged\\.springframework\\.beans\\.factory\\.suppor)t(|org\\.python\\.core)|(org\\.codehaus\\.groovy\\.runtime\\.ConvertedClosure)|(org\\.codehaus\\.groovy\\.runtime\\.ConversionHandler)|(org\\.codehaus\\.groovy\\.runtime\\.MethodClosure)|(org\\.springframework\\.transaction\\.support\\.AbstractPlatformTransactionManage)r(|java\\.rmi\\.server\\.UnicastRemoteObject)|(java\\.rmi\\.server\\.RemoteObjectInvocationHandler)|(com\\.bea\\.core\\.repackaged\\.springframework\\.transaction\\.support\\.AbstractPlatformTransactionManager)|(java\\.rmi\\.server\\.RemoteObject)|(java\\.lang\\.Runtime)|(com\\.bea\\.core\\.repackaged\\.aspectj\\.weaver\\.tools\\.cache)|(com\\.bea\\.core\\.repackaged\\.aspectj\\.weaver\\.tools)|(com\\.bea\\.core\\.repackaged\\.aspectj\\.weaver\\.reflect)|(com\\.bea\\.core\\.repackaged\\.aspectj\\.weaver)|(com\\.oracle\\.wls\\.shaded\\.org\\.apache\\.xalan\\.xsltc\\.trax)|(com\\.tangosol\\.coherence\\.rest\\.util\\.extractor\\.MvelExtractor)|(com\\.tangosol\\.internal\\.util\\.invoke)|(com\\.tangosol\\.internal\\.util\\.invoke\\.lambda)|(com\\.tangosol\\.coherence\\.rest\\.util\\.extractor)|(com\\.tangosol\\.coherence\\.rest\\.util)|(com\\.tangosol\\.util\\.extractor\\.ReflectionExtractor)|(com\\.tangosol\\.util\\.extractor\\.ConditionalExtractor)|(com\\.tangosol\\.util\\.extractor\\.ScriptvalueExtractor)|(com\\.tangosol\\.util\\.extractor\\.UniversalUpdater)|(com\\.tangosol\\.util\\.extractor\\.ComparisonValueExtractor)|(com\\.tangosol\\.util\\.extractor\\.ReflectionUpdater)|(com\\.tangosol\\.util\\.filter\\.LimitFilter)|(com\\.tangosol\\.util\\.extractor\\.ChainedExtractor)/R\";sid:2020071501;rev:1;)", "2020072208": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4e0a\u4f20\u6076\u610f\u884c\u4e3a|tag:\u4e0a\u4f20\u6076\u610f\u6587\u4ef6|level:attack|phase:exploit|result:unknown|o_msg:\u4e0a\u4f20\u6076\u610f\u884c\u4e3a|severity:2|dest:home_net|success_by:resp_body_upload_success_str|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, upload_script_file;content:\"POST\";http_method;http_content_type;content:\"multipart/form-data\\;\";content:\"boundary=\";pkt_data;content:\"Content-Disposition:\";nocase;http_client_body;pcre:\"/filename=\".+\\.(php|jsp|asp|asa|aspx|ashx|asax|ascx|asmx|soap|jspx|cer|cdx)/PRi\";sid:2020072208;rev:1;)", "2020062801": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5c1d\u8bd5\u8fde\u63a5 nps \u4ee3\u7406\u670d\u52a1\u5668|tag:\u653b\u51fb\u4ee3\u7406|tool:nps|direction:in|src:home_net|dest:external_net|level:attack|phase:control|type:control|severity:4|result:unknown|o_msg:\u5c1d\u8bd5\u8fde\u63a5 nps \u4ee3\u7406\u670d\u52a1\u5668\";flow:established, to_server;flowbits:set, nps_link;content:\"TST|06 00 00 00|\";depth:7;content:\"|06 00 00 00|\";distance:6;within:8;content:\"chan|00 ff ff ff ff 1e 00|\";distance:32;within:100;sid:2020062801;rev:1;)", "2019010118": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Solr \u6a21\u7248\u6ce8\u5165\u6f0f\u6d1e(RCE)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Apache Apache Solr \u6a21\u7248\u6ce8\u5165\u6f0f\u6d1e(RCE)|attacker:src\";flow:to_server,established;flowbits:set, solr_velocity_rce;content:\"/solr/\";http_uri;startswith;content:\"/select\";http_uri;distance:0;content:\"wt=velocity\";http_uri;content:\"v.template=\";http_uri;content:\"template.\";http_uri;content:\"#set\";http_uri;distance:0;sid:2019010118;rev:1;)", "2020060806": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Adobe ColdFusion \u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e(CVE-2010-2861)|tag:\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u653b\u51fb\u8005\u5229\u7528Adobe ColdFusion \u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e(CVE-2010-2861)\uff0c\u8bfb\u53d6\u7ba1\u7406\u5458\u8d26\u53f7\u5bc6\u7801|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flowbits:isset, cve_2010_2861;flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"<title>\";http_server_body;content:\"rdspassword=\";http_server_body;distance:0;within:100;pcre:\"/password=[A-Z0-9]{40}\\x0aencrypted=/QR\";sid:2020060806;rev:1;)", "2020010037": "alert tcp $EXTERNAL_NET any -> $HOME_NET 6379 (msg:\"name:\u7206\u7834Redis|tag:Redis\u7206\u7834|tool:redis_exp|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:Redis\u670d\u52a1\u6b63\u5728\u88ab\u7206\u7834|severity:1|attacker:src\";flow:to_server,established;flowbits:set, redis_blast;noalert;content:\"$4|0d 0a|auth\";nocase;sid:2020010037;rev:1;)", "2025796": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT Generic system shell command to php base64 encoded Remote Code Execution 2|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"N5c3RlbSgiIHBoc\";metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025796;rev:2;metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2020081442": "alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08udp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884c\u547d\u4ee4ll\u6216ls -l\";content:\"total \";fast_pattern;content:\"|0a|-\";distance:2;within:80;pcre:\"/^((r|-)(w|-)(x|-)){3}\\s+1\\s\\S+[ ]{2}\\S+[ ]+\\d+\\s/R\";sid:2020081442;gid:0;rev:1;)", "2019090050": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(IMAP)|direction:in|level:action|service_name:Microsoft Exchange(IMAP)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange|server:src\";flow:from_server,established;content:\"*OK Microsoft Exchange\";depth:23;pcre:\"/^\\* OK Microsoft Exchange 20\\d{2} IMAP4rev1 server version (\\d[-.\\w]+) \\([-.\\w]+\\) ready\\.\\r\\n/\";sid:2019090050;gid:0;)", "2020041023": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2017-3248)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2017-3248)|attacker:src\";flow:established, to_server;flowbits:set, cve_2017_3248;xbits:set, weblogic_link_jrmp, track ip_dst, expire 60;content:\"|ac ed 00 05|\";content:\"java.rmi.registry.Registry\";distance:0;content:\"java.rmi.server.RemoteObjectInvocationHandler\";distance:0;content:\"java.rmi.server.RemoteObject\";distance:0;content:\"UnicastRef\";distance:0;sid:2020041023;rev:1;)", "2019000063": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Jenkins\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2017-1000353\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Jenkins\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2017-1000353\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, cve_2017_1000353;content:\"POST\";http_method;content:\"/cli\";http_uri;content:\"Side: upload\";http_header;content:\"<===[JENKINS REMOTING CAPACITY]===>\";http_client_body;content:\"|ac ed 00 05|\";http_client_body;distance:0;content:\"java.security.SignedObject\";http_client_body;distance:0;sid:2019000063;rev:1;)", "2020020602": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:apache flink\u4e0a\u4f20jar\u5305|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:apache flink\u4e0a\u4f20jar\u5305|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, flink_upload_jar;content:\"200\";http_stat_code;http_content_type;content:\"application/json\";pkt_data;content:\"\\\"status\\\":\\\"success\\\"\";http_server_body;sid:2020020602;rev:1;)", "2018040020": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:dedeCMS\u7684\u6f0f\u6d1e\u5229\u7528|tag:\u6f0f\u6d1e\u626b\u63cf|type:\u626b\u63cf|direction:in|dest:home_net|src:external_net|level:attack|phase:exploit|severity:4|result:success|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u5bf9dedeCMS\u7684\u6f0f\u6d1e\u5229\u7528\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";content:\"Error page:/plus/search.php\";nocase;http_server_body;within:1000;flowbits:isset,recon_dedecms;flow:from_server,established;gid:0;sid:2018040020;rev:1;)", "2018010102": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u904d\u5386\u4e0a\u5c42\u76ee\u5f55|tag:\u904d\u5386\u76ee\u5f55|level:attack|failed_by:http_status_3XX,http_status_4XX|phase:exploit|severity:1|result:unknown|o_msg:\u5c1d\u8bd5\u904d\u5386\u4e0a\u5c42\u76ee\u5f55\u5305\u542b/windows/win.ini|dest:home_net|attacker:src\";content:\"GET\";nocase;http_method;content:\"/windows/win.ini\";nocase;http_uri;within:1024;flow:to_server,established;gid:0;sid:2018010102;rev:1;)", "2271019": "alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:\"name:443\u7aef\u53e3\u660e\u6587\u6d41\u91cf|tag:\u4f2ahttps|direction:out|src:home_net|dest:external_net|level:action|result:success|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5f02\u5e38\u6d41\u91cf\uff0c\u5728443\u7aef\u53e3\u53d1\u73b0http\u660e\u6587\u6d41\u91cf\";flow:to_server;app-layer-protocol:http;sid:2271019;rev:1;)", "2020010027": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528\u6f0f\u6d1e\u6267\u884c\u547d\u4ee4|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u68c0\u6d4b\u5230\u8fdc\u7a0b\u547d\u4ee4\u6267\u884cwhoami|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;http_content_len;byte_test:0,<,7,0,string,dec;pkt_data;content:\"nginx\";http_server_body;flowbits:isset,cmd_reponse_echo;sid:2020010027;)", "2821001": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528Empire\u5efa\u7acbSessiona|tag:\u6728\u9a6c|direction:out|src:home_net|dest:external_net|level:attack|type:c2|phase:control|severity:3|result:success|o_msg:\u4f7f\u7528Empire\u5efa\u7acbSession|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\"Mozilla/5.0 (Windows NT 6.1|3b 20|WOW64|3b 20|Trident/7.0|3b 20|rv|3a|11.0) like Gecko\";http_user_agent;pcre:\"/^\\/((?:login|admin)\\/(?:process\\.jsp|get\\.php)|(?:index|news)(\\.asp|\\.php))$/Ui\";http_start;content:\"HTTP/1.1|0d 0a|Cookie|3a 20|session=\";nocase;fast_pattern;pkt_data;http_header_names;content:\"|0d 0a|Cookie|0d 0a|\";depth:10;content:!\"Referer\";content:!\"Accept\";pkt_data;sid:2821001;)", "2020060209": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(Clojure-HTTP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"application/\";pcre:\"/(x-www-form-urlencoded)|(x-java-serialized-object)/R\";pkt_data;content:\"|ac ed 00 05|\";http_client_body;fast_pattern;content:\"java.util.HashMap\";http_client_body;content:\"javax.swing.table.AbstractTableModel$ff19274a\";http_client_body;content:\"clojure.core$comp$fn__4727\";http_client_body;content:\"clojure.main$eval_opt\";http_client_body;content:\"clojure.core$constantly$fn__4614\";http_client_body;sid:2020060209;rev:1;)", "2024212": "alert smb $HOME_NET any -> $HOME_NET any (msg:\"name:\u5229\u7528MS17-010\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u7591\u4f3c\u5b58\u5728\u6c38\u6052\u51a0\u519b\u6f0f\u6d1e\u7684\u5f02\u6b65\u8bf7\u6c42\";flow:to_server,established;content:\"|ff|SMB|25 00 00 00 00 18 03 c0 00 00 00 00 00 00 00 00 00 00 00 00|\";offset:4;depth:24;content:\"|00 00 00 00 ff ff ff ff 00 00|\";distance:17;within:10;content:\"|5c 00 50 00 49 00 50 00 45 00 5c 00 4c 00 41 00 4e 00 4d 00 41 00 4e 00 00 00|\";distance:13;within:26;content:\"|82 00|zb12g12DWrLehig24\";within:19;fast_pattern;flowbits:set,ET.ETERNALCHAMPIONsync;flowbits:noalert;metadata:former_category EXPLOIT;classtype:trojan-activity;sid:2024212;rev:2;metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_04_17;)", "2018041705": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Gh0st\u540e\u95e8\u6728\u9a6c|type:rat|tag:Gh0st|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cGh0st\u4e0a\u7ebf\u5305\";dsize:22;flow:from_server,established;content:\"|47 68 30 73 74 16 00 00 00 01 00 00 00 78 9c 63 00 00 00 01 00 01|\";flowbits:isset,TB_Gh0st3.6;flowbits:set,TB_Gh0st3.6.1;sid:2018041705;rev:1;)", "2018081324": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u6253\u5f00\u547d\u4ee4\u884c\";dsize:8;flow:from_server,established;content:\"getcmd|0D 0A|\";depth:8;nocase;flowbits:isset,TB_ZxShell;sid:2018081324;rev:1;)", "2020062305": "alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5efa\u7acb ICMP \u901a\u9053\u4f20\u8f93\u6570\u636e|tag:\u653b\u51fb\u4ee3\u7406|tool:icmpsh|direction:in|dest:external_net|src:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u653b\u51fb\u8005\u5efa\u7acbICMP\u96a7\u9053\uff0c\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4|attacker:dest\";flow:established, to_server;itype:8;icode:0;content:\"Microsoft Windows\";depth:30;sid:2020062305;rev:1;)", "2019090132": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK Dovecot DA ready\\. <[\\w._=-]+@([\\w._-]+)>\\r\\n/\";sid:2019090132;gid:0;)", "2020032408": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7phpmyadmin\u5f00\u542f\u6162\u67e5\u8be2\u65e5\u5fd7|tag:\u5371\u9669\u914d\u7f6e|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5c1d\u8bd5\u901a\u8fc7phpmyadmin\u4fee\u6539\u6162\u67e5\u8be2\u65e5\u5fd7|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, phpmyadmin_exec_sql_success;content:\"POST\";http_method;content:\"/import.php\";http_uri;content:\"sql_query=\";http_client_body;content:\"set+global+slow_query_log\";http_client_body;distance:0;nocase;content:\"on\";http_client_body;distance:0;within:10;nocase;sid:2020032408;rev:1;)", "2020081715": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:\u5c1d\u8bd5\u901a\u8fc7cmd\u6267\u884c\u547d\u4ee4\u4e0b\u8f7d\u6587\u4ef6|severity:2|gray:true|attacker:src\";flow:to_server, established;content:\"bitsadmin\";fast_pattern;pcre:\"/\\/transfer\\s+myDownLoadJob\\s+\\/download\\s+\\/priority\\s+normal/R\";sid:2020081715;rev:1;)", "2020073102": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874eWebshell\u901a\u8baf|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|gray:true|decode_by:bingxie_1|failed_by:http_status_3XX,http_status_4XX\";flowbits:isset, bingxie_decode_1;flow:from_server,established;content:\"200\";http_stat_code;http_content_len;content:\"16\";pkt_data;pcre:\"/^([a-z0-9]{16})$/Q\";sid:2020073102;gid:0;rev:1;)", "2019010095": "alert http $HOME_NET 9200 -> $EXTERNAL_NET any (msg:\"name:elasticsearch\u672a\u6388\u6743\u8bbf\u95ee|tag:elasticsearch|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:elasticsearch\u672a\u6388\u6743\u8bbf\u95ee|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, established_unauthorization;content:\"200\";http_stat_code;content:\"=^.^=\";http_server_body;sid:2019010095;)", "2020032103": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache axis2 \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\uff08\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\uff09|tag:\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Apache axis2 \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\uff08\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, axis2_xml_disclosure;content:\"/conf/axis2.xml\";http_uri;nocase;sid:2020032103;rev:1;)", "2020050910": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|dest:home_net|level:attack|phase:exploit|type:shell|severity:3|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, bingxie_webshell;noalert;content:\"GET\";http_method;content:\".asp?\";http_uri;pcre:\"/[\\w.$@!%_-]+=\\d{3}$/iUR\";isdataat:!1,relative;content:\"Connection: keep-alive\";http_header;sid:2020050910;gid:0;rev:1;)", "2020081720": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528AWVS\u626b\u63cf|tag:\u626b\u63cf\u5668|dest:home_net|level:attack|phase:recon|severity:2|result:unknown|o_msg:\u4f7f\u7528AWVS\u8fdb\u884c\u626b\u63cf|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"acunetix\";http_user_agent;depth:20;pcre:\"/^((-wvs-test-for-some-inexistent-file)|(_wvs_security_test)|(_wvs)|(_test))/VRi\";sid:2020081720;rev:1;)", "2018010006": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:weblogic\u6f0f\u6d1e\u5229\u7528|tag:Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Weblogic wls-wsat XMLDecoder\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1eCVE-2017-10271 Payload\u653b\u51fb\u7cfb\u7edf[1]|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"wls-wsat/CoordinatorPortType\";http_uri;content:\"java.lang.ProcessBuilder\";content:\"java.lang.String\";gid:3;sid:2018010006;rev:1;)", "2020063008": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Nexus \u4f7f\u7528\u9ed8\u8ba4\u5bc6\u7801|tag:\u5f31\u53e3\u4ee4|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Nexus \u4f7f\u7528\u9ed8\u8ba4\u5bc6\u7801|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2019_7238;content:\"200\";http_stat_code;content:\"|0d 0a|Server: Nexus/\";http_header;http_content_type;content:\"application/json\";pkt_data;content:!\"{\";http_server_body;depth:2;sid:2020063008;rev:1;)", "2020070316": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|tag:\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\".php\";http_uri;content:\"eval\";http_client_body;fast_pattern;pcre:\"/\\$_(GET|POST)\\[\\S+\\]/PRi\";sid:2020070316;rev:1;)", "2019090273": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"E|00 00 00|\";depth:4;pcre:\"/^E\\0\\0\\0.S[^\\0]+\\0C0A000\\0Munsupported frontend protocol 65363/\";sid:2019090273;gid:0;)", "2008699": "alert udp $HOME_NET any -> $HOME_NET 139 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:NETBIOS \u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";content:\"|20 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"|00 2E 00 2E 00 5C 00 2E 00 2E 00 5C|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008699;classtype:attempted-admin;sid:2008699;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2019090236": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:radmin\u8fde\u63a5|direction:in|level:action|service_name:Radmin|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728Radmin|server:src\";flow:from_server,established;content:\"200\";depth:3;pcre:\"/^200-?RAP 1 ([-\\w_.]+) ([-\\w_.]+) radmind access protocol\\r\\n/\";sid:2019090236;gid:0;)", "2019090182": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Youngzsoft\u8fde\u63a5|direction:in|level:action|service_name:Youngzsoft mail|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Youngzsoft|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ESMTP [^ ]+ CMailServer ([\\d.]+) SMTP Service Ready\\r\\n/\";sid:2019090182;gid:0;)", "2018010045": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"union\";nocase;http_uri;pcre:\"/[(\\/\\*.*\\*\\/)| ]select/iUR\";content:\"CHR(\";nocase;http_uri;pcre:\"/chr\\(\\d{1,3}\\)/iU\";flow:to_server,established;gid:0;sid:2018010045;rev:1;)", "2020061016": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:phpmyadmin \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08WooYun-2016-199433\uff09|tag:\u6587\u4ef6\u5305\u542b|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:phpmyadmin \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08WooYun-2016-199433\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, wooyun_2016_199433;content:\"POST\";http_method;content:\"/scripts/setup.php\";http_uri;depth:60;http_content_type;content:\"application/x-www-form-urlencoded\";pkt_data;content:\"configuration=\";http_client_body;content:\"O:10:\\\"PMA_Config\\\"\";http_client_body;distance:0;content:\"source\";http_client_body;distance:0;sid:2020061016;rev:1;)", "2009863": "alert tcp $HOME_NET any -> $EXTERNAL_NET 1024: (msg:\"name:Banker\u94f6\u884c\u6728\u9a6c|type:rat|tag:Banker|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u94f6\u884c\u6728\u9a6cC&C Hello\u547d\u4ee4\";flow:established,to_server;dsize:12;content:\"[S]hello[\";depth:9;reference:url,doc.emergingthreats.net/2009863;classtype:trojan-activity;sid:2009863;rev:3;)", "2008734": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent(WINS_HTTP_SEND Program/1.0)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| WINS_HTTP_SEND\";http_header;threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008734;classtype:trojan-activity;sid:2008734;rev:7;)", "2019010097": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Discuz!ML V3.X \u4ee3\u7801\u6ce8\u5165|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:Discuz!ML V3.X \u4ee3\u7801\u6ce8\u5165|attacker:src\";flow:established, to_server;flowbits:set, discuz_code_injection;content:\"language=\";http_cookie;pcre:\"/language=.*('|%27)(\\.|%2e)\\w+(\\(|%28).*(\\)|%29)(\\.|%2e)('|%27)/C\";sid:2019010097;rev:1;)", "2020052401": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:reGeorg\u8fde\u63a5\u6210\u529f|tag:\u653b\u51fb\u4ee3\u7406|tool:reGeorg|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:unknown|o_msg:\u5185\u7f51\u6e17\u900f\u65f6\u7684\u5e38\u7528\u5de5\u5177reGeorg|failed_by:http_status_3XX,http_status_4XX\";flowbits:set, regeory_connect;noalert;flow:established, to_server;content:\"X-CMD: CONNECT\";http_header;content:\"X-TARGET: \";http_header;content:\"X-PORT: \";http_header;sid:2020052401;rev:1;)", "2011668": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:reDuh\u5efa\u7acbhttp\u96a7\u9053|tag:\u653b\u51fb\u8df3\u677f|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:reDuh\u5efa\u7acbhttp\u96a7\u9053|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"?action=getData&servicePort=\";http_uri;content:\"Java/\";http_user_agent;threshold:type limit, track by_src, count 1, seconds 300;sid:2011668;rev:6;)", "2008378": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (ErrCode)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"ErrCode\";http_user_agent;reference:url,doc.emergingthreats.net/bin/view/Main/2008378;classtype:trojan-activity;sid:2008378;rev:11;)", "2019070000": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Struts2\u6f0f\u6d1e|tag:S2-045\u6f0f\u6d1e|direction:out|src:home_net|dest:external_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:attack_out|result:unknown|o_msg:\u68c0\u6d4b\u5230\u4f7f\u7528Struts2 Jakarta Plugin\u63d2\u4ef6\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u7684payload\u5bf9\u5916\u653b\u51fb\uff0c\u6000\u7591\u8be5\u7cfb\u7edf\u5df2\u88ab\u653b\u9677\";flow:established,to_server;content:\"com.opensymphony.xwork2.ActionContext.container\";http_header;content:\"com.opensymphony.xwork2.ognl.OgnlUtil@class\";http_header;gid:0;sid:2019070000;rev:1;)", "2020010302": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Nagios XI \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Nagios XI \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2019_20197;content:\"200\";http_stat_code;content:\"<td><a href='?edit=1&id=\";http_server_body;pcre:\"/(\\|\\|)|(%7c%7c)|(%7c)|(%3b)|(%26)|([\\|\\;])/QRi\";pcre:\"/ls|cd|pwd|wget|curl|adduser|cat|passwd|chmod|echo|netstat|uname|sysctl|mysql|history|bash|useradd|ps|ifconfig|find|id|grep|awk|last|lsof|iptables|find|whoami|touch|ping/QRi\";sid:2020010302;)", "2020052603": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:FreeMarker\u6a21\u677f\u6ce8\u5165|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|type:exploit|severity:3|result:unknown|o_msg:\u653b\u51fb\u8005\u5229\u7528FreeMarker\u6a21\u677f\u5f15\u64ce\uff0c\u5b9e\u73b0\u4ee3\u7801\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"<\";http_client_body;content:\"#\";http_client_body;distance:0;within:20;content:\"freemarker.template.utility.JythonRuntime\";http_client_body;distance:0;content:\"os.system\";http_client_body;distance:0;sid:2020052603;rev:1;)", "2020021702": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u53cd\u5411\u4ee3\u7406\u8fde\u63a5\u6210\u529f|tag:\u53cd\u5411\u4ee3\u7406|dest:home_net|src:external_net|level:action|severity:2|result:success|o_msg:\u53cd\u5411\u4ee3\u7406\u8fde\u63a5\";flow:established, to_client;flowbits:isset, rssock_link;dsize:6;content:\"|01 02|\";offset:0;depth:2;content:\"|00 00 00 00|\";distance:0;within:4;sid:2020021702;rev:1;)", "2019090084": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:FileZilla\u8fde\u63a5|direction:in|level:action|service_name:FileZilla|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728FileZilla|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220-Welcome to ([A-Z]+) FTP Service\\.\\r\\n220 All unauthorized access is logged\\.\\r\\n/\";sid:2019090084;gid:0;)", "2020051508": "alert dns $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528DNSlog\u65b9\u5f0f\u8fdb\u884c\u53cd\u5f39|tag:dnslog|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u68c0\u6d4b\u5230\u4f7f\u7528dnslog\u7684\u57df\u540d\u8fdb\u884c\u53cd\u8fde\uff0c\u8bf7\u5173\u6ce8\u5176\u8bf7\u6c42\u7684\u57df\u540d(\u8fde\u63a5ip\u4e3adns\uff0c\u5173\u6ce8\u5176\u8bf7\u6c42\u7684\u57df\u540d\u5730\u5740)|attacker:dest\";flow:established, to_server;dns_query;content:\".\";pcre:\"/\\.((wyzxxz\\.cn)|(awvsscan119\\.autoverify\\.cn)|(h\\.i\\.ydscan\\.net)|(ceye\\.io)|(vcap\\.me)|(xip\\.name)|(xip\\.io)|(sslip\\.io)|(nip\\.io)|(tu4\\.org)|(dnslog\\.bid))/i\";pkt_data;sid:2020051508;rev:1;)", "2016028": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT Metasploit -Java Atomic Exploit Downloaded|tag:TEST|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:dest\";flow:established,from_server;file_data;content:\"PK\";within:2;content:\"msf|2f|x|2f|\";distance:0;classtype:bad-unknown;sid:2016028;rev:2;metadata:affected_product Any, attack_target Client_and_Server, deployment Perimeter, deployment Internet, deployment Internal, deployment Datacenter, tag Metasploit, signatrue_severity Critical, created_at 2012_12_12, updated_at 2016_07_01;)", "2020072906": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Zabbix_2.x_4.x\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e|tag:\u672a\u6388\u6743\u8bbf\u95ee|phase:exploit|dest:home_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|result:success|o_msg:Zabbix_2.x_4.x\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e|attacker:src\";flow:from_server,established;flowbits:isset, Zabbix_2_x_4_x;content:\"200\";http_stat_code;content:\"<title>Dashboard</title>\";http_server_body;content:\"System status\";http_server_body;distance:0;gid:0;sid:2020072906;rev:1;)", "2019010014": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:/etc/passwd\u5c1d\u8bd5|tag:\u76ee\u5f55\u904d\u5386\u5c1d\u8bd5|dest:home_net|level:attack|phase:exploit|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u5305\u542b/etc/passwd|severity:1|attacker:src\";content:\"GET\";nocase;http_method;content:\"/etc/passwd\";nocase;http_header;flow:to_server,established;flowbits:set,etc.passwd;gid:0;sid:2019010014;rev:1;)", "2020011405": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JBoss \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08jboss_jmxinvokerservlet_rce\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JBOSS\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, jboss_jmxinvokerservlet_rce;content:\"POST\";http_method;content:\"/invoker/JMXInvokerServlet\";http_uri;within:40;http_content_type;content:\"application/\";pcre:\"/(x-www-form-urlencoded)|(x-java-serialized-object)/R\";pkt_data;content:\"| ac ed 00 05 |sr\";http_client_body;startswith;sid:2020011405;rev:1;)", "2020062212": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u653b\u51fb\u8005\u5c1d\u8bd5\u901a\u8fc7webshell\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, mem_webshell_interaction;content:\"pass_the_world=\";http_uri;content:\"model=\";http_uri;pcre:\"/^(exec|connectback|urldownload|list|download|upload|proxy|chopper)/UR\";sid:2020062212;rev:1;)", "2020060814": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fc7MOVE\u65b9\u6cd5\u79fb\u52a8\u6587\u4ef6|tag:\u6587\u4ef6\u64cd\u4f5c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u901a\u8fc7MOVE\u65b9\u6cd5\u79fb\u52a8\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, move_update;content:\"204\";http_stat_code;sid:2020060814;rev:1;)", "2020010038": "alert udp $HOME_NET any -> any 53 (msg:\"name:\u5229\u7528dnslog.io\u8fdb\u884cdnslog\u53cd\u5f39|tag:dns\u53cd\u5f39|direction:out|level:attack|phase:control|severity:3|result:success|o_msg:\u68c0\u6d4bdnslog.io\u7684dns\u8bf7\u6c42\";content:\"|01 00|\";offset:2;content:\"|06|dnslog|02|io|00|\";nocase;sid:2020010038;)", "2020070215": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7591\u4f3c\u88ab\u52ab\u6301|tag:\u52ab\u6301|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u7591\u4f3c\u901a\u8fc7\u9875\u9762\u7be1\u6539\u8fdb\u884c\u52ab\u6301|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;flowbits:set, gaoling;content:\"hillhousecap.com\";fast_pattern;http_host;http_header_names;content:\"|0d 0a|Referer\";sid:2020070215;rev:1;)", "2019090253": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:OpenVPN\u8fde\u63a5|direction:in|level:action|service_name:OpenVPN|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728OpenVPN|server:src\";flow:from_server,established;content:\"|00 1e|@\";depth:3;pcre:\"/^\\0\\x1e@........\\x02\\0\\0\\0\\0\\0\\0\\0\\x007\\xa5&\\x08\\xa2\\x1b\\xa0\\xb1\\0\\0\\0\\0\\0\\x0e@........\\0\\0\\0\\0\\0/\";sid:2019090253;gid:0;)", "2018081306": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u83b7\u53d6\u8ba1\u7b97\u673a\u8be6\u7ec6\u4fe1\u606f\";flow:to_server,established;content:\"RAM:\";depth:4;nocase;content:\"OS:\";distance:1;nocase;content:\"Product Id:\";distance:1;nocase;content:\"Organization:\";distance:1;nocase;sid:2018081306;rev:1;)", "2020050905": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|dest:home_net|level:attack|phase:exploit|type:shell|severity:3|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, bingxie_webshell;flowbits:set, bingxie_webshell_step2;noalert;content:\"200\";http_stat_code;content:\"JSESSIONID=\";http_cookie;http_content_len;content:\"16\";pkt_data;pcre:\"/^([a-z0-9]{16})$/Q\";isdataat:!1,relative;sid:2020050905;gid:0;rev:1;)", "2025801": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:\u626b\u63cf|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:recon|result:unknown|o_msg:\u626b\u63cf\u53ef\u80fd\u5b58\u5728\u7684\u9ed1\u5ba2\u540e\u95e8\";flow:established,to_server;flowbits:set,webshell.scan;content:\"ZmlsZV9wdXRfY29udGVudH\";http_header;metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025801;rev:2;metadata:affected_product Web_Server_Applications, affected_product PHP, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2020032109": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Apache axis2 \u901a\u8fc7cat.arr\u6267\u884c\u547d\u4ee4|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Apache axis2 \u901a\u8fc7cat.arr\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, axis2_exec_by_cat;content:\"200\";http_stat_code;http_content_type;content:\"application/xml\";pkt_data;content:\"<ns:\";startswith;http_server_body;pcre:\"/(getClassPath|exec|writeStringToFile|shell)Response/QR\";content:!\"<faultstring>\";http_server_body;content:!\"The ServiceClass object does not implement\";http_server_body;sid:2020032109;rev:1;)", "2020081727": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528Netsparker\u626b\u63cf|tag:\u626b\u63cf\u5668|dest:home_net|level:attack|phase:recon|severity:2|result:unknown|o_msg:\u4f7f\u7528Netsparker\u8fdb\u884c\u626b\u63cf|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established, to_server;content:\"Cookie: netsparker\";http_header;nocase;sid:2020081727;rev:1;)", "2020070109": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Termite-\u53cd\u5411\u4ee3\u7406)|tag:\u653b\u51fb\u4ee3\u7406|tool:Termite|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u5c1d\u8bd5\u8fde\u63a5\u4ee3\u7406\u670d\u52a1\u5668(Termite-\u53cd\u5411\u4ee3\u7406)\";flow:established, from_server;flowbits:isset, termite_link_type_2;dsize:125;content:\"|02 00 00 00 01 00 00 00|\";depth:8;content:\"|02 00 00 00 00 00 00 00|\";distance:0;within:8;content:\"|6c 00 00 00 01 00 00 00|\";distance:0;within:8;content:\"|01 61 67 65 6e 74 00 00|\";distance:0;within:8;sid:2020070109;rev:1;)", "2019090044": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(SMTP)|direction:in|level:action|service_name:Microsoft Exchange(SMTP)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange Server|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 Microsoft ESMTP MAIL Service, Version: ([\\w._-]+)\\r\\n/\";sid:2019090044;gid:0;)", "2019090052": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(POP3)|direction:in|level:action|service_name:Microsoft Exchange(POP3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange|server:src\";flow:from_server,established;content:\"*OK Microsoft Exchange\";depth:23;pcre:\"/^\\* OK Microsoft Exchange Server ([\\d]+) IMAP4rev1 server version (\\d[-.\\w]+) \\(([-.\\w]+)\\) ready\\.\\r\\n/\";sid:2019090052;gid:0;)", "2019090124": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK [Dd]ovecot ready\\.\\r\\n/\";sid:2019090124;gid:0;)", "2018030022": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u83dc\u5200\u521d\u59cb\u8fde\u63a5\u6210\u529f|tag:webshell\u8fde\u63a5|tool:\u83dc\u5200|direction:in|dest:home_net|src:external_net|level:attack|phase:control|severity:4|result:success|o_msg:\u83dc\u5200\u521d\u59cb\u8fde\u63a5\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";content:\"200\";nocase;http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"|09|\";http_server_body;within:50;pcre:\"/^([\\d\\w`~!@#$%^&*()+=_<>?,./:\"\\;'\\\\{}\\[\\]]{3})\\w:(\\\\[\\d\\w._-]+)+\\x09(\\w:)+\\x09/iQ\";flowbits:isset,req;flowbits:set,req_webshell;flow:from_server,established;sid:2018030022;rev:1;)", "2020051919": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee(env)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, spring_actuator_env;content:\"/actuator/env\";http_uri;sid:2020051919;rev:1;)", "2020050722": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ElasticSearch \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2015-1427\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:ElasticSearch \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2015-1427\uff09|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, es_rce;content:\"POST\";http_method;content:\"/_search?pretty\";http_uri;content:\"lang\";http_client_body;content:\"groovy\";http_client_body;distance:0;sid:2020050722;rev:2;)", "2019090104": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:vsFTPd\u8fde\u63a5|direction:in|level:action|service_name:vsFTPd|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728vsFTPd|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 vsFTPd (.*) ready\\.\\.\\.\\r\\n/\";sid:2019090104;gid:0;)", "2019090141": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Exim\u8fde\u63a5|direction:in|level:action|service_name:Exim(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Exim|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220[- ].*\\r\\n220[- ]([^\\r\\n]+) ESMTP Exim /\";sid:2019090141;gid:0;)", "2018121216": "alert smb $HOME_NET 445 -> $HOME_NET any (msg:\"name:SMB\u7206\u7834|tag:\u7206\u7834|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:dest|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230smb\u7684\u7206\u7834\u884c\u4e3a\";flow:to_client,established;content:\"|53 4d 42 73|\";offset:5;depth:4;content:\"|8d 01 00 c0|\";distance:0;within:4;threshold:type threshold,track by_src,count 20,seconds 2;sid:2018121216;)", "2019090101": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft FTP\u8fde\u63a5|direction:in|level:action|service_name:Microsoft FTP|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft FTP|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220.*Microsoft FTP Service \\(Version (\\d[^)]+)/\";sid:2019090101;gid:0;)", "2009534": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (Poker)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| Poker|0d 0a|\";http_header;nocase;threshold:type limit, count 2, track by_src, seconds 300;reference:url,vil.nai.com/vil/content/v_130975.htm;reference:url,doc.emergingthreats.net/2009534;classtype:trojan-activity;sid:2009534;rev:7;)", "2020000053": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528sqlmap --os-shell\u53c2\u6570getshell|tag:sqlmap|tool:sqlmap|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:\u4f7f\u7528sqlmap --os-shell\u53c2\u6570|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"/tmp\";http_uri;pcre:/^\\S{5}\\.(php|asp|aspx|jsp)$/URi;threshold:type threshold, track by_src, count 10, seconds 10;xbits:set, sqlmap_os_shell, track ip_pair, expire 60;sid:2020000053;rev:1;)", "2020080314": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Metasploit \u8fde\u63a5(tcp)|tag:\u53cd\u5f39shell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:Metasploit \u8fde\u63a5(windows/x64/shell_reverse_tcp)\";flags:P, A;flow:from_server, established;flowbits:isset, windows_x64_shell_reverse_tcp;dsize:336;content:\"|fc 48 83 e4|\";depth:4;content:\"cmd|00 00 00 00 00|\";distance:200;within:18;sid:2020080314;)", "2019010119": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5371\u9669\u914d\u7f6e\uff1a\u5141\u8bb8Apache Solr\u52a0\u8f7d\u6307\u5b9a\u6a21\u677f|tag:Apache Solr|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u5371\u9669\u914d\u7f6e\uff1a\u5141\u8bb8Apache Solr\u52a0\u8f7d\u6307\u5b9a\u6a21\u677f|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flowbits:isset, solr_risk_config;flow:from_server,established;content:\"200\";http_stat_code;content:\"\\\"responseHeader\\\"\";http_server_body;content:\"\\\"WARNING\\\":\\\"This response format is experimental.  It is likely to change in the future.\\\"\";distance:0;http_server_body;sid:2019010119;rev:1;)", "2019090158": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:LDAP\u8fde\u63a5|direction:in|level:action|service_name:LDAP|service_class:auth|severity:1|result:unknown|o_msg:\u5b58\u5728LDAP|server:src\";flow:from_server,established;content:\"0|84 00 00 00|\";depth:5;pcre:\"/^0\\x84\\0\\0\\0\\x10\\x02\\x01\\x01a\\x84\\0\\0\\0\\x07\\n\\x01\\0\\x04\\0\\x04\\0$/\";sid:2019090158;gid:0;)", "2019090241": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:radmin\u8fde\u63a5|direction:in|level:action|service_name:Radmin|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728Radmin|server:src\";flow:from_server,established;content:\"|01 00 00 00|\";depth:4;pcre:\"/^\\x01\\x00\\x00\\x00\\x25\\x08\\x00\\x02\\x12\\x08\\x02\\x00\\x08\\x0a/\";sid:2019090241;gid:0;)", "2019010140": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6d4b\u8bd5SQL\u6ce8\u5165\u6f0f\u6d1e|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"and\";nocase;http_client_body;pcre:\"/and(%20| )\\d+(%3d|=)\\d+/iP\";flow:to_server,established;gid:0;sid:2019010140;rev:1;)", "2020081402": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Shiro \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:Apache Shiro \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e, \u653b\u51fb\u8005\u53ef\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4|severity:3|gray:true|decode_by:decode_shiro_2|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server, established;content:\"rememberMe=\";http_cookie;sid:2020081402;rev:2;)", "2019090168": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Hmail\u8fde\u63a5|direction:in|level:action|service_name:Hmail(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Hmail|server:src\";flow:from_server,established;content:\"* OK \";depth:5;pcre:\"/^\\* OK ([\\w._-]+)\\r\\nGET BAD Unknown or NULL command\\r\\n BAD NULL COMMAND\\r\\n/\";sid:2019090168;gid:0;)", "2019090226": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Courier\u8fde\u63a5|direction:in|level:action|service_name:Courier(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Courier pop3|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK Hello there\\. <[\\d.]+@([-\\w_.]+)>\\r\\n$/\";sid:2019090226;gid:0;)", "2026925": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"dy1PYmplY3\";distance:0;fast_pattern;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026925;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2009358": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u68c0\u6d4bHTTP\u548cweb\u5e94\u7528\u6307\u7eb9|tag:\u626b\u63cf|tool:Nmap|type:\u6307\u7eb9\u63a2\u6d4b|direction:in|phase:recon|src:external_net|dest:home_net|level:attack|severity:1|result:unknown|o_msg:NMAP\u626b\u63cf\u68c0\u6d4bHTTP\u548cweb\u5e94\u7528\u6307\u7eb9|failed_by:http_status_3XX,http_status_4XX\";content:\"Mozilla/5.0 (compatible|3b| Nmap Scripting Engine\";nocase;http_user_agent;depth:46;flow:to_server,established;sid:2009358;rev:5;)", "2020061007": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;flowbits:set, tp_5_23_rce;content:\"_method=__construct\";http_client_body;content:\"filter=\";http_client_body;sid:2020061007;rev:1;)", "2019010103": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Joomla 3.4.6 \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Joomla 3.4.6 \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, Joomla_3_4_6_rce_2;content:\"500\";http_stat_code;content:!\"Error displaying\";startswith;http_server_body;content:\"Error displaying the error page\";sid:2019010103;rev:1;)", "2018120500": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Konni\u540e\u95e8\u6728\u9a6c|type:rat|tag:Konni|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cKonni\u4e0a\u7ebf\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\"download.php?file=\";http_uri;content:\"_dropcom\";distance:8;within:8;http_uri;content:\"HTTP\";http_user_agent;depth:4;isdataat:!1,relative;sid:2018120500;rev:1;)", "2008276": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (contains loader)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| \";http_header;content:\" loader\";fast_pattern;within:100;http_header;pcre:\"/User-Agent\\x3a[^\\n]+loader/iH\";threshold:type limit,count 2,track by_src,seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008276;classtype:trojan-activity;sid:2008276;rev:14;)", "2019030009": "alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528ngrok\u8fdb\u884c\u5185\u7f51\u7a7f\u900f|tag:tunnel|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|tool:ngrok|result:unknown|o_msg:\u5c1d\u8bd5\u4e0e\u516c\u7f51ngrok\u670d\u52a1\u5668\u5efa\u7acb\u63a7\u5236\u8fde\u63a5\uff0c\u53ef\u7528\u6765\u8fdb\u884c\u5185\u7f51\u7a7f\u900f\";flow:established,to_server;tls_sni;content:\"tunnel.jp.ngrok.com\";flowbits:set,ngrok_state_findsni;flowbits:noalert;sid:2019030009;)", "2018010069": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u653b\u51fbDiscuz converter\u63d2\u4ef6\u6f0f\u6d1e|tag:Discuz\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|failed_by:http_status_3XX,http_status_4XX|severity:3|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5bf9Discuz converter\u63d2\u4ef6\u6f0f\u6d1e\u8fdb\u884c\u653b\u51fb|attacker:src\";content:\"POST\";nocase;http_method;content:\"/convert/index.php\";nocase;http_uri;within:1000;content:\"a=config&source=d7.2_x2.0&newconfig\";nocase;http_client_body;pcre:\"/(\\[|%5b)[\\w\\d]+(%0d%0a)+eval/iPR\";flow:to_server,established;gid:0;sid:2018010069;rev:1;)", "2018010010": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Jboss\u6f0f\u6d1e\u5229\u7528|tag:Jboss\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|severity:2|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u4f7f\u7528Jboss\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1eCVE-2017-12149 Payload\u653b\u51fb\u7cfb\u7edf[1]|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"invoker/readonly\";http_uri;content:\"org.apache.commons.collections.functors.ConstantTransformerXv\";content:\"www.joaomatosf.com\";content:\"JexRemoteTools.jar\";content:\"org.apache.commons.collections.functors.InvokerTransformer\";gid:3;sid:2018010010;rev:1;)", "2019090201": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ESMTP Postfix\\r\\n501 Syntax: EHLO hostname\\r\\n/\";sid:2019090201;gid:0;)", "202001925": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Spring Boot Actuator \u672a\u6388\u6743\u8bbf\u95ee(configprops)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, spring_actuator_configprops;content:\"/actuator/configprops\";http_uri;sid:202001925;rev:1;)", "2020062218": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:success|o_msg:\u653b\u51fb\u8005\u5c1d\u8bd5\u901a\u8fc7webshell\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, mem_webshell_interaction;content:\"200\";http_stat_code;content:\" is upload successfully,and size is \";http_server_body;sid:2020062218;rev:1;)", "2019090180": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Hmail\u8fde\u63a5|direction:in|level:action|service_name:Hmail(pop3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Hmail|server:src\";flow:from_server,established;content:\"+OK \";depth:4;pcre:\"/^\\+OK ([\\w._-]+)\\r\\n-ERR Invalid command in current state\\.\\r\\n-ERR Invalid command in current state\\.\\r\\n/\";sid:2019090180;gid:0;)", "2019090229": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Courier\u8fde\u63a5|direction:in|level:action|service_name:Courier(imap)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Courier imap|server:src\";flow:from_server,established;content:\"* OK \";depth:5;pcre:\"/^\\* OK \\[CAPABILITY IMAP4rev1 .*?Courier-IMAP ready\\. Copyright 1998-\\d+ Double Precision, Inc\\.  See COPYING for distribution information\\.\\r\\n/\";sid:2019090229;gid:0;)", "2019060001": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6b63\u5e38PHP\u8bf7\u6c42|tag:php|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:1|result:unknown|o_msg:\u6b63\u5e38PHP\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";content:\"POST\";nocase;http_method;content:\".php\";nocase;http_uri;pcre:\"/\\.php(\\?)?/iU\";flow:to_server,established;flowbits:set,post_req;flowbits:noalert;gid:0;sid:2019060001;rev:1;)", "2020010029": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528\u6f0f\u6d1e\u6267\u884c\u547d\u4ee4|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u68c0\u6d4b\u5230\u8fdc\u7a0b\u547d\u4ee4\u6267\u884cwhoami|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;http_content_len;byte_test:0,<,8,0,string,dec;pkt_data;content:\"tomcat\";http_server_body;flowbits:isset,cmd_reponse_echo;sid:2020010029;)", "2019090215": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:qmail\u8fde\u63a5|direction:in|level:action|service_name:Qmail|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728qmail|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220[\\s-](\\S+) ESMTP ?\\r\\n214[\\s-]qmail home page: http://cr\\.yp\\.to/qmail\\.html, LinuxMagic Support http://www\\.linuxmagic\\.com\\r\\n/\";sid:2019090215;gid:0;)", "2018020006": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MSSQL\u767b\u5f55\u6210\u529f|tag:\u767b\u5f55|direction:in|service_name:MSSQL|service_class:database|src:home_net|dest:external_net|level:action|result:success|o_msg:\u68c0\u6d4b\u5230MSSQL(version:2012)\u767b\u9646\u6210\u529f(UNICODE)|server:src\";dsize:150<>400;flow:to_client,established;content:\"|04 01|\";depth:2;content:\"|4d 00 69 00 63 00 72 00 6f 00 73 00 6f 00 66 00 74 00 20 00 53 00 51 00 4c 00 20 00 53 00 65 00 72 00 76 00 65 00 72 00 00 00 00 00|\";distance:0;nocase;content:\"|00 00 00 00|\";isdataat:!1,relative;sid:2018020006;rev:1;)", "2020061908": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u7206\u7834 Jupyter Notebook|tag:\u66b4\u529b\u7834\u89e3|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u7206\u7834 Jupyter Notebook\uff0c\u653b\u51fb\u8005\u5982\u679c\u6210\u529f\u8fdb\u5165\uff0c\u53ef\u76f4\u63a5\u8bbf\u95ee\u90e8\u5206\u6587\u4ef6\uff0c\u5e76\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, jupyter_notebook_blasting;threshold:type both, track by_dst, count 10, seconds 3;content:\"401\";http_stat_code;content:\"<title>Jupyter Notebook</title>\";http_server_body;depth:200;sid:2020061908;rev:1;)", "2019090036": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:VNC\u8fde\u63a5|direction:in|level:action|service_name:VNC|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728VNC|server:src\";flow:from_server,established;content:\"RFB\";depth:3;pcre:\"/^RFB 003\\.00(\\d)\\n\\0\\0\\0\\0\\0\\0\\0\\x1aToo many security failures$/\";sid:2019090036;gid:0;)", "2010346": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230Ultimate HAckerz Team\u56e2\u4f19\u7684User-Agent (Made by UltimateHackerzTeam) - Likely \u6728\u9a6cReport|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| Mozilla/4.0 (compatible|3b| MSIE 6.0|3b| Windows NT 5.1|3b| SV1|3b| Made by UltimateHackerzTeam)\";http_header;fast_pattern:76,20;reference:url,doc.emergingthreats.net/2010346;classtype:trojan-activity;sid:2010346;rev:6;)", "2012690": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u8fde\u63a5\u6210\u529f|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:true|result:unknown|o_msg:webshell\u8fde\u63a5\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"Microsoft Windows [Version \";http_server_body;content:\"Copyright (c)\";distance:0;content:\"Microsoft Corp\";distance:0;flowbits:isset,req;sid:2012690;rev:1;)", "2018030005": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:URL\u8def\u5f84\u731c\u6d4b|tag:URL\u7206\u7834|tool:Test404|phase:exploit|dest:home_net|level:attack|severity:2|result:unknown|o_msg:\u4f7f\u7528Test404\u8fdb\u884c\u654f\u611f\u76ee\u5f55\u731c\u6d4b|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"HEAD\";nocase;http_method;content:\".\";http_uri;pcre:\"/(asp|php|jsp|aspx)$/iUR\";content:\"X-Forwarded-For:|20|\";nocase;http_raw_header;offset:0;content:\"Client-IP:|20|\";nocase;http_raw_header;within:29;content:\"Client-IP:|20|\";nocase;http_raw_header;within:30;flow:to_server,established;threshold:type both, track by_src, count 10, seconds 1;sid:2018030005;rev:1;)", "2008098": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (GOOGLE)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| GOOGLE|0d 0a|\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008098;classtype:trojan-activity;sid:2008098;rev:8;)", "2020081007": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6267\u884c\u547d\u4ee4net user|tag:\u53cd\u5f39shell|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884c\u547d\u4ee4net user\";flow:established;content:\"\\\\\\\\\";content:\"|0d 0a 0d 0a|-------------------------------------------------------------------------------\";distance:1;within:150;content:\"|0d 0a|Administrator\";distance:0;content:\"|0d 0a|Guest\";distance:0;sid:2020081007;)", "2019090175": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Hmail\u8fde\u63a5|direction:in|level:action|service_name:Hmail(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Hmail|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([\\w_.-]+)\\r\\n211 DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY\\r\\n/\";sid:2019090175;gid:0;)", "2018081315": "alert tcp $EXTERNAL_NET any -> $HOME_NET [!21] (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u8fdb\u884c\u6587\u4ef6\u4e0a\u4f20(1)\";dsize:5<>50;flow:from_server,established;content:\"SIZE \";depth:5;nocase;content:\"|0d 0a|\";isdataat:!1,relative;flowbits:set,TB_ZxShell_3;flowbits:noalert;sid:2018081315;rev:1;)", "2019090011": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:MySQL\u8fde\u63a5|direction:in|level:action|service_name:MySQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728MySQL|server:src\";flow:from_server,established;content:\"|00 00 00|\";offset:1;depth:3;pcre:\"/^.\\0\\0\\0\\xff..Too many connections|s p/MySQL/ i/Too many connections/\";sid:2019090011;gid:0;)", "2018010076": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MySQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"' UNION ALL SELECT\";nocase;http_client_body;within:300;content:\"NULL,NULL,NULL,NULL,NULL\";nocase;http_client_body;within:152;flow:to_server,established;gid:0;sid:2018010076;rev:1;)", "2018030009": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:webshell\u5c1d\u8bd5\u8fde\u63a5|tool:\u83dc\u5200|failed_by:http_status_3XX,http_status_4XX|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u83dc\u5200\u901a\u7528\u8bf7\u6c42php|attacker:src\";content:\"POST\";nocase;http_method;content:\".php\";nocase;http_uri;content:\"=array_map(\";nocase;http_client_body;within:21;flowbits:set,webshell.scan;flowbits:set, caidao_request;flow:to_server,established;gid:0;sid:2018030009;rev:1;)", "2020060404": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ThinkPHP 5.x \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:ThinkPHP 5.x \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"pathinfo=/index/\\\\\";http_uri;within:60;nocase;content:\"\\\\\";distance:1;within:30;content:\"/\";distance:0;within:30;sid:2020060404;rev:1;)", "2008709": "alert tcp $HOME_NET any -> $HOME_NET 139 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";flow:established,to_server;content:\"|1F 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"|00 2E 00 2E 00 2F 00 2E 00 2E 00 2F|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008709;classtype:attempted-admin;sid:2008709;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2020061006": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Drupal \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2018-7602\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Drupal \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2018-7602\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"application/json\";pkt_data;content:!\"[\";http_server_body;depth:1;content:!\"{\";http_server_body;depth:1;content:\"\\\"command\\\":\\\"settings\\\"\";http_server_body;sid:2020061006;rev:1;)", "2834607": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:ETPRO POLICY External GeoIP Lookup via vtransmit .com|tag:TEST|src:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:dest\";flow:to_server,established;content:\"GET\";http_method;content:\"vtransmit.com\";http_host;depth:13;isdataat:!1,relative;fast_pattern;http_header_names;content:!\"Referer\";metadata:former_category POLICY;classtype:policy-violation;sid:2834607;rev:1;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2019_01_28, performance_impact Low, updated_at 2019_01_28;)", "2020081717": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:\u5c1d\u8bd5\u901a\u8fc7powershell\u6267\u884c\u547d\u4ee4\u4e0b\u8f7d\u6587\u4ef6|severity:2|gray:true|attacker:src\";flow:to_server, established;content:\"System.Net.WebClient\";fast_pattern;content:\".DownloadFile('\";distance:0;within:200;sid:2020081717;rev:1;)", "2020032605": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Discuz! 1.5-2.5 \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2018-14729)|tag:\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Discuz! 1.5-2.5 \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE-2018-14729)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, discuz_3_4_sqli;content:\"POST\";http_method;content:\"/admin.php\";http_uri;content:\"action=db\";http_uri;distance:0;content:\"operation=export\";http_uri;offset:10;content:\"&customtables%5B%5D\";http_client_body;content:\"|22|\";http_client_body;within:100;pcre:\"/(ls|cd|pwd|wget|curl|adduser|cat|passwd|chmod|echo|netstat|uname|sysctl|mysql|history|bash|useradd|ps|ifconfig|find|id|grep|awk|last|lsof|iptables|find|whoami|touch|ping)/PRi\";sid:2020032605;rev:1;)", "2019030001": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u8fde\u63a5\u5230\u516c\u7f51frp\u670d\u52a1\u5668|tag:tunnel|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:3|tool:frp|result:unknown|o_msg:\u5c1d\u8bd5\u4e0e\u516c\u7f51frp\u670d\u52a1\u5668\u5efa\u7acbfrp\u96a7\u9053\uff0c\u53ef\u7528\u6765\u8fdb\u884c\u5185\u7f51\u7a7f\u900f\";flow:established,to_server;dsize:12;content:\"|00 01 00 01 00 00 00 01 00 00 00 00|\";flowbits:set,frp_state_1;flowbits:noalert;sid:2019030001;)", "2020071446": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Citrix \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e(CVE-2020-8195)|tag:\u672a\u6388\u6743\u8bbf\u95ee|dest:home_net|level:attack|severity:3|result:success|phase:exploit|o_msg:Citrix \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6b64\u6f0f\u6d1e\u83b7\u53d6\u654f\u611f\u4fe1\u606f|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2020_8195;content:\"200\";http_stat_code;content:\"|0d 0a|Content-Disposition: \";http_header;content:\"filename=\";http_header;distance:0;content:\".pdf\";http_header;distance:0;within:100;http_content_type;content:\"application/pdf\";pkt_data;sid:2020071446;)", "2019090234": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Courier\u8fde\u63a5|direction:in|level:action|service_name:Courier(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Courier smtp|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([-\\w_.]+) ESMTP\\r\\n400 STARTTLS is required first\\.\\r\\n/\";sid:2019090234;gid:0;)", "2020081701": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4e0a\u4f20\u51b0\u874eWebshell|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:\u4e0a\u4f20\u51b0\u874eWebshell|failed_by:http_status_3XX,http_status_4XX|success_by:resp_body_upload_success_str|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"boundary=\";pkt_data;content:\"Chr(ascb(midb(content,i,1)) Xor Asc(Mid(k,(i and 15)+1,1)))\";http_client_body;content:\"execute(\";http_client_body;distance:0;sid:2020081701;rev:1;)", "2020080325": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7 Metasploit \u8fde\u63a5\u670d\u52a1\u5668(tcp)|tag:\u53cd\u5f39shell|dest:home_net|level:attack|phase:exploit|severity:3|attack_type:target|result:unknown|o_msg:Metasploit \u8fde\u63a5(windows/x64/shell/bind_tcp)|attacker:src\";flags:P, A;flow:to_server, established;flowbits:isset, windows_x64_shell_bind_tcp;flowbits:set, windows_shell_bind_tcp_1;dsize:336;content:\"|fc 48 83 e4|\";depth:4;content:\"cmd|00 00 00 00 00|\";distance:200;within:18;sid:2020080325;)", "2020071450": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Citrix \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e(CVE-2020-8196)|tag:\u672a\u6388\u6743\u8bbf\u95ee|dest:home_net|level:attack|severity:3|result:success|phase:exploit|o_msg:Citrix \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u5b83\u9a8c\u8bc1API\u8c03\u7528\u662f\u5426\u6210\u529f|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2020_8196;content:\"201\";http_stat_code;content:\"SESSID=deleted\";http_cookie;http_content_type;content:\"application/xml\";pkt_data;content:\"<errorcode>0</errorcode>\";http_server_body;sid:2020071450;)", "2019090057": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Microsoft Exchange Server(POP3)|direction:in|level:action|service_name:Microsoft Exchange(POP3)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft Exchange|server:src\";flow:from_server,established;content:\"*OK Microsoft Exchange\";depth:23;pcre:\"/^\\+OK Microsoft Exchange Server 2007 POP3 service ready\\r\\n/\";sid:2019090057;gid:0;)", "2018112117": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:JBoss\u7684\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230JBoss\u7684\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2017-12149\uff09|failed_by:http_status_3XX,http_status_4XX\";content:\"post\";nocase;http_method;content:\"/invoker/readonly\";nocase;http_uri;content:\"java.util.hashset\";nocase;content:\"org.apache.commons.collections.map.LazyMapn\";nocase;content:\"Lorg/apache/commons/collections/Transformer\";nocase;content:\"org.apache.commons.collections.functors.ConstantTransformer\";nocase;flow:to_server,established;sid:2018112117;)", "2020062214": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:success|o_msg:\u653b\u51fb\u8005\u5c1d\u8bd5\u901a\u8fc7webshell\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, mem_webshell_interaction;content:\"200\";http_stat_code;http_content_len;content:\"11\";pkt_data;content:\"Successful!\";http_server_body;depth:11;sid:2020062214;rev:1;)", "2018010071": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u5229\u7528PUT\u6f0f\u6d1e|tag:\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|severity:1|phase:recon|result:unknown|failed_by:http_status_3XX,http_status_4XX|o_msg:\u68c0\u6d4b\u5230\u5c1d\u8bd5\u5229\u7528PUT\u6f0f\u6d1e\u4e0a\u4f20webshell|attacker:src\";content:\"PUT\";nocase;http_method;content:\".\";http_uri;within:1000;pcre:\"/[\\w\\d]+\\.(php|asp|asa|cer|jspf|jspx|jspa|php3|php4)$/iU\";flow:to_server,established;gid:0;sid:2018010071;rev:1;)", "2019090266": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:PostgreSQL\u8fde\u63a5|direction:in|level:action|service_name:PostgreSQL|service_class:database|severity:1|result:unknown|o_msg:\u5b58\u5728PostgreSQL|server:src\";flow:from_server,established;content:\"E|00 00 00|\";depth:4;pcre:\"/^E\\0\\0\\0.S[^\\0]+\\0C0A000\\0M\\xd0\\xbd\\xd0\\xb5\\xd0\\xbf\\xd0\\xbe\\xd0\\xb4\\xd0\\xb4\\xd0\\xb5\\xd1\\x80\\xd0\\xb6\\xd0\\xb8\\xd0\\xb2\\xd0\\xb0\\xd0\\xb5\\xd0\\xbc\\xd1\\x8b\\xd0\\xb9 \\xd0\\xba\\xd0\\xbb\\xd0\\xb8\\xd0\\xb5\\xd0\\xbd\\xd1\\x82\\xd1\\x81\\xd0\\xba\\xd0\\xb8\\xd0\\xb9 \\xd0\\xbf\\xd1\\x80\\xd0\\xbe\\xd1\\x82\\xd0\\xbe\\xd0\\xba\\xd0\\xbe\\xd0\\xbb 65363\\.19778: \\xd1\\x81\\xd0\\xb5\\xd1\\x80\\xd0\\xb2\\xd0\\xb5\\xd1\\x80 \\xd0\\xbf\\xd0\\xbe\\xd0\\xb4\\xd0\\xb4\\xd0\\xb5\\xd1\\x80\\xd0\\xb6\\xd0\\xb8\\xd0\\xb2\\xd0\\xb0\\xd0\\xb5\\xd1\\x82 \\xd0\\xbe\\xd1\\x82 1\\.0 \\xd0\\xb4\\xd0\\xbe 3\\.0\\0Fpostmaster\\.c\\0L\\d+\\0/\";sid:2019090266;gid:0;)", "2018010019": "alert tcp $HOME_NET 2323 -> $EXTERNAL_NET any (msg:\"name:\u7206\u7834Telnet|tag:Telnet\u7206\u7834|src:home_net|level:attack|phase:exploit|result:unknown|o_msg:TELNET \u670d\u52a1\u6b63\u5728\u88ab\u7206\u7834|severity:1|attacker:dest\";flow:from_server,established;content:\"login incorrect\";nocase;threshold:type threshold, track by_dst, count 10, seconds 60;gid:3;sid:2018010019;rev:1;)", "2020051005": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, bingxie_webshell;flowbits:set, bingxie_webshell_step2;noalert;content:\"200\";http_stat_code;content:\"ASPSESSIONID\";http_cookie;http_content_len;content:\"16\";pkt_data;pcre:\"/^([a-z0-9]{16})$/Q\";isdataat:!1,relative;sid:2020051005;gid:0;rev:1;)", "2019090191": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([-\\w_.]+) ESMTP postfix NO UCE\\r\\n/\";sid:2019090191;gid:0;)", "2019000072": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ThinkPHP 6.0 \u4efb\u610f\u6587\u4ef6\u521b\u5efa\u6f0f\u6d1e|tag:\u4efb\u610f\u6587\u4ef6\u521b\u5efa|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:ThinkPHP 6.0 \u4efb\u610f\u6587\u4ef6\u521b\u5efa\u6f0f\u6d1e|attacker:src\";flow:established, to_server;flowbits:set, thinkphp_upload;content:\"phpsession=\";nocase;content:\"../\";http_cookie;distance:0;sid:2019000072;rev:1;)", "2020010206": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(Commons Collections)|tag:\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(Commons Collections)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"| ac ed 00 05 |sr\";http_client_body;distance:0;content:\"org.apache.commons.collections\";http_client_body;distance:0;content:\"functors.ConstantTransformer\";http_client_body;distance:0;content:\"functors.InvokerTransformer\";http_client_body;distance:0;sid:2020010206;rev:1;)", "2020071411": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Xdebug \u63a2\u6d4b|tag:\u5371\u9669\u914d\u7f6e|dest:home_net|level:attack|severity:1|result:unknown|phase:exploit|o_msg:xdebug \u63a2\u6d4b|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;noalert;xbits:set, xdebug_server_discover, track ip_dst, expire 30;content:\"XDEBUG_SESSION_START\";http_uri;sid:2020071411;)", "2020071416": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5e94\u7528\u7a0b\u5e8f\u5141\u8bb8rpdb\u8c03\u8bd5|tag:\u5371\u9669\u914d\u7f6e|dest:home_net|level:attack|severity:3|result:success|phase:exploit|o_msg:\u5e94\u7528\u7a0b\u5e8f\u5141\u8bb8rpdb\u8c03\u8bd5\uff0c\u653b\u51fb\u8005\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4|attacker:src\";flow:to_server, established;flowbits:isset, rpdb_rce_success;content:\"(\";fast_pattern;pcre:\"/(os\\.popen)|(os\\.system)|(subprocess\\.Popen)|(commands\\.getstatusoutput)/\";sid:2020071416;)", "2832833": "alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Cobalt Strike\u6728\u9a6cSSL\u8bc1\u4e66\u4f20\u8f93\u884c\u4e3a|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|dest:home_net|src:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike\u6728\u9a6cSSL\u8bc1\u4e66\u4f20\u8f93\u884c\u4e3a\";flow:established,from_server;tls_cert_subject;content:\"CN=v39cdn.com\";nocase;isdataat:!1,relative;metadata:former_category TROJAN;reference:md5,17a5b2a251523b5b5efefd23796faa55;classtype:trojan-activity;sid:2832833;rev:1;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2018_09_27, malware_family Cobalt_Strike, performance_impact Moderate, updated_at 2019_09_28;)", "2018041701": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Gh0st2011\u540e\u95e8\u6728\u9a6c|type:rat|tag:Gh0st2011|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u540e\u95e8\u6728\u9a6cGh0st2011\u4e0a\u7ebf\u5305\uff082\uff09\";dsize:20;flow:from_server,established;content:\"|14 00 00 00 04 00 00 00 78 9c 63 60 60 60 00 00 00 04 00 01|\";depth:20;flowbits:noalert;flowbits:isset,TB_Gh0st2011_1;flowbits:set,TB_Gh0st2011_2;sid:2018041701;rev:1;)", "2020051004": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u8fde\u63a5\u6210\u529f|tag:webshell\u8fde\u63a5|tool:\u83dc\u5200|direction:in|dest:home_net|src:external_net|level:attack|phase:control|severity:3|result:success|type:shell|o_msg:webshell\u8fde\u63a5\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, caidao_req;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"|0a 0a 2d 3e 7c|\";http_server_body;depth:5;pcre:\"/^\\x0a\\x0a->\\|((.*\\n)+|.*)\\|<-\\x0a\\x0a$/Q\";isdataat:!1,relative;sid:2020051004;rev:1;)", "2020041001": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2017-3506\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2017-3506\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, weblogic_xmldecode_1;content:\"POST\";http_method;http_content_type;content:\"text/xml\";pkt_data;pcre:\"/(\\/_async\\/)|(\\/wls-wsat\\/)/Ii\";content:\"<soapenv:Envelope\";http_client_body;nocase;content:\"<object \";http_client_body;distance:0;nocase;content:\"class=\";http_client_body;distance:0;nocase;pcre:\"/(sun\\.misc\\.BASE64Decoder)|(weblogic\\.utils\\.Hex)|(java\\.lang\\.ProcessBuilder)|(java\\.lang\\.Runtime)|(java\\.lang\\.String)|(java\\.io\\.PrintWriter)|(java\\.beans\\.XMLDecoder)|(java\\.lang\\.Thread)/PRi\";sid:2020041001;rev:1;)", "2020082006": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528DirBuster\u626b\u63cf|tag:\u626b\u63cf\u5668|dest:home_net|level:attack|phase:recon|severity:2|result:unknown|o_msg:\u4f7f\u7528DirBuster\u8fdb\u884c\u626b\u63cf|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"DirBuster\";http_user_agent;sid:2020082006;rev:1;)", "2020070340": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:rConfig v3.9.2\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c(CVE-2019-16662)|tag:\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:rConfig v3.9.2\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c(CVE-2019-16662)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"install/lib/ajaxHandlers/ajaxServerSettingsChk.php\";http_uri;depth:100;content:\"rootUname=\";http_uri;distance:0;pcre:\"/((\\;)|(\\&)|(\\&\\&)|(\\|)|(\\|\\|))[\\S\\s]+\\#/UR\";sid:2020070340;rev:1;)", "2020081424": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08tcp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884cdir\u547d\u4ee4\";flow:established;content:\"   <DIR>          \";fast_pattern;pcre:\"/\\d{4}\\/[01]+\\d\\/[0-3]\\d {2}[0-2]\\d\\:[0-6]\\d {4}<DIR> {10}\\.\\x0d\\x0a\\d{4}\\/[01]+\\d\\/[0-3]\\d {2}[0-2]\\d\\:[0-6]\\d {4}<DIR> {10}\\.{2}\\x0d\\x0a/\";sid:2020081424;)", "2006546": "alert ssh $HOME_NET any -> $HOME_NET 22 (msg:\"name:\u7206\u7834SSH|direction:in|dest:home_net|src:home_net|level:attack|phase:post_exploit|severity:2|result:unknown|o_msg:\u5b58\u5728SSH\u7206\u7834\u884c\u4e3a|type:infil\";flow:established,to_server;content:\"SSH-\";content:\"libssh\";within:20;threshold:type both, count 5, seconds 30, track by_src;reference:url,doc.emergingthreats.net/2006546;classtype:attempted-admin;sid:2006546;rev:9;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2020011501": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:phpmyadmin SQL\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2020-5504\uff09|tag:SQL\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:phpmyadmin sql\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2020-5504\uff09|attacker:src\";flow:to_server,established;flowbits:set, cve_2020_5504;content:\"/server_privileges.php\";http_uri;content:\"ajax_request=\";http_uri;content:\"alidate_username=\";http_uri;content:\"username=\";http_uri;content:\"'\";http_uri;distance:0;pcre:\"/select|union|order|convert|concat|group_concat|sleep|waitfor|substr|updatexml/URi\";sid:2020011501;rev:1;)", "2020052410": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:reGeorg\u8fde\u63a5\u6210\u529f|tag:\u653b\u51fb\u4ee3\u7406|tool:reGeorg|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:success|o_msg:\u5185\u7f51\u6e17\u900f\u65f6\u7684\u5e38\u7528\u5de5\u5177reGeorg|failed_by:http_status_3XX,http_status_4XX\";flowbits:isset, regeory_froward;flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"application/octet-stream\";pkt_data;content:\"X-STATUS: OK\";http_header;content:\"Connection: Keep-Alive\";http_header;sid:2020052410;rev:1;)", "2027035": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"aABpAHMAIABwAHIAbwBnAHIAYQB\";distance:0;fast_pattern;metadata:former_category ATTACK_RESPONSE;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027035;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_03_05, malware_family DNSlivery, updated_at 2019_03_05;)", "2019070001": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Struts2\u6f0f\u6d1e|tag:S2-045\u6f0f\u6d1e|direction:out|src:home_net|dest:external_net|level:attack|severity:2|failed_by:http_status_3XX,http_status_4XX|phase:attack_out|result:unknown|o_msg:\u68c0\u6d4b\u5230\u4f7f\u7528Struts2 Jakarta Plugin\u63d2\u4ef6\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u7684payload\u5bf9\u5916\u653b\u51fb\uff0c\u6000\u7591\u8be5\u7cfb\u7edf\u5df2\u88ab\u653b\u9677\";flow:to_server,established;content:\"com.opensymphony.xwork2.ActionContext.container\";http_client_body;content:\"com.opensymphony.xwork2.ognl.OgnlUtil@class\";http_client_body;gid:0;sid:2019070001;rev:1;)", "2020070324": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|tag:\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\".php\";http_uri;fast_pattern;http_content_type;content:!\"boundary=\";pkt_data;content:!\"<?xml\";http_client_body;content:\"<script language=\";http_client_body;nocase;pcre:\"/echo|eval|system|phpinfo|md5|die|assert|call_user_func|print|file_put_contents/PRi\";sid:2020070324;rev:1;)", "2019000049": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528\u6f0f\u6d1e\u6267\u884c\u547d\u4ee4|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u68c0\u6d4b\u5230\u8fdc\u7a0b\u547d\u4ee4\u6267\u884cwhoami|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;http_content_len;byte_test:0,<,7,0,string,dec;pkt_data;content:\"nobody\";http_server_body;flowbits:isset,cmd_reponse_echo;sid:2019000049;)", "2020070811": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6587\u4ef6\u5305\u542b\u8bfb\u53d6|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u6587\u4ef6\u8bfb\u53d6\u5c1d\u8bd5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, file_read_general;content:\"/etc\";http_uri;fast_pattern;pcre:\"/httpd\\/logs\\/access(_|\\.)log/U\";sid:2020070811;rev:1;)", "2020072010": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u6f0f\u6d1e\u653b\u51fb\uff08\u673a\u5668\u5b66\u4e60\uff09|tag:\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u8bf7\u6c42\u4f53\u5305\u542b dnslog|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\".\";http_client_body;fast_pattern;pcre:\"/(vcap\\.me)|(xip\\.name)|(send\\.jiance\\.qianxin\\.com)|(tu4\\.org)|(d\\.zhack\\.ca)/Pi\";sid:2020072010;rev:1;)", "2020061211": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u8fbeOA\u524d\u53f0\u4efb\u610f\u7528\u6237\u4f2a\u9020\u767b\u5f55\u6f0f\u6d1e|tag:\u672a\u6388\u6743\u8bbf\u95ee|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u901a\u8fbeOA\u524d\u53f0\u4efb\u610f\u7528\u6237\u4f2a\u9020\u767b\u5f55\u6f0f\u6d1e\uff0c\u83b7\u53d6\u7528\u6237code_uid|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, tongda_login_bypass_step_1;noalert;content:\"/general/login_code.php\";http_uri;depth:80;nocase;sid:2020061211;rev:1;)", "2026924": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"XctT2JqZW\";fast_pattern;distance:0;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026924;rev:3;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2019010091": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6cdb\u5faeOA e-cology WorkflowCenterTreeData\u524d\u53f0\u63a5\u53e3SQL\u6ce8\u5165\u6f0f\u6d1e|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u6cdb\u5faeOA e-cology WorkflowCenterTreeData\u524d\u53f0\u63a5\u53e3SQL\u6ce8\u5165\u6f0f\u6d1e|attacker:src\";flow:to_server,established;flowbits:set, ecology_oa_workflowcentertreedata_sql;content:\"POST\";http_method;content:\"/mobile/browser/WorkflowCenterTreeData.jsp\";http_uri;content:\"node=wftype_\";http_uri;distance:0;content:\"formids=\";http_client_body;pcre:\"/(\\)|%29){3}/PR\";content:\"%0a%0d\";distance:0;pcre:\"/DBMS_PIPE\\.RECEIVE_MESSAGE|CASEWHENTHEN|union|order by|group by|order%20by|group%20by|decode|union|select|utl_inaddr.get_host_address|column_name|user_tab_columns|UTL_HTTP\\.request|rownum/PRi\";pcre:\"/(\\(|%28){3}/PR\";sid:2019010091;rev:1;)", "2027040": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"1hcmdvcnA\";distance:0;fast_pattern;metadata:former_category ATTACK_RESPONSE;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027040;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_03_05, malware_family DNSlivery, updated_at 2019_03_05;)", "2019090278": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DNS\u8fde\u63a5|direction:in|level:action|service_name:Microsoft DNS|service_class:other|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft DNS|server:src\";flow:from_server,established;content:\"|07|version|04|bind\";within:27;pcre:\"/\\x07version\\x04bind\\0\\0\\x10\\0\\x03\\xc0\\x0c\\0\\x10\\0\\x01.{7}Microsoft DNS (6\\.3\\.9600.+)/\";sid:2019090278;gid:0;)", "2020062219": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:webshell\u4ea4\u4e92|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:4|result:success|o_msg:\u653b\u51fb\u8005\u5c1d\u8bd5\u901a\u8fc7webshell\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, mem_webshell_interaction;content:\"200\";http_stat_code;http_content_len;content:\"6\";pkt_data;content:\"->|7c 7c|<-\";http_server_body;depth:6;sid:2020062219;rev:1;)", "2020071415": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5e94\u7528\u7a0b\u5e8f\u5141\u8bb8rpdb\u8c03\u8bd5|tag:\u5371\u9669\u914d\u7f6e|src:home_net|level:attack|severity:3|result:success|phase:exploit|o_msg:\u5e94\u7528\u7a0b\u5e8f\u5141\u8bb8rpdb\u8c03\u8bd5\uff0c\u653b\u51fb\u8005\u53ef\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4|attacker:dest\";flow:from_server, established;flowbits:set, rpdb_rce_success;content:\"--Return--\";depth:15;content:\"<module>()->None\";distance:0;content:\"-> rpdb.Rpdb(\";distance:0;content:\").set_trace()\";distance:0;content:\"(Pdb) \";distance:0;sid:2020071415;)", "2019000079": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Fastjson <=1.2.66 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Fastjson <=1.2.66 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, fastjson_jndi;content:\"@type\";http_client_body;fast_pattern;content:\"com.caucho.config.types.ResourceRef\";http_client_body;distance:0;content:\"lookupName\";http_client_body;nocase;pcre:\"/(ldap|rmi):\\/\\//PRi\";sid:2019000079;rev:1;)", "2018081308": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u8fdb\u884c\u8fdb\u884c\u78c1\u76d8\u6d4f\u89c8\";dsize:7;flow:from_server,established;content:\"LIST |0D 0A|\";depth:7;nocase;flowbits:set,TB_ZxShell_2;flowbits:noalert;sid:2018081308;rev:1;)", "2018062806": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:weevely\u8fde\u63a5\u8bf7\u6c42|tag:\u83dc\u5200|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230weevely\u8fde\u63a5php webshell\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;pcre:\"/^SESSID=we\\;/C\";sid:2018062806;rev:1;)", "2019090028": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:VNC\u8fde\u63a5|direction:in|level:action|service_name:VNC|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728VNC|server:src\";flow:from_server,established;content:\"RFB\";depth:3;pcre:\"/^RFB 240\\.6\\n\\0\\x02$/\";sid:2019090028;gid:0;)", "2018010038": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165\u5199\u5165\u6587\u4ef6|tag:\u6ce8\u5165\u5199\u6587\u4ef6|dest:home_net|level:attack|phase:exploit|severity:2|success_by:sql_inject_success|o_msg:\u5c1d\u8bd5\u5229\u7528MySQL\u6ce8\u5165\u5199\u5165\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"select\";nocase;http_uri;pcre:\"/[\\s\\w/\\\\.*\\d()\"'=,:\\;+<>_-]+/iUR\";content:\"into outfile \";nocase;http_uri;distance:1;within:100;pcre:\"/['\"][0-9A-Za-z/\\\\._:-]+['\"]/iUR\";flow:to_server,established;gid:0;sid:2018010038;rev:1;)", "2020032405": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7phpmyadmin\u5f00\u542f\u5168\u5c40\u65e5\u5fd7|tag:\u5371\u9669\u914d\u7f6e|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5c1d\u8bd5\u901a\u8fc7phpmyadmin\u4fee\u6539\u5168\u5c40\u65e5\u5fd7|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, phpmyadmin_exec_sql_success;content:\"POST\";http_method;content:\"/import.php\";http_uri;content:\"sql_query=\";http_client_body;content:\"set+global+general_log\";http_client_body;distance:0;nocase;content:\"on\";http_client_body;distance:0;within:10;nocase;sid:2020032405;rev:1;)", "2020051113": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:UEditor .net\u7248\u672c getshell|tag:getshell|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:success|o_msg:UEditor .net\u7248\u672c getshell|attacker:src\";flow:from_server,established;flowbits:isset, ueditor_net_getshell;content:\"200\";http_stat_code;content:\"{\\\"state\\\":\\\"SUCCESS\\\"\";http_server_body;sid:2020051113;rev:1;)", "2020021302": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6d4f\u89c8Web\u76ee\u5f55|tag:\u76ee\u5f55\u904d\u5386|direction:in|dest:home_net|src:external_net|level:action|severity:0|result:success|o_msg:\u68c0\u6d4b\u5230\u76ee\u5f55\u904d\u5386\u884c\u4e3a(python)|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"<!DOCTYPE html PUBLIC\";http_server_body;offset:0;content:\"<title>Directory listing for\";within:75;http_server_body;gid:0;sid:2020021302;)", "2019000024": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fc7nc\u6267\u884c\u547d\u4ee4|tag:\u53cd\u5f39shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:\u901a\u8fc7nc\u6267\u884c\u547d\u4ee4\";flags:P,A;dsize:<200;flow:established;content:\".x86_64 #1 SMP \";within:80;content:\"UTC \";within:34;pcre:\"/UTC 20[1,2]\\d x86_64/\";flowbits:isset,uname_send;flowbits:unset,uname_send;sid:2019000024;)", "180531201": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Gh0st2013\u540e\u95e8\u6728\u9a6c|type:rat|tag:Gh0st2013|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230Gh0st2013 - \u4e0a\u7ebf\u5305\";flow:from_server,established;dsize:22;content:\"|53 68 61 64 6f 16 00 00 00 01 00 00 00 78 9c 63 00 00 00 01 00 01|\";depth:22;sid:180531201;rev:1;)", "2002383": "alert tcp $HOME_NET 21 -> $HOME_NET any (msg:\"name:FTP\u7206\u7834\u653b\u51fb|tag:\u7206\u7834|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|attacker:dest|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5bf9FTP\u7684\u7206\u7834\u653b\u51fb\u5c1d\u8bd5\";flow:from_server,established;dsize:<100;content:\"530 \";depth:4;pcre:\"/530\\s+(Login|User|Failed|Not)/smi\";threshold:type threshold, track by_dst, count 30, seconds 1;reference:url,doc.emergingthreats.net/2002383;classtype:unsuccessful-user;sid:2002383;rev:12;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2020051205": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Jboss jmx\u2014console\u8fdc\u7a0b\u90e8\u7f72war\u5305|tag:\u5371\u9669\u884c\u4e3a|dest:home_net|level:attack|phase:exploit|force_save:true|result:unknown|o_msg:Jboss jmx\u2014console\u8fdc\u7a0b\u90e8\u7f72war\u5305|severity:2|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, jboss_remote_war;content:\"POST\";http_method;content:\"/jmx-console/HtmlAdaptor\";http_uri;content:\"action=invokeOp\";http_client_body;content:\"name=jboss.deployment%3Atype%3DDeploymentScanner%2Cflavor%3DURL\";http_client_body;content:\".war\";http_client_body;sid:2020051205;rev:2;)", "180531200": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Gh0st2013\u540e\u95e8\u6728\u9a6c|type:rat|tag:Gh0st2013|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230Gh0st2013\u6837\u672c(set)\";content:\"|53 68 61 64 6f|\";depth:5;content:\"|00 00 78 9c|\";distance:6;within:5;threshold:type both, track by_src, count 5, seconds 180;sid:180531200;rev:1;)", "2017120110": "alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:\"name:\u5efa\u7acb\u901a\u4fe1\u96a7\u9053|type:tunneling|tag:DNS\u96a7\u9053|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:2|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5f02\u5e38\u7684NULL\u7c7b\u578b\u8bf7\u6c42\";content:!\"|00|\";offset:12;depth:1;byte_test:1, >, 30, 12, big;content:\"|00 0a 00 01|\";content:\"|00 00 00 00 00 00|\";distance:0;isdataat:!1, relative;threshold:type threshold, track by_src, count 50, seconds 300;sid:2017120110;rev:2;)", "2020051247": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DIR-412 \u65e5\u5fd7\u6cc4\u6f0f\u6f0f\u6d1e|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:attack|phase:exploit|result:success|o_msg:DIR-412 \u65e5\u5fd7\u6cc4\u6f0f\u6f0f\u6d1e|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, d_link_412_info;content:\"200\";http_stat_code;http_content_type;content:\"test/plain\";pkt_data;content:\"[System]\";http_server_body;content:\"++++++++++++++++++++++++++++++++++++\";http_server_body;distance:0;sid:2020051247;rev:2;)", "2018081331": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u5378\u8f7d\u81ea\u8eab\";flow:from_server,established;content:\"UnInstall\";depth:9;nocase;flowbits:isset,TB_ZxShell;sid:2018081331;rev:1;)", "2020010047": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5229\u7528struts2\u6f0f\u6d1e|tag:struts2|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|failed_by:http_status_3XX,http_status_4XX|success_by:execmd|o_msg:\u8be5\u884c\u4e3a\u662f\u4e00\u7cfb\u5217struts2\u6f0f\u6d1e\u7684\u5229\u7528\u57fa\u7840|attacker:src\";flow:to_server,established;content:\"/\";http_uri;pcre:\"/(:?\\$|%){.*member_?access[^}]*}/URi\";flowbits:set,cmd_reponse_echo;sid:2020010047;)", "2026860": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT Possible Cisco RV320 RCE Attempt (CVE-2019-1652)|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"/certificate_handle2.htm?type=\";http_uri;content:\"page=self_generator.htm&totalRules=\";http_client_body;depth:35;fast_pattern;content:\"|25 32 37 25 32 34 25 32 38|\";http_client_body;distance:0;metadata:former_category EXPLOIT;reference:url,seclists.org/fulldisclosure/2019/Jan/54;classtype:trojan-activity;sid:2026860;rev:1;metadata:attack_target Networking_Equipment, deployment Perimeter, cve 2019_1652, signatrue_severity Major, created_at 2019_01_29, performance_impact Low, updated_at 2019_01_29;)", "2017872": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u77ff\u6c60\u5730\u5740|type:mining|tag:BitCoinMiner|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230W32/BitCoinMiner.MultiThreat\u6316\u77ff\u534f\u8bae\u7279\u5f81\uff08\u521d\u59cb\u5316\u8fde\u63a5\u4fe1\u606f\uff09\";flow:established,from_server;content:\"|22|result|22 3A| [[|22|mining.notify|22|\";depth:120;reference:url,research.zscaler.com/2013/12/bitcoin-mining-operation-seen-across.html;reference:url,www.btcguild.com/new_protocol.php;reference:url,mining.bitcoin.cz/stratum-mining;classtype:trojan-activity;sid:2017872;rev:2;)", "2020052517": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528burpsuite\u653b\u51fb|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tool:burp|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u4f7f\u7528burp\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"GET\";http_method;content:\"burpcollaborator.net\";http_uri;fast_pattern;sid:2020052517;rev:1;)", "2020052502": "alert dns $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528wyzxxz.cn\u8fdb\u884c\u53cd\u5f39|tag:dnslog|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u5229\u7528dnslog\u8fdb\u884c\u53cd\u5f39|attacker:dest\";flow:established, to_server;dns_query;content:\".wyzxxz.cn\";pkt_data;sid:2020052502;rev:1;)", "2026935": "alert dns any any -> $HOME_NET any (msg:\"name:DNS\u54cd\u5e94\u5305\u4e2d\u5305\u542bBase64\u7f16\u7801\u7684Powershell\u811a\u672c|tag:\u8fdc\u7a0b\u63a7\u5236|direction:out|dest:home_net|level:attack|phase:control|type:c2|result:success|severity:4|o_msg:DNS\u54cd\u5e94\u5305\u5e94\u8be5\u662f\u975e\u5e38\u5e72\u51c0\u7684\uff0c\u4f46\u662f\u9ed1\u5ba2\u4f1a\u901a\u8fc7DNS\u4f20\u8f93\u5185\u5bb9\uff0c\u8ba9DNS\u54cd\u5e94\u5305\u542b\u5404\u79cd\u547d\u4ee4\u548c\u811a\u672c\uff0c\u5e76\u7528Base64\u505a\u7f16\u7801\";content:\"|00 00 10 00 01 c0 0c 00 10 00 01|\";content:\"52b2tlLVdtaU1ldG\";distance:0;fast_pattern;metadata:former_category CURRENT_EVENTS;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026935;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_19, malware_family DNSlivery, updated_at 2019_02_19;)", "2019090164": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Lotus Domino 6.x LDAP|direction:in|level:action|service_name:Lotus Domino 6.x LDAP|service_class:auth|severity:1|result:unknown|o_msg:\u5b58\u5728Lotus Domino 6.x LDAP|server:src\";flow:from_server,established;content:\"0.|02 01 01|a\";depth:6;pcre:\"/^0\\.\\x02\\x01\\x01a\\)\\n\\x010\\x04\\0\\x04\\\"Failed, anonymous bind not allowed$/\";sid:2019090164;gid:0;)", "2020081714": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c|tag:\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:\u5c1d\u8bd5\u901a\u8fc7cmd\u6267\u884c\u547d\u4ee4\u4e0b\u8f7d\u6587\u4ef6|severity:2|gray:true|attacker:src\";flow:to_server, established;content:\"certutil\";fast_pattern;pcre:\"/-urlcache\\s+-split\\s+-f\\s+/R\";sid:2020081714;rev:1;)", "2020060214": "alert TCP $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(CommonsCollections1-TCP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|attacker:src\";flow:established, to_server;content:\"|ac ed 00 05|\";fast_pattern;content:\"sun.reflect.annotation.AnnotationInvocationHandler\";content:\"org.apache.commons.collections.map.LazyMap\";content:\"org.apache.commons.collections.functors.InvokerTransformer\";sid:2020060214;rev:1;)", "2020051406": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u81f4\u8fdc OA A8\u8fdc\u7a0bGetshell|tag:GetShell|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:\u81f4\u8fdc OA A8\u8fdc\u7a0b\u6f0f\u6d1e\u5229\u7528\uff0c\u653b\u51fb\u8005\u5c1d\u8bd5\u4e0a\u4f20\u6587\u4ef6\uff0c\u83b7\u53d6\u76ee\u6807\u673a\u5668\u6743\u9650|severity:3|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, seeyon_a8_getshell_exp;content:\"POST\";http_method;content:\"/seeyon/htmlofficeservle\";http_uri;depth:30;content:\"DBSTEP\";http_client_body;depth:20;content:\"DBSTEP=\";http_client_body;distance:10;content:\"FILENAME=\";http_client_body;distance:0;content:\"originalCreateDate=\";http_client_body;content:\"<\";http_client_body;distance:0;within:200;pcre:\"/^(\\s+)?((%)|(jsp)|(script))/PR\";sid:2020051406;rev:2;)", "2018111001": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Lucky\u52d2\u7d22|type:trojan|tag:Lucky\u52d2\u7d22|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230Lucky\u52d2\u7d22\u53d1\u8d77HTTP\u54cd\u5e94|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"1.0\";pcre:\"/1.0\\d/Q\";flowbits:isset,TB_ftxx;sid:2018111001;rev:1;)", "2019010052": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:fastjson\u6f0f\u6d1e\u5229\u7528|tag:JAVA\u53cd\u5e8f\u5217\u5316|phase:exploit|dest:home_net|level:attack|failed_by:http_status_3XX,http_status_4XX|severity:3|result:unknown|o_msg:fastjson|attacker:src\";flow:to_server,established;content:\"@type\";http_client_body;content:\"java.lang.Class\";within:22;http_client_body;content:\"com.sun.rowset.JdbcRowSetImpl\";within:50;http_client_body;sid:2019010052;gid:0;)", "2840241": "alert dns any any -> $HOME_NET any (msg:\"name:Cobalt Strike\u53cd\u5f39DNS\u8bf7\u6c42|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|dest:home_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike DNS\u53cd\u5f39\";content:\"|00 01 00 01 00 00 00 00|\";offset:4;depth:8;content:\"|00 10|\";distance:0;content:\"WYIIIIIIIIIIIIIII\";distance:0;fast_pattern;classtype:trojan-activity;sid:2840241;rev:1;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2020_01_03, updated_at 2020_01_03;)", "2019010105": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Harbor\u4efb\u610f\u7ba1\u7406\u5458\u6ce8\u518c\u6f0f\u6d1e(CVE-2019-16097)|tag:\u6743\u9650\u7ed5\u8fc7|dest:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:Harbor\u4efb\u610f\u7ba1\u7406\u5458\u6ce8\u518c\u6f0f\u6d1e(CVE-2019-16097)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, harbor_privilege_escalation;content:\"201\";http_stat_code;http_response_line;content:\"Created\";sid:2019010105;rev:1;)", "2018010054": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MSSQL\u6ce8\u5165|tag:\u6ce8\u5165\u6267\u884c\u547d\u4ee4|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:MSSQL\u6ce8\u5165 -  \u6267\u884c\u7cfb\u7edf\u547d\u4ee4|dest:home_net|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"GET\";nocase;http_method;content:\"\\;exec\";nocase;http_uri;pcre:\"/[ +]+master.(dbo)?.xp_cmdshell[ +]*['\"]/iUR\";flow:to_server,established;gid:0;sid:2018010054;rev:1;)", "2018020063": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u670d\u52a1\u5668\u51fa\u73b0PHP fatal error|direction:in|dest:home_net|src:external_net|level:action|o_msg:\u670d\u52a1\u5668\u8fd4\u56de\u9875\u9762\u51fa\u73b0php fatal error|failed_by:http_status_3XX,http_status_4XX\";http_content_type;content:\"text/html\";pkt_data;content:\"Fatal error</b>:\";nocase;within:3000;http_server_body;content:\"in\";within:300;http_server_body;pcre:\"/in (<b>)?\\d:(\\[\\d\\w_.-]+)+\\.php(<\\/b>)? on line /Q\";flow:from_server,established;sid:2018020063;rev:1;)", "2019060006": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:success|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"POST\";http_method;content:\".jsp\";http_uri;content:\"=\";http_cookie;pcre:\"/[a-fA-F0-9]{32}/CR\";http_content_len;byte_test:0,>=,8000,0,string,dec;pkt_data;http_accept;content:\"text/html, image/gif, image/jpeg, *\\; q=.2, */*\\; q=.2\";pkt_data;content:\"a\";nocase;http_client_body;pcre:\"/^([a-zA-Z0-9+/]+a[a-zA-Z0-9+=/]+)$/P\";flowbits:isset, bingxie_webshell_step2_jsp;sid:2019060006;gid:0;rev:1;)", "2020051115": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-2551)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-2551)|attacker:dest\";flow:established, from_server;flowbits:isset, cve_2020_2551;content:\"GIOP\";depth:4;content:\"omg.org/CORBA/MARSHAL\";distance:0;sid:2020051115;rev:1;)", "2019010041": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u5229\u7528fastjson\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:JAVA\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u901a\u8fc7http POST\u89e6\u53d1fastjson\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(BasicDataSource\u5229\u7528\u94fe)|attacker:src\";flow:to_server,established;content:\"@type\";http_client_body;content:\"org.apache.tomcat.dbcp.dbcp.BasicDataSource\";distance:1;nocase;http_client_body;content:\"com.sun.org.apache.bcel.internal.util.ClassLoader\";nocase;http_client_body;gid:3;sid:2019010041;)", "2829516": "alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Cobalt Strike\u8fde\u63a5(APT32)|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:external_net|dest:home_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:\u5b58\u5728Cobalt Strike \u8fde\u63a5\uff08APT32\uff09\";flow:established,from_server;tls_cert_subject;content:\"CN=steam.learning-api.com\";nocase;isdataat:!1,relative;metadata:former_category MALWARE;reference:md5,4d4ab90ffb069357239e95f82f6a524d;classtype:trojan-activity;sid:2829516;rev:1;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2018_02_01, malware_family APT32, performance_impact Moderate, updated_at 2019_09_28;)", "2020072015": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u6f0f\u6d1e\u653b\u51fb\uff08\u673a\u5668\u5b66\u4e60\uff09|tag:\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u8bf7\u6c42\u4f53\u5305\u542b dnslog|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\".\";http_uri;fast_pattern;pcre:\"/(vcap\\.me)|(xip\\.name)|(send\\.jiance\\.qianxin\\.com)|(tu4\\.org)|(d\\.zhack\\.ca)/Ui\";sid:2020072015;rev:1;)", "180827001": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dofloo_DDoS|type:botnet|tag:Dofloo|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u6728\u9a6c\u540e\u95e8Linux.DDoS.AesDDoS/Dofloo/MrBlack\u5fc3\u8df3\u5305\";dsize:16<>36;content:\"INFO:\";depth:5;nocase;content:\"%|7C|\";distance:0;content:\"MB\";distance:0;nocase;threshold:type both, track by_src, count 8, seconds 60;sid:180827001;rev:2;)", "2018030021": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u83dc\u5200webshell\u865a\u62df\u7ec8\u7aef\u6267\u884c\u547d\u4ee4|tag:webshell\u8fde\u63a5|tool:\u83dc\u5200|direction:in|dest:home_net|src:external_net|level:attack|type:shell|phase:control|severity:4|result:success|o_msg:\u83dc\u5200webshell\u5217\u76ee\u5f55\u884c\u4e3a|failed_by:http_status_3XX,http_status_4XX\";content:\"200\";nocase;http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"|0a|\";http_server_body;within:50;pcre:\"/^([\\d\\w`~!@#$%^&*()+=_<>?,./:\"\\;'\\\\{}\\[\\]]{3})([\\d\\w._-]+\\x0a)+\\[S\\]\\x0a(\\/[\\d\\w._-]+)+\\x0a\\[E\\]\\x0a\\1/iQ\";flowbits:isset,req;flow:from_server,established;sid:2018030021;rev:1;)", "2020070311": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|tag:\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:4|result:unknown|o_msg:PHP\u4ee3\u7801\u6267\u884c\u653b\u51fb|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\".php\";http_uri;content:\"system\";http_uri;fast_pattern;distance:0;pcre:\"/\\$_(GET|POST)\\[\\S+\\]/URi\";sid:2020070311;rev:1;)", "2019010061": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6210\u529f\u901a\u8fc7spark REST api\u90e8\u7f72\u4ee3\u7801|tag:\u6f0f\u6d1e\u5229\u7528|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u672a\u6388\u6743\u7684\u653b\u51fb\u8005\u53ef\u80fd\u901a\u8fc7\u672a\u6b63\u786e\u914d\u7f6eACL\u7684spark REST API\u8fdc\u7a0b\u6267\u884c\u4efb\u610f\u4ee3\u7801|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;http_content_type;content:\"application/json\";pkt_data;content:\"200\";http_stat_code;file_data;content:\"{|0a|  \\\"action\\\" \\: \\\"CreateSubmissionResponse\\\",|0a|  \\\"message\\\" \\: \\\"Driver successfully submitted as\";content:\"\\\"success\\\" \\: true|0a|}\";distance:0;flowbits:isset,spark_state_access;gid:3;sid:2019010061;)", "28095051": "alert tcp $HOME_NET any -> $HOME_NET 27017 (msg:\"name:\u7206\u7834MongoDB|tag:\u7206\u7834|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:1|attacker:src|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5bf9MongoDB\u7684\u7206\u7834\u653b\u51fb\";flow:to_server,established;content:\"|d4 07 00 00|\";offset:12;depth:4;fast_pattern;content:\"admin.$cmd|00|\";distance:0;content:\"listDatabases|00|\";distance:0;sid:28095051;)", "2019090279": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DNS\u8fde\u63a5|direction:in|level:action|service_name:Microsoft DNS|service_class:other|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft DNS|server:src\";flow:from_server,established;content:\"|07|version|04|bind\";within:27;pcre:\"/\\x07version\\x04bind\\0\\0\\x10\\0\\x03\\xc0\\x0c\\0\\x10\\0\\x01.{7}Microsoft DNS (6\\.2\\.9200.+)/\";sid:2019090279;gid:0;)", "2019090277": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:DNS\u8fde\u63a5|direction:in|level:action|service_name:Microsoft DNS|service_class:other|severity:1|result:unknown|o_msg:\u5b58\u5728Microsoft DNS|server:src\";flow:from_server,established;content:\"|07|version|04|bind\";within:27;pcre:\"/\\x07version\\x04bind\\0\\0\\x10\\0\\x03\\xc0\\x0c\\0\\x10\\0\\x01.{7}Microsoft DNS (10\\.0\\..+)/\";sid:2019090277;gid:0;)", "2020061812": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528goby\u626b\u63cf\u5668\u626b\u63cf|tag:\u626b\u63cf\u5668|dest:home_net|level:attack|phase:recon|severity:3|result:unknown|tool:goby|o_msg:\u4f7f\u7528goby\u626b\u63cf\u5668\u8fdb\u884c\u626b\u63cf\uff0c\u5904\u4e8e\u6f0f\u6d1e\u626b\u63cf\u9636\u6bb5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"/never_could_exists\";http_uri;depth:20;content:\"rememberMe=+2ewny/4XWAbAc9751f01TtmSLcxlwGmpMy2PSdrBq0=\";http_cookie;sid:2020061812;rev:1;)", "2019121802": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Tomcat\u4e0a\u4f20war\u5305|tag:Tomcat|dest:home_net|force_save:true|level:action|phase:exploit|severity:3|result:success|o_msg:Tomcat\u4e0a\u4f20war\u5305|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, tomcat_upload;content:\"200\";http_stat_code;content:\"Deploy directory or WAR file located on server\";http_server_body;sid:2019121802;rev:1;)", "2020070813": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u6587\u4ef6\u5305\u542b\u8bfb\u53d6|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u6587\u4ef6\u5305\u542b\u8bfb\u53d6|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, file_read_general;content:\"tomcat\";http_uri;fast_pattern;content:\"log/localhost_access_log\";http_uri;sid:2020070813;rev:1;)", "2809648": "alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:\"name:\u5229\u7528SMB\u4f20\u8f93mimikatz|tag:smb|direction:lateral|type:infil|src:home_net|dest:home_net|attacker:src|level:attack|phase:post_exploit|severity:3|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5728\u5185\u7f51\u901a\u8fc7SMB\u534f\u8bae\u4f20\u8f93\u9ed1\u5ba2\u5de5\u5177Mimikatz\u7684mimilib.dll\u6587\u4ef6\uff08Ascii\uff09\";flow:established,to_server;content:\"|FF|SMB|a2|\";offset:4;depth:5;byte_test:1,!&,0x80,6,relative;content:\"mimilib.dll\";distance:0;reference:url,github.com/gentilkiwi/mimikatz;classtype:trojan-activity;sid:2809648;rev:1;metadata:created_at 2015_01_30, updated_at 2015_01_30;)", "2018010104": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:python\u4ee3\u7801\u6ce8\u5165\u5c1d\u8bd5|tag:\u4ee3\u7801\u6ce8\u5165|dest:home_net|level:attack|failed_by:http_status_3XX,http_status_4XX|phase:exploit|severity:2|result:unknown|o_msg:\u6d4b\u8bd5\u662f\u5426\u5b58\u5728python\u4ee3\u7801\u6ce8\u5165\u6f0f\u6d1e|attacker:src\";content:\"POST\";nocase;http_method;content:\"eval(compile('for\";nocase;http_client_body;within:1000;flow:to_server,established;gid:0;sid:2018010104;rev:1;)", "2008463": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (ieguideupdate)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| ieguideupdate\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008463;classtype:trojan-activity;sid:2008463;rev:9;)", "2018072502": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u7aef\u53e3\u626b\u63cf|tag:\u626b\u63cf|tool:Nmap|type:\u6307\u7eb9\u63a2\u6d4b|direction:in|phase:recon|src:external_net|dest:home_net|level:attack|severity:1|result:unknown|o_msg:NMAP FIN\u626b\u63cf\u4e8b\u4ef6\";flags:F;threshold:type both, track by_src, count 260, seconds 10;sid:2018072502;rev:1;)", "2019010012": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5XSS\u6f0f\u6d1e|tag:XSS|dest:home_net|level:attack|severity:1|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:unknown|o_msg:\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u6d4b\u8bd5\u662f\u5426\u5b58\u5728XSS|attacker:src\";content:\"<script>alert(\";http_header;nocase;pcre:\"/'?\\w+'?\\)<\\/script>/iHR\";gid:0;sid:2019010012;rev:1;)", "2020020704": "alert tcp $HOME_NET 6379 -> $EXTERNAL_NET any (msg:\"name:redis\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|src:home_net|level:attack|phase:exploit|severity:2|result:success|o_msg:redis\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff08\u57fa\u4e8e\u4e3b\u4ece\u590d\u5236\uff09|attacker:dest\";flow:established, from_server;flowbits:isset, load_exp;flowbits:unset, load_exp;content:\"|2b 4f 4b 0d 0a|\";content:!\"-ERR Error loading the extension. Please check the server logs.\";sid:2020020704;rev:1;)", "2020041030": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2018-3191)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2018-3191)|attacker:src\";flow:established, to_server;xbits:set, weblogic_link_jrmp, track ip_dst, expire 60;content:\"|ac ed 00 05|\";content:\"com.bea.core.repackaged.springframework.transaction\";distance:0;content:\"weblogic.jms.common.MessageImpl\";distance:0;content:\"com.bea.core.repackaged.springframework.transaction.support.AbstractPlatformTransactionManager\";distance:0;sid:2020041030;rev:1;)", "2019010113": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:XML\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165|tag:XML\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:XML\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:!\"boundary=\";pkt_data;content:\"<soap:Body>\";http_client_body;content:\"<![CDATA[\";http_client_body;distance:0;content:\"<!DOCTYPE\";http_client_body;distance:0;content:\"<!ENTITY\";http_client_body;distance:0;content:\"SYSTEM \";http_client_body;distance:0;pcre:\"/(file|http|https|php|expect)\\:\\/\\//PRi\";sid:2019010113;rev:1;)", "2821002": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528Empire\u5efa\u7acbSessiona|tag:\u6728\u9a6c|direction:out|src:home_net|dest:external_net|level:attack|type:c2|phase:control|severity:3|result:success|o_msg:\u4f7f\u7528Empire\u5efa\u7acbSession|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\"Mozilla/5.0 (Windows NT 6.1|3b 20|WOW64|3b 20|Trident/7.0|3b 20|rv|3a|11.0) like Gecko\";http_user_agent;pcre:\"/^\\/((?:login|admin)\\/(?:process\\.jsp|get\\.php)|(?:index|news)(\\.asp|\\.php))$/Ui\";http_start;content:\"HTTP/1.1|0d 0a|Cookie|3a 20|SESSIONID=\";nocase;fast_pattern;pkt_data;http_header_names;content:\"|0d 0a|Cookie|0d 0a|\";depth:10;content:!\"Referer\";content:!\"Accept\";pkt_data;sid:2821002;)", "2019060012": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;content:\"200\";http_stat_code;content:\"PHPSESSID=\";http_cookie;pcre:\"/[a-fA-F0-9]{32}/CR\";noalert;flowbits:isset, bingxie_webshell;flowbits:set, bingxie_webshell_step2;content:\"b\";nocase;http_server_body;within:16;pcre:\"/^([a-f0-9A-F]{16})$/Q\";isdataat:!1,relative;sid:2019060012;gid:0;rev:1;)", "2020070105": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7\u52a0\u8f7d bcel \u7f16\u7801\u6267\u884c\u547d\u4ee4|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5c1d\u8bd5\u901a\u8fc7\u52a0\u8f7d bcel \u7f16\u7801\u540e\u7684\u6587\u4ef6\uff0c\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;content:\"com.sun.org.apache.bcel.internal.util.ClassLoader\";http_client_body;content:\"loadClass\";http_client_body;distance:0;content:\"$$BCEL$$\";http_client_body;distance:0;within:100;sid:2020070105;rev:1;)", "2020072706": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Weblogic\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\uff08CVE-2019-2615\uff09|tag:\u6587\u4ef6\u8bfb\u53d6|dest:home_net|level:attack|phase:exploit|result:success|o_msg:Weblogic\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\uff08CVE-2019-2615\uff09|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2019_2618;content:\"200\";http_stat_code;http_content_type;content:\"text/plain\";depth:12;pkt_data;content:\"|0d 0a|X-Powered-By: Servlet\";http_header;content:\"AdminServer\";http_server_body;content:!\"with an invalid application name\";http_server_body;sid:2020072706;rev:1;)", "2020051241": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:D-Link DIR-645\\DIR-815 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|result:unknown|o_msg:D-Link DIR-645 \u548c DIR-815 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, d_link_645_815_rce;content:\"POST\";http_method;content:\"/diagnostic.php\";http_uri;nocase;content:\"act=ping\";http_client_body;content:\"dst=\";http_client_body;pcre:\"/((\\|\\|)|(%7c%7c)|(%7c)|(%3b)|(%26)|([\\|\\;]))/PRi\";pcre:\"/(ls|cd|pwd|wget|curl|adduser|cat|passwd|chmod|echo|netstat|uname|sysctl|mysql|history|bash|useradd|ps|ifconfig|find|id|grep|awk|last|lsof|iptables|find|whoami|touch|ping)/PRi\";sid:2020051241;rev:2;)", "2019090144": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Exim\u8fde\u63a5|direction:in|level:action|service_name:Exim(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Exim|server:src\";flow:from_server,established;content:\"554\";depth:3;pcre:\"/^554 SMTP service not available\\r\\n$/\";sid:2019090144;gid:0;)", "2020081444": "alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c\uff08udp\uff09|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|type:shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884cdir\u547d\u4ee4\";content:\"   <DIR>          \";fast_pattern;pcre:\"/\\d{4}\\/[01]+\\d\\/[0-3]\\d {2}[0-2]\\d\\:[0-6]\\d {4}<DIR> {10}\\.\\x0d\\x0a\\d{4}\\/[01]+\\d\\/[0-3]\\d {2}[0-2]\\d\\:[0-6]\\d {4}<DIR> {10}\\.{2}\\x0d\\x0a/\";sid:2020081444;)", "2019090209": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 E?SMTP [^\\r\\n]*\\r\\n502 5\\.5\\.2 Error: command not recognized\\r\\n/\";sid:2019090209;gid:0;)", "2020062306": "alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5efa\u7acb ICMP \u901a\u9053\u4f20\u8f93\u6570\u636e|tag:\u653b\u51fb\u4ee3\u7406|tool:icmpsh|direction:in|dest:external_net|src:home_net|level:attack|phase:control|type:control|severity:4|result:success|o_msg:\u653b\u51fb\u8005\u5efa\u7acbICMP\u96a7\u9053\uff0c\u53cd\u5f39shell\u6267\u884c\u547d\u4ee4|attacker:dest\";flow:established, to_server;itype:8;icode:0;content:\"<DIR>|20 20 20 20 20 20 20 20|\";depth:30;sid:2020062306;rev:1;)", "2019010092": "alert http $EXTERNAL_NET any -> $HOME_NET 9200 (msg:\"name:elasticsearch\u672a\u6388\u6743\u8bbf\u95ee|tag:elasticsearch|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:elasticsearch\u672a\u6388\u6743\u8bbf\u95ee|attacker:src\";flow:established, to_server;flowbits:set, established_unauthorization;noalert;content:!\"Authorization\\: Basic\";http_header;sid:2019010092;)", "2020070704": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Jenkins\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2019-1003000\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|src:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Jenkins\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2019-1003000\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:dest\";flow:to_server,established;xbits:isset, cve_2019_1003000_1, track ip_src;content:\"HEAD\";http_method;content:\"Apache Ivy/\";http_user_agent;sid:2020070704;rev:1;)", "2020061022": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u4f7f\u7528weblogic\u4e0a\u4f20war\u5305\u90e8\u7f72\u5e94\u7528|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u5c1d\u8bd5\u4f7f\u7528weblogic\u4e0a\u4f20war\u5305\u90e8\u7f72\u5e94\u7528|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, weblogic_upload_war;content:\"POST\";http_method;content:\"/console/console.portal\";http_uri;content:\"AppApplicationInstallPortlet_actionOverride=\";http_uri;distance:0;content:\"/com/bea/console/actions/app/install/uploadApp\";http_uri;distance:0;http_content_type;content:\"boundary=\";pkt_data;content:\"name=\\\"AppApplicationInstallPortletuploadAppPath\\\"\";http_client_body;sid:2020061022;rev:1;)", "2029381": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Cobalt Strike\u8fde\u63a5\u8bf7\u6c42(\u5229\u7528stackoverflow)|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|src:home_net|dest:external_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike\u5229\u7528stackoverflow\u8fdb\u884c\u53cd\u8fde|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\"/questions/32251816/c-sharp-directives-compilation-error\";isdataat:!1,relative;fast_pattern;http_uri;content:\"prov=\";depth:5;http_cookie;content:\"_ga=GA1.2.9924|3b|_gat=1|3b|__qca=P0-214459\";isdataat:!1,relative;http_cookie;http_header_names;content:!\"Referer\";content:\"Cookie\";metadata:former_category MALWARE;reference:url,github.com/xx0hcd/Malleable-C2-Profiles;classtype:trojan-activity;sid:2029381;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2020_02_06, malware_family Cobalt_Strike, updated_at 2020_02_06;)", "2008084": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (Mozilla-web)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| Mozilla-web\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008084;classtype:trojan-activity;sid:2008084;rev:8;)", "2019090120": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Dovecot\u8fde\u63a5|direction:in|level:action|service_name:Dovecot(imap)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Dovecot|server:src\";flow:from_server,established;content:\"* OK \";depth:5;pcre:\"/^\\* OK Dovecot at ([-\\w_.]+) is ready\\.\\r\\n/\";sid:2019090120;gid:0;)", "2025798": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ET EXPLOIT Generic system shell command to php base64 encoded Remote Code Execution 4|tag:TEST|dest:home_net|level:attack|severity:3|failed_by:http_status_3XX,http_status_4XX|phase:exploit|result:success|gray:true|o_msg:BBBBB|attacker:src\";flow:established,to_server;content:\"c3lzdGVtKCJwaH\";metadata:former_category EXPLOIT;classtype:attempted-user;sid:2025798;rev:2;metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18;)", "2019000080": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Fastjson <=1.2.66 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:Fastjson <=1.2.66 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, fastjson_jndi;content:\"@type\";http_client_body;fast_pattern;content:\"org.apache.shiro.\";http_client_body;distance:0;pcre:\"/(realm\\.jndi\\.JndiRealmFactory)|(jndi\\.JndiObjectFactory)/PR\";content:\"jndiNames\";http_client_body;nocase;pcre:\"/(ldap|rmi):\\/\\//PRi\";sid:2019000080;rev:1;)", "2011667": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:reDuh\u521d\u59cb\u5316\u8fde\u63a5|tag:\u653b\u51fb\u8df3\u677f|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:4|result:unknown|o_msg:reDuh\u521d\u59cb\u5316\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"?action=checkPort&port=\";http_uri;content:\"Java/\";http_user_agent;sid:2011667;rev:6;)", "2019090088": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:FileZilla\u8fde\u63a5|direction:in|level:action|service_name:FileZilla|service_class:file|severity:1|result:unknown|o_msg:\u5b58\u5728FileZilla|server:src\";flow:from_server,established;content:\"220\";depth:3;pcre:\"/^220 FileZilla Server (\\d[\\w.]+)\\r\\n/\";sid:2019090088;gid:0;)", "2019010082": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:php create_function\u6f0f\u6d1e\u5229\u7528|tag:webshell php|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u901a\u8fc7create_function\u95f4\u63a5\u8c03\u7528eval\u89e6\u53d1rce|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:established,to_server;http_request_line;content:\".php?\";content:\"=\";distance:0;content:\"}\";distance:0;content:\"\\;/*\";distance:0;pcre:\"/\\.php\\?\\w+=[\\w\\s@()\\;.'\"_-]*}\\s*@?(?:echo )?(?:system|assert|eval|exec|shell_exec|passthru|popen|proc_open|)\\([\\s\\w'\"$_\\[\\]()%]*?\\)\\s*\\;\\s*\\/[*/]/U\";flowbits:set,php_create_function;sid:2019010082;)", "2020081009": "alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6267\u884c\u547d\u4ee4net user|tag:\u53cd\u5f39shell|direction:in|dest:external_net|src:home_net|level:attack|type:shell|phase:control|severity:3|result:success|o_msg:\u6267\u884c\u547d\u4ee4net user\";content:\"\\\\\\\\\";content:\"|0d 0a 0d 0a|-------------------------------------------------------------------------------\";distance:1;within:150;content:\"|0d 0a|Administrator\";distance:0;content:\"|0d 0a|Guest\";distance:0;sid:2020081009;)", "2020010033": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528\u6f0f\u6d1e\u6267\u884c\u547d\u4ee4|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u68c0\u6d4b\u5230\u8fdc\u7a0b\u547d\u4ee4\u6267\u884cid|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;http_content_len;byte_test:0,<,40,0,string,dec;pkt_data;content:\"uid=0(root) gid=0(root) groups=0(root)\";http_server_body;flowbits:isset,cmd_reponse_echo;sid:2020010033;)", "2018081312": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:ZxShellCV\u540e\u95e8\u6728\u9a6c|type:rat|tag:ZxShellCV|direction:out|src:external_net|dest:home_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230APT\u5de5\u5177\u540e\u95e8Win.ZxShellCV.a\u8fdb\u884c\u6d4f\u89c8F\u76d8\";dsize:9;flow:from_server,established;content:\"LIST F:|0d 0a|\";depth:9;nocase;flowbits:isset,TB_ZxShell_2;sid:2018081312;rev:1;)", "2019090176": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Hmail\u8fde\u63a5|direction:in|level:action|service_name:Hmail(smtp)|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Hmail|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 .+\\r\\n211 DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY\\r\\n\\r\\n/\";sid:2019090176;gid:0;)", "2018111004": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Lucky\u52d2\u7d22|type:trojan|tag:Lucky\u52d2\u7d22|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u5bf9Lucky\u52d2\u7d22\u7684\u4e0b\u8f7d\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"GET\";http_method;content:\"/d/conn32\";http_uri;fast_pattern;sid:2018111004;rev:1;)", "2019090211": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Postfix\u8fde\u63a5|direction:in|level:action|service_name:Postfix|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728Postfix|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220 ([-\\w_.]+) ESMTP \\w+\\r\\n$/\";sid:2019090211;gid:0;)", "2003586": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (WinXP Pro Service Pack 2)|failed_by:http_status_3XX,http_status_4XX\";flow:to_server,established;content:\"User-Agent|3a| WinXP Pro Service Pack\";http_header;threshold:type limit, count 3, seconds 300, track by_src;reference:url,doc.emergingthreats.net/2003586;classtype:trojan-activity;sid:2003586;rev:12;)", "2020072909": "alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528\u5411\u65e5\u8475\u8fdc\u63a7|tag:\u5411\u65e5\u8475\u8fdc\u63a7|direction:in|level:action|service_name:\u5411\u65e5\u8475\u8fdc\u63a7|severity:1|service_class:rlogin|result:unknown|o_msg:\u4f7f\u7528\u5411\u65e5\u8475\u8fdc\u63a7|server:src\";flow:established, to_server;tls_sni;content:\"sl-log.oray.net\";depth:15;isdataat:!1,relative;pkt_data;sid:2020072909;rev:2;)", "2028589": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Cobalt Strike\u5229\u7528O365\u8fdb\u884cC2\u8bf7\u6c42|tag:\u8fdc\u7a0b\u63a7\u5236|tool:Cobalt_Strike|direction:out|dest:external_net|src:home_net|level:attack|phase:control|attacker:external_net|result:success|severity:4|o_msg:Cobalt Strike\u5229\u7528O365\u8fdb\u884cC2\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:established,from_server;content:\"16723708fc9|0d 0a|X-CalculatedBETarget|3a 20|BY2PR06MB549.namprd06.prod.outlook.com\";http_header;fast_pattern;content:\"X-FEServer|3a 20|CY4PR02CA0010\";http_header;distance:0;metadata:former_category MALWARE;reference:md5,a26722fc7e5882b5a273239cddfe755f;reference:url,attack.mitre.org/groups/G0080/;classtype:trojan-activity;sid:2028589;rev:2;metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signatrue_severity Major, created_at 2019_09_17, malware_family Cobalt_Strike, updated_at 2019_09_17;)", "2019090217": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:qmail\u8fde\u63a5|direction:in|level:action|service_name:Qmail|service_class:mail|severity:1|result:unknown|o_msg:\u5b58\u5728qmail|server:src\";flow:from_server,established;content:\"220 \";depth:4;pcre:\"/^220[\\s-].*ESMTP ?\\r\\n214[- ]qmail home page: http://pobox\\.com/~djb/qmail\\.html\\r\\n/\";sid:2019090217;gid:0;)", "2019090246": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:OpenVPN\u8fde\u63a5|direction:in|level:action|service_name:OpenVPN|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728OpenVPN|server:src\";flow:from_server,established;content:\"|00 0e|@\";depth:3;pcre:\"/^\\0\\x0e@........\\0\\0\\0\\0\\0\\0\\x0e@/\";sid:2019090246;gid:0;)", "2019010145": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:MySQL\u6ce8\u5165|tag:\u6ce8\u5165|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|success_by:sql_inject_success|o_msg:SQL\u6ce8\u5165|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;content:\"union\";nocase;http_client_body;pcre:\"/[\\\\/*! ]+/select[\\\\/*! ]+/iPR\";flow:to_server,established;gid:0;sid:2019010145;rev:1;)", "2019010008": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4e0a\u4f20\u6076\u610f\u884c\u4e3a|tag:\u4e0a\u4f20\u6076\u610f\u6587\u4ef6|level:attack|phase:exploit|result:unknown|o_msg:\u4e0a\u4f20\u6076\u610f\u884c\u4e3a|severity:1|dest:home_net|failed_by:http_status_3XX,http_status_4XX|attacker:src\";content:\"POST\";nocase;http_method;http_content_type;content:\"multipart/form-data\\;\";nocase;pcre:\"/[ ]+boundary=/iHR\";pkt_data;content:\"Content-Disposition:\";nocase;http_client_body;content:\"<%@Page Language=\";nocase;http_client_body;flowbits:set,upload_script_file;flow:to_server,established;gid:0;sid:2019010008;rev:1;)", "2018020036": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6d4f\u89c8Web\u76ee\u5f55|tag:\u76ee\u5f55\u904d\u5386|direction:in|dest:home_net|src:external_net|level:attack|phase:exploit|severity:1|result:success|o_msg:\u68c0\u6d4b\u5230\u6d4f\u89c8\u76ee\u5f55\u7684\u884c\u4e3a\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u7279\u6027\u83b7\u53d6web\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6|failed_by:http_status_3XX,http_status_4XX|gray:true\";flow:from_server,established;content:\"<!DOCTYPE HTML PUBLIC\";http_server_body;offset:0;content:\"|0a|<html>|0a 20|<head>|0a 20 20|<title>Index|20|of|20|/\";http_server_body;within:75;gid:0;sid:2018020036;)", "2020010035": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5229\u7528\u6f0f\u6d1e\u6267\u884c\u547d\u4ee4|tag:\u6267\u884c\u547d\u4ee4|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u6267\u884cping\u547d\u4ee4(Linux)|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"PING \";http_server_body;content:\" bytes of data.|0a|\";http_server_body;distance:20;content:\" bytes from \";http_server_body;distance:2;content:\"icmp_seq=1 ttl=\";http_server_body;distance:6;content:\"time=\";http_server_body;distance:2;content:\" ms|0a|\";http_server_body;distance:4;content:\"|0a 0a 2d 2d 2d 20|\";http_server_body;distance:0;content:\" ping statistics ---|0a|\";http_server_body;distance:6;content:\" packets transmitted, \";http_server_body;distance:1;content:\" received, \";http_server_body;distance:1;content:\"% packet loss, time \";http_server_body;distance:1;content:\"ms|0a|rtt min/avg/max/mdev = \";http_server_body;distance:1;content:\" ms|0a|\";http_server_body;distance:2;flowbits:isset,cmd_reponse_echo;sid:2020010035;rev:1;)", "2008710": "alert tcp $HOME_NET any -> $HOME_NET 139 (msg:\"name:\u5229\u7528MS08-067\u6f0f\u6d1e\u653b\u51fb|tag:\u6f0f\u6d1e\u5229\u7528|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u5185\u7f51\u5b58\u5728NETBIOS\u534f\u8bae\u7f51\u7edcAPI\u6808\u6ea2\u51fa\u5229\u7528\u884c\u4e3a - MS08-067\";flow:established,to_server;content:\"|1F 00|\";content:\"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|\";content:\"|00 2E 00 2E 00 5C 00 2E 00 2E 00 5C|\";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008710;classtype:attempted-admin;sid:2008710;rev:5;metadata:created_at 2010_07_30, updated_at 2010_07_30;)", "2020061302": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u4e0a\u4f20Behinder webshell|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:\u4e0a\u4f20Behinder webshell|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"POST\";http_method;http_content_type;content:\"boundary=\";pkt_data;content:\"<%\";http_client_body;distance:0;content:\"javax.crypto.\";http_client_body;distance:0;content:\"Cipher.getInstance(\\\"AES\\\")\\;\";http_client_body;distance:0;sid:2020061302;rev:1;)", "2018030031": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u83dc\u5200\u8fde\u63a5\u6210\u529f|tag:webshell\u8fde\u63a5|tool:\u83dc\u5200|direction:in|dest:home_net|src:external_net|level:attack|phase:control|severity:4|result:success|o_msg:\u83dc\u5200\u8fde\u63a5\u6210\u529f|failed_by:http_status_3XX,http_status_4XX\";content:\"200\";nocase;http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"X@Y\";http_server_body;within:50;pcre:\"/X@Y\\w+(X@Y)(.?)$/iQ\";flowbits:isset,caidao_request;flow:from_server,established;sid:2018030031;rev:1;)", "2018010026": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u89e3\u6790\u6f0f\u6d1e\u63a2\u6d4b|tag:\u89e3\u6790\u6f0f\u6d1e\u8bd5\u63a2|phase:exploit|dest:home_net|level:attack|severity:1|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:IIS6.0\u89e3\u6790\u6f0f\u6d1e\u63a2\u6d4b|attacker:src\";content:\"GET\";nocase;http_method;content:\".asp\";nocase;http_uri;within:200;pcre:\"/\\/[\\d\\w_-]\\.(jpg|gif|png)/iUR\";flow:to_server,established;gid:0;sid:2018010026;rev:1;)", "2020030024": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u4f7f\u7528\u5de5\u5177LaZagne|tag:LaZagne|tool:LaZagne|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:LaZagne|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"[+] System masterkey decrypted for \";http_server_body;content:\"------------------- Hashdump passwords -----------------\";http_server_body;content:\"------------------- Lsa_secrets passwords -----------------\";http_server_body;content:\"Administrator:500:\";http_server_body;content:\"Guest:501:\";http_server_body;distance:70;sid:2020030024;rev:1;)", "2020080323": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u5c1d\u8bd5\u901a\u8fc7 Metasploit \u8fde\u63a5\u670d\u52a1\u5668(tcp)|tag:\u53cd\u5f39shell|direction:in|dest:external_net|src:home_net|level:attack|phase:control|severity:3|attack_type:target|result:success|o_msg:Metasploit \u8fde\u63a5(windows/shell/bind_tcp)\";flags:P, A;flow:from_server, established;flowbits:isset, windows_shell_bind_tcp_1;content:\"Microsoft Windows\";sid:2020080323;)", "2020010040": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6267\u884cipconfig\u547d\u4ee4|tag:\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u68c0\u6d4b\u5230\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\". . . . . . . . :\";http_server_body;pcre:\"/[0-9a-f]{4}::[0-9a-f]{4}:[0-9a-f]{4}:[0-9a-f]{4}:[0-9a-f]{4}%[0-9a-f]{2}/RQ\";content:\". . . . . . . :\";http_server_body;pcre:\"/\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}/RQ\";sid:2020010040;)", "2020050906": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u51b0\u874ewebshell|tag:webshell|dest:home_net|level:attack|phase:exploit|type:shell|severity:3|result:success|o_msg:\u51b0\u874e\u7684\u521d\u59cb\u8fde\u63a5|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:isset, bingxie_webshell_step2;content:\"POST\";http_method;content:\".jsp\";http_uri;isdataat:!1,relative;content:\"JSESSIONID=\";http_cookie;content:\"Pragma: no-cache\";http_header;content:\"Connection: keep-alive\";http_header;http_content_len;byte_test:0,>,8000,0,string,dec;pkt_data;pcre:\"/^([a-zA-Z0-9+/]+a[a-zA-Z0-9+=/]+)$/P\";sid:2020050906;gid:0;rev:1;)", "2020010016": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u8fbeOA\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20|tag:\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u901a\u8fbeOA\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, tongda_upload;content:\"200\";http_stat_code;content:\"+OK [vm]\";http_server_body;content:\"[/vm]\";http_server_body;distance:2;sid:2020010016;rev:1;)", "2019010037": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u5c1d\u8bd5\u5229\u7528fastjson\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e|tag:JAVA\u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:\u901a\u8fc7http POST\u89e6\u53d1fastjson\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(JNDI\u6ce8\u5165)|attacker:src\";flow:to_server,established;content:\"@type\";http_client_body;content:\"com.sun.rowset.JdbcRowSetImpl\";distance:1;nocase;http_client_body;content:\"ldap|3A|//\";http_client_body;flowbits:set, fastjson_exp;xbits:set,is_exploit_fastjson_ldap,track ip_dst;gid:3;sid:2019010037;)", "2020010603": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:mongo express \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c(CVE-2019-10758)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|failed_by:http_status_3XX,http_status_4XX|result:unknown|o_msg:mongo express \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c(CVE-2019-10758)|attacker:src\";flow:to_server,established;flowbits:set, cve_2019_10758;content:\"/checkValid\";http_uri;content:\"document=this.constructor.constructor(\\\"return process\\\")().mainModule.require(\\\"child_process\\\").execSync(\\\"\";http_client_body;sid:2020010603;rev:1;)", "2020061905": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Jupyter Notebook \u672a\u6388\u6743\u8bbf\u95ee|tag:\u672a\u6388\u6743\u8bbf\u95ee|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Jupyter Notebook \u672a\u6388\u6743\u8bbf\u95ee\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u8bbf\u95eenotebook\u6587\u4ef6\u751a\u81f3\u6267\u884c\u547d\u4ee4|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;noalert;flowbits:set, jupyter_notebook_unauth;content:\"GET\";http_method;content:\"/tree?\";http_uri;depth:20;http_header_names;content:\"|0d 0a|Cookie|0d 0a|\";fast_pattern;pkt_data;content:!\"username-\";http_cookie;sid:2020061905;rev:1;)", "2018062802": "alert http $HOME_NET any -> $HOME_NET any (msg:\"name:\u83dc\u5200\u8fde\u63a5\u8bf7\u6c42|tag:\u83dc\u5200|direction:lateral|type:infil|src:home_net|dest:home_net|level:attack|phase:post_exploit|severity:3|attacker:src|gray:|result:unknown|o_msg:\u68c0\u6d4b\u5230\u83dc\u5200\u8fde\u63a5php webshell\u8bf7\u6c42|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;pcre:\"/=.?\\$xx.{0,200}\\;.?\\$yy.?=.?\\$_POST.?\\;.{0,2}eval.{0,20}\\$xx.{0,20}\\$yy/iP\";sid:2018062802;rev:1;)", "2019090237": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:radmin\u8fde\u63a5|direction:in|level:action|service_name:Radmin|service_class:rlogin|severity:1|result:unknown|o_msg:\u5b58\u5728Radmin|server:src\";flow:from_server,established;content:\"|01 00 00 00|\";depth:4;pcre:\"/^\\x01\\x00\\x00\\x00\\x25\\x09\\x00\\x01\\x10\\x08\\x01\\x00\\x09\\x08/\";sid:2019090237;gid:0;)", "2020052010": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u6cdb\u5faeOA\u4e0a\u4f20GetShell|tag:\u6587\u4ef6\u4e0a\u4f20|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u6cdb\u5faeOA\u4e0a\u4f20GetShell|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"200\";http_stat_code;content:\"file type is not valid!\";http_server_body;sid:2020052010;rev:1;)", "2018040034": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:\u626b\u63cf\u9ed1\u5ba2\u540e\u95e8|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|phase:exploit|failed_by:http_status_3XX,http_status_4XX|severity:2|result:unknown|o_msg:\u68c0\u6d4b\u5230\u626b\u63cf\u83dc\u5200\u540e\u95e8\u884c\u4e3a(\u9ed1\u5403\u9ed1\u884c\u4e3a)\uff0c\u9ed1\u5ba2\u4ee5\u7206\u7834\u65b9\u5f0f\u5927\u8303\u56f4\u626b\u63cf\u522b\u7684\u9ed1\u5ba2\u7559\u4e0b\u7684\u540e\u95e8\";content:\"POST\";nocase;http_method;content:\"=eval/**/\";nocase;http_client_body;within:20;flowbits:set, caidao_request;flowbits:set,webshell.scan;flow:to_server,established;gid:0;sid:2018040034;rev:1;)", "2020060228": "alert TCP $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb(Groovy1-TCP)|tag:JAVA \u53cd\u5e8f\u5217\u5316|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:JAVA \u53cd\u5e8f\u5217\u5316\u653b\u51fb|attacker:src\";flow:established, to_server;content:\"|ac ed 00 05|\";fast_pattern;content:\"sun.reflect.annotation.AnnotationInvocationHandler\";content:\"java.util.Mapxrjava.lang.reflect.Proxy\";content:\"org.codehaus.groovy.runtime.ConvertedClosure\";sid:2020060228;rev:1;)", "2020050917": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u901a\u7528\u547d\u4ee4\u6267\u884c|tag:\u6267\u884c\u547d\u4ee4|direction:in|src:external_net|dest:home_net|level:attack|phase:control|severity:3|result:success|o_msg:\u6267\u884c\u547d\u4ee4ll\u6216ls -l|failed_by:http_status_3XX,http_status_4XX\";flow:from_server,established;flowbits:isset, post_req;content:\"200\";http_stat_code;http_content_type;content:\"text/html\";pkt_data;content:\"total \";http_server_body;fast_pattern;content:\"|0a|-\";http_server_body;distance:2;within:80;pcre:\"/^((r|-)(w|-)(x|-)){3}\\s+1\\s\\S+[ ]{2}\\S+[ ]+\\d+\\s/QR\";sid:2020050917;gid:0;rev:1;)", "2020072014": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u901a\u7528\u6f0f\u6d1e\u653b\u51fb\uff08\u673a\u5668\u5b66\u4e60\uff09|tag:exploit|dest:home_net|level:attack|phase:exploit|severity:2|result:unknown|o_msg:\u8bf7\u6c42\u4f53\u5305\u542b dnslog|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\".cn\";http_uri;fast_pattern;pcre:\"/(wyzxxz\\.cn)|(awvsscan119\\.autoverify\\.cn)|(cloudeye\\.cn)|(nslog\\.0kee\\.360\\.cn)/Ui\";sid:2020072014;rev:1;)", "2020000052": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Orcale\u4fe1\u606f\u6cc4\u9732|tag:Orcale|dest:home_net|phase:exploit|level:attack|severity:1|result:unknown|o_msg:\u901a\u8fc7\u5404\u79cd\u6e20\u9053\u5bfc\u81f4Orcale\u5730\u5740\uff0c\u5bc6\u7801\uff0c\u7528\u6237\u540d\u6cc4\u9732|gray:true|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;content:\"password\";http_server_body;content:\"user\";http_server_body;content:\"jdbc\";http_server_body;fast_pattern;pcre:\"/(jbdc\\:oracle\\:thin\\:@)|(oracle\\.jdbc\\.driver\\.OracleDriver)/Qi\";sid:2020000052;rev:1;)", "2020070309": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Thinkphp \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;content:\"/module/action/param1/${\";http_uri;depth:200;sid:2020070309;rev:1;)", "2020052409": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:reGeorg\u8fde\u63a5\u6210\u529f|tag:\u653b\u51fb\u4ee3\u7406|tool:reGeorg|direction:in|src:external_net|dest:home_net|level:attack|phase:control|type:shell|severity:3|result:unknown|o_msg:\u5185\u7f51\u6e17\u900f\u65f6\u7684\u5e38\u7528\u5de5\u5177reGeorg|failed_by:http_status_3XX,http_status_4XX\";flowbits:set, regeory_froward;noalert;flow:established, to_server;content:\"X-CMD: FORWARD\";http_header;http_content_type;content:\"application/octet-stream\";pkt_data;sid:2020052409;rev:1;)", "2018040032": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u626b\u63cf\u9ed1\u5ba2Webshell\u540e\u95e8|tag:\u626b\u63cf\u9ed1\u5ba2\u540e\u95e8|type:\u626b\u63cf|direction:in|src:external_net|dest:home_net|level:attack|phase:exploit|failed_by:http_status_3XX,http_status_4XX|severity:2|result:unknown|o_msg:\u68c0\u6d4b\u5230\u626b\u63cf\u540e\u95e8\u884c\u4e3a(\u9ed1\u5403\u9ed1\u884c\u4e3a)\uff0c\u9ed1\u5ba2\u4ee5\u7206\u7834\u65b9\u5f0f\u5927\u8303\u56f4\u626b\u63cf\u522b\u7684\u9ed1\u5ba2\u7559\u4e0b\u7684\u540e\u95e8\";content:\"POST\";nocase;http_method;content:\"=die(@md5(Ch3ck1ng))\";nocase;http_client_body;flowbits:set, caidao_request;flowbits:set,webshell.scan;flow:to_server,established;gid:0;sid:2018040032;rev:1;)", "2008423": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u540e\u95e8\u6728\u9a6c|type:rat|tag:\u53ef\u7591UA|direction:out|src:home_net|dest:external_net|level:attack|phase:control|severity:4|gray:|result:success|o_msg:\u68c0\u6d4b\u5230\u53ef\u7591User-Agent (CFS Agent)|failed_by:http_status_3XX,http_status_4XX\";flow:established,to_server;content:\"User-Agent|3a| CFS Agent\";http_header;threshold:type limit, count 2, track by_src, seconds 300;reference:url,doc.emergingthreats.net/bin/view/Main/2008423;classtype:trojan-activity;sid:2008423;rev:9;)", "2020061002": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Drupal Drupalgeddon 2 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2018-7600\uff09|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:Drupal Drupalgeddon 2 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2018-7600\uff09|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, cve_2018_7600_1;content:\"200\";http_stat_code;http_content_type;content:\"application/json\";pkt_data;content:\"\\\"command\\\":\\\"insert\\\"\";http_server_body;content:\"\\\"data\\\"\";http_server_body;content:!\"data\\\":\\\"\\\\u003C\";http_server_body;sid:2020061002;rev:1;)", "2020041035": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:WebLogic XXE|tag:xxe|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:WebLogic XXE|attacker:src\";flow:established, to_server;xbits:set, weblogic_xxe, track ip_dst, expire 20;content:\"|ac ed 00 05|\";content:\"<!DOCTYPE\";distance:0;content:\"SYSTEM \";distance:0;pcre:\"/(http|https):\\/\\//Ri\";sid:2020041035;rev:1;)", "2020051102": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:Zabbix SQL(latest.php) \u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2016-10134\uff09|tag:SQL\u6ce8\u5165\u6f0f\u6d1e|dest:home_net|level:attack|phase:exploit|result:success|o_msg:Zabbix SQL(latest.php) \u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2016-10134\uff09|severity:3|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, CVE-2016-10134;content:\"200\";http_stat_code;http_content_type;content:\"application/javascript\";pkt_data;content:\"Error in query [INSERT INTO profiles\";http_server_body;sid:2020051102;rev:2;)", "2020060005": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u7591\u4f3cwebshell\u8bbf\u95ee|tag:webshell|direction:in|src:home_net|dest:external_net|level:attack|phase:control|severity:2|result:success|type:shell|o_msg:webshell\u8fde\u63a5\";flow:established,to_server;content:\"\u4e3b\u673a\u540d|3a|\";content:\"OS \u540d\u79f0|3a|\";content:\"OS \u7248\u672c|3a|\";content:\"OS \u5236\u9020\u5546|3a|\";content:\"Microsoft Corporation\";distance:0;content:\"OS \u914d\u7f6e|3a|\";content:\"OS \u6784\u4ef6\u7c7b\u578b|3a|\";content:\"\u6ce8\u518c\u7684\u6240\u6709\u4eba|3a|\";content:\"\u6ce8\u518c\u7684\u7ec4\u7ec7|3a|\";content:\"\u4ea7\u54c1 ID|3a|\";content:\"\u521d\u59cb\u5b89\u88c5\u65e5\u671f|3a|\";content:\"\u7cfb\u7edf\u542f\u52a8\u65f6\u95f4|3a|\";content:\"\u7cfb\u7edf\u5236\u9020\u5546|3a|\";content:\"\u7cfb\u7edf\u578b\u53f7|3a|\";content:\"\u7cfb\u7edf\u7c7b\u578b|3a|\";content:\"\u5904\u7406\u5668|3a|\";reference:md5,a22af4fc7fe011069704a15296634ca6;classtype:trojan-activity;sid:2020060005;rev:1;metadata:created_at 2014_08_25, updated_at 2014_08_25;)", "2020050703": "alert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:\u63a2\u6d4b\u670d\u52a1\u5668\u652f\u6301\u7684HTTP\u8bf7\u6c42\u65b9\u6cd5|tag:\u4fe1\u606f\u6cc4\u9732|dest:home_net|level:action|phase:recon|result:unknown|o_msg:\u63a2\u6d4b\u670d\u52a1\u5668\u652f\u6301\u7684HTTP\u8bf7\u6c42\u65b9\u6cd5|severity:2|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:to_server,established;flowbits:set, get_methods;content:\"OPTIONS\";http_method;noalert;sid:2020050703;rev:2;)", "2020061209": "alert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"name:\u81f4\u8fdcOA A8-m \u540e\u53f0\u4e07\u80fd\u5bc6\u7801|tag:\u540e\u53f0\u767b\u5f55|dest:home_net|level:attack|phase:exploit|severity:3|result:success|o_msg:\u81f4\u8fdcOA A8-m \u540e\u53f0\u4e07\u80fd\u5bc6\u7801WLCCYBD@SEEYON\uff0c\u653b\u51fb\u8005\u53ef\u76f4\u63a5\u767b\u5f55\u540e\u53f0|failed_by:http_status_3XX,http_status_4XX|attacker:src\";flow:from_server,established;flowbits:isset, seeyou_passwd_bypass;content:\"200\";http_stat_code;content:\"<h4>Server</h4>\";http_server_body;content:\"OS Name: \";http_server_body;content:\"OS Architecture: \";http_server_body;sid:2020061209;rev:1;)", "2020072206": "alert smb $HOME_NET any -> $HOME_NET any (msg:\"name:\u4f7f\u7528smb_psexec\u8c03\u7528powershell|tag:\u8fdc\u7a0b\u63a7\u5236|tool:psexec|src:home_net|dest:home_net|level:attack|phase:exploit|attacker:src|result:success|severity:4|o_msg:\u4f7f\u7528smb_psexec\u8c03\u7528powershell\";flow:established, to_server;content:\"SMB\";offset:5;depth:3;content:\"%|00|C|00|O|00|M|00|S|00|P|00|E|00|C|00|%|00|\";distance:0;content:\"p|00|o|00|w|00|e|00|r|00|s|00|h|00|e|00|l|00|l|00 2e 00|e|00|x|00|e|00|\";distance:0;sid:2020072206;rev:1;)", "2020062315": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"name:Apache Dubbo \u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(xbean\u94fe-dubbo\u534f\u8bae)|tag:\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c|dest:home_net|level:attack|phase:exploit|severity:3|result:unknown|o_msg:Apache Dubbo \u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(xbean\u94fe-dubbo\u534f\u8bae)|attacker:src\";flow:established, to_server;content:\"|da bb|\";depth:2;fast_pattern;content:\"org.apache.xbean.naming.context.ContextUtil$ReadOnlyBinding\";distance:0;content:\"javax.naming.Reference\";distance:0;content:\"org.apache.xbean.naming.context.WritableContext\";distance:0;sid:2020062315;rev:1;)"}